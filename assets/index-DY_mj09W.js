const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ccip-C898IB_F.js","assets/localBatchGatewayRequest-v6XgKuSh.js","assets/embedded-wallet-BpBqZBvO.js","assets/if-defined-B_6agGxS.js","assets/index-CfmpL7DF.js","assets/index-BP-TBNBq.js","assets/ref-eyS92wTZ.js","assets/index-Dy1_JXIs.js","assets/index-dbL_HSuk.js","assets/index-B6P59b2P.js","assets/index-BbOz8hEn.js","assets/index-P1K8zE99.js","assets/index-CjU39KGd.js","assets/index-CjU4-NCF.js","assets/email-H-P4SjTi.js","assets/index--CZfrv6B.js","assets/socials-DHX7MTLB.js","assets/index-SmVAdVlD.js","assets/ConstantsUtil-Dmg8YACJ.js","assets/index-Bsn_B2QV.js","assets/index-C3LvszMl.js","assets/index-LiPF0Pdd.js","assets/index-CNnsSv2F.js","assets/swaps-DJUfOb1D.js","assets/index-TNPoB9Bo.js","assets/index-ChixxGH2.js","assets/SwapController-Dmr27Y1q.js","assets/index-C5WYCkoS.js","assets/send-Cp77UUf_.js","assets/index-DHYdKBKO.js","assets/index-BVY99x87.js","assets/receive-LNPDuEgS.js","assets/index-CQoya6-e.js","assets/onramp-COsBJmGz.js","assets/index-D-O2VW1B.js","assets/index-D-gLTL__.js","assets/transactions-BKEr4tHk.js","assets/index-B61OYJYx.js","assets/index--gSvzbrs.js","assets/index-Ch7hilvX.js","assets/ui-B-tSXs1C.js","assets/index-Cs4_L2Nv.js","assets/index-C0rCejD_.js","assets/w3m-modal-CfOUKDZZ.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const tT=Symbol(),Rw=Object.getPrototypeOf,tm=new WeakMap,nT=t=>t&&(tm.has(t)?tm.get(t):Rw(t)===Object.prototype||Rw(t)===Array.prototype),rT=t=>nT(t)&&t[tT]||null,kw=(t,e=!0)=>{tm.set(t,e)},Ah={},J0=t=>typeof t=="object"&&t!==null,sT=t=>J0(t)&&!qu.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),dC=(t,e)=>{const n=nm.get(t);if(n?.[0]===e)return n[1];const r=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return kw(r,!0),nm.set(t,[e,r]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),a={value:i,enumerable:o,configurable:!0};if(qu.has(i))kw(i,!1);else if(Qi.has(i)){const[c,l]=Qi.get(i);a.value=dC(c,l())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},iT=(t,e,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!t()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(Dw(l,o)||Hl.has(o)&&Dw(l,Hl.get(o))))return!0;n(i),J0(o)&&(o=rT(o)||o);const u=!Qi.has(o)&&aT(o)?ct(o):o;return e(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,l]),!0}}),Qi=new WeakMap,qu=new WeakSet,nm=new WeakMap,yl=[1,1],Hl=new WeakMap;let Dw=Object.is,oT=(t,e)=>new Proxy(t,e),aT=sT,cT=dC,lT=iT;function ct(t={}){if(!J0(t))throw new Error("object required");const e=Hl.get(t);if(e)return e;let n=yl[0];const r=new Set,s=(m,y=++yl[0])=>{n!==y&&(n=y,r.forEach(v=>v(m,y)))};let i=yl[1];const o=(m=++yl[1])=>(i!==m&&!r.size&&(i=m,c.forEach(([y])=>{const v=y[1](m);v>n&&(n=v)})),n),a=m=>(y,v)=>{const w=[...y];w[1]=[m,...w[1]],s(w,v)},c=new Map,l=(m,y)=>{const v=!qu.has(y)&&Qi.get(y);if(v){if((Ah?"production":void 0)!=="production"&&c.has(m))throw new Error("prop listener already exists");if(r.size){const w=v[2](a(m));c.set(m,[v,w])}else c.set(m,[v])}},u=m=>{var y;const v=c.get(m);v&&(c.delete(m),(y=v[1])==null||y.call(v))},d=m=>(r.add(m),r.size===1&&c.forEach(([v,w],N)=>{if((Ah?"production":void 0)!=="production"&&w)throw new Error("remove already exists");const b=v[2](a(N));c.set(N,[v,b])}),()=>{r.delete(m),r.size===0&&c.forEach(([v,w],N)=>{w&&(w(),c.set(N,[v]))})});let h=!0;const f=lT(()=>h,l,u,s),p=oT(t,f);Hl.set(t,p);const g=[t,o,d];return Qi.set(p,g),Reflect.ownKeys(t).forEach(m=>{const y=Object.getOwnPropertyDescriptor(t,m);"value"in y&&y.writable&&(p[m]=t[m])}),h=!1,p}function cn(t,e,n){const r=Qi.get(t);(Ah?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function zl(t){const e=Qi.get(t);(Ah?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[n,r]=e;return cT(n,r())}function Wo(t){return qu.add(t),t}function uT(){return{proxyStateMap:Qi,refSet:qu,snapCache:nm,versionHolder:yl,proxyCache:Hl}}function ln(t,e,n,r){let s=t[e];return cn(t,()=>{const i=t[e];Object.is(s,i)||n(s=i)})}const{proxyStateMap:dT,snapCache:hT}=uT(),yd=t=>dT.has(t);function fT(t){const e=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const l=hT.get(a),u=l?.[1];if(u&&!s.has(u)){const d=new Map(r);s.set(u,d)}},o=l=>s.get(l)||r,a={data:e,index:n,epoch:0,get size(){return yd(this)||i(),o(this).size},get(l){const d=o(this).get(l);if(d===void 0){this.epoch;return}return this.data[d]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!yd(this))throw new Error("Cannot perform mutations on a snapshot");const d=r.get(l);return d===void 0?(r.set(l,this.index),this.data[this.index++]=u):this.data[d]=u,this.epoch++,this},delete(l){if(!yd(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(l);return u===void 0?!1:(delete this.data[u],r.delete(l),this.epoch++,!0)},clear(){if(!yd(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(l){this.epoch,o(this).forEach((d,h)=>{l(this.data[d],h,this)})},*entries(){this.epoch;const l=o(this);for(const[u,d]of l)yield[u,this.data[d]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=ct(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}var hs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function pT(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var Uw={};const F={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof Uw<"u"?Uw.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}}},ql={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return t?.filter(n=>n.chainNamespace===e)||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){if(!e)return;const n=t.find(s=>s.caipNetworkId===e);if(n)return n.name;const[r]=e.split(":");return F.CHAIN_NAME_MAP?.[r]||void 0}},hC=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var gT=20,mT=1,Vo=1e6,Bw=1e6,yT=-7,wT=21,bT=!1,Wu="[big.js] ",la=Wu+"Invalid ",bf=la+"decimal places",ET=la+"rounding mode",fC=Wu+"Division by zero",tt={},bs=void 0,vT=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function pC(){function t(e){var n=this;if(!(n instanceof t))return e===bs?pC():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(la+"value");e=e===0&&1/e<0?"-0":String(e)}AT(n,e)}n.constructor=t}return t.prototype=tt,t.DP=gT,t.RM=mT,t.NE=yT,t.PE=wT,t.strict=bT,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function AT(t,e){var n,r,s;if(!vT.test(e))throw Error(la+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function ua(t,e,n,r){var s=t.c;if(n===bs&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(ET);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==bs))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==bs||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function da(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}tt.abs=function(){var t=new this.constructor(this);return t.s=1,t};tt.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,o=t.s,a=n.e,c=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};tt.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>Vo)throw Error(bf);if(!s[0])throw Error(fC);if(!r[0])return t.s=i,t.c=[t.e=0],t;var a,c,l,u,d,h=s.slice(),f=a=s.length,p=r.length,g=r.slice(0,a),m=g.length,y=t,v=y.c=[],w=0,N=o+(y.e=e.e-t.e)+1;for(y.s=i,i=N<0?0:N,h.unshift(0);m++<a;)g.push(0);do{for(l=0;l<10;l++){if(a!=(m=g.length))u=a>m?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=g[d]){u=s[d]>g[d]?1:-1;break}if(u<0){for(c=m==a?s:h;m;){if(g[--m]<c[m]){for(d=m;d&&!g[--d];)g[d]=9;--g[d],g[m]+=10}g[m]-=c[m]}for(;!g[0];)g.shift()}else break}v[w++]=u?l:++l,g[0]&&u?g[m]=r[f]||0:g=[r[f]]}while((f++<p||g[0]!==bs)&&i--);return!v[0]&&w!=1&&(v.shift(),y.e--,N--),w>N&&ua(y,N,n.RM,g[0]!==bs),y};tt.eq=function(t){return this.cmp(t)===0};tt.gt=function(t){return this.cmp(t)>0};tt.gte=function(t){return this.cmp(t)>-1};tt.lt=function(t){return this.cmp(t)<0};tt.lte=function(t){return this.cmp(t)<1};tt.minus=tt.sub=function(t){var e,n,r,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var l=i.c.slice(),u=i.e,d=t.c,h=t.e;if(!l[0]||!d[0])return d[0]?t.s=-c:l[0]?t=new o(i):t.s=1,t;if(a=u-h){for((s=a<0)?(a=-a,r=l):(h=u,r=d),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(n=((s=l.length<d.length)?l:d).length,a=c=0;c<n;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(r=l,l=d,d=r,t.s=-t.s),(c=(n=d.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;n>a;){if(l[--n]<d[n]){for(e=n;e&&!l[--e];)l[e]=9;--l[e],l[n]+=10}l[n]-=d[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--h;return l[0]||(t.s=1,l=[h=0]),t.c=l,t.e=h,t};tt.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(fC);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};tt.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};tt.plus=tt.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,l=t.c;if(!a[0]||!l[0])return l[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,r=l):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-l.length<0&&(r=l,l=a,a=r),e=l.length,n=0;e;a[e]%=10)n=(a[--e]=a[e]+l[e]+n)/10|0;for(n&&(a.unshift(n),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};tt.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-Bw||t>Bw)throw Error(la+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};tt.prec=function(t,e){if(t!==~~t||t<1||t>Vo)throw Error(la+"precision");return ua(new this.constructor(this),t,e)};tt.round=function(t,e){if(t===bs)t=0;else if(t!==~~t||t<-Vo||t>Vo)throw Error(bf);return ua(new this.constructor(this),t+this.e+1,e)};tt.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(Wu+"No square root");i=Math.sqrt(+da(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do n=t,t=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return ua(t,(s.DP-=4)+t.e+1,s.RM)};tt.times=tt.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,o=s.length,a=i.length,c=n.e,l=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};tt.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==bs){if(t!==~~t||t<0||t>Vo)throw Error(bf);for(n=ua(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return da(n,!0,!!r)};tt.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==bs){if(t!==~~t||t<0||t>Vo)throw Error(bf);for(n=ua(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return da(n,!1,!!r)};tt[Symbol.for("nodejs.util.inspect.custom")]=tt.toJSON=tt.toString=function(){var t=this,e=t.constructor;return da(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};tt.toNumber=function(){var t=+da(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(Wu+"Imprecise conversion");return t};tt.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==bs){if(t!==~~t||t<1||t>Vo)throw Error(la+"precision");for(n=ua(new r(n),t,e);n.c.length<t;)n.c.push(0)}return da(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};tt.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(Wu+"valueOf disallowed");return da(t,t.e<=e.NE||t.e>=e.PE,!0)};var gi=pC();const CT={bigNumber(t){return t?new gi(t):new gi(0)},multiply(t,e){if(t===void 0||e===void 0)return new gi(0);const n=new gi(t),r=new gi(e);return n.times(r)},toFixed(t,e=2){return t===void 0||t===""?new gi(0).toFixed(e):new gi(t).toFixed(e)},formatNumberToLocalString(t,e=2){return t===void 0||t===""?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(t){if(t===void 0||t==="")return 0;const e=t.replace(/,/gu,"");return new gi(e).toNumber()}},IT=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],_T=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],NT=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],ST={getERC20Abi:t=>F.USDT_CONTRACT_ADDRESSES.includes(t)?NT:IT,getSwapAbi:()=>_T},jn={validateCaipAddress(t){if(t.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},we={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails"};function yp(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const me={setItem(t,e){Ja()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(Ja())return localStorage.getItem(t)||void 0},removeItem(t){Ja()&&localStorage.removeItem(t)},clear(){Ja()&&localStorage.clear()}};function Ja(){return typeof window<"u"&&typeof localStorage<"u"}function Zs(t,e){return e==="light"?{"--w3m-accent":t?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":t?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}var $w={};const wp=(typeof process<"u"&&typeof $w<"u"?$w.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",gC=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],xT="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Ye={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:wp,SECURE_SITE_DASHBOARD:`${wp}/dashboard`,SECURE_SITE_FAVICON:`${wp}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:[F.CHAIN.EVM,F.CHAIN.SOLANA],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[F.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[F.CHAIN.EVM,F.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[F.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[F.CHAIN.EVM,F.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},W={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=W.getActiveNamespace(),e=W.getActiveCaipNetworkId(),n=e?e.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:t,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:t,href:e}){try{me.setItem(we.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=me.getItem(we.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{me.removeItem(we.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{me.setItem(we.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{me.setItem(we.ACTIVE_CAIP_NETWORK_ID,t),W.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return me.getItem(we.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{me.removeItem(we.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=yp(t);me.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=W.getRecentWallets();e.find(r=>r.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),me.setItem(we.RECENT_WALLETS,JSON.stringify(e)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=me.getItem(we.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(t,e){try{const n=yp(t);me.setItem(n,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return me.getItem(we.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=yp(t);return me.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{me.setItem(we.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return me.getItem(we.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{me.removeItem(we.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return me.getItem(we.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){return me.getItem(we.ACTIVE_CAIP_NETWORK_ID)?.split(":")?.[1]},setConnectionStatus(t){try{me.setItem(we.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return me.getItem(we.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=me.getItem(we.CONNECTED_NAMESPACES);return t?.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));me.setItem(we.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=W.getConnectedNamespaces();e.includes(t)||(e.push(t),W.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=W.getConnectedNamespaces(),n=e.indexOf(t);n>-1&&(e.splice(n,1),W.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return me.getItem(we.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{me.setItem(we.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{me.removeItem(we.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=me.getItem(we.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=W.getBalanceCache();me.setItem(we.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const n=W.getBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;W.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=W.getBalanceCache();e[t.caipAddress]=t,me.setItem(we.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=me.getItem(we.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=W.getBalanceCache();me.setItem(we.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const n=W.getNativeBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",t),W.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=W.getNativeBalanceCache();e[t.caipAddress]=t,me.setItem(we.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=me.getItem(we.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const n=W.getEnsCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;W.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=W.getEnsCache();e[t.address]=t,me.setItem(we.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=W.getEnsCache();me.setItem(we.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=me.getItem(we.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const n=W.getIdentityCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;W.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=W.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},me.setItem(we.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=W.getIdentityCache();me.setItem(we.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},clearAddressCache(){try{me.removeItem(we.PORTFOLIO_CACHE),me.removeItem(we.NATIVE_BALANCE_CACHE),me.removeItem(we.ENS_CACHE),me.removeItem(we.IDENTITY_CACHE),me.removeItem(we.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{me.setItem(we.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=me.getItem(we.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const n=W.getConnections(),r=n[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),c=o.connectorId===F.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...n,[e]:Array.from(s.values())};me.setItem(we.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const t=me.getItem(we.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:n}){try{const r=W.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),me.setItem(we.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const t=me.getItem(we.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const n=W.getDisconnectedConnectorIds(),r=n[e]??[];r.push(t),me.setItem(we.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const n=W.getDisconnectedConnectorIds();let r=n[e]??[];r=r.filter(s=>s.toLowerCase()!==t.toLowerCase()),me.setItem(we.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(W.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1},getTransactionsCache(){try{const t=me.getItem(we.HISTORY_TRANSACTIONS_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:t,chainId:e=""}){try{const r=W.getTransactionsCache()[t]?.[e];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.transactionsHistory))return r.transactions;W.removeTransactionsCache({address:t,chainId:e})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:t,chainId:e="",timestamp:n,transactions:r}){try{const s=W.getTransactionsCache();s[t]={...s[t],[e]:{timestamp:n,transactions:r}},me.setItem(we.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:t,chainId:e,timestamp:n,transactions:r})}},removeTransactionsCache({address:t,chainId:e}){try{const n=W.getTransactionsCache(),r=n?.[t]||{},{[e]:s,...i}=r;me.setItem(we.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...n,[t]:i}))}catch{console.info("Unable to remove transactions cache",{address:t,chainId:e})}},getTokenPriceCache(){try{const t=me.getItem(we.TOKEN_PRICE_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(t){try{const n=W.getTokenPriceCache()[t.join(",")];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.tokenPrice))return n.tokenPrice;W.removeTokenPriceCache(t)}catch{console.info("Unable to get token price cache for addresses",t)}},updateTokenPriceCache(t){try{const e=W.getTokenPriceCache();e[t.addresses.join(",")]={timestamp:t.timestamp,tokenPrice:t.tokenPrice},me.setItem(we.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update token price cache",t)}},removeTokenPriceCache(t){try{const e=W.getTokenPriceCache();me.setItem(we.TOKEN_PRICE_CACHE,JSON.stringify({...e,[t.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",t)}}},le={isMobile(){return this.isClient()?!!(window?.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t?.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return le.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window?.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=Ye.TEN_SEC_MS:!0},isAllowedRetry(t,e=Ye.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return window?.self!==window?.top}catch{return!1}},isSafeApp(){if(le.isClient()&&window.self!==window.top)try{const t=window?.location?.ancestorOrigins?.[0],e="https://app.safe.global";if(t){const n=new URL(t),r=new URL(e);return n.hostname===r.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Ye.FOUR_MINUTES_MS},getNetworkId(t){return t?.split(":")[1]},getPlainAddress(t){return t?.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let n;return(...r)=>{function s(){t(...r)}n&&clearTimeout(n),n=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,n=null){if(le.isHttpUrl(t))return this.formatUniversalUrl(t,e);let r=t,s=n;r.includes("://")||(r=t.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),s&&!s?.endsWith("/")&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(t,e){if(!le.isHttpUrl(t))return this.formatNativeUrl(t,e);let n=t;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(e);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?W.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,n){window?.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},returnOpenHref(t,e,n){return window?.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){if(typeof window>"u")return!1;const t=window?.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)")?.matches:!1,e=window?.navigator?.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,le.wait(2e3)])},formatBalance(t,e){let n="0.000";if(typeof t=="string"){const r=Number(t);if(r){const s=Math.floor(r*1e3)/1e3;s&&(n=s.toString())}}return`${n}${e?` ${e}`:""}`},getApiUrl(){return F.W3M_API_URL},getBlockchainApiUrl(){return F.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return F.PULSE_API_URL},getUUID(){return crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){return typeof t=="string"?t:typeof t?.issues?.[0]?.message=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const n={};return e&&t&&(t.forEach((r,s)=>{n[r]=s}),e.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const n of t)e+=n.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[n,r]=e.split(".");return{dollars:n,pennies:r}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const n=new Set;return t.filter(r=>{const s=r[e];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(t,e,n){const s=t.length===0?Ye.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${n}`},createAccount(t,e,n,r,s){return{namespace:t,address:e,type:n,publicKey:r,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),n=e[0];return e.filter(Boolean).length===3&&n in F.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window?.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window?.location.href)}`,n="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,n,e)},injectIntoUrl(t,e,n){const r=t.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",r),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,r+i),c=t.substring(r+i,o),l=t.substring(s),u=c+n;return a+u+l}};async function Kc(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class Vu{constructor({baseUrl:e,clientId:n}){this.baseUrl=e,this.clientId=n}async get({headers:e,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await Kc(i,{method:"GET",headers:e,signal:n,cache:r})).json()}async getBlob({headers:e,signal:n,...r}){const s=this.createUrl(r);return(await Kc(s,{method:"GET",headers:e,signal:n})).blob()}async post({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Kc(i,{method:"POST",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Kc(i,{method:"PUT",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Kc(i,{method:"DELETE",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:n}){const r=new URL(e,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}}const TT={getFeatureValue(t,e){const n=e?.[t];return n===void 0?Ye.DEFAULT_FEATURES[t]:n},filterSocialsByPlatform(t){if(!t||!t.length)return t;if(le.isTelegram()){if(le.isIos())return t.filter(e=>e!=="google");if(le.isMac())return t.filter(e=>e!=="x");if(le.isAndroid())return t.filter(e=>!["facebook","x"].includes(e))}return t}},pe=ct({features:Ye.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Ye.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{}}),H={state:pe,subscribeKey(t,e){return ln(pe,t,e)},setOptions(t){Object.assign(pe,t)},setRemoteFeatures(t){if(!t)return;const e={...pe.remoteFeatures,...t};pe.remoteFeatures=e,pe.remoteFeatures?.socials&&(pe.remoteFeatures.socials=TT.filterSocialsByPlatform(pe.remoteFeatures.socials)),pe.features?.pay&&(pe.remoteFeatures.email=!1,pe.remoteFeatures.socials=!1)},setFeatures(t){if(!t)return;pe.features||(pe.features=Ye.DEFAULT_FEATURES);const e={...pe.features,...t};pe.features=e,pe.features?.pay&&pe.remoteFeatures&&(pe.remoteFeatures.email=!1,pe.remoteFeatures.socials=!1)},setProjectId(t){pe.projectId=t},setCustomRpcUrls(t){pe.customRpcUrls=t},setAllWallets(t){pe.allWallets=t},setIncludeWalletIds(t){pe.includeWalletIds=t},setExcludeWalletIds(t){pe.excludeWalletIds=t},setFeaturedWalletIds(t){pe.featuredWalletIds=t},setTokens(t){pe.tokens=t},setTermsConditionsUrl(t){pe.termsConditionsUrl=t},setPrivacyPolicyUrl(t){pe.privacyPolicyUrl=t},setCustomWallets(t){pe.customWallets=t},setIsSiweEnabled(t){pe.isSiweEnabled=t},setIsUniversalProvider(t){pe.isUniversalProvider=t},setSdkVersion(t){pe.sdkVersion=t},setMetadata(t){pe.metadata=t},setDisableAppend(t){pe.disableAppend=t},setEIP6963Enabled(t){pe.enableEIP6963=t},setDebug(t){pe.debug=t},setEnableWalletConnect(t){pe.enableWalletConnect=t},setEnableWalletGuide(t){pe.enableWalletGuide=t},setEnableAuthLogger(t){pe.enableAuthLogger=t},setEnableWallets(t){pe.enableWallets=t},setPreferUniversalLinks(t){pe.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,n]of Object.entries(Ye.SIWX_DEFAULTS))t[e]??=n;pe.siwx=t},setConnectMethodsOrder(t){pe.features={...pe.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){pe.features={...pe.features,walletFeaturesOrder:t}},setSocialsOrder(t){pe.remoteFeatures={...pe.remoteFeatures,socials:t}},setCollapseWallets(t){pe.features={...pe.features,collapseWallets:t}},setEnableEmbedded(t){pe.enableEmbedded=t},setAllowUnsupportedChain(t){pe.allowUnsupportedChain=t},setManualWCControl(t){pe.manualWCControl=t},setEnableNetworkSwitch(t){pe.enableNetworkSwitch=t},setEnableReconnect(t){pe.enableReconnect=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,n])=>{n&&(pe.defaultAccountTypes[e]=n)})},setUniversalProviderConfigOverride(t){pe.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return pe.universalProviderConfigOverride},getSnapshot(){return zl(pe)}},PT=Object.freeze({enabled:!0,events:[]}),OT=new Vu({baseUrl:le.getAnalyticsUrl(),clientId:null}),RT=5,kT=60*1e3,mi=ct({...PT}),DT={state:mi,subscribeKey(t,e){return ln(mi,t,e)},async sendError(t,e){if(!mi.enabled)return;const n=Date.now();if(mi.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<kT}).length>=RT)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};mi.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=H.state;await OT.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:le.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){mi.enabled=!0},disable(){mi.enabled=!1},clearEvents(){mi.events=[]}};class dc extends Error{constructor(e,n,r){super(e),this.name="AppKitError",this.category=n,this.originalError=r,Object.setPrototypeOf(this,dc.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,dc):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function Lw(t,e){const n=t instanceof dc?t:new dc(t instanceof Error?t.message:String(t),e,t);throw DT.sendError(n,n.category),n}function cr(t,e="INTERNAL_SDK_ERROR"){const n={};return Object.keys(t).forEach(r=>{const s=t[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return Lw(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return Lw(a,e)}},n[r]=i}else n[r]=s}),n}var hc={};const UT="https://secure.walletconnect.org/sdk",BT=(typeof process<"u"&&typeof hc<"u"?hc.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||UT,$T=(typeof process<"u"&&typeof hc<"u"?hc.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",LT=(typeof process<"u"&&typeof hc<"u"?hc.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",he={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},Ht={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},bn={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},MT={handleMobileDeeplinkRedirect(t,e){const n=window.location.href,r=encodeURIComponent(n);if(t===bn.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${bn.PHANTOM.url}/ul/browse/${r}?ref=${o}`}if(t===bn.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${bn.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===F.CHAIN.SOLANA&&t===bn.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${bn.COINBASE.url}/dapp?cb_url=${r}`),e===F.CHAIN.BITCOIN&&t===bn.BINANCE.id&&!("binancew3w"in window)){const s=T.state.activeCaipNetwork,i=window.btoa("/pages/browser/index"),o=window.btoa(`url=${r}&defaultChainId=${s?.id??1}`),a=new URL(bn.BINANCE.deeplink);a.searchParams.set("appId",bn.BINANCE.appId),a.searchParams.set("startPagePath",i),a.searchParams.set("startPageQuery",o);const c=new URL(bn.BINANCE.url);c.searchParams.set("_dp",window.btoa(a.toString())),window.location.href=c.toString()}}},Yn=ct({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),FT={state:Yn,subscribeNetworkImages(t){return cn(Yn.networkImages,()=>t(Yn.networkImages))},subscribeKey(t,e){return ln(Yn,t,e)},subscribe(t){return cn(Yn,()=>t(Yn))},setWalletImage(t,e){Yn.walletImages[t]=e},setNetworkImage(t,e){Yn.networkImages[t]=e},setChainImage(t,e){Yn.chainImages[t]=e},setConnectorImage(t,e){Yn.connectorImages={...Yn.connectorImages,[t]:e}},setTokenImage(t,e){Yn.tokenImages[t]=e},setCurrencyImage(t,e){Yn.currencyImages[t]=e}},Hr=cr(FT),jT={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:""},bp=ct({networkImagePromises:{}}),mC={async fetchWalletImage(t){if(t)return await ye._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(bp.networkImagePromises[t]||(bp.networkImagePromises[t]=ye._fetchNetworkImage(t)),await bp.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return Hr.state.walletImages[t]},getWalletImage(t){if(t?.image_url)return t?.image_url;if(t?.image_id)return Hr.state.walletImages[t.image_id]},getNetworkImage(t){if(t?.assets?.imageUrl)return t?.assets?.imageUrl;if(t?.assets?.imageId)return Hr.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return Hr.state.networkImages[t]},getConnectorImage(t){if(t?.imageUrl)return t.imageUrl;if(t?.info?.icon)return t.info.icon;if(t?.imageId)return Hr.state.connectorImages[t.imageId]},getChainImage(t){return Hr.state.networkImages[jT[t]]}},yi=ct({message:"",variant:"info",open:!1}),HT={state:yi,subscribeKey(t,e){return ln(yi,t,e)},open(t,e){const{debug:n}=H.state,{code:r,displayMessage:s,debugMessage:i}=t;s&&n&&(yi.message=s,yi.variant=e,yi.open=!0),i&&console.error(typeof i=="function"?i():i,r?{code:r}:void 0)},close(){yi.open=!1,yi.message="",yi.variant="info"}},pt=cr(HT),zT=le.getAnalyticsUrl(),qT=new Vu({baseUrl:zT,clientId:null}),WT=["MODAL_CREATED"],Os=ct({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),et={state:Os,subscribe(t){return cn(Os,()=>t(Os))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=H.state;return{projectId:t,st:e,sv:n||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(t){try{let e=fe.state.address;if("address"in t.data&&t.data.address&&(e=t.data.address),WT.includes(t.data.event)||typeof window>"u")return;await qT.post({path:"/e",params:et.getSdkProperties(),body:{eventId:le.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:e}}}),Os.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===F.HTTP_STATUS_CODES.FORBIDDEN&&!Os.reportedErrors.FORBIDDEN&&(pt.open({displayMessage:"Invalid App Configuration",debugMessage:`Origin ${Ja()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),Os.reportedErrors.FORBIDDEN=!0)}},sendEvent(t){Os.timestamp=Date.now(),Os.data=t,(H.state.features?.analytics||t.event==="INITIALIZE")&&et._sendAnalyticsEvent(Os)}},VT=le.getApiUrl(),xn=new Vu({baseUrl:VT,clientId:null}),GT=40,Mw=4,KT=20,Ne=ct({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),ye={state:Ne,subscribeKey(t,e){return ln(Ne,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=H.state;return{projectId:t,st:e||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return H.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${xn.baseUrl}/getWalletImage/${t}`,n=await xn.getBlob({path:e,params:ye._getSdkProperties()});Hr.setWalletImage(t,URL.createObjectURL(n))},async _fetchNetworkImage(t){const e=`${xn.baseUrl}/public/getAssetImage/${t}`,n=await xn.getBlob({path:e,params:ye._getSdkProperties()});Hr.setNetworkImage(t,URL.createObjectURL(n))},async _fetchConnectorImage(t){const e=`${xn.baseUrl}/public/getAssetImage/${t}`,n=await xn.getBlob({path:e,params:ye._getSdkProperties()});Hr.setConnectorImage(t,URL.createObjectURL(n))},async _fetchCurrencyImage(t){const e=`${xn.baseUrl}/public/getCurrencyImage/${t}`,n=await xn.getBlob({path:e,params:ye._getSdkProperties()});Hr.setCurrencyImage(t,URL.createObjectURL(n))},async _fetchTokenImage(t){const e=`${xn.baseUrl}/public/getTokenImage/${t}`,n=await xn.getBlob({path:e,params:ye._getSdkProperties()});Hr.setTokenImage(t,URL.createObjectURL(n))},_filterWalletsByPlatform(t){return le.isMobile()?t?.filter(n=>n.mobile_link||n.id===bn.COINBASE.id||n.id===bn.BINANCE.id?!0:T.state.activeChain==="solana"&&(n.id===bn.SOLFLARE.id||n.id===bn.PHANTOM.id)):t},async fetchProjectConfig(){return(await xn.get({path:"/appkit/v1/config",params:ye._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await xn.get({path:"/projects/v1/origins",params:ye._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===F.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=F.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const e=T.getAllRequestedCaipNetworks()?.map(({assets:n})=>n?.imageId).filter(Boolean).filter(n=>!mC.getNetworkImageById(n));e&&await Promise.allSettled(e.map(n=>ye._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:t}=Y.state,e=t.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(e.map(n=>ye._fetchConnectorImage(n)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>ye._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>ye._fetchTokenImage(e)))},async fetchWallets(t){const e=t.exclude??[];ye._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(bn).map(i=>i.id));const r=await xn.get({path:"/getWallets",params:{...ye._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:t.include?.join(","),exclude:e.join(",")}});return{data:ye._filterWalletsByPlatform(r?.data)||[],count:r?.count}},async fetchFeaturedWallets(){const{featuredWalletIds:t}=H.state;if(t?.length){const e={...ye._getSdkProperties(),page:1,entries:t?.length??Mw,include:t},{data:n}=await ye.fetchWallets(e),r=[...n].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>ye._fetchWalletImage(i))),Ne.featured=r,Ne.allFeatured=r}},async fetchRecommendedWallets(){try{Ne.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:n}=H.state,r=[...e??[],...n??[]].filter(Boolean),s=T.getRequestedCaipNetworkIds().join(","),i={page:1,entries:Mw,include:t,exclude:r,chains:s},{data:o,count:a}=await ye.fetchWallets(i),c=W.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>ye._fetchWalletImage(d))),Ne.recommended=o,Ne.allRecommended=o,Ne.count=a??0}catch{}finally{Ne.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:n,featuredWalletIds:r}=H.state,s=T.getRequestedCaipNetworkIds().join(","),i=[...Ne.recommended.map(({id:u})=>u),...n??[],...r??[]].filter(Boolean),o={page:t,entries:GT,include:e,exclude:i,chains:s},{data:a,count:c}=await ye.fetchWallets(o),l=a.slice(0,KT).map(u=>u.image_id).filter(Boolean);await Promise.allSettled(l.map(u=>ye._fetchWalletImage(u))),Ne.wallets=le.uniqueBy([...Ne.wallets,...ye._filterOutExtensions(a)],"id").filter(u=>u.chains?.some(d=>s.includes(d))),Ne.count=c>Ne.count?c:Ne.count,Ne.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:n}=await ye.fetchWallets(e);n&&n.forEach(r=>{Ne.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:n,excludeWalletIds:r}=H.state,s=T.getRequestedCaipNetworkIds().join(",");Ne.search=[];const i={page:1,entries:100,search:t?.trim(),badge_type:e,include:n,exclude:r,chains:s},{data:o}=await ye.fetchWallets(i);et.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>ye._fetchWalletImage(c)),le.wait(300)]),Ne.search=ye._filterOutExtensions(o)},initPromise(t,e){const n=Ne.promises[t];return n||(Ne.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0}={}){const s=[t&&ye.initPromise("connectorImages",ye.fetchConnectorImages),e&&ye.initPromise("featuredWallets",ye.fetchFeaturedWallets),n&&ye.initPromise("recommendedWallets",ye.fetchRecommendedWallets),r&&ye.initPromise("networkImages",ye.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){H.state.features?.analytics&&ye.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await xn.get({path:"/getAnalyticsConfig",params:ye._getSdkProperties()});H.setFeatures({analytics:t})}catch{H.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!t?.length){Ne.featured=Ne.allFeatured,Ne.recommended=Ne.allRecommended;return}const e=T.getRequestedCaipNetworkIds().join(",");Ne.featured=Ne.allFeatured.filter(n=>n.chains?.some(r=>e.includes(r))),Ne.recommended=Ne.allRecommended.filter(n=>n.chains?.some(r=>e.includes(r))),Ne.filteredWallets=Ne.wallets.filter(n=>n.chains?.some(r=>e.includes(r)))},clearFilterByNamespaces(){Ne.filteredWallets=[]},setFilterByNamespace(t){if(!t){Ne.featured=Ne.allFeatured,Ne.recommended=Ne.allRecommended;return}const e=T.getRequestedCaipNetworkIds().join(",");Ne.featured=Ne.allFeatured.filter(n=>n.chains?.some(r=>e.includes(r))),Ne.recommended=Ne.allRecommended.filter(n=>n.chains?.some(r=>e.includes(r))),Ne.filteredWallets=Ne.wallets.filter(n=>n.chains?.some(r=>e.includes(r)))}},rt=ct({view:"Connect",history:["Connect"],transactionStack:[]}),JT={state:rt,subscribeKey(t,e){return ln(rt,t,e)},pushTransactionStack(t){rt.transactionStack.push(t)},popTransactionStack(t){const e=rt.transactionStack.pop();if(!e)return;const{onSuccess:n,onError:r,onCancel:s}=e;switch(t){case"success":n?.();break;case"error":r?.(),Ce.goBack();break;case"cancel":s?.(),Ce.goBack();break}},push(t,e){t!==rt.view&&(rt.view=t,rt.history.push(t),rt.data=e)},reset(t,e){rt.view=t,rt.history=[t],rt.data=e},replace(t,e){rt.history.at(-1)===t||(rt.view=t,rt.history[rt.history.length-1]=t,rt.data=e)},goBack(){const t=T.state.activeCaipAddress,e=Ce.state.view==="ConnectingFarcaster",n=!t&&e;if(rt.history.length>1){rt.history.pop();const[r]=rt.history.slice(-1);r&&(t&&r==="Connect"?rt.view="Account":rt.view=r)}else Fe.close();rt.data?.wallet&&(rt.data.wallet=void 0),setTimeout(()=>{if(n){fe.setFarcasterUrl(void 0,T.state.activeChain);const r=Y.getAuthConnector();r?.provider?.reload();const s=zl(H.state);r?.provider?.syncDappData?.({metadata:s.metadata,sdkVersion:s.sdkVersion,projectId:s.projectId,sdkType:s.sdkType})}},100)},goBackToIndex(t){if(rt.history.length>1){rt.history=rt.history.slice(0,t+1);const[e]=rt.history.slice(-1);e&&(rt.view=e)}},goBackOrCloseModal(){Ce.state.history.length>1?Ce.goBack():Fe.close()}},Ce=cr(JT),Rs=ct({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),rm={state:Rs,subscribe(t){return cn(Rs,()=>t(Rs))},setThemeMode(t){Rs.themeMode=t;try{const e=Y.getAuthConnector();if(e){const n=rm.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:n,w3mThemeVariables:Zs(n,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){Rs.themeVariables={...Rs.themeVariables,...t};try{const e=Y.getAuthConnector();if(e){const n=rm.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:n,w3mThemeVariables:Zs(Rs.themeVariables,Rs.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return zl(Rs)}},$n=cr(rm),yC=Object.fromEntries(hC.map(t=>[t,void 0])),YT=Object.fromEntries(hC.map(t=>[t,!0])),He=ct({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:yC,filterByNamespaceMap:YT}),ZT={state:He,subscribe(t){return cn(He,()=>{t(He)})},subscribeKey(t,e){return ln(He,t,e)},initialize(t){t.forEach(e=>{const n=W.getConnectedConnectorId(e);n&&Y.setConnectorId(n,e)})},setActiveConnector(t){t&&(He.activeConnector=Wo(t))},setConnectors(t){t.filter(s=>!He.allConnectors.some(i=>i.id===s.id&&Y.getConnectorName(i.name)===Y.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&He.allConnectors.push(Wo(s))});const n=Y.getEnabledNamespaces(),r=Y.getEnabledConnectors(n);He.connectors=Y.mergeMultiChainConnectors(r)},filterByNamespaces(t){Object.keys(He.filterByNamespaceMap).forEach(e=>{He.filterByNamespaceMap[e]=!1}),t.forEach(e=>{He.filterByNamespaceMap[e]=!0}),Y.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){He.filterByNamespaceMap[t]=e,Y.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=Y.getEnabledNamespaces(),e=Y.getEnabledConnectors(t),n=Y.areAllNamespacesEnabled();He.connectors=Y.mergeMultiChainConnectors(e),n?ye.clearFilterByNamespaces():ye.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(He.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return He.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(He.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=Y.generateConnectorMapByName(t),n=[];return e.forEach(r=>{const s=r[0],i=s?.id===F.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:s?.id||""}):s&&n.push(s)}),n},generateConnectorMapByName(t){const e=new Map;return t.forEach(n=>{const{name:r}=n,s=Y.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(n=>{e.find(r=>r.chain===n.chain)||e.push(n)}),e},addConnector(t){if(t.id===F.CONNECTOR_ID.AUTH){const e=t,n=zl(H.state),r=$n.getSnapshot().themeMode,s=$n.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,projectId:n.projectId,sdkType:n.sdkType}),e?.provider?.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Zs(s,r)}),Y.setConnectors([t])}else Y.setConnectors([t])},getAuthConnector(t){const e=t||T.state.activeChain,n=He.connectors.find(r=>r.id===F.CONNECTOR_ID.AUTH);if(n)return n?.connectors?.length?n.connectors.find(s=>s.chain===e):n},getAnnouncedConnectorRdns(){return He.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>t.info?.rdns)},getConnectorById(t){return He.allConnectors.find(e=>e.id===t)},getConnector({id:t,rdns:e,namespace:n}){const r=n||T.state.activeChain;return He.allConnectors.filter(i=>i.chain===r).find(i=>i.explorerId===t||i.info?.rdns===e)},syncIfAuthConnector(t){if(t.id!=="ID_AUTH")return;const e=t,n=zl(H.state),r=$n.getSnapshot().themeMode,s=$n.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Zs(s,r)})},getConnectorsByNamespace(t){const e=He.allConnectors.filter(n=>n.chain===t);return Y.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return T.checkIfSmartAccountEnabled()&&or(t)===Ht.ACCOUNT_TYPES.EOA},selectWalletConnector(t){const e=Y.getConnector({id:t.id,rdns:t.rdns});MT.handleMobileDeeplinkRedirect(e?.explorerId||t.id,T.state.activeChain),e?Ce.push("ConnectingExternal",{connector:e,wallet:t}):Ce.push("ConnectingWalletConnect",{wallet:t})},getConnectors(t){return t?Y.getConnectorsByNamespace(t):Y.mergeMultiChainConnectors(He.allConnectors)},setFilterByNamespace(t){He.filterByNamespace=t,He.connectors=Y.getConnectors(t),ye.setFilterByNamespace(t)},setConnectorId(t,e){t&&(He.activeConnectorIds={...He.activeConnectorIds,[e]:t},W.setConnectedConnectorId(e,t))},removeConnectorId(t){He.activeConnectorIds={...He.activeConnectorIds,[t]:void 0},W.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return He.activeConnectorIds[t]},isConnected(t){return t?!!He.activeConnectorIds[t]:Object.values(He.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){He.activeConnectorIds={...yC}}},Y=cr(ZT),QT=1e3,Jc={checkNamespaceConnectorId(t,e){return Y.getConnectorId(t)===e},isSocialProvider(t){return Ye.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&Y.setActiveConnector(e),s?.(le.isMobile()&&t),r){const l=Fe.subscribeKey("open",u=>{u||(Ce.state.view!==r&&Ce.replace(r),l(),a(new Error("Modal closed")))})}const c=T.subscribeKey("activeCaipAddress",l=>{l&&(i?.(),n&&Fe.close(),c(),o(jn.parseCaipAddress(l)))})})},connectExternal(t){return new Promise((e,n)=>{const r=T.subscribeKey("activeCaipAddress",s=>{s&&(Fe.close(),r(),e(jn.parseCaipAddress(s)))});ee.connectExternal(t,t.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:t,namespace:e,closeModalOnConnect:n=!0,onOpenFarcaster:r,onConnect:s}){let i=fe.state.socialWindow,o=fe.state.socialProvider,a=!1,c=null;const l=e||T.state.activeChain,u=T.subscribeKey("activeCaipAddress",d=>{d&&(n&&Fe.close(),u())});return new Promise((d,h)=>{async function f(g){if(g.data?.resultUri)if(g.origin===F.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",f,!1);try{const m=Y.getAuthConnector(l);if(m&&!a){i&&(i.close(),fe.setSocialWindow(void 0,l),i=fe.state.socialWindow),a=!0;const y=g.data.resultUri;if(o&&et.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:o}}),o){W.setConnectedSocialProvider(o),await ee.connectExternal({id:m.id,type:m.type,socialUri:y},m.chain);const v=T.state.activeCaipAddress;if(!v){h(new Error("Failed to connect"));return}d(jn.parseCaipAddress(v)),et.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:o,caipNetworkId:T.getActiveCaipNetwork()?.caipNetworkId}})}}}catch{o&&et.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:o}}),h(new Error("Failed to connect"))}}else o&&et.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:o}})}async function p(){if(t&&(fe.setSocialProvider(t,l),o=fe.state.socialProvider,et.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:o}})),o==="farcaster"){r?.();const g=Fe.subscribeKey("open",y=>{!y&&t==="farcaster"&&(h(new Error("Popup closed")),s?.(),g())}),m=Y.getAuthConnector();if(m&&!fe.state.farcasterUrl)try{const{url:y}=await m.provider.getFarcasterUri();fe.setFarcasterUrl(y,l)}catch{h(new Error("Failed to connect to farcaster"))}}else{const g=Y.getAuthConnector();c=le.returnOpenHref(`${F.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(g&&o){const{uri:m}=await g.provider.getSocialRedirectUri({provider:o});if(c&&m){fe.setSocialWindow(c,l),i=fe.state.socialWindow,c.location.href=m;const y=setInterval(()=>{i?.closed&&!a&&(h(new Error("Popup closed")),clearInterval(y))},1e3);window.addEventListener("message",f,!1)}else c?.close(),h(new Error("Failed to initiate social connection"))}}catch{h(new Error("Failed to initiate social connection")),c?.close()}}}p()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n?.(),e){const a=Fe.subscribeKey("open",c=>{c||(Ce.state.view!==e&&Ce.replace(e),a(),i(new Error("Modal closed")))})}const o=T.subscribeKey("activeCaipAddress",a=>{a&&(r?.(),t&&Fe.close(),o(),s(jn.parseCaipAddress(a)))})})},async updateEmail(){const t=W.getConnectedConnectorId(T.state.activeChain),e=Y.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==F.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=e.provider.getEmail()??"";return await Fe.open({view:"UpdateEmailWallet",data:{email:n,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==n&&(Fe.close(),clearInterval(i),o(),r({email:a}))},QT),o=Fe.subscribeKey("open",a=>{a||(Ce.state.view!=="Connect"&&Ce.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return T.checkIfSmartAccountEnabled()&&or(t)===Ht.ACCOUNT_TYPES.EOA}};function wC(){const t=T.state.activeCaipNetwork?.chainNamespace||"eip155",e=T.state.activeCaipNetwork?.id||1,n=Ye.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${n}`}function or(t){return T.getAccountData(t)?.preferredAccountType}function Hi(t){return t?T.state.chains.get(t)?.networkState?.caipNetwork:T.state.activeCaipNetwork}const Ch={getConnectionStatus(t,e){const n=Y.state.activeConnectorIds[e],r=ee.getConnections(e);return!!n&&t.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:n}){return t.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(t,e){const n=new Set(t);return e.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(n=>n.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){const e=!!H.state.remoteFeatures?.multiWallet,n=Y.state.activeConnectorIds[t],r=ee.getConnections(t),i=(ee.state.recentConnections.get(t)??[]).filter(a=>Y.getConnectorById(a.connectorId)),o=Ch.excludeExistingConnections([...r.map(a=>a.connectorId),...n?[n]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(a=>a.connectorId.toLowerCase()===n?.toLowerCase()),recentConnections:[]}}},bo=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),Ut=ct({...bo}),XT={state:Ut,subscribeKey(t,e){return ln(Ut,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=le.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){Ut.message=bo.message,Ut.variant=bo.variant,Ut.svg=bo.svg,Ut.open=bo.open,Ut.autoClose=bo.autoClose},_showMessage({message:t,svg:e,variant:n="success",autoClose:r=bo.autoClose}){Ut.open?(Ut.open=!1,setTimeout(()=>{Ut.message=t,Ut.variant=n,Ut.svg=e,Ut.open=!0,Ut.autoClose=r},150)):(Ut.message=t,Ut.variant=n,Ut.svg=e,Ut.open=!0,Ut.autoClose=r)}},ws=XT,yt=ct({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),eP={state:yt,subscribe(t){return cn(yt,()=>t(yt))},setLastNetworkInView(t){yt.lastNetworkInView=t},async fetchTransactions(t){if(!t)throw new Error("Transactions can't be fetched without an accountAddress");yt.loading=!0;try{const e=await Ee.fetchTransactions({account:t,cursor:yt.next,chainId:T.state.activeCaipNetwork?.caipNetworkId}),n=sh.filterSpamTransactions(e.data),r=sh.filterByConnectedChain(n),s=[...yt.transactions,...r];yt.loading=!1,yt.transactions=s,yt.transactionsByYear=sh.groupTransactionsByYearAndMonth(yt.transactionsByYear,r),yt.empty=s.length===0,yt.next=e.next?e.next:void 0}catch{const n=T.state.activeChain;et.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:H.state.projectId,cursor:yt.next,isSmartAccount:or(n)===Ht.ACCOUNT_TYPES.SMART_ACCOUNT}}),ws.showError("Failed to fetch transactions"),yt.loading=!1,yt.empty=!0,yt.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const n=t;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},c=(o[i]??[]).filter(l=>l.id!==r.id);n[s]={...o,[i]:[...c,r].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),n},filterSpamTransactions(t){return t.filter(e=>!e.transfers.every(r=>r.nft_info?.flags.is_spam===!0))},filterByConnectedChain(t){const e=T.state.activeCaipNetwork?.caipNetworkId;return t.filter(r=>r.metadata.chain===e)},clearCursor(){yt.next=void 0},resetTransactions(){yt.transactions=[],yt.transactionsByYear={},yt.lastNetworkInView=void 0,yt.loading=!1,yt.empty=!1,yt.next=void 0}},sh=cr(eP,"API_ERROR"),ze=ct({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let lo;const tP={state:ze,subscribe(t){return cn(ze,()=>t(ze))},subscribeKey(t,e){return ln(ze,t,e)},_getClient(){return ze._client},setClient(t){ze._client=Wo(t)},initialize(t){const e=t.filter(n=>!!n.namespace).map(n=>n.namespace);ee.syncStorageConnections(e)},syncStorageConnections(t){const e=W.getConnections(),n=t??Array.from(T.state.chains.keys());for(const r of n){const s=e[r]??[],i=new Map(ze.recentConnections);i.set(r,s),ze.recentConnections=i}},getConnections(t){return t?ze.connections.get(t)??[]:[]},hasAnyConnection(t){const e=ee.state.connections;return Array.from(e.values()).flatMap(n=>n).some(({connectorId:n})=>n===t)},async connectWalletConnect(){if(le.isTelegram()||le.isSafari()&&le.isIos()){if(lo){await lo,lo=void 0;return}if(!le.isPairingExpired(ze?.wcPairingExpiry)){const t=ze.wcUri;ze.wcUri=t;return}lo=ee._getClient()?.connectWalletConnect?.().catch(()=>{}),ee.state.status="connecting",await lo,lo=void 0,ze.wcPairingExpiry=void 0,ee.state.status="connected"}else await ee._getClient()?.connectWalletConnect?.()},async connectExternal(t,e,n=!0){const r=await ee._getClient()?.connectExternal?.(t);return n&&T.setActiveNamespace(e),r},async reconnectExternal(t){await ee._getClient()?.reconnectExternal?.(t);const e=t.chain||T.state.activeChain;e&&Y.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){if(!e)return;Fe.setLoading(!0,T.state.activeChain);const n=Y.getAuthConnector();n&&(fe.setPreferredAccountType(t,e),await n.provider.setPreferredAccount(t),W.setPreferredAccountTypes(Object.entries(T.state.chains).reduce((r,[s,i])=>{const o=s,a=or(o);return a!==void 0&&(r[o]=a),r},{})),await ee.reconnectExternal(n),Fe.setLoading(!1,T.state.activeChain),et.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:T.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(t){return ee._getClient()?.signMessage(t)},parseUnits(t,e){return ee._getClient()?.parseUnits(t,e)},formatUnits(t,e){return ee._getClient()?.formatUnits(t,e)},async sendTransaction(t){return ee._getClient()?.sendTransaction(t)},async getCapabilities(t){return ee._getClient()?.getCapabilities(t)},async grantPermissions(t){return ee._getClient()?.grantPermissions(t)},async walletGetAssets(t){return ee._getClient()?.walletGetAssets(t)??{}},async estimateGas(t){return ee._getClient()?.estimateGas(t)},async writeContract(t){return ee._getClient()?.writeContract(t)},async getEnsAddress(t){return ee._getClient()?.getEnsAddress(t)},async getEnsAvatar(t){return ee._getClient()?.getEnsAvatar(t)},checkInstalled(t){return ee._getClient()?.checkInstalled?.(t)||!1},resetWcConnection(){ze.wcUri=void 0,ze.wcPairingExpiry=void 0,ze.wcLinking=void 0,ze.recentWallet=void 0,ze.status="disconnected",sh.resetTransactions(),W.deleteWalletConnectDeepLink()},resetUri(){ze.wcUri=void 0,ze.wcPairingExpiry=void 0,lo=void 0},finalizeWcConnection(t){const{wcLinking:e,recentWallet:n}=ee.state;e&&W.setWalletConnectDeepLink(e),n&&W.setAppKitRecent(n),et.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:t,properties:{method:e?"mobile":"qrcode",name:Ce.state.data?.wallet?.name||"Unknown",caipNetworkId:T.getActiveCaipNetwork()?.caipNetworkId}})},setWcBasic(t){ze.wcBasic=t},setUri(t){ze.wcUri=t,ze.wcPairingExpiry=le.getPairingExpiry()},setWcLinking(t){ze.wcLinking=t},setWcError(t){ze.wcError=t,ze.buffering=!1},setRecentWallet(t){ze.recentWallet=t},setBuffering(t){ze.buffering=t},setStatus(t){ze.status=t},setIsSwitchingConnection(t){ze.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:n}={}){try{await ee._getClient()?.disconnect({id:t,chainNamespace:e,initialDisconnect:n})}catch(r){throw new dc("Failed to disconnect","INTERNAL_SDK_ERROR",r)}},setConnections(t,e){const n=new Map(ze.connections);n.set(e,t),ze.connections=n},async handleAuthAccountSwitch({address:t,namespace:e}){const n=fe.state.user?.accounts?.find(s=>s.type==="smartAccount"),r=n&&n.address.toLowerCase()===t.toLowerCase()&&Jc.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await ee.setPreferredAccountType(r,e)},async handleActiveConnection({connection:t,namespace:e,address:n}){const r=Y.getConnectorById(t.connectorId),s=t.connectorId===F.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)s&&n&&await ee.handleAuthAccountSwitch({address:n,namespace:e});else return(await ee.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:e},e))?.address;return n},async handleDisconnectedConnection({connection:t,namespace:e,address:n,closeModalOnConnect:r}){const s=Y.getConnectorById(t.connectorId),i=t.auth?.name?.toLowerCase(),o=t.connectorId===F.CONNECTOR_ID.AUTH,a=t.connectorId===F.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let c;if(o)if(i&&Jc.isSocialProvider(i)){const{address:l}=await Jc.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){Fe.open({view:"ConnectingFarcaster"})},onConnect(){Ce.replace("ProfileWallets")}});c=l}else{const{address:l}=await Jc.connectEmail({closeModalOnConnect:r,onOpen(){Fe.open({view:"EmailLogin"})},onConnect(){Ce.replace("ProfileWallets")}});c=l}else if(a){const{address:l}=await Jc.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(u){Fe.open({view:u?"AllWallets":"ConnectingWalletConnect"})},onConnect(){Ce.replace("ProfileWallets")}});c=l}else{const l=await ee.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);l&&(c=l.address)}return o&&n&&await ee.handleAuthAccountSwitch({address:n,namespace:e}),c},async switchConnection({connection:t,address:e,namespace:n,closeModalOnConnect:r,onChange:s}){let i;const o=fe.getCaipAddress(n);if(o){const{address:c}=jn.parseCaipAddress(o);i=c}const a=Ch.getConnectionStatus(t,n);switch(a){case"connected":case"active":{const c=await ee.handleActiveConnection({connection:t,namespace:n,address:e});if(i&&c){const l=c.toLowerCase()!==i.toLowerCase();s?.({address:c,namespace:n,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await ee.handleDisconnectedConnection({connection:t,namespace:n,address:e,closeModalOnConnect:r});c&&s?.({address:c,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0});break}default:throw new Error(`Invalid connection status: ${a}`)}}},ee=cr(tP),Ea=ct({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Vr={state:Ea,subscribe(t){return cn(Ea,()=>t(Ea))},subscribeOpen(t){return ln(Ea,"open",t)},set(t){Object.assign(Ea,{...Ea,...t})}},nP={async getTokenList(t){return(await Ee.fetchSwapTokens({chainId:t}))?.tokens?.map(r=>({...r,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0}))||[]},async fetchGasPrice(){const t=T.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const e=(await ee?.estimateGas({chainNamespace:"solana"}))?.toString();return{standard:e,fast:e,instant:e};case"eip155":default:return await Ee.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await Ee.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s?.allowance&&n&&r){const i=ee.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await yy.getMyTokensWithBalance(t);return fe.setTokenBalance(e,T.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return t?.map(e=>({...e,address:e?.address?e.address:wC(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]}},Xe=ct({tokenBalances:[],loading:!1}),rP={state:Xe,subscribe(t){return cn(Xe,()=>t(Xe))},subscribeKey(t,e){return ln(Xe,t,e)},setToken(t){t&&(Xe.token=Wo(t))},setTokenAmount(t){Xe.sendTokenAmount=t},setReceiverAddress(t){Xe.receiverAddress=t},setReceiverProfileImageUrl(t){Xe.receiverProfileImageUrl=t},setReceiverProfileName(t){Xe.receiverProfileName=t},setNetworkBalanceInUsd(t){Xe.networkBalanceInUSD=t},setLoading(t){Xe.loading=t},async sendToken(){try{switch(Je.setLoading(!0),T.state.activeCaipNetwork?.chainNamespace){case"eip155":await Je.sendEvmToken();return;case"solana":await Je.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{Je.setLoading(!1)}},async sendEvmToken(){const t=T.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=or(t);if(!Je.state.sendTokenAmount||!Je.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Je.state.token)throw new Error("A token is required");Je.state.token?.address?(et.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===Ht.ACCOUNT_TYPES.SMART_ACCOUNT,token:Je.state.token.address,amount:Je.state.sendTokenAmount,network:T.state.activeCaipNetwork?.caipNetworkId||""}}),await Je.sendERC20Token({receiverAddress:Je.state.receiverAddress,tokenAddress:Je.state.token.address,sendTokenAmount:Je.state.sendTokenAmount,decimals:Je.state.token.quantity.decimals})):(et.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===Ht.ACCOUNT_TYPES.SMART_ACCOUNT,token:Je.state.token.symbol||"",amount:Je.state.sendTokenAmount,network:T.state.activeCaipNetwork?.caipNetworkId||""}}),await Je.sendNativeToken({receiverAddress:Je.state.receiverAddress,sendTokenAmount:Je.state.sendTokenAmount,decimals:Je.state.token.quantity.decimals}))},async fetchTokenBalance(t){Xe.loading=!0;const e=T.state.activeCaipNetwork?.caipNetworkId,n=T.state.activeCaipNetwork?.chainNamespace,r=T.state.activeCaipAddress,s=r?le.getPlainAddress(r):void 0;if(Xe.lastRetry&&!le.isAllowedRetry(Xe.lastRetry,30*Ye.ONE_SEC_MS))return Xe.loading=!1,[];try{if(s&&e&&n){const i=await yy.getMyTokensWithBalance();return Xe.tokenBalances=i,Xe.lastRetry=void 0,i}}catch(i){Xe.lastRetry=Date.now(),t?.(i),ws.showError("Token Balance Unavailable")}finally{Xe.loading=!1}return[]},fetchNetworkBalance(){if(Xe.tokenBalances.length===0)return;const t=nP.mapBalancesToSwapTokens(Xe.tokenBalances);if(!t)return;const e=t.find(n=>n.address===wC());e&&(Xe.networkBalanceInUSD=e?CT.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){Ce.pushTransactionStack({});const e=t.receiverAddress,n=fe.state.address,r=ee.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals));await ee.sendTransaction({chainNamespace:F.CHAIN.EVM,to:e,address:n,data:"0x",value:r??BigInt(0)}),et.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:or("eip155")===Ht.ACCOUNT_TYPES.SMART_ACCOUNT,token:Je.state.token?.symbol||"",amount:t.sendTokenAmount,network:T.state.activeCaipNetwork?.caipNetworkId||""}}),ee._getClient()?.updateBalance("eip155"),Je.resetSend()},async sendERC20Token(t){Ce.pushTransactionStack({onSuccess(){Ce.replace("Account")}});const e=ee.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals));if(fe.state.address&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const n=le.getPlainAddress(t.tokenAddress);if(!n)throw new Error("SendController:sendERC20Token - tokenAddress is required");await ee.writeContract({fromAddress:fe.state.address,tokenAddress:n,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:ST.getERC20Abi(n),chainNamespace:F.CHAIN.EVM}),Je.resetSend()}},async sendSolanaToken(){if(!Je.state.sendTokenAmount||!Je.state.receiverAddress)throw new Error("An amount and receiver address are required");Ce.pushTransactionStack({onSuccess(){Ce.replace("Account")}}),await ee.sendTransaction({chainNamespace:"solana",to:Je.state.receiverAddress,value:Je.state.sendTokenAmount}),ee._getClient()?.updateBalance("solana"),Je.resetSend()},resetSend(){Xe.token=void 0,Xe.sendTokenAmount=void 0,Xe.receiverAddress=void 0,Xe.receiverProfileImageUrl=void 0,Xe.receiverProfileName=void 0,Xe.loading=!1,Xe.tokenBalances=[]}},Je=cr(rP),Ep={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},wd={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},te=ct({chains:fT(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),sP={state:te,subscribe(t){return cn(te,()=>{t(te)})},subscribeKey(t,e){return ln(te,t,e)},subscribeChainProp(t,e,n){let r;return cn(te.chains,()=>{const s=n||te.activeChain;if(s){const i=te.chains.get(s)?.[t];r!==i&&(r=i,e(i))}})},initialize(t,e,n){const{chainId:r,namespace:s}=W.getActiveNetworkProps(),i=e?.find(u=>u.id.toString()===r?.toString()),a=t.find(u=>u?.namespace===s)||t?.[0],c=t.map(u=>u.namespace).filter(u=>u!==void 0),l=H.state.enableEmbedded?new Set([...c]):new Set([...e?.map(u=>u.chainNamespace)??[]]);(t?.length===0||!a)&&(te.noAdapters=!0),te.noAdapters||(te.activeChain=a?.namespace,te.activeCaipNetwork=i,T.setChainNetworkData(a?.namespace,{caipNetwork:i}),te.activeChain&&Vr.set({activeChain:a?.namespace})),l.forEach(u=>{const d=e?.filter(p=>p.chainNamespace===u),h=W.getPreferredAccountTypes()||{},f={...H.state.defaultAccountTypes,...h};T.state.chains.set(u,{namespace:u,networkState:ct({...wd,caipNetwork:d?.[0]}),accountState:ct({...Ep,preferredAccountType:f[u]}),caipNetworks:d??[],...n}),T.setRequestedCaipNetworks(d??[],u)})},removeAdapter(t){if(te.activeChain===t){const e=Array.from(te.chains.entries()).find(([n])=>n!==t);if(e){const n=e[1]?.caipNetworks?.[0];n&&T.setActiveCaipNetwork(n)}}te.chains.delete(t)},addAdapter(t,{networkControllerClient:e,connectionControllerClient:n},r){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");te.chains.set(t.namespace,{namespace:t.namespace,networkState:{...wd,caipNetwork:r[0]},accountState:Ep,caipNetworks:r,connectionControllerClient:n,networkControllerClient:e}),T.setRequestedCaipNetworks(r?.filter(s=>s.chainNamespace===t.namespace)??[],t.namespace)},addNetwork(t){const e=te.chains.get(t.chainNamespace);if(e){const n=[...e.caipNetworks||[]];e.caipNetworks?.find(r=>r.id===t.id)||n.push(t),te.chains.set(t.chainNamespace,{...e,caipNetworks:n}),T.setRequestedCaipNetworks(n,t.chainNamespace),Y.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){const n=te.chains.get(t);if(n){const r=te.activeCaipNetwork?.id===e,s=[...n.caipNetworks?.filter(i=>i.id!==e)||[]];r&&n?.caipNetworks?.[0]&&T.setActiveCaipNetwork(n.caipNetworks[0]),te.chains.set(t,{...n,caipNetworks:s}),T.setRequestedCaipNetworks(s||[],t),s.length===0&&Y.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const n=te.chains.get(t);n&&(n.networkState={...n.networkState||wd,...e},te.chains.set(t,n))},setChainAccountData(t,e,n=!0){if(!t)throw new Error("Chain is required to update chain account data");const r=te.chains.get(t);if(r){const s={...r.accountState||Ep,...e};te.chains.set(t,{...r,accountState:s}),(te.chains.size===1||te.activeChain===t)&&(e.caipAddress&&(te.activeCaipAddress=e.caipAddress),fe.replaceState(s))}},setChainNetworkData(t,e){if(!t)return;const n=te.chains.get(t);if(n){const r={...n.networkState||wd,...e};te.chains.set(t,{...n,networkState:r})}},setAccountProp(t,e,n,r=!0){T.setChainAccountData(n,{[t]:e},r)},setActiveNamespace(t){te.activeChain=t;const e=t?te.chains.get(t):void 0,n=e?.networkState?.caipNetwork;n?.id&&t&&(te.activeCaipAddress=e?.accountState?.caipAddress,te.activeCaipNetwork=n,T.setChainNetworkData(t,{caipNetwork:n}),W.setActiveCaipNetworkId(n?.caipNetworkId),Vr.set({activeChain:t,selectedNetworkId:n?.caipNetworkId}))},setActiveCaipNetwork(t){if(!t)return;te.activeChain!==t.chainNamespace&&T.setIsSwitchingNamespace(!0);const e=te.chains.get(t.chainNamespace);te.activeChain=t.chainNamespace,te.activeCaipNetwork=t,T.setChainNetworkData(t.chainNamespace,{caipNetwork:t}),e?.accountState?.address?te.activeCaipAddress=`${t.chainNamespace}:${t.id}:${e?.accountState?.address}`:te.activeCaipAddress=void 0,T.setAccountProp("caipAddress",te.activeCaipAddress,t.chainNamespace),e&&fe.replaceState(e.accountState),Je.resetSend(),Vr.set({activeChain:te.activeChain,selectedNetworkId:te.activeCaipNetwork?.caipNetworkId}),W.setActiveCaipNetworkId(t.caipNetworkId),!T.checkIfSupportedNetwork(t.chainNamespace)&&H.state.enableNetworkSwitch&&!H.state.allowUnsupportedChain&&!ee.state.wcBasic&&T.showUnsupportedChainUI()},addCaipNetwork(t){if(!t)return;const e=te.chains.get(t.chainNamespace);e&&e?.caipNetworks?.push(t)},async switchActiveNamespace(t){if(!t)return;const e=t!==T.state.activeChain,n=T.getNetworkData(t)?.caipNetwork,r=T.getCaipNetworkByNamespace(t,n?.id);e&&r&&await T.switchActiveNetwork(r)},async switchActiveNetwork(t){const e=T.state.activeChain;if(!e)throw new Error("ChainController:switchActiveNetwork - namespace is required");const r=!T.state.chains.get(e)?.caipNetworks?.some(i=>i.id===te.activeCaipNetwork?.id),s=T.getNetworkControllerClient(t.chainNamespace);if(s){try{await s.switchCaipNetwork(t),r&&Fe.close()}catch{Ce.goBack()}et.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})}},getNetworkControllerClient(t){const e=t||te.activeChain;if(!e)throw new Error("ChainController:getNetworkControllerClient - chain is required");const n=te.chains.get(e);if(!n)throw new Error("Chain adapter not found");if(!n.networkControllerClient)throw new Error("NetworkController client not set");return n.networkControllerClient},getConnectionControllerClient(t){const e=t||te.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const n=te.chains.get(e);if(!n?.connectionControllerClient)throw new Error("ConnectionController client not set");return n.connectionControllerClient},getNetworkProp(t,e){const n=te.chains.get(e)?.networkState;if(n)return n[t]},getRequestedCaipNetworks(t){const e=te.chains.get(t),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=e?.networkState||{};return le.sortRequestedNetworks(n,r).filter(o=>o?.id)},getAllRequestedCaipNetworks(){const t=[];return te.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=T.getRequestedCaipNetworks(e.namespace);t.push(...n)}),t},setRequestedCaipNetworks(t,e){T.setAdapterNetworkState(e,{requestedCaipNetworks:t});const r=T.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));Y.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return te.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=T.getApprovedCaipNetworkIds(e.namespace);t.push(...n)}),t},getActiveCaipNetwork(t){return t?te.chains.get(t)?.networkState?.caipNetwork:te.activeCaipNetwork},getActiveCaipAddress(){return te.activeCaipAddress},getApprovedCaipNetworkIds(t){return te.chains.get(t)?.networkState?.approvedCaipNetworkIds||[]},async setApprovedCaipNetworksData(t){const n=await T.getNetworkControllerClient()?.getApprovedCaipNetworksData();T.setAdapterNetworkState(t,{approvedCaipNetworkIds:n?.approvedCaipNetworkIds,supportsAllNetworks:n?.supportsAllNetworks})},checkIfSupportedNetwork(t,e){const n=e||te.activeCaipNetwork?.caipNetworkId,r=T.getRequestedCaipNetworks(t);return r.length?r?.some(s=>s.caipNetworkId===n):!0},checkIfSupportedChainId(t){return te.activeChain?T.getRequestedCaipNetworks(te.activeChain)?.some(n=>n.id===t):!0},setSmartAccountEnabledNetworks(t,e){T.setAdapterNetworkState(e,{smartAccountEnabledNetworks:t})},checkIfSmartAccountEnabled(){const t=ql.caipNetworkIdToNumber(te.activeCaipNetwork?.caipNetworkId),e=te.activeChain;return!e||!t?!1:!!T.getNetworkProp("smartAccountEnabledNetworks",e)?.includes(Number(t))},showUnsupportedChainUI(){Fe.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=te.activeCaipNetwork;return!!(t?.chainNamespace&&Ye.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){T.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){const e=t;if(!e)throw new Error("Chain is required to set account prop");const n=T.state.chains.get(e)?.accountState?.preferredAccountType,r=H.state.defaultAccountTypes[e];te.activeCaipAddress=void 0,T.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||n,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),Y.removeConnectorId(e)},setIsSwitchingNamespace(t){te.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){const t=[];let e;if(te.chains.forEach(n=>{F.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(r=>r===n.namespace)&&n.namespace&&t.push(n.namespace)}),t.length>0){const n=t[0];return e=n?te.chains.get(n)?.caipNetworks?.[0]:void 0,e}},getAccountData(t){const e=t||te.activeChain;if(e)return T.state.chains.get(e)?.accountState},getNetworkData(t){const e=t||te.activeChain;if(e)return T.state.chains.get(e)?.networkState},getCaipNetworkByNamespace(t,e){if(!t)return;const n=T.state.chains.get(t),r=n?.caipNetworks?.find(s=>s.id===e);return r||n?.networkState?.caipNetwork||n?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){const t=Y.state.filterByNamespace;return(t?[te.chains.get(t)]:Array.from(te.chains.values())).flatMap(n=>n?.caipNetworks||[]).map(n=>n.caipNetworkId)},getCaipNetworks(t){return t?T.getRequestedCaipNetworks(t):T.getAllRequestedCaipNetworks()},setLastConnectedSIWECaipNetwork(t){te.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return te.lastConnectedSIWECaipNetwork}},T=cr(sP),iP={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},bC=le.getBlockchainApiUrl(),Tn=ct({clientId:null,api:new Vu({baseUrl:bC,clientId:null}),supportedChains:{http:[],ws:[]}}),Ee={state:Tn,async get(t){const{st:e,sv:n}=Ee.getSdkProperties(),r=H.state.projectId,s={...t.params||{},st:e,sv:n,projectId:r};return Tn.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=H.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{Tn.supportedChains.http.length||await Ee.getSupportedNetworks()}catch{return!1}return Tn.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await Ee.get({path:"v1/supported-chains"});return Tn.supportedChains=t,t}catch{return Tn.supportedChains}},async fetchIdentity({address:t,caipNetworkId:e}){if(!await Ee.isNetworkSupported(e))return{avatar:"",name:""};const r=W.getIdentityFromCacheForAddress(t);if(r)return r;const s=await Ee.get({path:`/v1/identity/${t}`,params:{sender:T.state.activeCaipAddress?le.getPlainAddress(T.state.activeCaipAddress):void 0}});return W.updateIdentityCache({address:t,identity:s,timestamp:Date.now()}),s},async fetchTransactions({account:t,cursor:e,signal:n,cache:r,chainId:s}){if(!await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return{data:[],next:void 0};const o=W.getTransactionsCacheForAddress({address:t,chainId:s});if(o)return o;const a=await Ee.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:n,cache:r});return W.updateTransactionsCache({address:t,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:t,userAddress:e,from:n,to:r,gasPrice:s}){return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async fetchTokenPrice({addresses:t}){if(!await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return{fungibles:[]};const n=W.getTokenPriceCacheForAddresses(t);if(n)return n;const r=await Tn.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:H.state.projectId},headers:{"Content-Type":"application/json"}});return W.updateTokenPriceCache({addresses:t,timestamp:Date.now(),tokenPrice:r}),r},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){const{st:e,sv:n}=Ee.getSdkProperties();if(!await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return Ee.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:n}})},async generateSwapCalldata({amount:t,from:e,to:n,userAddress:r,disableEstimate:s}){if(!await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return Tn.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:Ye.CONVERT_SLIPPAGE_TOLERANCE},projectId:H.state.projectId,from:e,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:n}){const{st:r,sv:s}=Ee.getSdkProperties();if(!await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return Ee.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:t,to:e,st:r,sv:s}})},async getBalance(t,e,n){const{st:r,sv:s}=Ee.getSdkProperties();if(!await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return ws.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=W.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await Ee.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:n,st:r,sv:s}});return W.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:`/v1/profile/reverse/${t}`,params:{sender:fe.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(t){return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:n,signature:r}){return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?Tn.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?(await Tn.api.post({path:"/v1/generators/onrampurl",params:{projectId:H.state.projectId},body:{destinationWallets:t,defaultNetwork:n,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){if(!await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await Ee.get({path:"/v1/onramp/options"})}catch{return iP}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}){try{return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?await Tn.api.post({path:"/v1/onramp/quote",params:{projectId:H.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:e.id},paymentSubtotal:{amount:n,currency:e.id},paymentTotal:{amount:n,currency:e.id},purchaseAmount:{amount:n,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,n){return await Ee.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?Tn.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:H.state.projectId},body:{pci:e,signature:n}}):{success:!1}},setClientId(t){Tn.clientId=t,Tn.api=new Vu({baseUrl:bC,clientId:t})}},oP="1.0.8";let Nr=class sm extends Error{constructor(e,n={}){const r=n.cause instanceof sm?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof sm&&n.cause.docsPath||n.docsPath,i=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: https://abitype.dev${s}`]:[],...r?[`Details: ${r}`]:[],`Version: abitype@${oP}`].join(`
`);super(i),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}};function fi(t,e){return t.exec(e)?.groups}const EC=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,vC=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,AC=/^\(.+?\).*?$/,Fw=/^tuple(?<array>(\[(\d*)\])*)$/;function im(t){let e=t.type;if(Fw.test(t.type)&&"components"in t){e="(";const n=t.components.length;for(let s=0;s<n;s++){const i=t.components[s];e+=im(i),s<n-1&&(e+=", ")}const r=fi(Fw,t.type);return e+=`)${r?.array??""}`,im({...t,type:e})}return"indexed"in t&&t.indexed&&(e=`${e} indexed`),t.name?`${e} ${t.name}`:e}function Yc(t){let e="";const n=t.length;for(let r=0;r<n;r++){const s=t[r];e+=im(s),r!==n-1&&(e+=", ")}return e}function aP(t){return t.type==="function"?`function ${t.name}(${Yc(t.inputs)})${t.stateMutability&&t.stateMutability!=="nonpayable"?` ${t.stateMutability}`:""}${t.outputs?.length?` returns (${Yc(t.outputs)})`:""}`:t.type==="event"?`event ${t.name}(${Yc(t.inputs)})`:t.type==="error"?`error ${t.name}(${Yc(t.inputs)})`:t.type==="constructor"?`constructor(${Yc(t.inputs)})${t.stateMutability==="payable"?" payable":""}`:t.type==="fallback"?`fallback() external${t.stateMutability==="payable"?" payable":""}`:"receive() external payable"}const CC=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function cP(t){return CC.test(t)}function lP(t){return fi(CC,t)}const IC=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function uP(t){return IC.test(t)}function dP(t){return fi(IC,t)}const _C=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/;function hP(t){return _C.test(t)}function fP(t){return fi(_C,t)}const NC=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/;function SC(t){return NC.test(t)}function pP(t){return fi(NC,t)}const xC=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/;function gP(t){return xC.test(t)}function mP(t){return fi(xC,t)}const TC=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/;function yP(t){return TC.test(t)}function wP(t){return fi(TC,t)}const bP=/^receive\(\) external payable$/;function EP(t){return bP.test(t)}const vP=new Set(["indexed"]),om=new Set(["calldata","memory","storage"]);class AP extends Nr{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}}class CP extends Nr{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}class IP extends Nr{constructor({param:e}){super("Invalid ABI parameter.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}}class _P extends Nr{constructor({param:e,name:n}){super("Invalid ABI parameter.",{details:e,metaMessages:[`"${n}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}}class NP extends Nr{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}}class SP extends Nr{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${r}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}}class xP extends Nr{constructor({abiParameter:e}){super("Invalid ABI parameter.",{details:JSON.stringify(e,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}class kc extends Nr{constructor({signature:e,type:n}){super(`Invalid ${n} signature.`,{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}}class TP extends Nr{constructor({signature:e}){super("Unknown signature.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}}class PP extends Nr{constructor({signature:e}){super("Invalid struct signature.",{details:e,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}class OP extends Nr{constructor({type:e}){super("Circular reference detected.",{metaMessages:[`Struct "${e}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}class RP extends Nr{constructor({current:e,depth:n}){super("Unbalanced parentheses.",{metaMessages:[`"${e.trim()}" has too many ${n>0?"opening":"closing"} parentheses.`],details:`Depth "${n}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}function kP(t,e,n){let r="";if(n)for(const s of Object.entries(n)){if(!s)continue;let i="";for(const o of s[1])i+=`[${o.type}${o.name?`:${o.name}`:""}]`;r+=`(${s[0]}{${i}})`}return e?`${e}:${t}${r}`:t}const vp=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]);function DP(t,e={}){if(hP(t))return UP(t,e);if(uP(t))return BP(t,e);if(cP(t))return $P(t,e);if(gP(t))return LP(t,e);if(yP(t))return MP(t);if(EP(t))return{type:"receive",stateMutability:"payable"};throw new TP({signature:t})}function UP(t,e={}){const n=fP(t);if(!n)throw new kc({signature:t,type:"function"});const r=qr(n.parameters),s=[],i=r.length;for(let a=0;a<i;a++)s.push(Go(r[a],{modifiers:om,structs:e,type:"function"}));const o=[];if(n.returns){const a=qr(n.returns),c=a.length;for(let l=0;l<c;l++)o.push(Go(a[l],{modifiers:om,structs:e,type:"function"}))}return{name:n.name,type:"function",stateMutability:n.stateMutability??"nonpayable",inputs:s,outputs:o}}function BP(t,e={}){const n=dP(t);if(!n)throw new kc({signature:t,type:"event"});const r=qr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(Go(r[o],{modifiers:vP,structs:e,type:"event"}));return{name:n.name,type:"event",inputs:s}}function $P(t,e={}){const n=lP(t);if(!n)throw new kc({signature:t,type:"error"});const r=qr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(Go(r[o],{structs:e,type:"error"}));return{name:n.name,type:"error",inputs:s}}function LP(t,e={}){const n=mP(t);if(!n)throw new kc({signature:t,type:"constructor"});const r=qr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(Go(r[o],{structs:e,type:"constructor"}));return{type:"constructor",stateMutability:n.stateMutability??"nonpayable",inputs:s}}function MP(t){const e=wP(t);if(!e)throw new kc({signature:t,type:"fallback"});return{type:"fallback",stateMutability:e.stateMutability??"nonpayable"}}const FP=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,jP=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,HP=/^u?int$/;function Go(t,e){const n=kP(t,e?.type,e?.structs);if(vp.has(n))return vp.get(n);const r=AC.test(t),s=fi(r?jP:FP,t);if(!s)throw new IP({param:t});if(s.name&&qP(s.name))throw new _P({param:t,name:s.name});const i=s.name?{name:s.name}:{},o=s.modifier==="indexed"?{indexed:!0}:{},a=e?.structs??{};let c,l={};if(r){c="tuple";const d=qr(s.type),h=[],f=d.length;for(let p=0;p<f;p++)h.push(Go(d[p],{structs:a}));l={components:h}}else if(s.type in a)c="tuple",l={components:a[s.type]};else if(HP.test(s.type))c=`${s.type}256`;else if(c=s.type,e?.type!=="struct"&&!PC(c))throw new CP({type:c});if(s.modifier){if(!e?.modifiers?.has?.(s.modifier))throw new NP({param:t,type:e?.type,modifier:s.modifier});if(om.has(s.modifier)&&!WP(c,!!s.array))throw new SP({param:t,type:e?.type,modifier:s.modifier})}const u={type:`${c}${s.array??""}`,...i,...o,...l};return vp.set(n,u),u}function qr(t,e=[],n="",r=0){const s=t.trim().length;for(let i=0;i<s;i++){const o=t[i],a=t.slice(i+1);switch(o){case",":return r===0?qr(a,[...e,n.trim()]):qr(a,e,`${n}${o}`,r);case"(":return qr(a,e,`${n}${o}`,r+1);case")":return qr(a,e,`${n}${o}`,r-1);default:return qr(a,e,`${n}${o}`,r)}}if(n==="")return e;if(r!==0)throw new RP({current:n,depth:r});return e.push(n.trim()),e}function PC(t){return t==="address"||t==="bool"||t==="function"||t==="string"||EC.test(t)||vC.test(t)}const zP=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function qP(t){return t==="address"||t==="bool"||t==="function"||t==="string"||t==="tuple"||EC.test(t)||vC.test(t)||zP.test(t)}function WP(t,e){return e||t==="bytes"||t==="string"||t==="tuple"}function VP(t){const e={},n=t.length;for(let o=0;o<n;o++){const a=t[o];if(!SC(a))continue;const c=pP(a);if(!c)throw new kc({signature:a,type:"struct"});const l=c.properties.split(";"),u=[],d=l.length;for(let h=0;h<d;h++){const p=l[h].trim();if(!p)continue;const g=Go(p,{type:"struct"});u.push(g)}if(!u.length)throw new PP({signature:a});e[c.name]=u}const r={},s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[a,c]=s[o];r[a]=OC(c,e)}return r}const GP=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/;function OC(t,e,n=new Set){const r=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];if(AC.test(o.type))r.push(o);else{const c=fi(GP,o.type);if(!c?.type)throw new xP({abiParameter:o});const{array:l,type:u}=c;if(u in e){if(n.has(u))throw new OP({type:u});r.push({...o,type:`tuple${l??""}`,components:OC(e[u]??[],e,new Set([...n,u]))})}else if(PC(u))r.push(o);else throw new AP({type:u})}}return r}function RC(t){const e=VP(t),n=[],r=t.length;for(let s=0;s<r;s++){const i=t[s];SC(i)||n.push(DP(i,e))}return n}function mt(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}function Xi(t,{includeName:e=!1}={}){if(t.type!=="function"&&t.type!=="event"&&t.type!=="error")throw new iO(t.type);return`${t.name}(${Ef(t.inputs,{includeName:e})})`}function Ef(t,{includeName:e=!1}={}){return t?t.map(n=>KP(n,{includeName:e})).join(e?", ":","):""}function KP(t,{includeName:e}){return t.type.startsWith("tuple")?`(${Ef(t.components,{includeName:e})})${t.type.slice(5)}`:t.type+(e&&t.name?` ${t.name}`:"")}function eo(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function Ft(t){return eo(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const kC="2.33.3";let Ap={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${kC}`},G=class am extends Error{constructor(e,n={}){const r=n.cause instanceof am?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof am&&n.cause.docsPath||n.docsPath,i=Ap.getDocsUrl?.({...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...Ap.version?[`Version: ${Ap.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=kC}walk(e){return DC(this,e)}};function DC(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?DC(t.cause,e):e?null:t}class JP extends G{constructor({docsPath:e}){super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join(`
`),{docsPath:e,name:"AbiConstructorNotFoundError"})}}class jw extends G{constructor({docsPath:e}){super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join(`
`),{docsPath:e,name:"AbiConstructorParamsNotFoundError"})}}class UC extends G{constructor({data:e,params:n,size:r}){super([`Data size of ${r} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${Ef(n,{includeName:!0})})`,`Data:   ${e} (${r} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e,this.params=n,this.size=r}}class vf extends G{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}}class YP extends G{constructor({expectedLength:e,givenLength:n,type:r}){super([`ABI encoding array length mismatch for type ${r}.`,`Expected length: ${e}`,`Given length: ${n}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}}class ZP extends G{constructor({expectedSize:e,value:n}){super(`Size of bytes "${n}" (bytes${Ft(n)}) does not match expected size (bytes${e}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class QP extends G{constructor({expectedLength:e,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${e}`,`Given length (values): ${n}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class Jee extends G{constructor(e,{docsPath:n}){super([`Arguments (\`args\`) were provided to "${e}", but "${e}" on the ABI does not contain any parameters (\`inputs\`).`,"Cannot encode error result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the inputs exist on it."].join(`
`),{docsPath:n,name:"AbiErrorInputsNotFoundError"})}}class Yee extends G{constructor(e,{docsPath:n}={}){super([`Error ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it."].join(`
`),{docsPath:n,name:"AbiErrorNotFoundError"})}}class BC extends G{constructor(e,{docsPath:n}){super([`Encoded error signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=e}}class XP extends G{constructor({docsPath:e}){super("Cannot extract event signature from empty topics.",{docsPath:e,name:"AbiEventSignatureEmptyTopicsError"})}}class $C extends G{constructor(e,{docsPath:n}){super([`Encoded event signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiEventSignatureNotFoundError"})}}class Zee extends G{constructor(e,{docsPath:n}={}){super([`Event ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it."].join(`
`),{docsPath:n,name:"AbiEventNotFoundError"})}}class Ih extends G{constructor(e,{docsPath:n}={}){super([`Function ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionNotFoundError"})}}class eO extends G{constructor(e,{docsPath:n}){super([`Function "${e}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionOutputsNotFoundError"})}}class Qee extends G{constructor(e,{docsPath:n}){super([`Encoded function signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiFunctionSignatureNotFoundError"})}}class tO extends G{constructor(e,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${e.type}\` in \`${Xi(e.abiItem)}\`, and`,`\`${n.type}\` in \`${Xi(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class Xee extends G{constructor({expectedSize:e,givenSize:n}){super(`Expected bytes${e}, got bytes${n}.`,{name:"BytesSizeMismatchError"})}}class cm extends G{constructor({abiItem:e,data:n,params:r,size:s}){super([`Data size of ${s} bytes is too small for non-indexed event parameters.`].join(`
`),{metaMessages:[`Params: (${Ef(r,{includeName:!0})})`,`Data:   ${n} (${s} bytes)`],name:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e,this.data=n,this.params=r,this.size=s}}class LC extends G{constructor({abiItem:e,param:n}){super([`Expected a topic for indexed event parameter${n.name?` "${n.name}"`:""} on event "${Xi(e,{includeName:!0})}".`].join(`
`),{name:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e}}class nO extends G{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiEncodingType"})}}class rO extends G{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiDecodingType"})}}class sO extends G{constructor(e){super([`Value "${e}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}}class iO extends G{constructor(e){super([`"${e}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}class ete extends G{constructor(e){super(`Type "${e}" is not supported for packed encoding.`,{name:"UnsupportedPackedAbiType"})}}let MC=class extends G{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}},FC=class extends G{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}};class Hw extends G{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} is expected to be ${n} ${r} long, but is ${e} ${r} long.`,{name:"InvalidBytesLengthError"})}}function Dc(t,{dir:e,size:n=32}={}){return typeof t=="string"?Wi(t,{dir:e,size:n}):oO(t,{dir:e,size:n})}function Wi(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new FC({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function oO(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new FC({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}let jC=class extends G{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}};class aO extends G{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}}class cO extends G{constructor(e){super(`Hex value "${e}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`,{name:"InvalidHexBooleanError"})}}let lO=class extends G{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function Vi(t,{dir:e="left"}={}){let n=typeof t=="string"?t.replace("0x",""):t,r=0;for(let s=0;s<n.length-1&&n[e==="left"?s:n.length-s-1].toString()==="0";s++)r++;return n=e==="left"?n.slice(r):n.slice(0,n.length-r),typeof t=="string"?(n.length===1&&e==="right"&&(n=`${n}0`),`0x${n.length%2===1?`0${n}`:n}`):n}function Sr(t,{size:e}){if(Ft(t)>e)throw new lO({givenSize:Ft(t),maxSize:e})}function fc(t,e={}){const{signed:n}=e;e.size&&Sr(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function ite(t,e={}){let n=t;if(e.size&&(Sr(n,{size:e.size}),n=Vi(n)),Vi(n)==="0x00")return!1;if(Vi(n)==="0x01")return!0;throw new cO(n)}function Ko(t,e={}){return Number(fc(t,e))}function HC(t,e={}){let n=Is(t);return e.size&&(Sr(n,{size:e.size}),n=Vi(n,{dir:"right"})),new TextDecoder().decode(n)}const uO=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function pc(t,e={}){return typeof t=="number"||typeof t=="bigint"?De(t,e):typeof t=="string"?Af(t,e):typeof t=="boolean"?zC(t,e):Vn(t,e)}function zC(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Sr(n,{size:e.size}),Dc(n,{size:e.size})):n}function Vn(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=uO[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Sr(r,{size:e.size}),Dc(r,{dir:"right",size:e.size})):r}function De(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new jC({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${t}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Dc(a,{size:r}):a}const dO=new TextEncoder;function Af(t,e={}){const n=dO.encode(t);return Vn(n,e)}const hO=new TextEncoder;function Cf(t,e={}){return typeof t=="number"||typeof t=="bigint"?pO(t,e):typeof t=="boolean"?fO(t,e):eo(t)?Is(t,e):qC(t,e)}function fO(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(Sr(n,{size:e.size}),Dc(n,{size:e.size})):n}const ks={zero:48,nine:57,A:65,F:70,a:97,f:102};function zw(t){if(t>=ks.zero&&t<=ks.nine)return t-ks.zero;if(t>=ks.A&&t<=ks.F)return t-(ks.A-10);if(t>=ks.a&&t<=ks.f)return t-(ks.a-10)}function Is(t,e={}){let n=t;e.size&&(Sr(n,{size:e.size}),n=Dc(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=zw(r.charCodeAt(a++)),l=zw(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new G(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+l}return i}function pO(t,e){const n=De(t,e);return Is(n)}function qC(t,e={}){const n=hO.encode(t);return typeof e.size=="number"?(Sr(n,{size:e.size}),Dc(n,{dir:"right",size:e.size})):n}const bd=BigInt(2**32-1),qw=BigInt(32);function gO(t,e=!1){return e?{h:Number(t&bd),l:Number(t>>qw&bd)}:{h:Number(t>>qw&bd)|0,l:Number(t&bd)|0}}function mO(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=gO(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const yO=(t,e,n)=>t<<n|e>>>32-n,wO=(t,e,n)=>e<<n|t>>>32-n,bO=(t,e,n)=>e<<n-32|t>>>64-n,EO=(t,e,n)=>t<<n-32|e>>>64-n,va=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function vO(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function _h(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Jo(t,...e){if(!vO(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function ote(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");_h(t.outputLen),_h(t.blockLen)}function Nh(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function WC(t,e){Jo(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function AO(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Wl(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Cp(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ns(t,e){return t<<32-e|t>>>e}const CO=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function IO(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function _O(t){for(let e=0;e<t.length;e++)t[e]=IO(t[e]);return t}const Ww=CO?t=>t:_O,VC=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",NO=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ate(t){if(Jo(t),VC)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=NO[t[n]];return e}const Ds={_0:48,_9:57,A:65,F:70,a:97,f:102};function Vw(t){if(t>=Ds._0&&t<=Ds._9)return t-Ds._0;if(t>=Ds.A&&t<=Ds.F)return t-(Ds.A-10);if(t>=Ds.a&&t<=Ds.f)return t-(Ds.a-10)}function cte(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(VC)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=Vw(t.charCodeAt(i)),a=Vw(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function SO(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Y0(t){return typeof t=="string"&&(t=SO(t)),Jo(t),t}function lte(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Jo(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let GC=class{};function KC(t){const e=r=>t().update(Y0(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function dte(t=32){if(va&&typeof va.getRandomValues=="function")return va.getRandomValues(new Uint8Array(t));if(va&&typeof va.randomBytes=="function")return Uint8Array.from(va.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const xO=BigInt(0),Zc=BigInt(1),TO=BigInt(2),PO=BigInt(7),OO=BigInt(256),RO=BigInt(113),JC=[],YC=[],ZC=[];for(let t=0,e=Zc,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],JC.push(2*(5*r+n)),YC.push((t+1)*(t+2)/2%64);let s=xO;for(let i=0;i<7;i++)e=(e<<Zc^(e>>PO)*RO)%OO,e&TO&&(s^=Zc<<(Zc<<BigInt(i))-Zc);ZC.push(s)}const QC=mO(ZC,!0),kO=QC[0],DO=QC[1],Gw=(t,e,n)=>n>32?bO(t,e,n):yO(t,e,n),Kw=(t,e,n)=>n>32?EO(t,e,n):wO(t,e,n);function UO(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=Gw(l,u,1)^n[a],h=Kw(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=YC[o],c=Gw(s,i,a),l=Kw(s,i,a),u=JC[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=kO[r],t[1]^=DO[r]}Wl(n)}let BO=class XC extends GC{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,_h(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=AO(this.state)}clone(){return this._cloneInto()}keccak(){Ww(this.state32),UO(this.state32,this.rounds),Ww(this.state32),this.posOut=0,this.pos=0}update(e){Nh(this),e=Y0(e),Jo(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Nh(this,!1),Jo(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return _h(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(WC(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Wl(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new XC(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const $O=(t,e,n)=>KC(()=>new BO(e,t,n)),LO=$O(1,136,256/8);function Gu(t,e){const n=e||"hex",r=LO(eo(t,{strict:!1})?Cf(t):t);return n==="bytes"?r:pc(r)}const MO=t=>Gu(Cf(t));function FO(t){return MO(t)}function jO(t){let e=!0,n="",r=0,s="",i=!1;for(let o=0;o<t.length;o++){const a=t[o];if(["(",")",","].includes(a)&&(e=!0),a==="("&&r++,a===")"&&r--,!!e){if(r===0){if(a===" "&&["event","function",""].includes(s))s="";else if(s+=a,a===")"){i=!0;break}continue}if(a===" "){t[o-1]!==","&&n!==","&&n!==",("&&(n="",e=!1);continue}s+=a,n+=a}}if(!i)throw new G("Unable to normalize signature.");return s}const HO=t=>{const e=typeof t=="string"?t:aP(t);return jO(e)};function eI(t){return FO(HO(t))}const Z0=eI;class Yo extends G{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}let If=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const Ip=new If(8192);function _f(t,e){if(Ip.has(`${t}.${e}`))return Ip.get(`${t}.${e}`);const n=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),r=Gu(qC(n),"bytes"),s=(e?n.substring(`${e}0x`.length):n).split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Ip.set(`${t}.${e}`,i),i}function xo(t,e){if(!_s(t,{strict:!1}))throw new Yo({address:t});return _f(t,e)}const zO=/^0x[a-fA-F0-9]{40}$/,_p=new If(8192);function _s(t,e){const{strict:n=!0}=e??{},r=`${t}.${n}`;if(_p.has(r))return _p.get(r);const s=zO.test(t)?t.toLowerCase()===t?!0:n?_f(t)===t:!0:!1;return _p.set(r,s),s}function gc(t){return typeof t[0]=="string"?Nf(t):qO(t)}function qO(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function Nf(t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function Sh(t,e,n,{strict:r}={}){return eo(t,{strict:!1})?WO(t,e,n,{strict:r}):rI(t,e,n,{strict:r})}function tI(t,e){if(typeof e=="number"&&e>0&&e>Ft(t)-1)throw new MC({offset:e,position:"start",size:Ft(t)})}function nI(t,e,n){if(typeof e=="number"&&typeof n=="number"&&Ft(t)!==n-e)throw new MC({offset:n,position:"end",size:Ft(t)})}function rI(t,e,n,{strict:r}={}){tI(t,e);const s=t.slice(e,n);return r&&nI(s,e,n),s}function WO(t,e,n,{strict:r}={}){tI(t,e);const s=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return r&&nI(s,e,n),s}const fte=/^(.*)\[([0-9]*)\]$/,pte=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,VO=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function sI(t,e){if(t.length!==e.length)throw new QP({expectedLength:t.length,givenLength:e.length});const n=GO({params:t,values:e}),r=X0(n);return r.length===0?"0x":r}function GO({params:t,values:e}){const n=[];for(let r=0;r<t.length;r++)n.push(Q0({param:t[r],value:e[r]}));return n}function Q0({param:t,value:e}){const n=ey(t.type);if(n){const[r,s]=n;return JO(e,{length:r,param:{...t,type:s}})}if(t.type==="tuple")return eR(e,{param:t});if(t.type==="address")return KO(e);if(t.type==="bool")return ZO(e);if(t.type.startsWith("uint")||t.type.startsWith("int")){const r=t.type.startsWith("int"),[,,s="256"]=VO.exec(t.type)??[];return QO(e,{signed:r,size:Number(s)})}if(t.type.startsWith("bytes"))return YO(e,{param:t});if(t.type==="string")return XO(e);throw new nO(t.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function X0(t){let e=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?e+=32:e+=Ft(a)}const n=[],r=[];let s=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?(n.push(De(e+s,{size:32})),r.push(a),s+=Ft(a)):n.push(a)}return gc([...n,...r])}function KO(t){if(!_s(t))throw new Yo({address:t});return{dynamic:!1,encoded:Wi(t.toLowerCase())}}function JO(t,{length:e,param:n}){const r=e===null;if(!Array.isArray(t))throw new sO(t);if(!r&&t.length!==e)throw new YP({expectedLength:e,givenLength:t.length,type:`${n.type}[${e}]`});let s=!1;const i=[];for(let o=0;o<t.length;o++){const a=Q0({param:n,value:t[o]});a.dynamic&&(s=!0),i.push(a)}if(r||s){const o=X0(i);if(r){const a=De(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?gc([a,o]):a}}if(s)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:gc(i.map(({encoded:o})=>o))}}function YO(t,{param:e}){const[,n]=e.type.split("bytes"),r=Ft(t);if(!n){let s=t;return r%32!==0&&(s=Wi(s,{dir:"right",size:Math.ceil((t.length-2)/2/32)*32})),{dynamic:!0,encoded:gc([Wi(De(r,{size:32})),s])}}if(r!==Number.parseInt(n))throw new ZP({expectedSize:Number.parseInt(n),value:t});return{dynamic:!1,encoded:Wi(t,{dir:"right"})}}function ZO(t){if(typeof t!="boolean")throw new G(`Invalid boolean value: "${t}" (type: ${typeof t}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:Wi(zC(t))}}function QO(t,{signed:e,size:n=256}){if(typeof n=="number"){const r=2n**(BigInt(n)-(e?1n:0n))-1n,s=e?-r-1n:0n;if(t>r||t<s)throw new jC({max:r.toString(),min:s.toString(),signed:e,size:n/8,value:t.toString()})}return{dynamic:!1,encoded:De(t,{size:32,signed:e})}}function XO(t){const e=Af(t),n=Math.ceil(Ft(e)/32),r=[];for(let s=0;s<n;s++)r.push(Wi(Sh(e,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:gc([Wi(De(Ft(e),{size:32})),...r])}}function eR(t,{param:e}){let n=!1;const r=[];for(let s=0;s<e.components.length;s++){const i=e.components[s],o=Array.isArray(t)?s:i.name,a=Q0({param:i,value:t[o]});r.push(a),a.dynamic&&(n=!0)}return{dynamic:n,encoded:n?X0(r):gc(r.map(({encoded:s})=>s))}}function ey(t){const e=t.match(/^(.*)\[(\d+)?\]$/);return e?[e[2]?Number(e[2]):null,e[1]]:void 0}const ty=t=>Sh(eI(t),0,4);function ny(t){const{abi:e,args:n=[],name:r}=t,s=eo(r,{strict:!1}),i=e.filter(a=>s?a.type==="function"?ty(a)===r:a.type==="event"?Z0(a)===r:!1:"name"in a&&a.name===r);if(i.length===0)return;if(i.length===1)return i[0];let o;for(const a of i){if(!("inputs"in a))continue;if(!n||n.length===0){if(!a.inputs||a.inputs.length===0)return a;continue}if(!a.inputs||a.inputs.length===0||a.inputs.length!==n.length)continue;if(n.every((l,u)=>{const d="inputs"in a&&a.inputs[u];return d?lm(l,d):!1})){if(o&&"inputs"in o&&o.inputs){const l=iI(a.inputs,o.inputs,n);if(l)throw new tO({abiItem:a,type:l[0]},{abiItem:o,type:l[1]})}o=a}}return o||i[0]}function lm(t,e){const n=typeof t,r=e.type;switch(r){case"address":return _s(t,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in e?Object.values(e.components).every((s,i)=>lm(Object.values(t)[i],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||t instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(t)&&t.every(s=>lm(s,{...e,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function iI(t,e,n){for(const r in t){const s=t[r],i=e[r];if(s.type==="tuple"&&i.type==="tuple"&&"components"in s&&"components"in i)return iI(s.components,i.components,n[r]);const o=[s.type,i.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")?_s(n[r],{strict:!1}):o.includes("address")&&o.includes("bytes")?_s(n[r],{strict:!1}):!1)return o}}function tR(t,{method:e}){const n={};return t.transport.type==="fallback"&&t.transport.onResponse?.(({method:r,response:s,status:i,transport:o})=>{i==="success"&&e===r&&(n[s]=o.request)}),r=>n[r]||t.request}function Ps(t){return typeof t=="string"?{address:t,type:"json-rpc"}:t}const Jw="/docs/contract/encodeFunctionData";function nR(t){const{abi:e,args:n,functionName:r}=t;let s=e[0];if(r){const i=ny({abi:e,args:n,name:r});if(!i)throw new Ih(r,{docsPath:Jw});s=i}if(s.type!=="function")throw new Ih(void 0,{docsPath:Jw});return{abi:[s],functionName:ty(Xi(s))}}function Sf(t){const{args:e}=t,{abi:n,functionName:r}=t.abi.length===1&&t.functionName?.startsWith("0x")?t:nR(t),s=n[0],i=r,o="inputs"in s&&s.inputs?sI(s.inputs,e??[]):void 0;return Nf([i,o??"0x"])}const rR={1:"An `assert` condition failed.",17:"Arithmetic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},sR={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},iR={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"};class Yw extends G{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`,{name:"NegativeOffsetError"})}}class oI extends G{constructor({length:e,position:n}){super(`Position \`${n}\` is out of bounds (\`0 < position < ${e}\`).`,{name:"PositionOutOfBoundsError"})}}class oR extends G{constructor({count:e,limit:n}){super(`Recursive read limit of \`${n}\` exceeded (recursive read count: \`${e}\`).`,{name:"RecursiveReadLimitExceededError"})}}const aR={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new oR({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(t){if(t<0||t>this.bytes.length-1)throw new oI({length:this.bytes.length,position:t})},decrementPosition(t){if(t<0)throw new Yw({offset:t});const e=this.position-t;this.assertPosition(e),this.position=e},getReadCount(t){return this.positionReadCount.get(t||this.position)||0},incrementPosition(t){if(t<0)throw new Yw({offset:t});const e=this.position+t;this.assertPosition(e),this.position=e},inspectByte(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectBytes(t,e){const n=e??this.position;return this.assertPosition(n+t-1),this.bytes.subarray(n,n+t)},inspectUint8(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectUint16(t){const e=t??this.position;return this.assertPosition(e+1),this.dataView.getUint16(e)},inspectUint24(t){const e=t??this.position;return this.assertPosition(e+2),(this.dataView.getUint16(e)<<8)+this.dataView.getUint8(e+2)},inspectUint32(t){const e=t??this.position;return this.assertPosition(e+3),this.dataView.getUint32(e)},pushByte(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushBytes(t){this.assertPosition(this.position+t.length-1),this.bytes.set(t,this.position),this.position+=t.length},pushUint8(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushUint16(t){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,t),this.position+=2},pushUint24(t){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,t>>8),this.dataView.setUint8(this.position+2,t&255),this.position+=3},pushUint32(t){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,t),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const t=this.inspectByte();return this.position++,t},readBytes(t,e){this.assertReadLimit(),this._touch();const n=this.inspectBytes(t);return this.position+=e??t,n},readUint8(){this.assertReadLimit(),this._touch();const t=this.inspectUint8();return this.position+=1,t},readUint16(){this.assertReadLimit(),this._touch();const t=this.inspectUint16();return this.position+=2,t},readUint24(){this.assertReadLimit(),this._touch();const t=this.inspectUint24();return this.position+=3,t},readUint32(){this.assertReadLimit(),this._touch();const t=this.inspectUint32();return this.position+=4,t},get remaining(){return this.bytes.length-this.position},setPosition(t){const e=this.position;return this.assertPosition(t),this.position=t,()=>this.position=e},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const t=this.getReadCount();this.positionReadCount.set(this.position,t+1),t>0&&this.recursiveReadCount++}};function ry(t,{recursiveReadLimit:e=8192}={}){const n=Object.create(aR);return n.bytes=t,n.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength),n.positionReadCount=new Map,n.recursiveReadLimit=e,n}function cR(t,e={}){typeof e.size<"u"&&Sr(t,{size:e.size});const n=Vn(t,e);return fc(n,e)}function lR(t,e={}){let n=t;if(typeof e.size<"u"&&(Sr(n,{size:e.size}),n=Vi(n)),n.length>1||n[0]>1)throw new aO(n);return!!n[0]}function ei(t,e={}){typeof e.size<"u"&&Sr(t,{size:e.size});const n=Vn(t,e);return Ko(n,e)}function uR(t,e={}){let n=t;return typeof e.size<"u"&&(Sr(n,{size:e.size}),n=Vi(n,{dir:"right"})),new TextDecoder().decode(n)}function xf(t,e){const n=typeof e=="string"?Is(e):e,r=ry(n);if(Ft(n)===0&&t.length>0)throw new vf;if(Ft(e)&&Ft(e)<32)throw new UC({data:typeof e=="string"?e:Vn(e),params:t,size:Ft(e)});let s=0;const i=[];for(let o=0;o<t.length;++o){const a=t[o];r.setPosition(s);const[c,l]=tc(r,a,{staticPosition:0});s+=l,i.push(c)}return i}function tc(t,e,{staticPosition:n}){const r=ey(e.type);if(r){const[s,i]=r;return hR(t,{...e,type:i},{length:s,staticPosition:n})}if(e.type==="tuple")return mR(t,e,{staticPosition:n});if(e.type==="address")return dR(t);if(e.type==="bool")return fR(t);if(e.type.startsWith("bytes"))return pR(t,e,{staticPosition:n});if(e.type.startsWith("uint")||e.type.startsWith("int"))return gR(t,e);if(e.type==="string")return yR(t,{staticPosition:n});throw new rO(e.type,{docsPath:"/docs/contract/decodeAbiParameters"})}const Zw=32,um=32;function dR(t){const e=t.readBytes(32);return[_f(Vn(rI(e,-20))),32]}function hR(t,e,{length:n,staticPosition:r}){if(!n){const o=ei(t.readBytes(um)),a=r+o,c=a+Zw;t.setPosition(a);const l=ei(t.readBytes(Zw)),u=Vl(e);let d=0;const h=[];for(let f=0;f<l;++f){t.setPosition(c+(u?f*32:d));const[p,g]=tc(t,e,{staticPosition:c});d+=g,h.push(p)}return t.setPosition(r+32),[h,32]}if(Vl(e)){const o=ei(t.readBytes(um)),a=r+o,c=[];for(let l=0;l<n;++l){t.setPosition(a+l*32);const[u]=tc(t,e,{staticPosition:a});c.push(u)}return t.setPosition(r+32),[c,32]}let s=0;const i=[];for(let o=0;o<n;++o){const[a,c]=tc(t,e,{staticPosition:r+s});s+=c,i.push(a)}return[i,s]}function fR(t){return[lR(t.readBytes(32),{size:32}),32]}function pR(t,e,{staticPosition:n}){const[r,s]=e.type.split("bytes");if(!s){const o=ei(t.readBytes(32));t.setPosition(n+o);const a=ei(t.readBytes(32));if(a===0)return t.setPosition(n+32),["0x",32];const c=t.readBytes(a);return t.setPosition(n+32),[Vn(c),32]}return[Vn(t.readBytes(Number.parseInt(s),32)),32]}function gR(t,e){const n=e.type.startsWith("int"),r=Number.parseInt(e.type.split("int")[1]||"256"),s=t.readBytes(32);return[r>48?cR(s,{signed:n}):ei(s,{signed:n}),32]}function mR(t,e,{staticPosition:n}){const r=e.components.length===0||e.components.some(({name:o})=>!o),s=r?[]:{};let i=0;if(Vl(e)){const o=ei(t.readBytes(um)),a=n+o;for(let c=0;c<e.components.length;++c){const l=e.components[c];t.setPosition(a+i);const[u,d]=tc(t,l,{staticPosition:a});i+=d,s[r?c:l?.name]=u}return t.setPosition(n+32),[s,32]}for(let o=0;o<e.components.length;++o){const a=e.components[o],[c,l]=tc(t,a,{staticPosition:n});s[r?o:a?.name]=c,i+=l}return[s,i]}function yR(t,{staticPosition:e}){const n=ei(t.readBytes(32)),r=e+n;t.setPosition(r);const s=ei(t.readBytes(32));if(s===0)return t.setPosition(e+32),["",32];const i=t.readBytes(s,32),o=uR(Vi(i));return t.setPosition(e+32),[o,32]}function Vl(t){const{type:e}=t;if(e==="string"||e==="bytes"||e.endsWith("[]"))return!0;if(e==="tuple")return t.components?.some(Vl);const n=ey(t.type);return!!(n&&Vl({...t,type:n[1]}))}function wR(t){const{abi:e,data:n}=t,r=Sh(n,0,4);if(r==="0x")throw new vf;const i=[...e||[],sR,iR].find(o=>o.type==="error"&&r===ty(Xi(o)));if(!i)throw new BC(r,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:i,args:"inputs"in i&&i.inputs&&i.inputs.length>0?xf(i.inputs,Sh(n,4)):void 0,errorName:i.name}}const vr=(t,e,n)=>JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString():s,n);function aI({abiItem:t,args:e,includeFunctionName:n=!0,includeName:r=!1}){if("name"in t&&"inputs"in t&&t.inputs)return`${n?t.name:""}(${t.inputs.map((s,i)=>`${r&&s.name?`${s.name}: `:""}${typeof e[i]=="object"?vr(e[i]):e[i]}`).join(", ")})`}const bR={gwei:9,wei:18},ER={ether:-9,wei:9},vR={ether:-18,gwei:-9};function Uc(t,e){let n=t.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(e,"0");let[s,i]=[n.slice(0,n.length-e),n.slice(n.length-e)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}function sy(t,e="wei"){return Uc(t,bR[e])}function qn(t,e="wei"){return Uc(t,ER[e])}class AR extends G{constructor({address:e}){super(`State for account "${e}" is set multiple times.`,{name:"AccountStateConflictError"})}}class CR extends G{constructor(){super("state and stateDiff are set on the same account.",{name:"StateAssignmentConflictError"})}}function Qw(t){return t.reduce((e,{slot:n,value:r})=>`${e}        ${n}: ${r}
`,"")}function IR(t){return t.reduce((e,{address:n,...r})=>{let s=`${e}    ${n}:
`;return r.nonce&&(s+=`      nonce: ${r.nonce}
`),r.balance&&(s+=`      balance: ${r.balance}
`),r.code&&(s+=`      code: ${r.code}
`),r.state&&(s+=`      state:
`,s+=Qw(r.state)),r.stateDiff&&(s+=`      stateDiff:
`,s+=Qw(r.stateDiff)),s},`  State Override:
`).slice(0,-1)}function Ku(t){const e=Object.entries(t).map(([r,s])=>s===void 0||s===!1?null:[r,s]).filter(Boolean),n=e.reduce((r,[s])=>Math.max(r,s.length),0);return e.map(([r,s])=>`  ${`${r}:`.padEnd(n+1)}  ${s}`).join(`
`)}class _R extends G{constructor(){super(["Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.","Use `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others."].join(`
`),{name:"FeeConflictError"})}}class NR extends G{constructor({transaction:e}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",Ku(e),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}}class SR extends G{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:h}){const f=Ku({chain:s&&`${s?.name} (id: ${s?.id})`,from:n?.address,to:d,value:typeof h<"u"&&`${sy(h)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${qn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${qn(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${qn(l)} gwei`,nonce:u});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Request Arguments:",f].filter(Boolean),name:"TransactionExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class cI extends G{constructor({blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i}){let o="Transaction";r&&i!==void 0&&(o=`Transaction at block time "${r}" at index "${i}"`),e&&i!==void 0&&(o=`Transaction at block hash "${e}" at index "${i}"`),n&&i!==void 0&&(o=`Transaction at block number "${n}" at index "${i}"`),s&&(o=`Transaction with hash "${s}"`),super(`${o} could not be found.`,{name:"TransactionNotFoundError"})}}class lI extends G{constructor({hash:e}){super(`Transaction receipt with hash "${e}" could not be found. The Transaction may not be processed on a block yet.`,{name:"TransactionReceiptNotFoundError"})}}class xR extends G{constructor({hash:e}){super(`Timed out while waiting for transaction with hash "${e}" to be confirmed.`,{name:"WaitForTransactionReceiptTimeoutError"})}}const TR=t=>t,iy=t=>t;class PR extends G{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:h,stateOverride:f}){const p=n?Ps(n):void 0;let g=Ku({from:p?.address,to:d,value:typeof h<"u"&&`${sy(h)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${qn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${qn(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${qn(l)} gwei`,nonce:u});f&&(g+=`
${IR(f)}`),super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Raw Call Arguments:",g].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class uI extends G{constructor(e,{abi:n,args:r,contractAddress:s,docsPath:i,functionName:o,sender:a}){const c=ny({abi:n,args:r,name:o}),l=c?aI({abiItem:c,args:r,includeFunctionName:!1,includeName:!1}):void 0,u=c?Xi(c,{includeName:!0}):void 0,d=Ku({address:s&&TR(s),function:u,args:l&&l!=="()"&&`${[...Array(o?.length??0).keys()].map(()=>" ").join("")}${l}`,sender:a});super(e.shortMessage||`An unknown error occurred while executing the contract function "${o}".`,{cause:e,docsPath:i,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],d&&"Contract Call:",d].filter(Boolean),name:"ContractFunctionExecutionError"}),Object.defineProperty(this,"abi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formattedArgs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"functionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sender",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abi=n,this.args=r,this.cause=e,this.contractAddress=s,this.functionName=o,this.sender=a}}class OR extends G{constructor({abi:e,data:n,functionName:r,message:s}){let i,o,a,c;if(n&&n!=="0x")try{o=wR({abi:e,data:n});const{abiItem:u,errorName:d,args:h}=o;if(d==="Error")c=h[0];else if(d==="Panic"){const[f]=h;c=rR[f]}else{const f=u?Xi(u,{includeName:!0}):void 0,p=u&&h?aI({abiItem:u,args:h,includeFunctionName:!1,includeName:!1}):void 0;a=[f?`Error: ${f}`:"",p&&p!=="()"?`       ${[...Array(d?.length??0).keys()].map(()=>" ").join("")}${p}`:""]}}catch(u){i=u}else s&&(c=s);let l;i instanceof BC&&(l=i.signature,a=[`Unable to decode signature "${l}" as it was not found on the provided ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${l}.`]),super(c&&c!=="execution reverted"||l?[`The contract function "${r}" reverted with the following ${l?"signature":"reason"}:`,c||l].join(`
`):`The contract function "${r}" reverted.`,{cause:i,metaMessages:a,name:"ContractFunctionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"raw",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reason",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=o,this.raw=n,this.reason=c,this.signature=l}}class RR extends G{constructor({functionName:e}){super(`The contract function "${e}" returned no data ("0x").`,{metaMessages:["This could be due to any of the following:",`  - The contract does not have the function "${e}",`,"  - The parameters passed to the contract function may be invalid, or","  - The address is not a contract."],name:"ContractFunctionZeroDataError"})}}class kR extends G{constructor({factory:e}){super(`Deployment for counterfactual contract call failed${e?` for factory "${e}".`:""}`,{metaMessages:["Please ensure:","- The `factory` is a valid contract deployment factory (ie. Create2 Factory, ERC-4337 Factory, etc).","- The `factoryData` is a valid encoded function call for contract deployment function on the factory."],name:"CounterfactualDeploymentFailedError"})}}class oy extends G{constructor({data:e,message:n}){super(n||"",{name:"RawContractError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e}}class _l extends G{constructor({body:e,cause:n,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:n,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${iy(o)}`,e&&`Request body: ${vr(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class ay extends G{constructor({body:e,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${iy(r)}`,`Request body: ${vr(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data}}class Xw extends G{constructor({body:e,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${iy(n)}`,`Request body: ${vr(e)}`],name:"TimeoutError"})}}const DR=-1;class Kn extends G{constructor(e,{code:n,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:s||e?.metaMessages,name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof ay?e.code:n??DR}}class lr extends Kn{constructor(e,n){super(e,n),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class Gl extends Kn{constructor(e){super(e,{code:Gl.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Gl,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class Kl extends Kn{constructor(e){super(e,{code:Kl.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(Kl,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Jl extends Kn{constructor(e,{method:n}={}){super(e,{code:Jl.code,name:"MethodNotFoundRpcError",shortMessage:`The method${n?` "${n}"`:""} does not exist / is not available.`})}}Object.defineProperty(Jl,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Yl extends Kn{constructor(e){super(e,{code:Yl.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Yl,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class Zo extends Kn{constructor(e){super(e,{code:Zo.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(Zo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class Zl extends Kn{constructor(e){super(e,{code:Zl.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Zl,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Ql extends Kn{constructor(e){super(e,{code:Ql.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(Ql,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Gi extends Kn{constructor(e){super(e,{code:Gi.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(Gi,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class mc extends Kn{constructor(e){super(e,{code:mc.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(mc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class To extends Kn{constructor(e,{method:n}={}){super(e,{code:To.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${n?` "${n}"`:""} is not supported.`})}}Object.defineProperty(To,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class yc extends Kn{constructor(e){super(e,{code:yc.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(yc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Xl extends Kn{constructor(e){super(e,{code:Xl.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(Xl,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class Lt extends lr{constructor(e){super(e,{code:Lt.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(Lt,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class eu extends lr{constructor(e){super(e,{code:eu.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(eu,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class tu extends lr{constructor(e,{method:n}={}){super(e,{code:tu.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${n?` " ${n}"`:""}.`})}}Object.defineProperty(tu,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class nu extends lr{constructor(e){super(e,{code:nu.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(nu,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class ru extends lr{constructor(e){super(e,{code:ru.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(ru,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Ns extends lr{constructor(e){super(e,{code:Ns.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(Ns,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class su extends lr{constructor(e){super(e,{code:su.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(su,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class iu extends lr{constructor(e){super(e,{code:iu.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(iu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class ou extends lr{constructor(e){super(e,{code:ou.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(ou,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class au extends lr{constructor(e){super(e,{code:au.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(au,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class cu extends lr{constructor(e){super(e,{code:cu.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(cu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class lu extends lr{constructor(e){super(e,{code:lu.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(lu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class uu extends lr{constructor(e){super(e,{code:uu.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(uu,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class UR extends Kn{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}const BR=3;function xh(t,{abi:e,address:n,args:r,docsPath:s,functionName:i,sender:o}){const a=t instanceof oy?t:t instanceof G?t.walk(p=>"data"in p)||t.walk():{},{code:c,data:l,details:u,message:d,shortMessage:h}=a,f=t instanceof vf?new RR({functionName:i}):[BR,Zo.code].includes(c)&&(l||u||d||h)?new OR({abi:e,data:typeof l=="object"?l.data:l,functionName:i,message:a instanceof ay?u:h??d}):t;return new uI(f,{abi:e,args:r,contractAddress:n,docsPath:s,functionName:i,sender:o})}function $R(t){const e=Gu(`0x${t.substring(4)}`).substring(26);return _f(`0x${e}`)}const LR="modulepreload",MR=function(t){return"/codespaces-blank/"+t},eb={},nn=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){let c=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=c(n.map(l=>{if(l=MR(l),l in eb)return;eb[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":LR,u||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};async function FR({hash:t,signature:e}){const n=eo(t)?t:pc(t),{secp256k1:r}=await nn(async()=>{const{secp256k1:o}=await import("./secp256k1-DA6GXruR.js");return{secp256k1:o}},[]);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:d,yParity:h}=e,f=Number(h??d),p=tb(f);return new r.Signature(fc(l),fc(u)).addRecoveryBit(p)}const o=eo(e)?e:pc(e);if(Ft(o)!==65)throw new Error("invalid signature length");const a=Ko(`0x${o.slice(130)}`),c=tb(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function tb(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function jR({hash:t,signature:e}){return $R(await FR({hash:t,signature:e}))}function HR(t,e="hex"){const n=dI(t),r=ry(new Uint8Array(n.length));return n.encode(r),e==="hex"?Vn(r.bytes):r.bytes}function dI(t){return Array.isArray(t)?zR(t.map(e=>dI(e))):qR(t)}function zR(t){const e=t.reduce((s,i)=>s+i.length,0),n=hI(e);return{length:e<=55?1+e:1+n+e,encode(s){e<=55?s.pushByte(192+e):(s.pushByte(247+n),n===1?s.pushUint8(e):n===2?s.pushUint16(e):n===3?s.pushUint24(e):s.pushUint32(e));for(const{encode:i}of t)i(s)}}}function qR(t){const e=typeof t=="string"?Is(t):t,n=hI(e.length);return{length:e.length===1&&e[0]<128?1:e.length<=55?1+e.length:1+n+e.length,encode(s){e.length===1&&e[0]<128?s.pushBytes(e):e.length<=55?(s.pushByte(128+e.length),s.pushBytes(e)):(s.pushByte(183+n),n===1?s.pushUint8(e.length):n===2?s.pushUint16(e.length):n===3?s.pushUint24(e.length):s.pushUint32(e.length),s.pushBytes(e))}}}function hI(t){if(t<2**8)return 1;if(t<2**16)return 2;if(t<2**24)return 3;if(t<2**32)return 4;throw new G("Length is too large.")}function WR(t){const{chainId:e,nonce:n,to:r}=t,s=t.contractAddress??t.address,i=Gu(Nf(["0x05",HR([e?De(e):"0x",s,n?De(n):"0x"])]));return r==="bytes"?Is(i):i}async function fI(t){const{authorization:e,signature:n}=t;return jR({hash:WR(e),signature:n??e})}class VR extends G{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:h}){const f=Ku({from:n?.address,to:d,value:typeof h<"u"&&`${sy(h)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${qn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${qn(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${qn(l)} gwei`,nonce:u});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Estimate Gas Arguments:",f].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class Po extends G{constructor({cause:e,message:n}={}){const r=n?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(Po,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(Po,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class Th extends G{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${qn(n)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(Th,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class dm extends G{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${qn(n)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(dm,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class hm extends G{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(hm,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class fm extends G{constructor({cause:e,nonce:n}={}){super([`Nonce provided for the transaction ${n?`(${n}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(fm,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class pm extends G{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(pm,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class gm extends G{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(gm,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class mm extends G{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(mm,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class ym extends G{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(ym,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class wm extends G{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(wm,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class Ph extends G{constructor({cause:e,maxPriorityFeePerGas:n,maxFeePerGas:r}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${n?` = ${qn(n)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${qn(r)} gwei`:""}).`].join(`
`),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(Ph,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class Tf extends G{constructor({cause:e}){super(`An error occurred while executing: ${e?.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}function cy(t,e){const n=(t.details||"").toLowerCase(),r=t instanceof G?t.walk(s=>s?.code===Po.code):t;return r instanceof G?new Po({cause:t,message:r.details}):Po.nodeMessage.test(n)?new Po({cause:t,message:t.details}):Th.nodeMessage.test(n)?new Th({cause:t,maxFeePerGas:e?.maxFeePerGas}):dm.nodeMessage.test(n)?new dm({cause:t,maxFeePerGas:e?.maxFeePerGas}):hm.nodeMessage.test(n)?new hm({cause:t,nonce:e?.nonce}):fm.nodeMessage.test(n)?new fm({cause:t,nonce:e?.nonce}):pm.nodeMessage.test(n)?new pm({cause:t,nonce:e?.nonce}):gm.nodeMessage.test(n)?new gm({cause:t}):mm.nodeMessage.test(n)?new mm({cause:t,gas:e?.gas}):ym.nodeMessage.test(n)?new ym({cause:t,gas:e?.gas}):wm.nodeMessage.test(n)?new wm({cause:t}):Ph.nodeMessage.test(n)?new Ph({cause:t,maxFeePerGas:e?.maxFeePerGas,maxPriorityFeePerGas:e?.maxPriorityFeePerGas}):new Tf({cause:t})}function GR(t,{docsPath:e,...n}){const r=(()=>{const s=cy(t,n);return s instanceof Tf?t:s})();return new VR(r,{docsPath:e,...n})}function ly(t,{format:e}){if(!e)return{};const n={};function r(i){const o=Object.keys(i);for(const a of o)a in t&&(n[a]=t[a]),i[a]&&typeof i[a]=="object"&&!Array.isArray(i[a])&&r(i[a])}const s=e(t||{});return r(s),n}const KR={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"};function uy(t){const e={};return typeof t.authorizationList<"u"&&(e.authorizationList=JR(t.authorizationList)),typeof t.accessList<"u"&&(e.accessList=t.accessList),typeof t.blobVersionedHashes<"u"&&(e.blobVersionedHashes=t.blobVersionedHashes),typeof t.blobs<"u"&&(typeof t.blobs[0]!="string"?e.blobs=t.blobs.map(n=>Vn(n)):e.blobs=t.blobs),typeof t.data<"u"&&(e.data=t.data),typeof t.from<"u"&&(e.from=t.from),typeof t.gas<"u"&&(e.gas=De(t.gas)),typeof t.gasPrice<"u"&&(e.gasPrice=De(t.gasPrice)),typeof t.maxFeePerBlobGas<"u"&&(e.maxFeePerBlobGas=De(t.maxFeePerBlobGas)),typeof t.maxFeePerGas<"u"&&(e.maxFeePerGas=De(t.maxFeePerGas)),typeof t.maxPriorityFeePerGas<"u"&&(e.maxPriorityFeePerGas=De(t.maxPriorityFeePerGas)),typeof t.nonce<"u"&&(e.nonce=De(t.nonce)),typeof t.to<"u"&&(e.to=t.to),typeof t.type<"u"&&(e.type=KR[t.type]),typeof t.value<"u"&&(e.value=De(t.value)),e}function JR(t){return t.map(e=>({address:e.address,r:e.r?De(BigInt(e.r)):e.r,s:e.s?De(BigInt(e.s)):e.s,chainId:De(e.chainId),nonce:De(e.nonce),...typeof e.yParity<"u"?{yParity:De(e.yParity)}:{},...typeof e.v<"u"&&typeof e.yParity>"u"?{v:De(e.v)}:{}}))}function nb(t){if(!(!t||t.length===0))return t.reduce((e,{slot:n,value:r})=>{if(n.length!==66)throw new Hw({size:n.length,targetSize:66,type:"hex"});if(r.length!==66)throw new Hw({size:r.length,targetSize:66,type:"hex"});return e[n]=r,e},{})}function YR(t){const{balance:e,nonce:n,state:r,stateDiff:s,code:i}=t,o={};if(i!==void 0&&(o.code=i),e!==void 0&&(o.balance=De(e)),n!==void 0&&(o.nonce=De(n)),r!==void 0&&(o.state=nb(r)),s!==void 0){if(o.state)throw new CR;o.stateDiff=nb(s)}return o}function pI(t){if(!t)return;const e={};for(const{address:n,...r}of t){if(!_s(n,{strict:!1}))throw new Yo({address:n});if(e[n])throw new AR({address:n});e[n]=YR(r)}return e}const ZR=2n**256n-1n;function Pf(t){const{account:e,gasPrice:n,maxFeePerGas:r,maxPriorityFeePerGas:s,to:i}=t,o=e?Ps(e):void 0;if(o&&!_s(o.address))throw new Yo({address:o.address});if(i&&!_s(i))throw new Yo({address:i});if(typeof n<"u"&&(typeof r<"u"||typeof s<"u"))throw new _R;if(r&&r>ZR)throw new Th({maxFeePerGas:r});if(s&&r&&s>r)throw new Ph({maxFeePerGas:r,maxPriorityFeePerGas:s})}class QR extends G{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class dy extends G{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class XR extends G{constructor({maxPriorityFeePerGas:e}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${qn(e)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class gI extends G{constructor({blockHash:e,blockNumber:n}){let r="Block";e&&(r=`Block at hash "${e}"`),n&&(r=`Block at number "${n}"`),super(`${r} could not be found.`,{name:"BlockNotFoundError"})}}const mI={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function yI(t){const e={...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,chainId:t.chainId?Ko(t.chainId):void 0,gas:t.gas?BigInt(t.gas):void 0,gasPrice:t.gasPrice?BigInt(t.gasPrice):void 0,maxFeePerBlobGas:t.maxFeePerBlobGas?BigInt(t.maxFeePerBlobGas):void 0,maxFeePerGas:t.maxFeePerGas?BigInt(t.maxFeePerGas):void 0,maxPriorityFeePerGas:t.maxPriorityFeePerGas?BigInt(t.maxPriorityFeePerGas):void 0,nonce:t.nonce?Ko(t.nonce):void 0,to:t.to?t.to:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,type:t.type?mI[t.type]:void 0,typeHex:t.type?t.type:void 0,value:t.value?BigInt(t.value):void 0,v:t.v?BigInt(t.v):void 0};return t.authorizationList&&(e.authorizationList=e3(t.authorizationList)),e.yParity=(()=>{if(t.yParity)return Number(t.yParity);if(typeof e.v=="bigint"){if(e.v===0n||e.v===27n)return 0;if(e.v===1n||e.v===28n)return 1;if(e.v>=35n)return e.v%2n===0n?1:0}})(),e.type==="legacy"&&(delete e.accessList,delete e.maxFeePerBlobGas,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas,delete e.yParity),e.type==="eip2930"&&(delete e.maxFeePerBlobGas,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas),e.type==="eip1559"&&delete e.maxFeePerBlobGas,e}function e3(t){return t.map(e=>({address:e.address,chainId:Number(e.chainId),nonce:Number(e.nonce),r:e.r,s:e.s,yParity:Number(e.yParity)}))}function t3(t){const e=(t.transactions??[]).map(n=>typeof n=="string"?n:yI(n));return{...t,baseFeePerGas:t.baseFeePerGas?BigInt(t.baseFeePerGas):null,blobGasUsed:t.blobGasUsed?BigInt(t.blobGasUsed):void 0,difficulty:t.difficulty?BigInt(t.difficulty):void 0,excessBlobGas:t.excessBlobGas?BigInt(t.excessBlobGas):void 0,gasLimit:t.gasLimit?BigInt(t.gasLimit):void 0,gasUsed:t.gasUsed?BigInt(t.gasUsed):void 0,hash:t.hash?t.hash:null,logsBloom:t.logsBloom?t.logsBloom:null,nonce:t.nonce?t.nonce:null,number:t.number?BigInt(t.number):null,size:t.size?BigInt(t.size):void 0,timestamp:t.timestamp?BigInt(t.timestamp):void 0,transactions:e,totalDifficulty:t.totalDifficulty?BigInt(t.totalDifficulty):null}}async function du(t,{blockHash:e,blockNumber:n,blockTag:r=t.experimental_blockTag??"latest",includeTransactions:s}={}){const i=s??!1,o=n!==void 0?De(n):void 0;let a=null;if(e?a=await t.request({method:"eth_getBlockByHash",params:[e,i]},{dedupe:!0}):a=await t.request({method:"eth_getBlockByNumber",params:[o||r,i]},{dedupe:!!o}),!a)throw new gI({blockHash:e,blockNumber:n});return(t.chain?.formatters?.block?.format||t3)(a)}async function wI(t){const e=await t.request({method:"eth_gasPrice"});return BigInt(e)}async function gte(t,e){return bI(t,e)}async function bI(t,e){const{block:n,chain:r=t.chain,request:s}=e||{};try{const i=r?.fees?.maxPriorityFeePerGas??r?.fees?.defaultPriorityFee;if(typeof i=="function"){const a=n||await mt(t,du,"getBlock")({}),c=await i({block:a,client:t,request:s});if(c===null)throw new Error;return c}if(typeof i<"u")return i;const o=await t.request({method:"eth_maxPriorityFeePerGas"});return fc(o)}catch{const[i,o]=await Promise.all([n?Promise.resolve(n):mt(t,du,"getBlock")({}),mt(t,wI,"getGasPrice")({})]);if(typeof i.baseFeePerGas!="bigint")throw new dy;const a=o-i.baseFeePerGas;return a<0n?0n:a}}async function mte(t,e){return bm(t,e)}async function bm(t,e){const{block:n,chain:r=t.chain,request:s,type:i="eip1559"}=e||{},o=await(async()=>typeof r?.fees?.baseFeeMultiplier=="function"?r.fees.baseFeeMultiplier({block:n,client:t,request:s}):r?.fees?.baseFeeMultiplier??1.2)();if(o<1)throw new QR;const c=10**(o.toString().split(".")[1]?.length??0),l=h=>h*BigInt(Math.ceil(o*c))/BigInt(c),u=n||await mt(t,du,"getBlock")({});if(typeof r?.fees?.estimateFeesPerGas=="function"){const h=await r.fees.estimateFeesPerGas({block:n,client:t,multiply:l,request:s,type:i});if(h!==null)return h}if(i==="eip1559"){if(typeof u.baseFeePerGas!="bigint")throw new dy;const h=typeof s?.maxPriorityFeePerGas=="bigint"?s.maxPriorityFeePerGas:await bI(t,{block:u,chain:r,request:s}),f=l(u.baseFeePerGas);return{maxFeePerGas:s?.maxFeePerGas??f+h,maxPriorityFeePerGas:h}}return{gasPrice:s?.gasPrice??l(await mt(t,wI,"getGasPrice")({}))}}async function n3(t,{address:e,blockTag:n="latest",blockNumber:r}){const s=await t.request({method:"eth_getTransactionCount",params:[e,typeof r=="bigint"?De(r):n]},{dedupe:!!r});return Ko(s)}function EI(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(i=>Is(i)):t.blobs,s=[];for(const i of r)s.push(Uint8Array.from(e.blobToKzgCommitment(i)));return n==="bytes"?s:s.map(i=>Vn(i))}function vI(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(o=>Is(o)):t.blobs,s=typeof t.commitments[0]=="string"?t.commitments.map(o=>Is(o)):t.commitments,i=[];for(let o=0;o<r.length;o++){const a=r[o],c=s[o];i.push(Uint8Array.from(e.computeBlobKzgProof(a,c)))}return n==="bytes"?i:i.map(o=>Vn(o))}function r3(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function s3(t,e,n){return t&e^~t&n}function i3(t,e,n){return t&e^t&n^e&n}class o3 extends GC{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Cp(this.buffer)}update(e){Nh(this),e=Y0(e),Jo(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Cp(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Nh(this),WC(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Wl(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;r3(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Cp(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const wi=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),a3=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),bi=new Uint32Array(64);let c3=class extends o3{constructor(e=32){super(64,e,8,!1),this.A=wi[0]|0,this.B=wi[1]|0,this.C=wi[2]|0,this.D=wi[3]|0,this.E=wi[4]|0,this.F=wi[5]|0,this.G=wi[6]|0,this.H=wi[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)bi[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=bi[d-15],f=bi[d-2],p=ns(h,7)^ns(h,18)^h>>>3,g=ns(f,17)^ns(f,19)^f>>>10;bi[d]=g+bi[d-7]+p+bi[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=ns(a,6)^ns(a,11)^ns(a,25),f=u+h+s3(a,c,l)+a3[d]+bi[d]|0,g=(ns(r,2)^ns(r,13)^ns(r,22))+i3(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Wl(bi)}destroy(){this.set(0,0,0,0,0,0,0,0),Wl(this.buffer)}};const l3=KC(()=>new c3),u3=l3;function d3(t,e){return u3(eo(t,{strict:!1})?Cf(t):t)}function h3(t){const{commitment:e,version:n=1}=t,r=t.to??(typeof e=="string"?"hex":"bytes"),s=d3(e);return s.set([n],0),r==="bytes"?s:Vn(s)}function f3(t){const{commitments:e,version:n}=t,r=t.to,s=[];for(const i of e)s.push(h3({commitment:i,to:r,version:n}));return s}const rb=6,AI=32,hy=4096,CI=AI*hy,sb=CI*rb-1-1*hy*rb;class p3 extends G{constructor({maxSize:e,size:n}){super("Blob size is too large.",{metaMessages:[`Max: ${e} bytes`,`Given: ${n} bytes`],name:"BlobSizeTooLargeError"})}}class g3 extends G{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}function m3(t){const e=typeof t.data=="string"?Is(t.data):t.data,n=Ft(e);if(!n)throw new g3;if(n>sb)throw new p3({maxSize:sb,size:n});const r=[];let s=!0,i=0;for(;s;){const o=ry(new Uint8Array(CI));let a=0;for(;a<hy;){const c=e.slice(i,i+(AI-1));if(o.pushByte(0),o.pushBytes(c),c.length<31){o.pushByte(128),s=!1;break}a++,i+=31}r.push(o)}return r.map(o=>Vn(o.bytes))}function y3(t){const{data:e,kzg:n,to:r}=t,s=t.blobs??m3({data:e}),i=t.commitments??EI({blobs:s,kzg:n,to:r}),o=t.proofs??vI({blobs:s,commitments:i,kzg:n,to:r}),a=[];for(let c=0;c<s.length;c++)a.push({blob:s[c],commitment:i[c],proof:o[c]});return a}function w3(t){if(t.type)return t.type;if(typeof t.authorizationList<"u")return"eip7702";if(typeof t.blobs<"u"||typeof t.blobVersionedHashes<"u"||typeof t.maxFeePerBlobGas<"u"||typeof t.sidecars<"u")return"eip4844";if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")return"eip1559";if(typeof t.gasPrice<"u")return typeof t.accessList<"u"?"eip2930":"legacy";throw new NR({transaction:t})}async function II(t){const e=await t.request({method:"eth_chainId"},{dedupe:!0});return Ko(e)}const _I=["blobVersionedHashes","chainId","fees","gas","nonce","type"],ib=new Map;async function fy(t,e){const{account:n=t.account,blobs:r,chain:s,gas:i,kzg:o,nonce:a,nonceManager:c,parameters:l=_I,type:u}=e,d=n&&Ps(n),h={...e,...d?{from:d?.address}:{}};let f;async function p(){return f||(f=await mt(t,du,"getBlock")({blockTag:"latest"}),f)}let g;async function m(){return g||(s?s.id:typeof e.chainId<"u"?e.chainId:(g=await mt(t,II,"getChainId")({}),g))}if(l.includes("nonce")&&typeof a>"u"&&d)if(c){const y=await m();h.nonce=await c.consume({address:d.address,chainId:y,client:t})}else h.nonce=await mt(t,n3,"getTransactionCount")({address:d.address,blockTag:"pending"});if((l.includes("blobVersionedHashes")||l.includes("sidecars"))&&r&&o){const y=EI({blobs:r,kzg:o});if(l.includes("blobVersionedHashes")){const v=f3({commitments:y,to:"hex"});h.blobVersionedHashes=v}if(l.includes("sidecars")){const v=vI({blobs:r,commitments:y,kzg:o}),w=y3({blobs:r,commitments:y,proofs:v,to:"hex"});h.sidecars=w}}if(l.includes("chainId")&&(h.chainId=await m()),(l.includes("fees")||l.includes("type"))&&typeof u>"u")try{h.type=w3(h)}catch{let y=ib.get(t.uid);typeof y>"u"&&(y=typeof(await p())?.baseFeePerGas=="bigint",ib.set(t.uid,y)),h.type=y?"eip1559":"legacy"}if(l.includes("fees"))if(h.type!=="legacy"&&h.type!=="eip2930"){if(typeof h.maxFeePerGas>"u"||typeof h.maxPriorityFeePerGas>"u"){const y=await p(),{maxFeePerGas:v,maxPriorityFeePerGas:w}=await bm(t,{block:y,chain:s,request:h});if(typeof e.maxPriorityFeePerGas>"u"&&e.maxFeePerGas&&e.maxFeePerGas<w)throw new XR({maxPriorityFeePerGas:w});h.maxPriorityFeePerGas=w,h.maxFeePerGas=v}}else{if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")throw new dy;if(typeof e.gasPrice>"u"){const y=await p(),{gasPrice:v}=await bm(t,{block:y,chain:s,request:h,type:"legacy"});h.gasPrice=v}}return l.includes("gas")&&typeof i>"u"&&(h.gas=await mt(t,SI,"estimateGas")({...h,account:d&&{address:d.address,type:"json-rpc"}})),Pf(h),delete h.parameters,h}async function NI(t,{address:e,blockNumber:n,blockTag:r=t.experimental_blockTag??"latest"}){const s=typeof n=="bigint"?De(n):void 0,i=await t.request({method:"eth_getBalance",params:[e,s||r]});return BigInt(i)}async function SI(t,e){const{account:n=t.account}=e,r=n?Ps(n):void 0;try{let P=function(M){const{block:$,request:A,rpcStateOverride:_}=M;return t.request({method:"eth_estimateGas",params:_?[A,$??t.experimental_blockTag??"latest",_]:$?[A,$]:[A]})};const{accessList:s,authorizationList:i,blobs:o,blobVersionedHashes:a,blockNumber:c,blockTag:l,data:u,gas:d,gasPrice:h,maxFeePerBlobGas:f,maxFeePerGas:p,maxPriorityFeePerGas:g,nonce:m,value:y,stateOverride:v,...w}=await fy(t,{...e,parameters:r?.type==="local"?void 0:["blobVersionedHashes"]}),b=(typeof c=="bigint"?De(c):void 0)||l,E=pI(v),S=await(async()=>{if(w.to)return w.to;if(i&&i.length>0)return await fI({authorization:i[0]}).catch(()=>{throw new G("`to` is required. Could not infer from `authorizationList`")})})();Pf(e);const x=t.chain?.formatters?.transactionRequest?.format,O=(x||uy)({...ly(w,{format:x}),from:r?.address,accessList:s,authorizationList:i,blobs:o,blobVersionedHashes:a,data:u,gas:d,gasPrice:h,maxFeePerBlobGas:f,maxFeePerGas:p,maxPriorityFeePerGas:g,nonce:m,to:S,value:y});let k=BigInt(await P({block:b,request:O,rpcStateOverride:E}));if(i){const M=await NI(t,{address:O.from}),$=await Promise.all(i.map(async A=>{const{address:_}=A,R=await P({block:b,request:{authorizationList:void 0,data:u,from:r?.address,to:_,value:De(M)},rpcStateOverride:E}).catch(()=>100000n);return 2n*BigInt(R)}));k+=$.reduce((A,_)=>A+_,0n)}return k}catch(s){throw GR(s,{...e,account:r,chain:t.chain})}}function b3(t,e){if(!_s(t,{strict:!1}))throw new Yo({address:t});if(!_s(e,{strict:!1}))throw new Yo({address:e});return t.toLowerCase()===e.toLowerCase()}const ob="/docs/contract/decodeEventLog";function E3(t){const{abi:e,data:n,strict:r,topics:s}=t,i=r??!0,[o,...a]=s;if(!o)throw new XP({docsPath:ob});const c=e.find(g=>g.type==="event"&&o===Z0(Xi(g)));if(!(c&&"name"in c)||c.type!=="event")throw new $C(o,{docsPath:ob});const{name:l,inputs:u}=c,d=u?.some(g=>!("name"in g&&g.name)),h=d?[]:{},f=u.map((g,m)=>[g,m]).filter(([g])=>"indexed"in g&&g.indexed);for(let g=0;g<f.length;g++){const[m,y]=f[g],v=a[g];if(!v)throw new LC({abiItem:c,param:m});h[d?y:m.name||y]=v3({param:m,value:v})}const p=u.filter(g=>!("indexed"in g&&g.indexed));if(p.length>0){if(n&&n!=="0x")try{const g=xf(p,n);if(g)if(d)for(let m=0;m<u.length;m++)h[m]=h[m]??g.shift();else for(let m=0;m<p.length;m++)h[p[m].name]=g[m]}catch(g){if(i)throw g instanceof UC||g instanceof oI?new cm({abiItem:c,data:n,params:p,size:Ft(n)}):g}else if(i)throw new cm({abiItem:c,data:"0x",params:p,size:0})}return{eventName:l,args:Object.values(h).length>0?h:void 0}}function v3({param:t,value:e}){return t.type==="string"||t.type==="bytes"||t.type==="tuple"||t.type.match(/^(.*)\[(\d+)?\]$/)?e:(xf([t],e)||[])[0]}function A3(t){const{abi:e,args:n,logs:r,strict:s=!0}=t,i=(()=>{if(t.eventName)return Array.isArray(t.eventName)?t.eventName:[t.eventName]})();return r.map(o=>{try{const a=e.find(l=>l.type==="event"&&o.topics[0]===Z0(l));if(!a)return null;const c=E3({...o,abi:[a],strict:s});return i&&!i.includes(c.eventName)||!C3({args:c.args,inputs:a.inputs,matchArgs:n})?null:{...c,...o}}catch(a){let c,l;if(a instanceof $C)return null;if(a instanceof cm||a instanceof LC){if(s)return null;c=a.abiItem.name,l=a.abiItem.inputs?.some(u=>!("name"in u&&u.name))}return{...o,args:l?[]:{},eventName:c}}}).filter(Boolean)}function C3(t){const{args:e,inputs:n,matchArgs:r}=t;if(!r)return!0;if(!e)return!1;function s(i,o,a){try{return i.type==="address"?b3(o,a):i.type==="string"||i.type==="bytes"?Gu(Cf(o))===a:o===a}catch{return!1}}return Array.isArray(e)&&Array.isArray(r)?r.every((i,o)=>{if(i==null)return!0;const a=n[o];return a?(Array.isArray(i)?i:[i]).some(l=>s(a,l,e[o])):!1}):typeof e=="object"&&!Array.isArray(e)&&typeof r=="object"&&!Array.isArray(r)?Object.entries(r).every(([i,o])=>{if(o==null)return!0;const a=n.find(l=>l.name===i);return a?(Array.isArray(o)?o:[o]).some(l=>s(a,l,e[i])):!1}):!1}function xI(t,{args:e,eventName:n}={}){return{...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,logIndex:t.logIndex?Number(t.logIndex):null,transactionHash:t.transactionHash?t.transactionHash:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,...n?{args:e,eventName:n}:{}}}const Np="/docs/contract/decodeFunctionResult";function py(t){const{abi:e,args:n,functionName:r,data:s}=t;let i=e[0];if(r){const a=ny({abi:e,args:n,name:r});if(!a)throw new Ih(r,{docsPath:Np});i=a}if(i.type!=="function")throw new Ih(void 0,{docsPath:Np});if(!i.outputs)throw new eO(i.name,{docsPath:Np});const o=xf(i.outputs,s);if(o&&o.length>1)return o;if(o&&o.length===1)return o[0]}const I3="0.1.1";function _3(){return I3}let Bc=class Em extends Error{constructor(e,n={}){const r=(()=>{if(n.cause instanceof Em){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:n.cause?.message?n.cause.message:n.details})(),s=n.cause instanceof Em&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||s?["",r?`Details: ${r}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${_3()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return TI(this,e)}};function TI(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?TI(t.cause,e):e?null:t}const N3="#__bigint";function S3(t,e,n){return JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+N3:s,n)}function PI(t,e){if(wc(t)>e)throw new B3({givenSize:wc(t),maxSize:e})}function x3(t,e){if(typeof e=="number"&&e>0&&e>wc(t)-1)throw new kI({offset:e,position:"start",size:wc(t)})}function T3(t,e,n){if(typeof e=="number"&&typeof n=="number"&&wc(t)!==n-e)throw new kI({offset:n,position:"end",size:wc(t)})}function OI(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;const s=t.replace("0x","");if(s.length>r*2)throw new $3({size:Math.ceil(s.length/2),targetSize:r,type:"Hex"});return`0x${s[n==="right"?"padEnd":"padStart"](r*2,"0")}`}const P3=new TextEncoder,O3=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function R3(t,e={}){const{strict:n=!1}=e;if(!t)throw new ab(t);if(typeof t!="string")throw new ab(t);if(n&&!/^0x[0-9a-fA-F]*$/.test(t))throw new cb(t);if(!t.startsWith("0x"))throw new cb(t)}function wte(...t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function bte(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(PI(n,e.size),RI(n,e.size)):n}function k3(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=O3[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(PI(r,e.size),D3(r,e.size)):r}function Ws(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new U3({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?RI(c,r):c}function Ete(t,e={}){return k3(P3.encode(t),e)}function RI(t,e){return OI(t,{dir:"left",size:e})}function D3(t,e){return OI(t,{dir:"right",size:e})}function vte(t,e,n,r={}){const{strict:s}=r;x3(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return s&&T3(i,e,n),i}function wc(t){return Math.ceil((t.length-2)/2)}function Ate(t,e={}){const{strict:n=!1}=e;try{return R3(t,{strict:n}),!0}catch{return!1}}let U3=class extends Bc{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${n}\` to \`${e}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}};class ab extends Bc{constructor(e){super(`Value \`${typeof e=="object"?S3(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class cb extends Bc{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let B3=class extends Bc{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class kI extends Bc{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let $3=class extends Bc{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};function L3(t){return{address:t.address,amount:Ws(t.amount),index:Ws(t.index),validatorIndex:Ws(t.validatorIndex)}}function M3(t){return{...typeof t.baseFeePerGas=="bigint"&&{baseFeePerGas:Ws(t.baseFeePerGas)},...typeof t.blobBaseFee=="bigint"&&{blobBaseFee:Ws(t.blobBaseFee)},...typeof t.feeRecipient=="string"&&{feeRecipient:t.feeRecipient},...typeof t.gasLimit=="bigint"&&{gasLimit:Ws(t.gasLimit)},...typeof t.number=="bigint"&&{number:Ws(t.number)},...typeof t.prevRandao=="bigint"&&{prevRandao:Ws(t.prevRandao)},...typeof t.time=="bigint"&&{time:Ws(t.time)},...t.withdrawals&&{withdrawals:t.withdrawals.map(L3)}}}const vm=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"}],Nte=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],DI=[{inputs:[],name:"ResolverNotFound",type:"error"},{inputs:[],name:"ResolverWildcardNotSupported",type:"error"},{inputs:[],name:"ResolverNotContract",type:"error"},{inputs:[{name:"returnData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{components:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"errors",type:"tuple[]"}],name:"HttpError",type:"error"}],Ste=[...DI,{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]},{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],xte=[...DI,{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]},{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]}],Tte=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],Pte=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],Ote=[{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function",name:"isValidSig"}],Rte=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"function",name:"allowance",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],F3="0x82ad56cb",j3="0x608060405234801561001057600080fd5b5060405161018e38038061018e83398101604081905261002f91610124565b6000808351602085016000f59050803b61004857600080fd5b6000808351602085016000855af16040513d6000823e81610067573d81fd5b3d81f35b634e487b7160e01b600052604160045260246000fd5b600082601f83011261009257600080fd5b81516001600160401b038111156100ab576100ab61006b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156100d9576100d961006b565b6040528181528382016020018510156100f157600080fd5b60005b82811015610110576020818601810151838301820152016100f4565b506000918101602001919091529392505050565b6000806040838503121561013757600080fd5b82516001600160401b0381111561014d57600080fd5b61015985828601610081565b602085015190935090506001600160401b0381111561017757600080fd5b61018385828601610081565b915050925092905056fe",H3="0x608060405234801561001057600080fd5b506040516102c03803806102c083398101604081905261002f916101e6565b836001600160a01b03163b6000036100e457600080836001600160a01b03168360405161005c9190610270565b6000604051808303816000865af19150503d8060008114610099576040519150601f19603f3d011682016040523d82523d6000602084013e61009e565b606091505b50915091508115806100b857506001600160a01b0386163b155b156100e1578060405163101bb98d60e01b81526004016100d8919061028c565b60405180910390fd5b50505b6000808451602086016000885af16040513d6000823e81610103573d81fd5b3d81f35b80516001600160a01b038116811461011e57600080fd5b919050565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561015457818101518382015260200161013c565b50506000910152565b600082601f83011261016e57600080fd5b81516001600160401b0381111561018757610187610123565b604051601f8201601f19908116603f011681016001600160401b03811182821017156101b5576101b5610123565b6040528181528382016020018510156101cd57600080fd5b6101de826020830160208701610139565b949350505050565b600080600080608085870312156101fc57600080fd5b61020585610107565b60208601519094506001600160401b0381111561022157600080fd5b61022d8782880161015d565b93505061023c60408601610107565b60608601519092506001600160401b0381111561025857600080fd5b6102648782880161015d565b91505092959194509250565b60008251610282818460208701610139565b9190910192915050565b60208152600082518060208401526102ab816040850160208701610139565b601f01601f1916919091016040019291505056fe",kte="0x608060405234801561001057600080fd5b5060405161069438038061069483398101604081905261002f9161051e565b600061003c848484610048565b9050806000526001601ff35b60007f64926492649264926492649264926492649264926492649264926492649264926100748361040c565b036101e7576000606080848060200190518101906100929190610577565b60405192955090935091506000906001600160a01b038516906100b69085906105dd565b6000604051808303816000865af19150503d80600081146100f3576040519150601f19603f3d011682016040523d82523d6000602084013e6100f8565b606091505b50509050876001600160a01b03163b60000361016057806101605760405162461bcd60e51b815260206004820152601e60248201527f5369676e617475726556616c696461746f723a206465706c6f796d656e74000060448201526064015b60405180910390fd5b604051630b135d3f60e11b808252906001600160a01b038a1690631626ba7e90610190908b9087906004016105f9565b602060405180830381865afa1580156101ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101d19190610633565b6001600160e01b03191614945050505050610405565b6001600160a01b0384163b1561027a57604051630b135d3f60e11b808252906001600160a01b03861690631626ba7e9061022790879087906004016105f9565b602060405180830381865afa158015610244573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102689190610633565b6001600160e01b031916149050610405565b81516041146102df5760405162461bcd60e51b815260206004820152603a602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e6174757265206c656e6774680000000000006064820152608401610157565b6102e7610425565b5060208201516040808401518451859392600091859190811061030c5761030c61065d565b016020015160f81c9050601b811480159061032b57508060ff16601c14155b1561038c5760405162461bcd60e51b815260206004820152603b602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e617475726520762076616c756500000000006064820152608401610157565b60408051600081526020810180835289905260ff83169181019190915260608101849052608081018390526001600160a01b0389169060019060a0016020604051602081039080840390855afa1580156103ea573d6000803e3d6000fd5b505050602060405103516001600160a01b0316149450505050505b9392505050565b600060208251101561041d57600080fd5b508051015190565b60405180606001604052806003906020820280368337509192915050565b6001600160a01b038116811461045857600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561048c578181015183820152602001610474565b50506000910152565b600082601f8301126104a657600080fd5b81516001600160401b038111156104bf576104bf61045b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156104ed576104ed61045b565b60405281815283820160200185101561050557600080fd5b610516826020830160208701610471565b949350505050565b60008060006060848603121561053357600080fd5b835161053e81610443565b6020850151604086015191945092506001600160401b0381111561056157600080fd5b61056d86828701610495565b9150509250925092565b60008060006060848603121561058c57600080fd5b835161059781610443565b60208501519093506001600160401b038111156105b357600080fd5b6105bf86828701610495565b604086015190935090506001600160401b0381111561056157600080fd5b600082516105ef818460208701610471565b9190910192915050565b828152604060208201526000825180604084015261061e816060850160208701610471565b601f01601f1916919091016060019392505050565b60006020828403121561064557600080fd5b81516001600160e01b03198116811461040557600080fd5b634e487b7160e01b600052603260045260246000fdfe5369676e617475726556616c696461746f72237265636f7665725369676e6572";class Am extends G{constructor({blockNumber:e,chain:n,contract:r}){super(`Chain "${n.name}" does not support contract "${r.name}".`,{metaMessages:["This could be due to any of the following:",...e&&r.blockCreated&&r.blockCreated>e?[`- The contract "${r.name}" was not deployed until block ${r.blockCreated} (current block ${e}).`]:[`- The chain does not have the contract "${r.name}" configured.`]],name:"ChainDoesNotSupportContract"})}}class z3 extends G{constructor({chain:e,currentChainId:n}){super(`The current chain of the wallet (id: ${n}) does not match the target chain for the transaction (id: ${e.id}  ${e.name}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e.id}  ${e.name}`],name:"ChainMismatchError"})}}class q3 extends G{constructor(){super(["No chain was provided to the request.","Please provide a chain with the `chain` argument on the Action, or by supplying a `chain` to WalletClient."].join(`
`),{name:"ChainNotFoundError"})}}class UI extends G{constructor(){super("No chain was provided to the Client.",{name:"ClientChainNotConfiguredError"})}}const Sp="/docs/contract/encodeDeployData";function BI(t){const{abi:e,args:n,bytecode:r}=t;if(!n||n.length===0)return r;const s=e.find(o=>"type"in o&&o.type==="constructor");if(!s)throw new JP({docsPath:Sp});if(!("inputs"in s))throw new jw({docsPath:Sp});if(!s.inputs||s.inputs.length===0)throw new jw({docsPath:Sp});const i=sI(s.inputs,n);return Nf([r,i])}function $I({blockNumber:t,chain:e,contract:n}){const r=e?.contracts?.[n];if(!r)throw new Am({chain:e,contract:{name:n}});if(t&&r.blockCreated&&r.blockCreated>t)throw new Am({blockNumber:t,chain:e,contract:{name:n,blockCreated:r.blockCreated}});return r.address}function W3(t,{docsPath:e,...n}){const r=(()=>{const s=cy(t,n);return s instanceof Tf?t:s})();return new PR(r,{docsPath:e,...n})}function LI(){let t=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{t=r,e=s}),resolve:t,reject:e}}const xp=new Map;function MI({fn:t,id:e,shouldSplitBatch:n,wait:r=0,sort:s}){const i=async()=>{const u=c();o();const d=u.map(({args:h})=>h);d.length!==0&&t(d).then(h=>{s&&Array.isArray(h)&&h.sort(s);for(let f=0;f<u.length;f++){const{resolve:p}=u[f];p?.([h[f],h])}}).catch(h=>{for(let f=0;f<u.length;f++){const{reject:p}=u[f];p?.(h)}})},o=()=>xp.delete(e),a=()=>c().map(({args:u})=>u),c=()=>xp.get(e)||[],l=u=>xp.set(e,[...c(),u]);return{flush:o,async schedule(u){const{promise:d,resolve:h,reject:f}=LI();return n?.([...a(),u])&&i(),c().length>0?(l({args:u,resolve:h,reject:f}),d):(l({args:u,resolve:h,reject:f}),setTimeout(i,r),d)}}}async function FI(t,e){const{account:n=t.account,authorizationList:r,batch:s=!!t.batch?.multicall,blockNumber:i,blockTag:o=t.experimental_blockTag??"latest",accessList:a,blobs:c,blockOverrides:l,code:u,data:d,factory:h,factoryData:f,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:y,maxPriorityFeePerGas:v,nonce:w,to:N,value:b,stateOverride:E,...S}=e,x=n?Ps(n):void 0;if(u&&(h||f))throw new G("Cannot provide both `code` & `factory`/`factoryData` as parameters.");if(u&&N)throw new G("Cannot provide both `code` & `to` as parameters.");const I=u&&d,O=h&&f&&N&&d,P=I||O,k=I?K3({code:u,data:d}):O?J3({data:d,factory:h,factoryData:f,to:N}):d;try{Pf(e);const $=(typeof i=="bigint"?De(i):void 0)||o,A=l?M3(l):void 0,_=pI(E),R=t.chain?.formatters?.transactionRequest?.format,U=(R||uy)({...ly(S,{format:R}),from:x?.address,accessList:a,authorizationList:r,blobs:c,data:k,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:y,maxPriorityFeePerGas:v,nonce:w,to:P?void 0:N,value:b});if(s&&V3({request:U})&&!_&&!A)try{return await G3(t,{...U,blockNumber:i,blockTag:o})}catch(q){if(!(q instanceof UI)&&!(q instanceof Am))throw q}const L=(()=>{const q=[U,$];return _&&A?[...q,_,A]:_?[...q,_]:A?[...q,{},A]:q})(),j=await t.request({method:"eth_call",params:L});return j==="0x"?{data:void 0}:{data:j}}catch(M){const $=Y3(M),{offchainLookup:A,offchainLookupSignature:_}=await nn(async()=>{const{offchainLookup:R,offchainLookupSignature:B}=await import("./ccip-C898IB_F.js");return{offchainLookup:R,offchainLookupSignature:B}},__vite__mapDeps([0,1]));if(t.ccipRead!==!1&&$?.slice(0,10)===_&&N)return{data:await A(t,{data:$,to:N})};throw P&&$?.slice(0,10)==="0x101bb98d"?new kR({factory:h}):W3(M,{...e,account:x,chain:t.chain})}}function V3({request:t}){const{data:e,to:n,...r}=t;return!(!e||e.startsWith(F3)||!n||Object.values(r).filter(s=>typeof s<"u").length>0)}async function G3(t,e){const{batchSize:n=1024,wait:r=0}=typeof t.batch?.multicall=="object"?t.batch.multicall:{},{blockNumber:s,blockTag:i=t.experimental_blockTag??"latest",data:o,multicallAddress:a,to:c}=e;let l=a;if(!l){if(!t.chain)throw new UI;l=$I({blockNumber:s,chain:t.chain,contract:"multicall3"})}const d=(typeof s=="bigint"?De(s):void 0)||i,{schedule:h}=MI({id:`${t.uid}.${d}`,wait:r,shouldSplitBatch(g){return g.reduce((y,{data:v})=>y+(v.length-2),0)>n*2},fn:async g=>{const m=g.map(w=>({allowFailure:!0,callData:w.data,target:w.to})),y=Sf({abi:vm,args:[m],functionName:"aggregate3"}),v=await t.request({method:"eth_call",params:[{data:y,to:l},d]});return py({abi:vm,args:[m],functionName:"aggregate3",data:v||"0x"})}}),[{returnData:f,success:p}]=await h({data:o,to:c});if(!p)throw new oy({data:f});return f==="0x"?{data:void 0}:{data:f}}function K3(t){const{code:e,data:n}=t;return BI({abi:RC(["constructor(bytes, bytes)"]),bytecode:j3,args:[e,n]})}function J3(t){const{data:e,factory:n,factoryData:r,to:s}=t;return BI({abi:RC(["constructor(address, bytes, address, bytes)"]),bytecode:H3,args:[s,e,n,r]})}function Y3(t){if(!(t instanceof G))return;const e=t.walk();return typeof e?.data=="object"?e.data?.data:e.data}async function jI(t,e){const{abi:n,address:r,args:s,functionName:i,...o}=e,a=Sf({abi:n,args:s,functionName:i});try{const{data:c}=await mt(t,FI,"call")({...o,data:a,to:r});return py({abi:n,args:s,functionName:i,data:c||"0x"})}catch(c){throw xh(c,{abi:n,address:r,args:s,docsPath:"/docs/contract/readContract",functionName:i})}}const Tp=new Map,lb=new Map;let Z3=0;function Oh(t,e,n){const r=++Z3,s=()=>Tp.get(t)||[],i=()=>{const u=s();Tp.set(t,u.filter(d=>d.id!==r))},o=()=>{const u=s();if(!u.some(h=>h.id===r))return;const d=lb.get(t);if(u.length===1&&d){const h=d();h instanceof Promise&&h.catch(()=>{})}i()},a=s();if(Tp.set(t,[...a,{id:r,fns:e}]),a&&a.length>0)return o;const c={};for(const u in e)c[u]=(...d)=>{const h=s();if(h.length!==0)for(const f of h)f.fns[u]?.(...d)};const l=n(c);return typeof l=="function"&&lb.set(t,l),o}async function Rh(t){return new Promise(e=>setTimeout(e,t))}function HI(t,{emitOnBegin:e,initialWaitTime:n,interval:r}){let s=!0;const i=()=>s=!1;return(async()=>{let a;e&&(a=await t({unpoll:i}));const c=await n?.(a)??r;await Rh(c);const l=async()=>{s&&(await t({unpoll:i}),await Rh(r),l())};l()})(),i}const Q3=new Map,X3=new Map;function ek(t){const e=(s,i)=>({clear:()=>i.delete(s),get:()=>i.get(s),set:o=>i.set(s,o)}),n=e(t,Q3),r=e(t,X3);return{clear:()=>{n.clear(),r.clear()},promise:n,response:r}}async function tk(t,{cacheKey:e,cacheTime:n=Number.POSITIVE_INFINITY}){const r=ek(e),s=r.response.get();if(s&&n>0&&new Date().getTime()-s.created.getTime()<n)return s.data;let i=r.promise.get();i||(i=t(),r.promise.set(i));try{const o=await i;return r.response.set({created:new Date,data:o}),o}finally{r.promise.clear()}}const nk=t=>`blockNumber.${t}`;async function rk(t,{cacheTime:e=t.cacheTime}={}){const n=await tk(()=>t.request({method:"eth_blockNumber"}),{cacheKey:nk(t.uid),cacheTime:e});return BigInt(n)}async function sk(t,{filter:e}){const n="strict"in e&&e.strict,r=await e.request({method:"eth_getFilterChanges",params:[e.id]});if(typeof r[0]=="string")return r;const s=r.map(i=>xI(i));return!("abi"in e)||!e.abi?s:A3({abi:e.abi,logs:s,strict:n})}async function ik(t,{filter:e}){return e.request({method:"eth_uninstallFilter",params:[e.id]})}class gy extends G{constructor({docsPath:e}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:e,docsSlug:"account",name:"AccountNotFoundError"})}}class Pp extends G{constructor({docsPath:e,metaMessages:n,type:r}){super(`Account type "${r}" is not supported.`,{docsPath:e,metaMessages:n,name:"AccountTypeNotSupportedError"})}}function ok({chain:t,currentChainId:e}){if(!t)throw new q3;if(e!==t.id)throw new z3({chain:t,currentChainId:e})}function ak(t,{docsPath:e,...n}){const r=(()=>{const s=cy(t,n);return s instanceof Tf?t:s})();return new SR(r,{docsPath:e,...n})}async function ck(t,{serializedTransaction:e}){return t.request({method:"eth_sendRawTransaction",params:[e]},{retryCount:0})}const Op=new If(128);async function zI(t,e){const{account:n=t.account,chain:r=t.chain,accessList:s,authorizationList:i,blobs:o,data:a,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,type:p,value:g,...m}=e;if(typeof n>"u")throw new gy({docsPath:"/docs/actions/wallet/sendTransaction"});const y=n?Ps(n):null;try{Pf(e);const v=await(async()=>{if(e.to)return e.to;if(e.to!==null&&i&&i.length>0)return await fI({authorization:i[0]}).catch(()=>{throw new G("`to` is required. Could not infer from `authorizationList`.")})})();if(y?.type==="json-rpc"||y===null){let w;r!==null&&(w=await mt(t,II,"getChainId")({}),ok({currentChainId:w,chain:r}));const N=t.chain?.formatters?.transactionRequest?.format,E=(N||uy)({...ly(m,{format:N}),accessList:s,authorizationList:i,blobs:o,chainId:w,data:a,from:y?.address,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,to:v,type:p,value:g}),S=Op.get(t.uid),x=S?"wallet_sendTransaction":"eth_sendTransaction";try{return await t.request({method:x,params:[E]},{retryCount:0})}catch(I){if(S===!1)throw I;const O=I;if(O.name==="InvalidInputRpcError"||O.name==="InvalidParamsRpcError"||O.name==="MethodNotFoundRpcError"||O.name==="MethodNotSupportedRpcError")return await t.request({method:"wallet_sendTransaction",params:[E]},{retryCount:0}).then(P=>(Op.set(t.uid,!0),P)).catch(P=>{const k=P;throw k.name==="MethodNotFoundRpcError"||k.name==="MethodNotSupportedRpcError"?(Op.set(t.uid,!1),O):k});throw O}}if(y?.type==="local"){const w=await mt(t,fy,"prepareTransactionRequest")({account:y,accessList:s,authorizationList:i,blobs:o,chain:r,data:a,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,nonceManager:y.nonceManager,parameters:[..._I,"sidecars"],type:p,value:g,...m,to:v}),N=r?.serializers?.transaction,b=await y.signTransaction(w,{serializer:N});return await mt(t,ck,"sendRawTransaction")({serializedTransaction:b})}throw y?.type==="smart"?new Pp({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new Pp({docsPath:"/docs/actions/wallet/sendTransaction",type:y?.type})}catch(v){throw v instanceof Pp?v:ak(v,{...e,account:y,chain:e.chain||void 0})}}async function lk(t,e){const{abi:n,account:r=t.account,address:s,args:i,dataSuffix:o,functionName:a,...c}=e;if(typeof r>"u")throw new gy({docsPath:"/docs/contract/writeContract"});const l=r?Ps(r):null,u=Sf({abi:n,args:i,functionName:a});try{return await mt(t,zI,"sendTransaction")({data:`${u}${o?o.replace("0x",""):""}`,to:s,account:l,...c})}catch(d){throw xh(d,{abi:n,address:s,args:i,docsPath:"/docs/contract/writeContract",functionName:a,sender:l?.address})}}function kh(t,{delay:e=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof e=="function"?e({count:a,error:l}):e;u&&await Rh(u),o({count:a+1})};try{const l=await t();s(l)}catch(l){if(a<n&&await r({count:a,error:l}))return c({error:l});i(l)}};o()})}const uk={"0x0":"reverted","0x1":"success"};function dk(t){const e={...t,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,contractAddress:t.contractAddress?t.contractAddress:null,cumulativeGasUsed:t.cumulativeGasUsed?BigInt(t.cumulativeGasUsed):null,effectiveGasPrice:t.effectiveGasPrice?BigInt(t.effectiveGasPrice):null,gasUsed:t.gasUsed?BigInt(t.gasUsed):null,logs:t.logs?t.logs.map(n=>xI(n)):null,to:t.to?t.to:null,transactionIndex:t.transactionIndex?Ko(t.transactionIndex):null,status:t.status?uk[t.status]:null,type:t.type?mI[t.type]||t.type:null};return t.blobGasPrice&&(e.blobGasPrice=BigInt(t.blobGasPrice)),t.blobGasUsed&&(e.blobGasUsed=BigInt(t.blobGasUsed)),e}const Cm=256;let Ed=Cm,vd;function qI(t=11){if(!vd||Ed+t>Cm*2){vd="",Ed=0;for(let e=0;e<Cm;e++)vd+=(256+Math.random()*256|0).toString(16).substring(1)}return vd.substring(Ed,Ed+++t)}function WI(t){const{batch:e,chain:n,ccipRead:r,key:s="base",name:i="Base Client",type:o="base"}=t,a=t.experimental_blockTag??(typeof n?.experimental_preconfirmationTime=="number"?"pending":void 0),c=n?.blockTime??12e3,l=Math.min(Math.max(Math.floor(c/2),500),4e3),u=t.pollingInterval??l,d=t.cacheTime??u,h=t.account?Ps(t.account):void 0,{config:f,request:p,value:g}=t.transport({chain:n,pollingInterval:u}),m={...f,...g},y={account:h,batch:e,cacheTime:d,ccipRead:r,chain:n,key:s,name:i,pollingInterval:u,request:p,transport:m,type:o,uid:qI(),...a?{experimental_blockTag:a}:{}};function v(w){return N=>{const b=N(w);for(const S in y)delete b[S];const E={...w,...b};return Object.assign(E,{extend:v(E)})}}return Object.assign(y,{extend:v(y)})}const Ad=new If(8192);function hk(t,{enabled:e=!0,id:n}){if(!e||!n)return t();if(Ad.get(n))return Ad.get(n);const r=t().finally(()=>Ad.delete(n));return Ad.set(n,r),r}function fk(t,e={}){return async(n,r={})=>{const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...r},{method:l}=n;if(i?.exclude?.includes(l))throw new To(new Error("method not supported"),{method:l});if(i?.include&&!i.include.includes(l))throw new To(new Error("method not supported"),{method:l});const u=s?Af(`${c}.${vr(n)}`):void 0;return hk(()=>kh(async()=>{try{return await t(n)}catch(d){const h=d;switch(h.code){case Gl.code:throw new Gl(h);case Kl.code:throw new Kl(h);case Jl.code:throw new Jl(h,{method:n.method});case Yl.code:throw new Yl(h);case Zo.code:throw new Zo(h);case Zl.code:throw new Zl(h);case Ql.code:throw new Ql(h);case Gi.code:throw new Gi(h);case mc.code:throw new mc(h);case To.code:throw new To(h,{method:n.method});case yc.code:throw new yc(h);case Xl.code:throw new Xl(h);case Lt.code:throw new Lt(h);case eu.code:throw new eu(h);case tu.code:throw new tu(h);case nu.code:throw new nu(h);case ru.code:throw new ru(h);case Ns.code:throw new Ns(h);case su.code:throw new su(h);case iu.code:throw new iu(h);case ou.code:throw new ou(h);case au.code:throw new au(h);case cu.code:throw new cu(h);case lu.code:throw new lu(h);case uu.code:throw new uu(h);case 5e3:throw new Lt(h);default:throw d instanceof G?d:new UR(h)}}},{delay:({count:d,error:h})=>{if(h&&h instanceof _l){const f=h?.headers?.get("Retry-After");if(f?.match(/\d/))return Number.parseInt(f)*1e3}return~~(1<<d)*o},retryCount:a,shouldRetry:({error:d})=>pk(d)}),{enabled:s,id:u})}}function pk(t){return"code"in t&&typeof t.code=="number"?t.code===-1||t.code===yc.code||t.code===Zo.code:t instanceof _l&&t.status?t.status===403||t.status===408||t.status===413||t.status===429||t.status===500||t.status===502||t.status===503||t.status===504:!0}function my({key:t,methods:e,name:n,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=qI();return{config:{key:t,methods:e,name:n,request:r,retryCount:s,retryDelay:i,timeout:o,type:a},request:fk(r,{methods:e,retryCount:s,retryDelay:i,uid:l}),value:c}}function gk(t,e={}){const{key:n="custom",methods:r,name:s="Custom Provider",retryDelay:i}=e;return({retryCount:o})=>my({key:n,methods:r,name:s,request:t.request.bind(t),retryCount:e.retryCount??o,retryDelay:i,type:"custom"})}function ub(t,e={}){const{key:n="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=mk,retryCount:o,retryDelay:a}=e;return({chain:c,pollingInterval:l=4e3,timeout:u,...d})=>{let h=t,f=()=>{};const p=my({key:n,name:r,async request({method:g,params:m}){let y;const v=async(w=0)=>{const N=h[w]({...d,chain:c,retryCount:0,timeout:u});try{const b=await N.request({method:g,params:m});return f({method:g,params:m,response:b,transport:N,status:"success"}),b}catch(b){if(f({error:b,method:g,params:m,transport:N,status:"error"}),i(b)||w===h.length-1||(y??=h.slice(w+1).some(E=>{const{include:S,exclude:x}=E({chain:c}).config.methods||{};return S?S.includes(g):x?!x.includes(g):!0}),!y))throw b;return v(w+1)}};return v()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>f=g,transports:h.map(g=>g({chain:c,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};yk({chain:c,interval:g.interval??l,onTransports:m=>h=m,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:h,weights:g.weights})}return p}}function mk(t){return!!("code"in t&&typeof t.code=="number"&&(t.code===mc.code||t.code===Lt.code||Po.nodeMessage.test(t.message)||t.code===5e3))}function yk({chain:t,interval:e=4e3,onTransports:n,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],d=async()=>{const h=await Promise.all(o.map(async g=>{const m=g({chain:t,retryCount:0,timeout:i}),y=Date.now();let v,w;try{await(r?r({transport:m}):m.request({method:"net_listening"})),w=1}catch{w=0}finally{v=Date.now()}return{latency:v-y,success:w}}));u.push(h),u.length>s&&u.shift();const f=Math.max(...u.map(g=>Math.max(...g.map(({latency:m})=>m)))),p=o.map((g,m)=>{const y=u.map(E=>E[m].latency),w=1-y.reduce((E,S)=>E+S,0)/y.length/f,N=u.map(E=>E[m].success),b=N.reduce((E,S)=>E+S,0)/N.length;return b===0?[0,m]:[l*w+c*b,m]}).sort((g,m)=>m[0]-g[0]);n(p.map(([,g])=>o[g])),await Rh(e),d()};d()}class wk extends G{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function VI(t,{errorInstance:e=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;n>0&&(o=setTimeout(()=>{r?a.abort():i(e)},n)),s(await t({signal:a?.signal||null}))}catch(a){a?.name==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function bk(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const db=bk();function Ek(t,e={}){return{async request(n){const{body:r,onRequest:s=e.onRequest,onResponse:i=e.onResponse,timeout:o=e.timeout??1e4}=n,a={...e.fetchOptions??{},...n.fetchOptions??{}},{headers:c,method:l,signal:u}=a;try{const d=await VI(async({signal:f})=>{const p={...a,body:Array.isArray(r)?vr(r.map(v=>({jsonrpc:"2.0",id:v.id??db.take(),...v}))):vr({jsonrpc:"2.0",id:r.id??db.take(),...r}),headers:{"Content-Type":"application/json",...c},method:l||"POST",signal:u||(o>0?f:null)},g=new Request(t,p),m=await s?.(g,p)??{...p,url:t};return await fetch(m.url??t,m)},{errorInstance:new Xw({body:r,url:t}),timeout:o,signal:!0});i&&await i(d);let h;if(d.headers.get("Content-Type")?.startsWith("application/json"))h=await d.json();else{h=await d.text();try{h=JSON.parse(h||"{}")}catch(f){if(d.ok)throw f;h={error:h}}}if(!d.ok)throw new _l({body:r,details:vr(h.error)||d.statusText,headers:d.headers,status:d.status,url:t});return h}catch(d){throw d instanceof _l||d instanceof Xw?d:new _l({body:r,cause:d,url:t})}}}}function Cd(t,e={}){const{batch:n,fetchOptions:r,key:s="http",methods:i,name:o="HTTP JSON-RPC",onFetchRequest:a,onFetchResponse:c,retryDelay:l,raw:u}=e;return({chain:d,retryCount:h,timeout:f})=>{const{batchSize:p=1e3,wait:g=0}=typeof n=="object"?n:{},m=e.retryCount??h,y=f??e.timeout??1e4,v=t||d?.rpcUrls.default.http[0];if(!v)throw new wk;const w=Ek(v,{fetchOptions:r,onRequest:a,onResponse:c,timeout:y});return my({key:s,methods:i,name:o,async request({method:N,params:b}){const E={method:N,params:b},{schedule:S}=MI({id:v,wait:g,shouldSplitBatch(P){return P.length>p},fn:P=>w.request({body:P}),sort:(P,k)=>P.id-k.id}),x=async P=>n?S(P):[await w.request({body:P})],[{error:I,result:O}]=await x(E);if(u)return{error:I,result:O};if(I)throw new ay({body:E,error:I,url:v});return O},retryCount:m,retryDelay:l,timeout:y,type:"http"},{fetchOptions:r,url:v})}}async function vk(t){const e=tR(t,{method:"eth_newPendingTransactionFilter"}),n=await t.request({method:"eth_newPendingTransactionFilter"});return{id:n,request:e(n),type:"transaction"}}function Ak(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}class Ck extends G{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function Ik(t,e){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(t))throw new Ck({value:t});let[n,r="0"]=t.split(".");const s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),e===0)Math.round(+`.${r}`)===1&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>e){const[i,o,a]=[r.slice(0,e-1),r.slice(e-1,e),r.slice(e)],c=Math.round(+`${o}.${a}`);c>9?r=`${BigInt(i)+BigInt(1)}0`.padStart(i.length+1,"0"):r=`${i}${c}`,r.length>e&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,e)}else r=r.padEnd(e,"0");return BigInt(`${s?"-":""}${n}${r}`)}async function GI(t,{blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i}){const o=r||"latest",a=n!==void 0?De(n):void 0;let c=null;if(s?c=await t.request({method:"eth_getTransactionByHash",params:[s]},{dedupe:!0}):e?c=await t.request({method:"eth_getTransactionByBlockHashAndIndex",params:[e,De(i)]},{dedupe:!0}):c=await t.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[a||o,De(i)]},{dedupe:!!a}),!c)throw new cI({blockHash:e,blockNumber:n,blockTag:o,hash:s,index:i});return(t.chain?.formatters?.transaction?.format||yI)(c)}async function Rp(t,{hash:e}){const n=await t.request({method:"eth_getTransactionReceipt",params:[e]},{dedupe:!0});if(!n)throw new lI({hash:e});return(t.chain?.formatters?.transactionReceipt?.format||dk)(n)}async function _k(t,e){const{account:n,allowFailure:r=!0,batchSize:s,blockNumber:i,blockTag:o,multicallAddress:a,stateOverride:c}=e,l=e.contracts,u=s??(typeof t.batch?.multicall=="object"&&t.batch.multicall.batchSize||1024);let d=a;if(!d){if(!t.chain)throw new Error("client chain not configured. multicallAddress is required.");d=$I({blockNumber:i,chain:t.chain,contract:"multicall3"})}const h=[[]];let f=0,p=0;for(let y=0;y<l.length;y++){const{abi:v,address:w,args:N,functionName:b}=l[y];try{const E=Sf({abi:v,args:N,functionName:b});p+=(E.length-2)/2,u>0&&p>u&&h[f].length>0&&(f++,p=(E.length-2)/2,h[f]=[]),h[f]=[...h[f],{allowFailure:!0,callData:E,target:w}]}catch(E){const S=xh(E,{abi:v,address:w,args:N,docsPath:"/docs/contract/multicall",functionName:b,sender:n});if(!r)throw S;h[f]=[...h[f],{allowFailure:!0,callData:"0x",target:w}]}}const g=await Promise.allSettled(h.map(y=>mt(t,jI,"readContract")({abi:vm,account:n,address:d,args:[y],blockNumber:i,blockTag:o,functionName:"aggregate3",stateOverride:c}))),m=[];for(let y=0;y<g.length;y++){const v=g[y];if(v.status==="rejected"){if(!r)throw v.reason;for(let N=0;N<h[y].length;N++)m.push({status:"failure",error:v.reason,result:void 0});continue}const w=v.value;for(let N=0;N<w.length;N++){const{returnData:b,success:E}=w[N],{callData:S}=h[y][N],{abi:x,address:I,functionName:O,args:P}=l[m.length];try{if(S==="0x")throw new vf;if(!E)throw new oy({data:b});const k=py({abi:x,args:P,data:b,functionName:O});m.push(r?{result:k,status:"success"}:k)}catch(k){const M=xh(k,{abi:x,address:I,args:P,docsPath:"/docs/contract/multicall",functionName:O});if(!r)throw M;m.push({error:M,result:void 0,status:"failure"})}}}if(m.length!==l.length)throw new G("multicall results mismatch");return m}function Nk(t,{emitOnBegin:e=!1,emitMissed:n=!1,onBlockNumber:r,onError:s,poll:i,pollingInterval:o=t.pollingInterval}){const a=typeof i<"u"?i:!(t.transport.type==="webSocket"||t.transport.type==="ipc"||t.transport.type==="fallback"&&(t.transport.transports[0].config.type==="webSocket"||t.transport.transports[0].config.type==="ipc"));let c;return a?(()=>{const d=vr(["watchBlockNumber",t.uid,e,n,o]);return Oh(d,{onBlockNumber:r,onError:s},h=>HI(async()=>{try{const f=await mt(t,rk,"getBlockNumber")({cacheTime:0});if(c){if(f===c)return;if(f-c>1&&n)for(let p=c+1n;p<f;p++)h.onBlockNumber(p,c),c=p}(!c||f>c)&&(h.onBlockNumber(f,c),c=f)}catch(f){h.onError?.(f)}},{emitOnBegin:e,interval:o}))})():(()=>{const d=vr(["watchBlockNumber",t.uid,e,n]);return Oh(d,{onBlockNumber:r,onError:s},h=>{let f=!0,p=()=>f=!1;return(async()=>{try{const g=(()=>{if(t.transport.type==="fallback"){const y=t.transport.transports.find(v=>v.config.type==="webSocket"||v.config.type==="ipc");return y?y.value:t.transport}return t.transport})(),{unsubscribe:m}=await g.subscribe({params:["newHeads"],onData(y){if(!f)return;const v=fc(y.result?.number);h.onBlockNumber(v,c),c=v},onError(y){h.onError?.(y)}});p=m,f||p()}catch(g){s?.(g)}})(),()=>p()})})()}async function Sk(t,e){const{checkReplacement:n=!0,confirmations:r=1,hash:s,onReplaced:i,retryCount:o=6,retryDelay:a=({count:b})=>~~(1<<b)*200,timeout:c=18e4}=e,l=vr(["waitForTransactionReceipt",t.uid,s]),u=e.pollingInterval?e.pollingInterval:t.chain?.experimental_preconfirmationTime?t.chain.experimental_preconfirmationTime:t.pollingInterval;let d,h,f,p=!1,g,m;const{promise:y,resolve:v,reject:w}=LI(),N=c?setTimeout(()=>{m(),g(),w(new xR({hash:s}))},c):void 0;return g=Oh(l,{onReplaced:i,resolve:v,reject:w},async b=>{if(f=await mt(t,Rp,"getTransactionReceipt")({hash:s}).catch(()=>{}),f&&r<=1){clearTimeout(N),b.resolve(f),g();return}m=mt(t,Nk,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:u,async onBlockNumber(E){const S=I=>{clearTimeout(N),m(),I(),g()};let x=E;if(!p)try{if(f){if(r>1&&(!f.blockNumber||x-f.blockNumber+1n<r))return;S(()=>b.resolve(f));return}if(n&&!d&&(p=!0,await kh(async()=>{d=await mt(t,GI,"getTransaction")({hash:s}),d.blockNumber&&(x=d.blockNumber)},{delay:a,retryCount:o}),p=!1),f=await mt(t,Rp,"getTransactionReceipt")({hash:s}),r>1&&(!f.blockNumber||x-f.blockNumber+1n<r))return;S(()=>b.resolve(f))}catch(I){if(I instanceof cI||I instanceof lI){if(!d){p=!1;return}try{h=d,p=!0;const O=await kh(()=>mt(t,du,"getBlock")({blockNumber:x,includeTransactions:!0}),{delay:a,retryCount:o,shouldRetry:({error:M})=>M instanceof gI});p=!1;const P=O.transactions.find(({from:M,nonce:$})=>M===h.from&&$===h.nonce);if(!P||(f=await mt(t,Rp,"getTransactionReceipt")({hash:P.hash}),r>1&&(!f.blockNumber||x-f.blockNumber+1n<r)))return;let k="replaced";P.to===h.to&&P.value===h.value&&P.input===h.input?k="repriced":P.from===P.to&&P.value===0n&&(k="cancelled"),S(()=>{b.onReplaced?.({reason:k,replacedTransaction:h,transaction:P,transactionReceipt:f}),b.resolve(f)})}catch(O){S(()=>b.reject(O))}}else S(()=>b.reject(I))}}})}),y}function xk(t,{batch:e=!0,onError:n,onTransactions:r,poll:s,pollingInterval:i=t.pollingInterval}){return(typeof s<"u"?s:t.transport.type!=="webSocket"&&t.transport.type!=="ipc")?(()=>{const l=vr(["watchPendingTransactions",t.uid,e,i]);return Oh(l,{onTransactions:r,onError:n},u=>{let d;const h=HI(async()=>{try{if(!d)try{d=await mt(t,vk,"createPendingTransactionFilter")({});return}catch(p){throw h(),p}const f=await mt(t,sk,"getFilterChanges")({filter:d});if(f.length===0)return;if(e)u.onTransactions(f);else for(const p of f)u.onTransactions([p])}catch(f){u.onError?.(f)}},{emitOnBegin:!0,interval:i});return async()=>{d&&await mt(t,ik,"uninstallFilter")({filter:d}),h()}})})():(()=>{let l=!0,u=()=>l=!1;return(async()=>{try{const{unsubscribe:d}=await t.transport.subscribe({params:["newPendingTransactions"],onData(h){if(!l)return;const f=h.result;r([f])},onError(h){n?.(h)}});u=d,l||u()}catch(d){n?.(d)}})(),()=>u()})()}async function Tk(t,{account:e=t.account,message:n}){if(!e)throw new gy({docsPath:"/docs/actions/wallet/signMessage"});const r=Ps(e);if(r.signMessage)return r.signMessage({message:n});const s=typeof n=="string"?Af(n):n.raw instanceof Uint8Array?pc(n.raw):n.raw;return t.request({method:"personal_sign",params:[s,r.address]},{retryCount:0})}const kp={createBalance(t,e){const n={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return Uc(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const n=e[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(n=>this.isValidAsset(n)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}},yy={async getMyTokensWithBalance(t){const e=fe.state.address,n=T.state.activeCaipNetwork,r=Y.getConnectorId("eip155")===F.CONNECTOR_ID.AUTH;if(!e||!n)return[];const s=`${n.caipNetworkId}:${e}`,i=W.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===F.CHAIN.EVM&&r){const a=await this.getEIP155Balances(e,n);if(a)return this.filterLowQualityTokens(a)}const o=await Ee.getBalance(e,n.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){try{const n=kp.getChainIdHexFromCAIP2ChainId(e.caipNetworkId);if(!(await ee.getCapabilities(t))?.[n]?.assetDiscovery?.supported)return null;const s=await ee.walletGetAssets({account:t,chainFilter:[n]});if(!kp.isWalletGetAssetsResponse(s))return null;const o=(s[n]||[]).map(a=>kp.createBalance(a,e.caipNetworkId));return W.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:o},timestamp:Date.now()}),o}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")}},rs=ct({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map}),Pk={state:rs,replaceState(t){t&&Object.assign(rs,Wo(t))},subscribe(t){return T.subscribeChainProp("accountState",e=>{if(e)return t(e)})},subscribeKey(t,e,n){let r;return T.subscribeChainProp("accountState",s=>{if(s){const i=s[t];r!==i&&(r=i,e(i))}},n)},setStatus(t,e){T.setAccountProp("status",t,e)},getCaipAddress(t){if(t)return T.state.chains.get(t)?.accountState?.caipAddress},setCaipAddress(t,e){const n=t?le.getPlainAddress(t):void 0;e===T.state.activeChain&&(T.state.activeCaipAddress=t),T.setAccountProp("caipAddress",t,e),T.setAccountProp("address",n,e)},setBalance(t,e,n){T.setAccountProp("balance",t,n),T.setAccountProp("balanceSymbol",e,n)},setProfileName(t,e){T.setAccountProp("profileName",t,e)},setProfileImage(t,e){T.setAccountProp("profileImage",t,e)},setUser(t,e){T.setAccountProp("user",t,e)},setAddressExplorerUrl(t,e){T.setAccountProp("addressExplorerUrl",t,e)},setSmartAccountDeployed(t,e){T.setAccountProp("smartAccountDeployed",t,e)},setCurrentTab(t){T.setAccountProp("currentTab",t,T.state.activeChain)},setTokenBalance(t,e){t&&T.setAccountProp("tokenBalance",t,e)},setShouldUpdateToAddress(t,e){T.setAccountProp("shouldUpdateToAddress",t,e)},addAddressLabel(t,e,n){if(!n)return;const r=T.state.chains.get(n)?.accountState?.addressLabels||new Map;r.set(t,e),T.setAccountProp("addressLabels",r,n)},removeAddressLabel(t,e){if(!e)return;const n=T.state.chains.get(e)?.accountState?.addressLabels||new Map;n.delete(t),T.setAccountProp("addressLabels",n,e)},setConnectedWalletInfo(t,e){T.setAccountProp("connectedWalletInfo",t,e,!1)},setPreferredAccountType(t,e){T.setAccountProp("preferredAccountType",t,e)},setSocialProvider(t,e){t&&T.setAccountProp("socialProvider",t,e)},setSocialWindow(t,e){T.setAccountProp("socialWindow",t?Wo(t):void 0,e)},setFarcasterUrl(t,e){T.setAccountProp("farcasterUrl",t,e)},async fetchTokenBalance(t){rs.balanceLoading=!0;const e=T.state.activeCaipNetwork?.caipNetworkId,n=T.state.activeCaipNetwork?.chainNamespace,r=T.state.activeCaipAddress,s=r?le.getPlainAddress(r):void 0;if(rs.lastRetry&&!le.isAllowedRetry(rs.lastRetry,30*Ye.ONE_SEC_MS))return rs.balanceLoading=!1,[];try{if(s&&e&&n){const i=await yy.getMyTokensWithBalance();return fe.setTokenBalance(i,n),rs.lastRetry=void 0,rs.balanceLoading=!1,i}}catch(i){rs.lastRetry=Date.now(),t?.(i),ws.showError("Token Balance Unavailable")}finally{rs.balanceLoading=!1}return[]},resetAccount(t){T.resetAccount(t)}},fe=cr(Pk),Ok={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){const n=T.state.activeCaipNetwork,r=Ce.state.data;if(t.id===n?.id)return;const i=fe.getCaipAddress(T.state.activeChain),o=t.chainNamespace!==T.state.activeChain,a=fe.getCaipAddress(t.chainNamespace),l=Y.getConnectorId(T.state.activeChain)===F.CONNECTOR_ID.AUTH,u=F.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(d=>d===t.chainNamespace);e||l&&u?Ce.push("SwitchNetwork",{...r,network:t}):i&&o&&!a?Ce.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):Ce.push("SwitchNetwork",{...r,network:t})}},Pn=ct({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),Rk={state:Pn,subscribe(t){return cn(Pn,()=>t(Pn))},subscribeKey(t,e){return ln(Pn,t,e)},async open(t){const e=t?.namespace,n=T.state.activeChain,r=e&&e!==n,s=T.getAccountData(t?.namespace)?.caipAddress;if(ee.state.wcBasic?ye.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await ye.prefetch(),Y.setFilterByNamespace(t?.namespace),Fe.setLoading(!0,e),e&&r){const i=T.getNetworkData(e)?.caipNetwork||T.getRequestedCaipNetworks(e)[0];i&&Ok.onSwitchNetwork({network:i,ignoreSwitchConfirmation:!0})}else{const i=T.state.noAdapters;H.state.manualWCControl||i&&!s?le.isMobile()?Ce.reset("AllWallets"):Ce.reset("ConnectingWalletConnectBasic"):t?.view?Ce.reset(t.view,t.data):s?Ce.reset("Account"):Ce.reset("Connect")}Pn.open=!0,Vr.set({open:!0}),et.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=H.state.enableEmbedded,e=!!T.state.activeCaipAddress;Pn.open&&et.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),Pn.open=!1,Ce.reset("Connect"),Fe.clearLoading(),t?e?Ce.replace("Account"):Ce.push("Connect"):Vr.set({open:!1}),ee.resetUri()},setLoading(t,e){e&&Pn.loadingNamespaceMap.set(e,t),Pn.loading=t,Vr.set({loading:t})},clearLoading(){Pn.loadingNamespaceMap.clear(),Pn.loading=!1,Vr.set({loading:!1})},shake(){Pn.shake||(Pn.shake=!0,setTimeout(()=>{Pn.shake=!1},500))}},Fe=cr(Rk),Nl={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},Im={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},kk={providers:gC,selectedProvider:null,error:null,purchaseCurrency:Nl,paymentCurrency:Im,purchaseCurrencies:[Nl],paymentCurrencies:[],quotesLoading:!1},je=ct(kk),Dk={state:je,subscribe(t){return cn(je,()=>t(je))},subscribeKey(t,e){return ln(je,t,e)},setSelectedProvider(t){if(t&&t.name==="meld"){const e=T.state.activeChain,n=e===F.CHAIN.SOLANA?"SOL":"USDC",r=e?T.state.chains.get(e)?.accountState?.address??"":"",s=new URL(t.url);s.searchParams.append("publicKey",xT),s.searchParams.append("destinationCurrencyCode",n),s.searchParams.append("walletAddress",r),s.searchParams.append("externalCustomerId",H.state.projectId),je.selectedProvider={...t,url:s.toString()}}else je.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,n=gC.filter(r=>e.includes(r.name));je.providers=n}else je.providers=[]},setPurchaseCurrency(t){je.purchaseCurrency=t},setPaymentCurrency(t){je.paymentCurrency=t},setPurchaseAmount(t){_m.state.purchaseAmount=t},setPaymentAmount(t){_m.state.paymentAmount=t},async getAvailableCurrencies(){const t=await Ee.getOnrampOptions();je.purchaseCurrencies=t.purchaseCurrencies,je.paymentCurrencies=t.paymentCurrencies,je.paymentCurrency=t.paymentCurrencies[0]||Im,je.purchaseCurrency=t.purchaseCurrencies[0]||Nl,await ye.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await ye.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){je.quotesLoading=!0;try{const t=await Ee.getOnrampQuote({purchaseCurrency:je.purchaseCurrency,paymentCurrency:je.paymentCurrency,amount:je.paymentAmount?.toString()||"0",network:je.purchaseCurrency?.symbol});return je.quotesLoading=!1,je.purchaseAmount=Number(t?.purchaseAmount.amount),t}catch(t){return je.error=t.message,je.quotesLoading=!1,null}finally{je.quotesLoading=!1}},resetState(){je.selectedProvider=null,je.error=null,je.purchaseCurrency=Nl,je.paymentCurrency=Im,je.purchaseCurrencies=[Nl],je.paymentCurrencies=[],je.paymentAmount=void 0,je.purchaseAmount=void 0,je.quotesLoading=!1}},_m=cr(Dk),hb=2147483648,Uk={convertEVMChainIdToCoinType(t){if(t>=hb)throw new Error("Invalid chainId");return(hb|t)>>>0}},ur=ct({suggestions:[],loading:!1}),Bk={state:ur,subscribe(t){return cn(ur,()=>t(ur))},subscribeKey(t,e){return ln(ur,t,e)},async resolveName(t){try{return await Ee.lookupEnsName(t)}catch(e){const n=e;throw new Error(n?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(t){try{return await Ee.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{ur.loading=!0,ur.suggestions=[];const e=await Ee.getEnsNameSuggestions(t);return ur.suggestions=e.suggestions||[],ur.suggestions}catch(e){const n=Sl.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(n)}finally{ur.loading=!1}},async getNamesForAddress(t){try{if(!T.state.activeCaipNetwork)return[];const n=W.getEnsFromCacheForAddress(t);if(n)return n;const r=await Ee.reverseLookupEnsName({address:t});return W.updateEnsCache({address:t,ens:r,timestamp:Date.now()}),r}catch(e){const n=Sl.parseEnsApiError(e,"Error fetching names for address");throw new Error(n)}},async registerName(t){const e=T.state.activeCaipNetwork,n=fe.state.address,r=Y.getAuthConnector();if(!e)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");ur.loading=!0;try{const s=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});Ce.pushTransactionStack({onCancel(){Ce.replace("RegisterAccountName")}});const i=await ee.signMessage(s);ur.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=Uk.convertEVMChainIdToCoinType(Number(o));await Ee.registerEnsName({coinType:a,address:n,signature:i,message:s}),fe.setProfileName(t,e.chainNamespace),W.updateEnsCache({address:n,ens:[{name:t,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),Ce.replace("RegisterAccountNameSuccess")}catch(s){const i=Sl.parseEnsApiError(s,`Error registering name ${t}`);throw Ce.replace("RegisterAccountName"),new Error(i)}finally{ur.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){return t?.reasons?.[0]?.description||e}},Sl=cr(Bk);var Id={exports:{}},fb;function $k(){if(fb)return Id.exports;fb=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(b,E,S){return Function.prototype.apply.call(b,E,S)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:n=function(b){return Object.getOwnPropertyNames(b)};function r(N){console&&console.warn&&console.warn(N)}var s=Number.isNaN||function(b){return b!==b};function i(){i.init.call(this)}Id.exports=i,Id.exports.once=y,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(N){if(typeof N!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof N)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(N){if(typeof N!="number"||N<0||s(N))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+N+".");o=N}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(b){if(typeof b!="number"||b<0||s(b))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+b+".");return this._maxListeners=b,this};function c(N){return N._maxListeners===void 0?i.defaultMaxListeners:N._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(b){for(var E=[],S=1;S<arguments.length;S++)E.push(arguments[S]);var x=b==="error",I=this._events;if(I!==void 0)x=x&&I.error===void 0;else if(!x)return!1;if(x){var O;if(E.length>0&&(O=E[0]),O instanceof Error)throw O;var P=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw P.context=O,P}var k=I[b];if(k===void 0)return!1;if(typeof k=="function")e(k,this,E);else for(var M=k.length,$=p(k,M),S=0;S<M;++S)e($[S],this,E);return!0};function l(N,b,E,S){var x,I,O;if(a(E),I=N._events,I===void 0?(I=N._events=Object.create(null),N._eventsCount=0):(I.newListener!==void 0&&(N.emit("newListener",b,E.listener?E.listener:E),I=N._events),O=I[b]),O===void 0)O=I[b]=E,++N._eventsCount;else if(typeof O=="function"?O=I[b]=S?[E,O]:[O,E]:S?O.unshift(E):O.push(E),x=c(N),x>0&&O.length>x&&!O.warned){O.warned=!0;var P=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");P.name="MaxListenersExceededWarning",P.emitter=N,P.type=b,P.count=O.length,r(P)}return N}i.prototype.addListener=function(b,E){return l(this,b,E,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(b,E){return l(this,b,E,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(N,b,E){var S={fired:!1,wrapFn:void 0,target:N,type:b,listener:E},x=u.bind(S);return x.listener=E,S.wrapFn=x,x}i.prototype.once=function(b,E){return a(E),this.on(b,d(this,b,E)),this},i.prototype.prependOnceListener=function(b,E){return a(E),this.prependListener(b,d(this,b,E)),this},i.prototype.removeListener=function(b,E){var S,x,I,O,P;if(a(E),x=this._events,x===void 0)return this;if(S=x[b],S===void 0)return this;if(S===E||S.listener===E)--this._eventsCount===0?this._events=Object.create(null):(delete x[b],x.removeListener&&this.emit("removeListener",b,S.listener||E));else if(typeof S!="function"){for(I=-1,O=S.length-1;O>=0;O--)if(S[O]===E||S[O].listener===E){P=S[O].listener,I=O;break}if(I<0)return this;I===0?S.shift():g(S,I),S.length===1&&(x[b]=S[0]),x.removeListener!==void 0&&this.emit("removeListener",b,P||E)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(b){var E,S,x;if(S=this._events,S===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[b]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete S[b]),this;if(arguments.length===0){var I=Object.keys(S),O;for(x=0;x<I.length;++x)O=I[x],O!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(E=S[b],typeof E=="function")this.removeListener(b,E);else if(E!==void 0)for(x=E.length-1;x>=0;x--)this.removeListener(b,E[x]);return this};function h(N,b,E){var S=N._events;if(S===void 0)return[];var x=S[b];return x===void 0?[]:typeof x=="function"?E?[x.listener||x]:[x]:E?m(x):p(x,x.length)}i.prototype.listeners=function(b){return h(this,b,!0)},i.prototype.rawListeners=function(b){return h(this,b,!1)},i.listenerCount=function(N,b){return typeof N.listenerCount=="function"?N.listenerCount(b):f.call(N,b)},i.prototype.listenerCount=f;function f(N){var b=this._events;if(b!==void 0){var E=b[N];if(typeof E=="function")return 1;if(E!==void 0)return E.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function p(N,b){for(var E=new Array(b),S=0;S<b;++S)E[S]=N[S];return E}function g(N,b){for(;b+1<N.length;b++)N[b]=N[b+1];N.pop()}function m(N){for(var b=new Array(N.length),E=0;E<b.length;++E)b[E]=N[E].listener||N[E];return b}function y(N,b){return new Promise(function(E,S){function x(O){N.removeListener(b,I),S(O)}function I(){typeof N.removeListener=="function"&&N.removeListener("error",x),E([].slice.call(arguments))}w(N,b,I,{once:!0}),b!=="error"&&v(N,x,{once:!0})})}function v(N,b,E){typeof N.on=="function"&&w(N,"error",b,E)}function w(N,b,E,S){if(typeof N.on=="function")S.once?N.once(b,E):N.on(b,E);else if(typeof N.addEventListener=="function")N.addEventListener(b,function x(I){S.once&&N.removeEventListener(b,x),E(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof N)}return Id.exports}var xr=$k();const wy=wf(xr);var Dp={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Nm=function(t,e){return Nm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},Nm(t,e)};function Lk(t,e){Nm(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Sm=function(){return Sm=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Sm.apply(this,arguments)};function Mk(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Fk(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function jk(t,e){return function(n,r){e(n,r,t)}}function Hk(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function zk(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function qk(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,s=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Wk(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function Vk(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function xm(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function KI(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function Gk(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(KI(arguments[e]));return t}function Kk(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function hu(t){return this instanceof hu?(this.v=t,this):new hu(t)}function Jk(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){r[h]&&(s[h]=function(f){return new Promise(function(p,g){i.push([h,f,p,g])>1||a(h,f)})})}function a(h,f){try{c(r[h](f))}catch(p){d(i[0][3],p)}}function c(h){h.value instanceof hu?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Yk(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:hu(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function Zk(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof xm=="function"?xm(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function Qk(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Xk(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function e5(t){return t&&t.__esModule?t:{default:t}}function t5(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function n5(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const r5=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Sm},__asyncDelegator:Yk,__asyncGenerator:Jk,__asyncValues:Zk,__await:hu,__awaiter:zk,__classPrivateFieldGet:t5,__classPrivateFieldSet:n5,__createBinding:Wk,__decorate:Fk,__exportStar:Vk,__extends:Lk,__generator:qk,__importDefault:e5,__importStar:Xk,__makeTemplateObject:Qk,__metadata:Hk,__param:jk,__read:KI,__rest:Mk,__spread:Gk,__spreadArrays:Kk,__values:xm},Symbol.toStringTag,{value:"Module"})),Ju=pT(r5);var Up={},Qc={},pb;function s5(){if(pb)return Qc;pb=1,Object.defineProperty(Qc,"__esModule",{value:!0}),Qc.delay=void 0;function t(e){return new Promise(n=>{setTimeout(()=>{n(!0)},e)})}return Qc.delay=t,Qc}var uo={},Bp={},ho={},gb;function i5(){return gb||(gb=1,Object.defineProperty(ho,"__esModule",{value:!0}),ho.ONE_THOUSAND=ho.ONE_HUNDRED=void 0,ho.ONE_HUNDRED=100,ho.ONE_THOUSAND=1e3),ho}var $p={},mb;function o5(){return mb||(mb=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}($p)),$p}var yb;function JI(){return yb||(yb=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ju;e.__exportStar(i5(),t),e.__exportStar(o5(),t)}(Bp)),Bp}var wb;function a5(){if(wb)return uo;wb=1,Object.defineProperty(uo,"__esModule",{value:!0}),uo.fromMiliseconds=uo.toMiliseconds=void 0;const t=JI();function e(r){return r*t.ONE_THOUSAND}uo.toMiliseconds=e;function n(r){return Math.floor(r/t.ONE_THOUSAND)}return uo.fromMiliseconds=n,uo}var bb;function c5(){return bb||(bb=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ju;e.__exportStar(s5(),t),e.__exportStar(a5(),t)}(Up)),Up}var Aa={},Eb;function l5(){if(Eb)return Aa;Eb=1,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return Aa.Watch=t,Aa.default=t,Aa}var Lp={},Xc={},vb;function u5(){if(vb)return Xc;vb=1,Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.IWatch=void 0;class t{}return Xc.IWatch=t,Xc}var Ab;function d5(){return Ab||(Ab=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Ju.__exportStar(u5(),t)}(Lp)),Lp}var Cb;function h5(){return Cb||(Cb=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ju;e.__exportStar(c5(),t),e.__exportStar(l5(),t),e.__exportStar(d5(),t),e.__exportStar(JI(),t)}(Dp)),Dp}var Q=h5();class ha{}let f5=class extends ha{constructor(e){super()}};const Ib=Q.FIVE_SECONDS,fa={pulse:"heartbeat_pulse"};let p5=class YI extends f5{constructor(e){super(e),this.events=new xr.EventEmitter,this.interval=Ib,this.interval=e?.interval||Ib}static async init(e){const n=new YI(e);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Q.toMiliseconds(this.interval))}pulse(){this.events.emit(fa.pulse)}};const g5=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,m5=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,y5=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function w5(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){b5(t);return}return e}function b5(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function _d(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const n=t.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!y5.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(g5.test(t)||m5.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,w5)}return JSON.parse(t)}catch(r){if(e.strict)throw r;return t}}function E5(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Vt(t,...e){try{return E5(t(...e))}catch(n){return Promise.reject(n)}}function v5(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function A5(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function ih(t){if(v5(t))return String(t);if(A5(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return ih(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Tm="base64:";function C5(t){return typeof t=="string"?t:Tm+N5(t)}function I5(t){return typeof t!="string"||!t.startsWith(Tm)?t:_5(t.slice(Tm.length))}function _5(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function N5(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function Un(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function S5(...t){return Un(t.join(":"))}function Nd(t){return t=Un(t),t?t+":":""}function x5(t,e){if(e===void 0)return!0;let n=0,r=t.indexOf(":");for(;r>-1;)n++,r=t.indexOf(":",r+1);return n<=e}function T5(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const P5="memory",O5=()=>{const t=new Map;return{name:P5,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,n){t.set(e,n)},setItemRaw(e,n){t.set(e,n)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function R5(t={}){const e={mounts:{"":t.driver||O5()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},r=(l,u)=>e.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(l,u)=>{if(e.watching){u=Un(u);for(const d of e.watchListeners)d(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await _b(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,d)=>{const h=new Map,f=p=>{let g=h.get(p.base);return g||(g={driver:p.driver,base:p.base,items:[]},h.set(p.base,g)),g};for(const p of l){const g=typeof p=="string",m=Un(g?p:p.key),y=g?void 0:p.value,v=g||!p.options?u:{...u,...p.options},w=n(m);f(w).items.push({key:m,value:y,relativeKey:w.relativeKey,options:v})}return Promise.all([...h.values()].map(p=>d(p))).then(p=>p.flat())},c={hasItem(l,u={}){l=Un(l);const{relativeKey:d,driver:h}=n(l);return Vt(h.hasItem,d,u)},getItem(l,u={}){l=Un(l);const{relativeKey:d,driver:h}=n(l);return Vt(h.getItem,d,u).then(f=>_d(f))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?Vt(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(f=>({key:S5(d.base,f.key),value:_d(f.value)}))):Promise.all(d.items.map(h=>Vt(d.driver.getItem,h.relativeKey,h.options).then(f=>({key:h.key,value:_d(f)})))))},getItemRaw(l,u={}){l=Un(l);const{relativeKey:d,driver:h}=n(l);return h.getItemRaw?Vt(h.getItemRaw,d,u):Vt(h.getItem,d,u).then(f=>I5(f))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=Un(l);const{relativeKey:h,driver:f}=n(l);f.setItem&&(await Vt(f.setItem,h,ih(u),d),f.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return Vt(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:ih(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>Vt(d.driver.setItem,h.relativeKey,ih(h.value),h.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=Un(l);const{relativeKey:h,driver:f}=n(l);if(f.setItemRaw)await Vt(f.setItemRaw,h,u,d);else if(f.setItem)await Vt(f.setItem,h,C5(u),d);else return;f.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=Un(l);const{relativeKey:d,driver:h}=n(l);h.removeItem&&(await Vt(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await Vt(h.removeItem,d+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=Un(l);const{relativeKey:d,driver:h}=n(l),f=Object.create(null);if(h.getMeta&&Object.assign(f,await Vt(h.getMeta,d,u)),!u.nativeOnly){const p=await Vt(h.getItem,d+"$",u).then(g=>_d(g));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(f,p))}return f},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){l=Nd(l);const d=r(l,!0);let h=[];const f=[];let p=!0;for(const m of d){m.driver.flags?.maxDepth||(p=!1);const y=await Vt(m.driver.getKeys,m.relativeBase,u);for(const v of y){const w=m.mountpoint+Un(v);h.some(N=>w.startsWith(N))||f.push(w)}h=[m.mountpoint,...h.filter(v=>!v.startsWith(m.mountpoint))]}const g=u.maxDepth!==void 0&&!p;return f.filter(m=>(!g||x5(m,u.maxDepth))&&T5(m,l))},async clear(l,u={}){l=Nd(l),await Promise.all(r(l,!1).map(async d=>{if(d.driver.clear)return Vt(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(f=>d.driver.removeItem(f,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>Nb(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=Nd(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((d,h)=>h.length-d.length)),e.mounts[l]=u,e.watching&&Promise.resolve(_b(u,s,l)).then(d=>{e.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){l=Nd(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&(e.unwatch[l]?.(),delete e.unwatch[l]),u&&await Nb(e.mounts[l]),e.mountpoints=e.mountpoints.filter(d=>d!==l),delete e.mounts[l])},getMount(l=""){l=Un(l)+":";const u=n(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=Un(l),r(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function _b(t,e,n){return t.watch?t.watch((r,s)=>e(r,n+s)):()=>{}}async function Nb(t){typeof t.dispose=="function"&&await Vt(t.dispose)}function pa(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function ZI(t,e){let n;const r=()=>{if(n)return n;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),n=pa(s),n.then(i=>{i.onclose=()=>n=void 0},()=>{}),n};return(s,i)=>r().then(o=>i(o.transaction(e,s).objectStore(e)))}let Mp;function Yu(){return Mp||(Mp=ZI("keyval-store","keyval")),Mp}function Sb(t,e=Yu()){return e("readonly",n=>pa(n.get(t)))}function k5(t,e,n=Yu()){return n("readwrite",r=>(r.put(e,t),pa(r.transaction)))}function D5(t,e=Yu()){return e("readwrite",n=>(n.delete(t),pa(n.transaction)))}function U5(t=Yu()){return t("readwrite",e=>(e.clear(),pa(e.transaction)))}function B5(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},pa(t.transaction)}function $5(t=Yu()){return t("readonly",e=>{if(e.getAllKeys)return pa(e.getAllKeys());const n=[];return B5(e,r=>n.push(r.key)).then(()=>n)})}const L5=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),M5=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=t.replace(e,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Qo(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return M5(t)}catch{return t}}function oi(t){return typeof t=="string"?t:L5(t)||""}const F5="idb-keyval";var j5=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",n=s=>e+s;let r;return t.dbName&&t.storeName&&(r=ZI(t.dbName,t.storeName)),{name:F5,options:t,async hasItem(s){return!(typeof await Sb(n(s),r)>"u")},async getItem(s){return await Sb(n(s),r)??null},setItem(s,i){return k5(n(s),i,r)},removeItem(s){return D5(n(s),r)},getKeys(){return $5(r)},clear(){return U5(r)}}};const H5="WALLET_CONNECT_V2_INDEXED_DB",z5="keyvaluestorage";let q5=class{constructor(){this.indexedDb=R5({driver:j5({dbName:H5,storeName:z5})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const n=await this.indexedDb.getItem(e);if(n!==null)return n}async setItem(e,n){await this.indexedDb.setItem(e,oi(n))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Fp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},oh={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},t.prototype.setItem=function(n,r){this[n]=String(r)},t.prototype.removeItem=function(n){delete this[n]},t.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},t.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Fp<"u"&&Fp.localStorage?oh.exports=Fp.localStorage:typeof window<"u"&&window.localStorage?oh.exports=window.localStorage:oh.exports=new e})();function W5(t){var e;return[t[0],Qo((e=t[1])!=null?e:"")]}let V5=class{constructor(){this.localStorage=oh.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(W5)}async getItem(e){const n=this.localStorage.getItem(e);if(n!==null)return Qo(n)}async setItem(e,n){this.localStorage.setItem(e,oi(n))}async removeItem(e){this.localStorage.removeItem(e)}};const G5="wc_storage_version",xb=1,K5=async(t,e,n)=>{const r=G5,s=await e.getItem(r);if(s&&s>=xb){n(e);return}const i=await t.getKeys();if(!i.length){n(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await t.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(r,xb),n(e),J5(t,o)},J5=async(t,e)=>{e.length&&e.forEach(async n=>{await t.removeItem(n)})};let Y5=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const e=new V5;this.storage=e;try{const n=new q5;K5(e,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,n){return await this.initialize(),this.storage.setItem(e,n)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),e())},20)})}};var jp,Tb;function Z5(){if(Tb)return jp;Tb=1;function t(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}jp=e;function e(n,r,s){var i=s&&s.stringify||t,o=1;if(typeof n=="object"&&n!==null){var a=r.length+o;if(a===1)return n;var c=new Array(a);c[0]=i(n);for(var l=1;l<a;l++)c[l]=i(r[l]);return c.join(" ")}if(typeof n!="string")return n;var u=r.length;if(u===0)return n;for(var d="",h=1-o,f=-1,p=n&&n.length||0,g=0;g<p;){if(n.charCodeAt(g)===37&&g+1<p){switch(f=f>-1?f:0,n.charCodeAt(g+1)){case 100:case 102:if(h>=u||r[h]==null)break;f<g&&(d+=n.slice(f,g)),d+=Number(r[h]),f=g+2,g++;break;case 105:if(h>=u||r[h]==null)break;f<g&&(d+=n.slice(f,g)),d+=Math.floor(Number(r[h])),f=g+2,g++;break;case 79:case 111:case 106:if(h>=u||r[h]===void 0)break;f<g&&(d+=n.slice(f,g));var m=typeof r[h];if(m==="string"){d+="'"+r[h]+"'",f=g+2,g++;break}if(m==="function"){d+=r[h].name||"<anonymous>",f=g+2,g++;break}d+=i(r[h]),f=g+2,g++;break;case 115:if(h>=u)break;f<g&&(d+=n.slice(f,g)),d+=String(r[h]),f=g+2,g++;break;case 37:f<g&&(d+=n.slice(f,g)),d+="%",f=g+2,g++,h--;break}++h}++g}return f===-1?n:(f<p&&(d+=n.slice(f)),d)}return jp}var Hp,Pb;function Q5(){if(Pb)return Hp;Pb=1;const t=Z5();Hp=s;const e=b().console||{},n={mapHttpRequest:p,mapHttpResponse:p,wrapRequestSerializer:g,wrapResponseSerializer:g,wrapErrorSerializer:g,req:p,res:p,err:h};function r(E,S){return Array.isArray(E)?E.filter(function(I){return I!=="!stdSerializers.err"}):E===!0?Object.keys(S):!1}function s(E){E=E||{},E.browser=E.browser||{};const S=E.browser.transmit;if(S&&typeof S.send!="function")throw Error("pino: transmit option must have a send function");const x=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const I=E.serializers||{},O=r(E.browser.serialize,I);let P=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(P=!1);const k=["error","fatal","warn","info","debug","trace"];typeof x=="function"&&(x.error=x.fatal=x.warn=x.info=x.debug=x.trace=x),E.enabled===!1&&(E.level="silent");const M=E.level||"info",$=Object.create(x);$.log||($.log=m),Object.defineProperty($,"levelVal",{get:_}),Object.defineProperty($,"level",{get:R,set:B});const A={transmit:S,serialize:O,asObject:E.browser.asObject,levels:k,timestamp:f(E)};$.levels=s.levels,$.level=M,$.setMaxListeners=$.getMaxListeners=$.emit=$.addListener=$.on=$.prependListener=$.once=$.prependOnceListener=$.removeListener=$.removeAllListeners=$.listeners=$.listenerCount=$.eventNames=$.write=$.flush=m,$.serializers=I,$._serialize=O,$._stdErrSerialize=P,$.child=U,S&&($._logEvent=d());function _(){return this.level==="silent"?1/0:this.levels.values[this.level]}function R(){return this._level}function B(L){if(L!=="silent"&&!this.levels.values[L])throw Error("unknown level "+L);this._level=L,i(A,$,"error","log"),i(A,$,"fatal","error"),i(A,$,"warn","error"),i(A,$,"info","log"),i(A,$,"debug","log"),i(A,$,"trace","log")}function U(L,j){if(!L)throw new Error("missing bindings for child Pino");j=j||{},O&&L.serializers&&(j.serializers=L.serializers);const q=j.serializers;if(O&&q){var X=Object.assign({},I,q),K=E.browser.serialize===!0?Object.keys(X):O;delete L.serializers,c([L],K,X,this._stdErrSerialize)}function se(ge){this._childLevel=(ge._childLevel|0)+1,this.error=l(ge,L,"error"),this.fatal=l(ge,L,"fatal"),this.warn=l(ge,L,"warn"),this.info=l(ge,L,"info"),this.debug=l(ge,L,"debug"),this.trace=l(ge,L,"trace"),X&&(this.serializers=X,this._serialize=K),S&&(this._logEvent=d([].concat(ge._logEvent.bindings,L)))}return se.prototype=this,new se(this)}return $}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=n,s.stdTimeFunctions=Object.assign({},{nullTime:y,epochTime:v,unixTime:w,isoTime:N});function i(E,S,x,I){const O=Object.getPrototypeOf(S);S[x]=S.levelVal>S.levels.values[x]?m:O[x]?O[x]:e[x]||e[I]||m,o(E,S,x)}function o(E,S,x){!E.transmit&&S[x]===m||(S[x]=function(I){return function(){const P=E.timestamp(),k=new Array(arguments.length),M=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var $=0;$<k.length;$++)k[$]=arguments[$];if(E.serialize&&!E.asObject&&c(k,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?I.call(M,a(this,x,k,P)):I.apply(M,k),E.transmit){const A=E.transmit.level||S.level,_=s.levels.values[A],R=s.levels.values[x];if(R<_)return;u(this,{ts:P,methodLevel:x,methodValue:R,transmitValue:s.levels.values[E.transmit.level||S.level],send:E.transmit.send,val:S.levelVal},k)}}}(S[x]))}function a(E,S,x,I){E._serialize&&c(x,E._serialize,E.serializers,E._stdErrSerialize);const O=x.slice();let P=O[0];const k={};I&&(k.time=I),k.level=s.levels.values[S];let M=(E._childLevel|0)+1;if(M<1&&(M=1),P!==null&&typeof P=="object"){for(;M--&&typeof O[0]=="object";)Object.assign(k,O.shift());P=O.length?t(O.shift(),O):void 0}else typeof P=="string"&&(P=t(O.shift(),O));return P!==void 0&&(k.msg=P),k}function c(E,S,x,I){for(const O in E)if(I&&E[O]instanceof Error)E[O]=s.stdSerializers.err(E[O]);else if(typeof E[O]=="object"&&!Array.isArray(E[O]))for(const P in E[O])S&&S.indexOf(P)>-1&&P in x&&(E[O][P]=x[P](E[O][P]))}function l(E,S,x){return function(){const I=new Array(1+arguments.length);I[0]=S;for(var O=1;O<I.length;O++)I[O]=arguments[O-1];return E[x].apply(this,I)}}function u(E,S,x){const I=S.send,O=S.ts,P=S.methodLevel,k=S.methodValue,M=S.val,$=E._logEvent.bindings;c(x,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=O,E._logEvent.messages=x.filter(function(A){return $.indexOf(A)===-1}),E._logEvent.level.label=P,E._logEvent.level.value=k,I(P,E._logEvent,M),E._logEvent=d($)}function d(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function h(E){const S={type:E.constructor.name,msg:E.message,stack:E.stack};for(const x in E)S[x]===void 0&&(S[x]=E[x]);return S}function f(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?y:v}function p(){return{}}function g(E){return E}function m(){}function y(){return!1}function v(){return Date.now()}function w(){return Math.round(Date.now()/1e3)}function N(){return new Date(Date.now()).toISOString()}function b(){function E(S){return typeof S<"u"&&S}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return Hp}var qa=Q5();const Zu=wf(qa),X5={level:"info"},Qu="custom_context",by=1e3*1024;let e6=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Ob=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const n=new e6(e);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let n=this.head;for(;n!==null;)e.push(n.value),n=n.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const n=e.value;return e=e.next,{done:!1,value:n}}}}},QI=class{constructor(e,n=by){this.level=e??"error",this.levelValue=qa.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new Ob(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,n){n===qa.levels.values.error?console.error(e):n===qa.levels.values.warn?console.warn(e):n===qa.levels.values.debug?console.debug(e):n===qa.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(oi({timestamp:new Date().toISOString(),log:e}));const n=typeof e=="string"?JSON.parse(e).level:e.level;n>=this.levelValue&&this.forwardToConsole(e,n)}getLogs(){return this.logs}clearLogs(){this.logs=new Ob(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const n=this.getLogArray();return n.push(oi({extraMetadata:e})),new Blob(n,{type:"application/json"})}},t6=class{constructor(e,n=by){this.baseChunkLogger=new QI(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const n=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}},n6=class{constructor(e,n=by){this.baseChunkLogger=new QI(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var r6=Object.defineProperty,s6=Object.defineProperties,i6=Object.getOwnPropertyDescriptors,Rb=Object.getOwnPropertySymbols,o6=Object.prototype.hasOwnProperty,a6=Object.prototype.propertyIsEnumerable,kb=(t,e,n)=>e in t?r6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Dh=(t,e)=>{for(var n in e||(e={}))o6.call(e,n)&&kb(t,n,e[n]);if(Rb)for(var n of Rb(e))a6.call(e,n)&&kb(t,n,e[n]);return t},Uh=(t,e)=>s6(t,i6(e));function $c(t){return Uh(Dh({},t),{level:t?.level||X5.level})}function c6(t,e=Qu){return t[e]||""}function l6(t,e,n=Qu){return t[n]=e,t}function Jn(t,e=Qu){let n="";return typeof t.bindings>"u"?n=c6(t,e):n=t.bindings().context||"",n}function u6(t,e,n=Qu){const r=Jn(t,n);return r.trim()?`${r}/${e}`:e}function wn(t,e,n=Qu){const r=u6(t,e,n),s=t.child({context:r});return l6(s,r,n)}function d6(t){var e,n;const r=new t6((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Zu(Uh(Dh({},t.opts),{level:"trace",browser:Uh(Dh({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function h6(t){var e;const n=new n6((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Zu(Uh(Dh({},t.opts),{level:"trace"}),n),chunkLoggerController:n}}function Ey(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?d6(t):h6(t)}var f6=Object.defineProperty,p6=(t,e,n)=>e in t?f6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Db=(t,e,n)=>p6(t,typeof e!="symbol"?e+"":e,n);let g6=class extends ha{constructor(e){super(),this.opts=e,Db(this,"protocol","wc"),Db(this,"version",2)}};var m6=Object.defineProperty,y6=(t,e,n)=>e in t?m6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,w6=(t,e,n)=>y6(t,e+"",n);let b6=class extends ha{constructor(e,n){super(),this.core=e,this.logger=n,w6(this,"records",new Map)}},E6=class{constructor(e,n){this.logger=e,this.core=n}},v6=class extends ha{constructor(e,n){super(),this.relayer=e,this.logger=n}},A6=class extends ha{constructor(e){super()}},C6=class{constructor(e,n,r,s){this.core=e,this.logger=n,this.name=r}},I6=class extends ha{constructor(e,n){super(),this.relayer=e,this.logger=n}},_6=class extends ha{constructor(e,n){super(),this.core=e,this.logger=n}},N6=class{constructor(e,n,r){this.core=e,this.logger=n,this.store=r}},S6=class{constructor(e,n){this.projectId=e,this.logger=n}},x6=class{constructor(e,n,r){this.core=e,this.logger=n,this.telemetryEnabled=r}};var T6=Object.defineProperty,P6=(t,e,n)=>e in t?T6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ub=(t,e,n)=>P6(t,typeof e!="symbol"?e+"":e,n);let O6=class{constructor(e){this.opts=e,Ub(this,"protocol","wc"),Ub(this,"version",2)}},R6=class{constructor(e){this.client=e}};function k6(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function XI(t,...e){if(!k6(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Bb(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function D6(t,e){XI(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Ca=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zp=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function U6(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function e_(t){return typeof t=="string"&&(t=U6(t)),XI(t),t}let B6=class{clone(){return this._cloneInto()}};function $6(t){const e=r=>t().update(e_(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function t_(t=32){if(Ca&&typeof Ca.getRandomValues=="function")return Ca.getRandomValues(new Uint8Array(t));if(Ca&&typeof Ca.randomBytes=="function")return Ca.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function L6(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}let M6=class extends B6{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=zp(this.buffer)}update(e){Bb(this);const{view:n,buffer:r,blockLen:s}=this;e=e_(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=zp(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Bb(this),D6(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;L6(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=zp(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const Sd=BigInt(2**32-1),Pm=BigInt(32);function n_(t,e=!1){return e?{h:Number(t&Sd),l:Number(t>>Pm&Sd)}:{h:Number(t>>Pm&Sd)|0,l:Number(t&Sd)|0}}function F6(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=n_(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const j6=(t,e)=>BigInt(t>>>0)<<Pm|BigInt(e>>>0),H6=(t,e,n)=>t>>>n,z6=(t,e,n)=>t<<32-n|e>>>n,q6=(t,e,n)=>t>>>n|e<<32-n,W6=(t,e,n)=>t<<32-n|e>>>n,V6=(t,e,n)=>t<<64-n|e>>>n-32,G6=(t,e,n)=>t>>>n-32|e<<64-n,K6=(t,e)=>e,J6=(t,e)=>t,Y6=(t,e,n)=>t<<n|e>>>32-n,Z6=(t,e,n)=>e<<n|t>>>32-n,Q6=(t,e,n)=>e<<n-32|t>>>64-n,X6=(t,e,n)=>t<<n-32|e>>>64-n;function eD(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const tD=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),nD=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,rD=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),sD=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,iD=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),oD=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Te={fromBig:n_,split:F6,toBig:j6,shrSH:H6,shrSL:z6,rotrSH:q6,rotrSL:W6,rotrBH:V6,rotrBL:G6,rotr32H:K6,rotr32L:J6,rotlSH:Y6,rotlSL:Z6,rotlBH:Q6,rotlBL:X6,add:eD,add3L:tD,add3H:nD,add4L:rD,add4H:sD,add5H:oD,add5L:iD},[aD,cD]=Te.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Ei=new Uint32Array(80),vi=new Uint32Array(80);let lD=class extends M6{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let w=0;w<16;w++,n+=4)Ei[w]=e.getUint32(n),vi[w]=e.getUint32(n+=4);for(let w=16;w<80;w++){const N=Ei[w-15]|0,b=vi[w-15]|0,E=Te.rotrSH(N,b,1)^Te.rotrSH(N,b,8)^Te.shrSH(N,b,7),S=Te.rotrSL(N,b,1)^Te.rotrSL(N,b,8)^Te.shrSL(N,b,7),x=Ei[w-2]|0,I=vi[w-2]|0,O=Te.rotrSH(x,I,19)^Te.rotrBH(x,I,61)^Te.shrSH(x,I,6),P=Te.rotrSL(x,I,19)^Te.rotrBL(x,I,61)^Te.shrSL(x,I,6),k=Te.add4L(S,P,vi[w-7],vi[w-16]),M=Te.add4H(k,E,O,Ei[w-7],Ei[w-16]);Ei[w]=M|0,vi[w]=k|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:y,Hl:v}=this;for(let w=0;w<80;w++){const N=Te.rotrSH(d,h,14)^Te.rotrSH(d,h,18)^Te.rotrBH(d,h,41),b=Te.rotrSL(d,h,14)^Te.rotrSL(d,h,18)^Te.rotrBL(d,h,41),E=d&f^~d&g,S=h&p^~h&m,x=Te.add5L(v,b,S,cD[w],vi[w]),I=Te.add5H(x,y,N,E,aD[w],Ei[w]),O=x|0,P=Te.rotrSH(r,s,28)^Te.rotrBH(r,s,34)^Te.rotrBH(r,s,39),k=Te.rotrSL(r,s,28)^Te.rotrBL(r,s,34)^Te.rotrBL(r,s,39),M=r&i^r&a^i&a,$=s&o^s&c^o&c;y=g|0,v=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Te.add(l|0,u|0,I|0,O|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const A=Te.add3L(O,k,$);r=Te.add3H(A,I,P,M),s=A|0}({h:r,l:s}=Te.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Te.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Te.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Te.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Te.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Te.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Te.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:y,l:v}=Te.add(this.Hh|0,this.Hl|0,y|0,v|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,g,m,y,v)}roundClean(){Ei.fill(0),vi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const uD=$6(()=>new lD);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const vy=BigInt(0),r_=BigInt(1),dD=BigInt(2);function Ay(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Cy(t){if(!Ay(t))throw new Error("Uint8Array expected")}function qp(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const hD=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Iy(t){Cy(t);let e="";for(let n=0;n<t.length;n++)e+=hD[t[n]];return e}function s_(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?vy:BigInt("0x"+t)}const Us={_0:48,_9:57,A:65,F:70,a:97,f:102};function $b(t){if(t>=Us._0&&t<=Us._9)return t-Us._0;if(t>=Us.A&&t<=Us.F)return t-(Us.A-10);if(t>=Us.a&&t<=Us.f)return t-(Us.a-10)}function i_(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=$b(t.charCodeAt(i)),a=$b(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function fD(t){return s_(Iy(t))}function ah(t){return Cy(t),s_(Iy(Uint8Array.from(t).reverse()))}function o_(t,e){return i_(t.toString(16).padStart(e*2,"0"))}function Om(t,e){return o_(t,e).reverse()}function Bs(t,e,n){let r;if(typeof e=="string")try{r=i_(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Ay(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function Lb(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Cy(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const Wp=t=>typeof t=="bigint"&&vy<=t;function pD(t,e,n){return Wp(t)&&Wp(e)&&Wp(n)&&e<=t&&t<n}function el(t,e,n,r){if(!pD(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function gD(t){let e;for(e=0;t>vy;t>>=r_,e+=1);return e}const mD=t=>(dD<<BigInt(t-1))-r_,yD={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Ay(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function _y(t,e,n={}){const r=(s,i,o)=>{const a=yD[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function Mb(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const Yt=BigInt(0),Tt=BigInt(1),Ao=BigInt(2),wD=BigInt(3),Rm=BigInt(4),Fb=BigInt(5),jb=BigInt(8);function Mt(t,e){const n=t%e;return n>=Yt?n:e+n}function bD(t,e,n){if(e<Yt)throw new Error("invalid exponent, negatives unsupported");if(n<=Yt)throw new Error("invalid modulus");if(n===Tt)return Yt;let r=Tt;for(;e>Yt;)e&Tt&&(r=r*t%n),t=t*t%n,e>>=Tt;return r}function ss(t,e,n){let r=t;for(;e-- >Yt;)r*=r,r%=n;return r}function Hb(t,e){if(t===Yt)throw new Error("invert: expected non-zero number");if(e<=Yt)throw new Error("invert: expected positive modulus, got "+e);let n=Mt(t,e),r=e,s=Yt,i=Tt;for(;n!==Yt;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==Tt)throw new Error("invert: does not exist");return Mt(s,e)}function ED(t){const e=(t-Tt)/Ao;let n,r,s;for(n=t-Tt,r=0;n%Ao===Yt;n/=Ao,r++);for(s=Ao;s<t&&bD(s,e,t)!==t-Tt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+Tt)/Rm;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(n+Tt)/Ao;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,s),n),u=o.pow(a,i),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let p=o.sqr(d);h<c&&!o.eql(p,o.ONE);h++)p=o.sqr(p);const f=o.pow(l,Tt<<BigInt(c-h-1));l=o.sqr(f),u=o.mul(u,f),d=o.mul(d,l),c=h}return u}}function vD(t){if(t%Rm===wD){const e=(t+Tt)/Rm;return function(n,r){const s=n.pow(r,e);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(t%jb===Fb){const e=(t-Fb)/jb;return function(n,r){const s=n.mul(r,Ao),i=n.pow(s,e),o=n.mul(r,i),a=n.mul(n.mul(o,Ao),i),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return ED(t)}const AD=(t,e)=>(Mt(t,e)&Tt)===Tt,CD=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ID(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=CD.reduce((r,s)=>(r[s]="function",r),e);return _y(t,n)}function _D(t,e,n){if(n<Yt)throw new Error("invalid exponent, negatives unsupported");if(n===Yt)return t.ONE;if(n===Tt)return e;let r=t.ONE,s=e;for(;n>Yt;)n&Tt&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Tt;return r}function ND(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function a_(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function c_(t,e,n=!1,r={}){if(t<=Yt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=a_(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:mD(s),ZERO:Yt,ONE:Tt,create:c=>Mt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Yt<=c&&c<t},is0:c=>c===Yt,isOdd:c=>(c&Tt)===Tt,neg:c=>Mt(-c,t),eql:(c,l)=>c===l,sqr:c=>Mt(c*c,t),add:(c,l)=>Mt(c+l,t),sub:(c,l)=>Mt(c-l,t),mul:(c,l)=>Mt(c*l,t),pow:(c,l)=>_D(a,c,l),div:(c,l)=>Mt(c*Hb(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Hb(c,t),sqrt:r.sqrt||(c=>(o||(o=vD(t)),o(a,c))),invertBatch:c=>ND(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?Om(c,i):o_(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?ah(c):fD(c)}});return Object.freeze(a)}const zb=BigInt(0),xd=BigInt(1);function Vp(t,e){const n=e.negate();return t?n:e}function l_(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Gp(t,e){l_(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function SD(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function xD(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Kp=new WeakMap,u_=new WeakMap;function Jp(t){return u_.get(t)||1}function TD(t,e){return{constTimeNegate:Vp,hasPrecomputes(n){return Jp(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>zb;)r&xd&&(s=s.add(i)),i=i.double(),r>>=xd;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=Gp(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=Gp(n,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let h=0;h<i;h++){const f=h*o;let p=Number(s&l);s>>=d,p>o&&(p-=u,s+=xd);const g=f,m=f+Math.abs(p)-1,y=h%2!==0,v=p<0;p===0?c=c.add(Vp(y,r[g])):a=a.add(Vp(v,r[m]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=Gp(n,e),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(s===zb)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=xd),f===0)continue;let p=r[h+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(n,r,s){let i=Kp.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&Kp.set(r,s(i))),i},wNAFCached(n,r,s){const i=Jp(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Jp(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){l_(r,e),u_.set(n,r),Kp.delete(n)}}}function PD(t,e,n,r){if(SD(n,t),xD(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=gD(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let f=0;f<r.length;f++){const p=r[f],g=Number(p>>BigInt(d)&BigInt(a));c[g]=c[g].add(n[f])}let h=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),h=h.add(p);if(u=u.add(h),d!==0)for(let f=0;f<o;f++)u=u.double()}return u}function OD(t){return ID(t.Fp),_y(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...a_(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const kr=BigInt(0),On=BigInt(1),Td=BigInt(2),RD=BigInt(8),kD={zip215:!0};function DD(t){const e=OD(t);return _y(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function UD(t){const e=DD(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=Td<<BigInt(a*8)-On,u=n.create,d=c_(e.n,e.nBitLength),h=e.uvRatio||((A,_)=>{try{return{isValid:!0,value:n.sqrt(A*n.inv(_))}}catch{return{isValid:!1,value:kr}}}),f=e.adjustScalarBytes||(A=>A),p=e.domain||((A,_,R)=>{if(qp("phflag",R),_.length||R)throw new Error("Contexts/pre-hash are not supported");return A});function g(A,_){el("coordinate "+A,_,kr,l)}function m(A){if(!(A instanceof w))throw new Error("ExtendedPoint expected")}const y=Mb((A,_)=>{const{ex:R,ey:B,ez:U}=A,L=A.is0();_==null&&(_=L?RD:n.inv(U));const j=u(R*_),q=u(B*_),X=u(U*_);if(L)return{x:kr,y:On};if(X!==On)throw new Error("invZ was invalid");return{x:j,y:q}}),v=Mb(A=>{const{a:_,d:R}=e;if(A.is0())throw new Error("bad point: ZERO");const{ex:B,ey:U,ez:L,et:j}=A,q=u(B*B),X=u(U*U),K=u(L*L),se=u(K*K),ge=u(q*_),Re=u(K*u(ge+X)),Ue=u(se+u(R*u(q*X)));if(Re!==Ue)throw new Error("bad point: equation left != right (1)");const Ie=u(B*U),nt=u(L*j);if(Ie!==nt)throw new Error("bad point: equation left != right (2)");return!0});class w{constructor(_,R,B,U){this.ex=_,this.ey=R,this.ez=B,this.et=U,g("x",_),g("y",R),g("z",B),g("t",U),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(_){if(_ instanceof w)throw new Error("extended point not allowed");const{x:R,y:B}=_||{};return g("x",R),g("y",B),new w(R,B,On,u(R*B))}static normalizeZ(_){const R=n.invertBatch(_.map(B=>B.ez));return _.map((B,U)=>B.toAffine(R[U])).map(w.fromAffine)}static msm(_,R){return PD(w,d,_,R)}_setWindowSize(_){E.setWindowSize(this,_)}assertValidity(){v(this)}equals(_){m(_);const{ex:R,ey:B,ez:U}=this,{ex:L,ey:j,ez:q}=_,X=u(R*q),K=u(L*U),se=u(B*q),ge=u(j*U);return X===K&&se===ge}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:_}=e,{ex:R,ey:B,ez:U}=this,L=u(R*R),j=u(B*B),q=u(Td*u(U*U)),X=u(_*L),K=R+B,se=u(u(K*K)-L-j),ge=X+j,Re=ge-q,Ue=X-j,Ie=u(se*Re),nt=u(ge*Ue),Ot=u(se*Ue),zt=u(Re*ge);return new w(Ie,nt,zt,Ot)}add(_){m(_);const{a:R,d:B}=e,{ex:U,ey:L,ez:j,et:q}=this,{ex:X,ey:K,ez:se,et:ge}=_;if(R===BigInt(-1)){const _w=u((L-U)*(K+X)),Nw=u((L+U)*(K-X)),mp=u(Nw-_w);if(mp===kr)return this.double();const Sw=u(j*Td*ge),xw=u(q*Td*se),Tw=xw+Sw,Pw=Nw+_w,Ow=xw-Sw,Zx=u(Tw*mp),Qx=u(Pw*Ow),Xx=u(Tw*Ow),eT=u(mp*Pw);return new w(Zx,Qx,eT,Xx)}const Re=u(U*X),Ue=u(L*K),Ie=u(q*B*ge),nt=u(j*se),Ot=u((U+L)*(X+K)-Re-Ue),zt=nt-Ie,Or=nt+Ie,Rr=u(Ue-R*Re),ba=u(Ot*zt),md=u(Or*Rr),Jx=u(Ot*Rr),Yx=u(zt*Or);return new w(ba,md,Yx,Jx)}subtract(_){return this.add(_.negate())}wNAF(_){return E.wNAFCached(this,_,w.normalizeZ)}multiply(_){const R=_;el("scalar",R,On,r);const{p:B,f:U}=this.wNAF(R);return w.normalizeZ([B,U])[0]}multiplyUnsafe(_,R=w.ZERO){const B=_;return el("scalar",B,kr,r),B===kr?b:this.is0()||B===On?this:E.wNAFCachedUnsafe(this,B,w.normalizeZ,R)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return E.unsafeLadder(this,r).is0()}toAffine(_){return y(this,_)}clearCofactor(){const{h:_}=e;return _===On?this:this.multiplyUnsafe(_)}static fromHex(_,R=!1){const{d:B,a:U}=e,L=n.BYTES;_=Bs("pointHex",_,L),qp("zip215",R);const j=_.slice(),q=_[L-1];j[L-1]=q&-129;const X=ah(j),K=R?l:n.ORDER;el("pointHex.y",X,kr,K);const se=u(X*X),ge=u(se-On),Re=u(B*se-U);let{isValid:Ue,value:Ie}=h(ge,Re);if(!Ue)throw new Error("Point.fromHex: invalid y coordinate");const nt=(Ie&On)===On,Ot=(q&128)!==0;if(!R&&Ie===kr&&Ot)throw new Error("Point.fromHex: x=0 and x_0=1");return Ot!==nt&&(Ie=u(-Ie)),w.fromAffine({x:Ie,y:X})}static fromPrivateKey(_){return I(_).point}toRawBytes(){const{x:_,y:R}=this.toAffine(),B=Om(R,n.BYTES);return B[B.length-1]|=_&On?128:0,B}toHex(){return Iy(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,On,u(e.Gx*e.Gy)),w.ZERO=new w(kr,On,On,kr);const{BASE:N,ZERO:b}=w,E=TD(w,a*8);function S(A){return Mt(A,r)}function x(A){return S(ah(A))}function I(A){const _=n.BYTES;A=Bs("private key",A,_);const R=Bs("hashed private key",i(A),2*_),B=f(R.slice(0,_)),U=R.slice(_,2*_),L=x(B),j=N.multiply(L),q=j.toRawBytes();return{head:B,prefix:U,scalar:L,point:j,pointBytes:q}}function O(A){return I(A).pointBytes}function P(A=new Uint8Array,..._){const R=Lb(..._);return x(i(p(R,Bs("context",A),!!s)))}function k(A,_,R={}){A=Bs("message",A),s&&(A=s(A));const{prefix:B,scalar:U,pointBytes:L}=I(_),j=P(R.context,B,A),q=N.multiply(j).toRawBytes(),X=P(R.context,q,L,A),K=S(j+X*U);el("signature.s",K,kr,r);const se=Lb(q,Om(K,n.BYTES));return Bs("result",se,n.BYTES*2)}const M=kD;function $(A,_,R,B=M){const{context:U,zip215:L}=B,j=n.BYTES;A=Bs("signature",A,2*j),_=Bs("message",_),R=Bs("publicKey",R,j),L!==void 0&&qp("zip215",L),s&&(_=s(_));const q=ah(A.slice(j,2*j));let X,K,se;try{X=w.fromHex(R,L),K=w.fromHex(A.slice(0,j),L),se=N.multiplyUnsafe(q)}catch{return!1}if(!L&&X.isSmallOrder())return!1;const ge=P(U,K.toRawBytes(),X.toRawBytes(),_);return K.add(X.multiplyUnsafe(ge)).subtract(se).clearCofactor().equals(w.ZERO)}return N._setWindowSize(8),{CURVE:e,getPublicKey:O,sign:k,verify:$,ExtendedPoint:w,utils:{getExtendedPublicKey:I,randomPrivateKey:()=>o(n.BYTES),precompute(A=8,_=w.BASE){return _._setWindowSize(A),_.multiply(BigInt(3)),_}}}}BigInt(0),BigInt(1);const Ny=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),qb=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const BD=BigInt(1),Wb=BigInt(2);BigInt(3);const $D=BigInt(5),LD=BigInt(8);function MD(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=Ny,o=t*t%i*t%i,a=ss(o,Wb,i)*o%i,c=ss(a,BD,i)*t%i,l=ss(c,$D,i)*c%i,u=ss(l,e,i)*l%i,d=ss(u,n,i)*u%i,h=ss(d,r,i)*d%i,f=ss(h,s,i)*h%i,p=ss(f,s,i)*h%i,g=ss(p,e,i)*l%i;return{pow_p_5_8:ss(g,Wb,i)*t%i,b2:o}}function FD(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function jD(t,e){const n=Ny,r=Mt(e*e*e,n),s=Mt(r*r*e,n),i=MD(t*s).pow_p_5_8;let o=Mt(t*r*i,n);const a=Mt(e*o*o,n),c=o,l=Mt(o*qb,n),u=a===t,d=a===Mt(-t,n),h=a===Mt(-t*qb,n);return u&&(o=c),(d||h)&&(o=l),AD(o,n)&&(o=Mt(-o,n)),{isValid:u||d,value:o}}const HD=c_(Ny,void 0,!0),zD={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:HD,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:LD,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:uD,randomBytes:t_,adjustScalarBytes:FD,uvRatio:jD},d_=UD(zD),qD="EdDSA",WD="JWT",Bh=".",Of="base64url",h_="utf8",f_="utf8",VD=":",GD="did",KD="key",Vb="base58btc",JD="z",YD="K36",ZD=32;function Sy(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function p_(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Sy(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function g_(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=p_(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return Sy(n)}function QD(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,y=0,v=p.length;y!==v&&p[y]===0;)y++,g++;for(var w=(v-y)*u+1>>>0,N=new Uint8Array(w);y!==v;){for(var b=p[y],E=0,S=w-1;(b!==0||E<m)&&S!==-1;S--,E++)b+=256*N[S]>>>0,N[S]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");m=E,y++}for(var x=w-m;x!==w&&N[x]===0;)x++;for(var I=c.repeat(g);x<w;++x)I+=t.charAt(N[x]);return I}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,y=0;p[g]===c;)m++,g++;for(var v=(p.length-g)*l+1>>>0,w=new Uint8Array(v);p[g];){var N=n[p.charCodeAt(g)];if(N===255)return;for(var b=0,E=v-1;(N!==0||b<y)&&E!==-1;E--,b++)N+=a*w[E]>>>0,w[E]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");y=b,g++}if(p[g]!==" "){for(var S=v-y;S!==v&&w[S]===0;)S++;for(var x=new Uint8Array(m+(v-S)),I=m;S!==v;)x[I++]=w[S++];return x}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var XD=QD,e8=XD;const m_=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},t8=t=>new TextEncoder().encode(t),n8=t=>new TextDecoder().decode(t);let r8=class{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},s8=class{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return y_(this,e)}},i8=class{constructor(e){this.decoders=e}or(e){return y_(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const y_=(t,e)=>new i8({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let o8=class{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new r8(e,n,r),this.decoder=new s8(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Rf=({name:t,prefix:e,encode:n,decode:r})=>new o8(t,e,n,r),Xu=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=e8(n,e);return Rf({prefix:t,name:e,encode:r,decode:i=>m_(s(i))})},a8=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},c8=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},un=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>Rf({prefix:e,name:t,encode(s){return c8(s,r,n)},decode(s){return a8(s,r,n,t)}}),l8=Rf({prefix:"\0",name:"identity",encode:t=>n8(t),decode:t=>t8(t)});var u8=Object.freeze({__proto__:null,identity:l8});const d8=un({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var h8=Object.freeze({__proto__:null,base2:d8});const f8=un({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var p8=Object.freeze({__proto__:null,base8:f8});const g8=Xu({prefix:"9",name:"base10",alphabet:"0123456789"});var m8=Object.freeze({__proto__:null,base10:g8});const y8=un({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),w8=un({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var b8=Object.freeze({__proto__:null,base16:y8,base16upper:w8});const E8=un({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),v8=un({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),A8=un({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),C8=un({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),I8=un({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),_8=un({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),N8=un({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),S8=un({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),x8=un({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var T8=Object.freeze({__proto__:null,base32:E8,base32upper:v8,base32pad:A8,base32padupper:C8,base32hex:I8,base32hexupper:_8,base32hexpad:N8,base32hexpadupper:S8,base32z:x8});const P8=Xu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),O8=Xu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var R8=Object.freeze({__proto__:null,base36:P8,base36upper:O8});const k8=Xu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),D8=Xu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var U8=Object.freeze({__proto__:null,base58btc:k8,base58flickr:D8});const B8=un({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$8=un({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),L8=un({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),M8=un({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var F8=Object.freeze({__proto__:null,base64:B8,base64pad:$8,base64url:L8,base64urlpad:M8});const w_=Array.from(""),j8=w_.reduce((t,e,n)=>(t[n]=e,t),[]),H8=w_.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function z8(t){return t.reduce((e,n)=>(e+=j8[n],e),"")}function q8(t){const e=[];for(const n of t){const r=H8[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const W8=Rf({prefix:"",name:"base256emoji",encode:z8,decode:q8});var V8=Object.freeze({__proto__:null,base256emoji:W8}),G8=b_,Gb=128,K8=-128,J8=Math.pow(2,31);function b_(t,e,n){e=e||[],n=n||0;for(var r=n;t>=J8;)e[n++]=t&255|Gb,t/=128;for(;t&K8;)e[n++]=t&255|Gb,t>>>=7;return e[n]=t|0,b_.bytes=n-r+1,e}var Y8=km,Z8=128,Kb=127;function km(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw km.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&Kb)<<s:(o&Kb)*Math.pow(2,s),s+=7}while(o>=Z8);return km.bytes=i-r,n}var Q8=Math.pow(2,7),X8=Math.pow(2,14),eU=Math.pow(2,21),tU=Math.pow(2,28),nU=Math.pow(2,35),rU=Math.pow(2,42),sU=Math.pow(2,49),iU=Math.pow(2,56),oU=Math.pow(2,63),aU=function(t){return t<Q8?1:t<X8?2:t<eU?3:t<tU?4:t<nU?5:t<rU?6:t<sU?7:t<iU?8:t<oU?9:10},cU={encode:G8,decode:Y8,encodingLength:aU},E_=cU;const Jb=(t,e,n=0)=>(E_.encode(t,e,n),e),Yb=t=>E_.encodingLength(t),Dm=(t,e)=>{const n=e.byteLength,r=Yb(t),s=r+Yb(n),i=new Uint8Array(s+n);return Jb(t,i,0),Jb(n,i,r),i.set(e,s),new lU(t,n,e,i)};let lU=class{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}};const v_=({name:t,code:e,encode:n})=>new uU(t,e,n);let uU=class{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?Dm(this.code,n):n.then(r=>Dm(this.code,r))}else throw Error("Unknown type, must be binary type")}};const A_=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),dU=v_({name:"sha2-256",code:18,encode:A_("SHA-256")}),hU=v_({name:"sha2-512",code:19,encode:A_("SHA-512")});var fU=Object.freeze({__proto__:null,sha256:dU,sha512:hU});const C_=0,pU="identity",I_=m_,gU=t=>Dm(C_,I_(t)),mU={code:C_,name:pU,encode:I_,digest:gU};var yU=Object.freeze({__proto__:null,identity:mU});new TextEncoder,new TextDecoder;const Zb={...u8,...h8,...p8,...m8,...b8,...T8,...R8,...U8,...F8,...V8};({...fU,...yU});function __(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Qb=__("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Yp=__("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=p_(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),N_={utf8:Qb,"utf-8":Qb,hex:Zb.base16,latin1:Yp,ascii:Yp,binary:Yp,...Zb};function kf(t,e="utf8"){const n=N_[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}function Lc(t,e="utf8"){const n=N_[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Sy(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function Xb(t){return Qo(kf(Lc(t,Of),h_))}function $h(t){return kf(Lc(oi(t),h_),Of)}function S_(t){const e=Lc(YD,Vb),n=JD+kf(g_([e,t]),Vb);return[GD,KD,n].join(VD)}function wU(t){return kf(t,Of)}function bU(t){return Lc(t,Of)}function EU(t){return Lc([$h(t.header),$h(t.payload)].join(Bh),f_)}function vU(t){return[$h(t.header),$h(t.payload),wU(t.signature)].join(Bh)}function Um(t){const e=t.split(Bh),n=Xb(e[0]),r=Xb(e[1]),s=bU(e[2]),i=Lc(e.slice(0,2).join(Bh),f_);return{header:n,payload:r,signature:s,data:i}}function eE(t=t_(ZD)){const e=d_.getPublicKey(t);return{secretKey:g_([t,e]),publicKey:e}}async function AU(t,e,n,r,s=Q.fromMiliseconds(Date.now())){const i={alg:qD,typ:WD},o=S_(r.publicKey),a=s+n,c={iss:o,sub:t,aud:e,iat:s,exp:a},l=EU({header:i,payload:c}),u=d_.sign(l,r.secretKey.slice(0,32));return vU({header:i,payload:c,signature:u})}var tE=function(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))},CU=function(){function t(e,n,r){this.name=e,this.version=n,this.os=r,this.type="browser"}return t}(),IU=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),_U=function(){function t(e,n,r,s){this.name=e,this.version=n,this.os=r,this.bot=s,this.type="bot-device"}return t}(),NU=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),SU=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),xU=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,TU=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,nE=3,PU=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",xU]],rE=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function OU(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new SU:typeof navigator<"u"?kU(navigator.userAgent):UU()}function RU(t){return t!==""&&PU.reduce(function(e,n){var r=n[0],s=n[1];if(e)return e;var i=s.exec(t);return!!i&&[r,i]},!1)}function kU(t){var e=RU(t);if(!e)return null;var n=e[0],r=e[1];if(n==="searchbot")return new NU;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<nE&&(s=tE(tE([],s,!0),BU(nE-s.length),!0)):s=[];var i=s.join("."),o=DU(t),a=TU.exec(t);return a&&a[1]?new _U(n,i,o,a[1]):new CU(n,i,o)}function DU(t){for(var e=0,n=rE.length;e<n;e++){var r=rE[e],s=r[0],i=r[1],o=i.exec(t);if(o)return s}return null}function UU(){var t=typeof process<"u"&&process.version;return t?new IU(process.version.slice(1)):null}function BU(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}var ot={},sE;function x_(){if(sE)return ot;sE=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.getLocalStorage=ot.getLocalStorageOrThrow=ot.getCrypto=ot.getCryptoOrThrow=ot.getLocation=ot.getLocationOrThrow=ot.getNavigator=ot.getNavigatorOrThrow=ot.getDocument=ot.getDocumentOrThrow=ot.getFromWindowOrThrow=ot.getFromWindow=void 0;function t(h){let f;return typeof window<"u"&&typeof window[h]<"u"&&(f=window[h]),f}ot.getFromWindow=t;function e(h){const f=t(h);if(!f)throw new Error(`${h} is not defined in Window`);return f}ot.getFromWindowOrThrow=e;function n(){return e("document")}ot.getDocumentOrThrow=n;function r(){return t("document")}ot.getDocument=r;function s(){return e("navigator")}ot.getNavigatorOrThrow=s;function i(){return t("navigator")}ot.getNavigator=i;function o(){return e("location")}ot.getLocationOrThrow=o;function a(){return t("location")}ot.getLocation=a;function c(){return e("crypto")}ot.getCryptoOrThrow=c;function l(){return t("crypto")}ot.getCrypto=l;function u(){return e("localStorage")}ot.getLocalStorageOrThrow=u;function d(){return t("localStorage")}return ot.getLocalStorage=d,ot}var ai=x_(),tl={},iE;function $U(){if(iE)return tl;iE=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.getWindowMetadata=void 0;const t=x_();function e(){let n,r;try{n=t.getDocumentOrThrow(),r=t.getLocationOrThrow()}catch{return null}function s(){const f=n.getElementsByTagName("link"),p=[];for(let g=0;g<f.length;g++){const m=f[g],y=m.getAttribute("rel");if(y&&y.toLowerCase().indexOf("icon")>-1){const v=m.getAttribute("href");if(v)if(v.toLowerCase().indexOf("https:")===-1&&v.toLowerCase().indexOf("http:")===-1&&v.indexOf("//")!==0){let w=r.protocol+"//"+r.host;if(v.indexOf("/")===0)w+=v;else{const N=r.pathname.split("/");N.pop();const b=N.join("/");w+=b+"/"+v}p.push(w)}else if(v.indexOf("//")===0){const w=r.protocol+v;p.push(w)}else p.push(v)}}return p}function i(...f){const p=n.getElementsByTagName("meta");for(let g=0;g<p.length;g++){const m=p[g],y=["itemprop","property","name"].map(v=>m.getAttribute(v)).filter(v=>v?f.includes(v):!1);if(y.length&&y){const v=m.getAttribute("content");if(v)return v}}return""}function o(){let f=i("name","og:site_name","og:title","twitter:title");return f||(f=n.title),f}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),l=a(),u=r.origin,d=s();return{description:l,url:u,icons:d,name:c}}return tl.getWindowMetadata=e,tl}var LU=$U();function fu(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function Bm(t){return fu(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const T_="2.31.0";let Zp={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${T_}`},Df=class $m extends Error{constructor(e,n={}){const r=n.cause instanceof $m?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof $m&&n.cause.docsPath||n.docsPath,i=Zp.getDocsUrl?.({...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...Zp.version?[`Version: ${Zp.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=T_}walk(e){return P_(this,e)}};function P_(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?P_(t.cause,e):e?null:t}class O_ extends Df{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function Mc(t,{dir:e,size:n=32}={}){return typeof t=="string"?MU(t,{dir:e,size:n}):FU(t,{dir:e,size:n})}function MU(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new O_({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function FU(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new O_({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}class jU extends Df{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class HU extends Df{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Fc(t,{size:e}){if(Bm(t)>e)throw new HU({givenSize:Bm(t),maxSize:e})}function Lm(t,e={}){const{signed:n}=e;e.size&&Fc(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function zU(t,e={}){return Number(Lm(t,e))}const qU=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Mm(t,e={}){return typeof t=="number"||typeof t=="bigint"?k_(t,e):typeof t=="string"?GU(t,e):typeof t=="boolean"?WU(t,e):R_(t,e)}function WU(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Fc(n,{size:e.size}),Mc(n,{size:e.size})):n}function R_(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=qU[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Fc(r,{size:e.size}),Mc(r,{dir:"right",size:e.size})):r}function k_(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new jU({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${t}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Mc(a,{size:r}):a}const VU=new TextEncoder;function GU(t,e={}){const n=VU.encode(t);return R_(n,e)}const KU=new TextEncoder;function JU(t,e={}){return typeof t=="number"||typeof t=="bigint"?ZU(t,e):typeof t=="boolean"?YU(t,e):fu(t)?D_(t,e):U_(t,e)}function YU(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(Fc(n,{size:e.size}),Mc(n,{size:e.size})):n}const $s={zero:48,nine:57,A:65,F:70,a:97,f:102};function oE(t){if(t>=$s.zero&&t<=$s.nine)return t-$s.zero;if(t>=$s.A&&t<=$s.F)return t-($s.A-10);if(t>=$s.a&&t<=$s.f)return t-($s.a-10)}function D_(t,e={}){let n=t;e.size&&(Fc(n,{size:e.size}),n=Mc(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=oE(r.charCodeAt(a++)),l=oE(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new Df(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+l}return i}function ZU(t,e){const n=k_(t,e);return D_(n)}function U_(t,e={}){const n=KU.encode(t);return typeof e.size=="number"?(Fc(n,{size:e.size}),Mc(n,{dir:"right",size:e.size})):n}const Pd=BigInt(2**32-1),aE=BigInt(32);function QU(t,e=!1){return e?{h:Number(t&Pd),l:Number(t>>aE&Pd)}:{h:Number(t>>aE&Pd)|0,l:Number(t&Pd)|0}}function XU(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=QU(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const eB=(t,e,n)=>t<<n|e>>>32-n,tB=(t,e,n)=>e<<n|t>>>32-n,nB=(t,e,n)=>e<<n-32|t>>>64-n,rB=(t,e,n)=>t<<n-32|e>>>64-n,Ia=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function sB(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Lh(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function pu(t,...e){if(!sB(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function dne(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Lh(t.outputLen),Lh(t.blockLen)}function cE(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function iB(t,e){pu(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function oB(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function B_(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function hne(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function fne(t,e){return t<<32-e|t>>>e}const aB=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function cB(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function lB(t){for(let e=0;e<t.length;e++)t[e]=cB(t[e]);return t}const lE=aB?t=>t:lB;function uB(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function $_(t){return typeof t=="string"&&(t=uB(t)),pu(t),t}function pne(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];pu(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let dB=class{};function hB(t){const e=r=>t().update($_(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function mne(t=32){if(Ia&&typeof Ia.getRandomValues=="function")return Ia.getRandomValues(new Uint8Array(t));if(Ia&&typeof Ia.randomBytes=="function")return Uint8Array.from(Ia.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const fB=BigInt(0),nl=BigInt(1),pB=BigInt(2),gB=BigInt(7),mB=BigInt(256),yB=BigInt(113),L_=[],M_=[],F_=[];for(let t=0,e=nl,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],L_.push(2*(5*r+n)),M_.push((t+1)*(t+2)/2%64);let s=fB;for(let i=0;i<7;i++)e=(e<<nl^(e>>gB)*yB)%mB,e&pB&&(s^=nl<<(nl<<BigInt(i))-nl);F_.push(s)}const j_=XU(F_,!0),wB=j_[0],bB=j_[1],uE=(t,e,n)=>n>32?nB(t,e,n):eB(t,e,n),dE=(t,e,n)=>n>32?rB(t,e,n):tB(t,e,n);function EB(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=uE(l,u,1)^n[a],h=dE(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=M_[o],c=uE(s,i,a),l=dE(s,i,a),u=L_[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=wB[r],t[1]^=bB[r]}B_(n)}let vB=class H_ extends dB{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Lh(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=oB(this.state)}clone(){return this._cloneInto()}keccak(){lE(this.state32),EB(this.state32,this.rounds),lE(this.state32),this.posOut=0,this.pos=0}update(e){cE(this),e=$_(e),pu(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){cE(this,!1),pu(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Lh(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(iB(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,B_(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new H_(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const AB=(t,e,n)=>hB(()=>new vB(e,t,n)),CB=AB(1,136,256/8);function z_(t,e){const n=e||"hex",r=CB(fu(t,{strict:!1})?JU(t):t);return n==="bytes"?r:Mm(r)}class IB extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const Qp=new IB(8192);function _B(t,e){if(Qp.has(`${t}.${e}`))return Qp.get(`${t}.${e}`);const n=t.substring(2).toLowerCase(),r=z_(U_(n),"bytes"),s=n.split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Qp.set(`${t}.${e}`,i),i}function NB(t){const e=z_(`0x${t.substring(4)}`).substring(26);return _B(`0x${e}`)}async function SB({hash:t,signature:e}){const n=fu(t)?t:Mm(t),{secp256k1:r}=await nn(async()=>{const{secp256k1:o}=await import("./secp256k1-BSgERAN1.js");return{secp256k1:o}},[]);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:d,yParity:h}=e,f=Number(h??d),p=hE(f);return new r.Signature(Lm(l),Lm(u)).addRecoveryBit(p)}const o=fu(e)?e:Mm(e);if(Bm(o)!==65)throw new Error("invalid signature length");const a=zU(`0x${o.slice(130)}`),c=hE(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function hE(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function xB({hash:t,signature:e}){return NB(await SB({hash:t,signature:e}))}function TB(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const f=l.length;for(;h!==f&&l[h]===0;)h++,u++;const p=(f-h)*i+1>>>0,g=new Uint8Array(p);for(;h!==f;){let v=l[h],w=0;for(let N=p-1;(v!==0||w<d)&&N!==-1;N--,w++)v+=256*g[N]>>>0,g[N]=v%n>>>0,v=v/n>>>0;if(v!==0)throw new Error("Non-zero carry");d=w,h++}let m=p-d;for(;m!==p&&g[m]===0;)m++;let y=r.repeat(u);for(;m<p;++m)y+=t.charAt(g[m]);return y}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===r;)d++,u++;const f=(l.length-u)*s+1>>>0,p=new Uint8Array(f);for(;u<l.length;){const v=l.charCodeAt(u);if(v>255)return;let w=e[v];if(w===255)return;let N=0;for(let b=f-1;(w!==0||N<h)&&b!==-1;b--,N++)w+=n*p[b]>>>0,p[b]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");h=N,u++}let g=f-h;for(;g!==f&&p[g]===0;)g++;const m=new Uint8Array(d+(f-g));let y=d;for(;g!==f;)m[y++]=p[g++];return m}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var PB="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const jc=TB(PB);function OB(t){const e=t.length;let n=0,r=0;for(;r<e;){let s=t.charCodeAt(r++);if((s&4294967168)===0){n++;continue}else if((s&4294965248)===0)n+=2;else{if(s>=55296&&s<=56319&&r<e){const i=t.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}(s&4294901760)===0?n+=3:n+=4}}return n}function RB(t,e,n){const r=t.length;let s=n,i=0;for(;i<r;){let o=t.charCodeAt(i++);if((o&4294967168)===0){e[s++]=o;continue}else if((o&4294965248)===0)e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128):(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128)}e[s++]=o&63|128}}const kB=new TextEncoder,DB=50;function UB(t,e,n){kB.encodeInto(t,e.subarray(n))}function BB(t,e,n){t.length>DB?UB(t,e,n):RB(t,e,n)}const $B=4096;function q_(t,e,n){let r=e;const s=r+n,i=[];let o="";for(;r<s;){const a=t[r++];if((a&128)===0)i.push(a);else if((a&224)===192){const c=t[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=t[r++]&63,l=t[r++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=t[r++]&63,l=t[r++]&63,u=t[r++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=$B&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const LB=new TextDecoder,MB=200;function FB(t,e,n){const r=t.subarray(e,e+n);return LB.decode(r)}function jB(t,e,n){return n>MB?FB(t,e,n):q_(t,e,n)}class Od{constructor(e,n){this.type=e,this.data=n}}class tr extends Error{constructor(e){super(e);const n=Object.create(tr.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:tr.name})}}const rl=4294967295;function HB(t,e,n){const r=n/4294967296,s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function W_(t,e,n){const r=Math.floor(n/4294967296),s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function V_(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function zB(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const qB=-1,WB=4294967296-1,VB=17179869184-1;function GB({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=VB)if(e===0&&t<=WB){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),W_(r,4,t),n}}function KB(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function JB(t){if(t instanceof Date){const e=KB(t);return GB(e)}else return null}function YB(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=V_(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new tr(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function ZB(t){const e=YB(t);return new Date(e.sec*1e3+e.nsec/1e6)}const QB={type:qB,encode:JB,decode:ZB};class Mh{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(QB)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=-1-r;return new Od(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=r;return new Od(o,i)}}}return e instanceof Od?e:null}decode(e,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(e,n,r):new Od(n,e)}}Mh.defaultCodec=new Mh;function XB(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function Fm(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):XB(t)?new Uint8Array(t):Uint8Array.from(t)}const e$=100,t$=2048;let n$=class G_{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??Mh.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??e$,this.initialBufferSize=e?.initialBufferSize??t$,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new G_({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=OB(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),BB(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=Fm(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,n+1)}countWithoutUndefined(e,n){let r=0;for(const s of n)e[s]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),HB(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),W_(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function r$(t,e){return new n$(e).encodeSharedRef(t)}function Xp(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const s$=16,i$=16;class o${constructor(e=s$,n=i$){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==e[n+a])continue e;return i.str}return null}store(e,n){const r=this.caches[e.length-1],s={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,n,r){const s=this.find(e,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=q_(e,n,r),o=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(o,i),i}}const jm="array",xl="map_key",K_="map_value",a$=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new tr("The type of key must be string or number but "+typeof t)};class c${constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=jm,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=xl,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===jm){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===xl||e.type===K_){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const sl=-1,xy=new DataView(new ArrayBuffer(0)),l$=new Uint8Array(xy.buffer);try{xy.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const fE=new RangeError("Insufficient data"),u$=new o$;let d$=class J_{constructor(e){this.totalPos=0,this.pos=0,this.view=xy,this.bytes=l$,this.headByte=sl,this.stack=new c$,this.entered=!1,this.extensionCodec=e?.extensionCodec??Mh.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??rl,this.maxBinLength=e?.maxBinLength??rl,this.maxArrayLength=e?.maxArrayLength??rl,this.maxMapLength=e?.maxMapLength??rl,this.maxExtLength=e?.maxExtLength??rl,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:u$,this.mapKeyConverter=e?.mapKeyConverter??a$}clone(){return new J_({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=sl,this.stack.reset()}setBuffer(e){const n=Fm(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===sl&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=Fm(e),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const a of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Xp(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of e){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=e-160;n=this.decodeString(s,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new tr(`Unrecognized type byte: ${Xp(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===jm)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===xl){if(n==="__proto__")throw new tr("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=K_;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=xl;continue e}}return n}}readHeadByte(){return this.headByte===sl&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=sl}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new tr(`Unrecognized array type byte: ${Xp(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new tr(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new tr(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new tr(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw fE;const r=this.pos+n;let s;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?s=this.keyDecoder.decode(this.bytes,r,e):s=jB(this.bytes,r,e),this.pos+=n+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===xl:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new tr(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw fE;const r=this.pos+n,s=this.bytes.subarray(r,r+e);return this.pos+=n+e,s}decodeExtension(e,n){if(e>this.maxExtLength)throw new tr(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(e,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=zB(this.view,this.pos);return this.pos+=8,e}readI64(){const e=V_(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function h$(t,e){return new d$(e).decode(t)}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function f$(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Y_(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(n=>typeof n=="string"):e.every(n=>Number.isSafeInteger(n)):!1}function Fh(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function Ty(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function Hm(t){if(!Array.isArray(t))throw new Error("array expected")}function jh(t,e){if(!Y_(!0,e))throw new Error(`${t}: array of strings expected`)}function p$(t,e){if(!Y_(!1,e))throw new Error(`${t}: array of numbers expected`)}function g$(...t){const e=i=>i,n=(i,o)=>a=>i(o(a)),r=t.map(i=>i.encode).reduceRight(n,e),s=t.map(i=>i.decode).reduce(n,e);return{encode:r,decode:s}}function m$(t){const e=typeof t=="string"?t.split(""):t,n=e.length;jh("alphabet",e);const r=new Map(e.map((s,i)=>[s,i]));return{encode:s=>(Hm(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${t}`);return e[i]})),decode:s=>(Hm(s),s.map(i=>{Fh("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${t}`);return o}))}}function y$(t=""){return Fh("join",t),{encode:e=>(jh("join.decode",e),e.join(t)),decode:e=>(Fh("join.decode",e),e.split(t))}}function w$(t,e="="){return Ty(t),Fh("padding",e),{encode(n){for(jh("padding.encode",n);n.length*t%8;)n.push(e);return n},decode(n){jh("padding.decode",n);let r=n.length;if(r*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if((r-1)*t%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}const Z_=(t,e)=>e===0?t:Z_(e,t%e),Hh=(t,e)=>t+(e-Z_(t,e)),eg=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function pE(t,e,n,r){if(Hm(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Hh(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${Hh(e,n)}`);let s=0,i=0;const o=eg[e],a=eg[n]-1,c=[];for(const l of t){if(Ty(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${e}`);if(s=s<<e|l,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)c.push((s>>i-n&a)>>>0);const u=eg[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<n-i&a,!r&&i>=e)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&c.push(s>>>0),c}function b$(t,e=!1){if(Ty(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(Hh(8,t)>32||Hh(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!f$(n))throw new Error("radix2.encode input should be Uint8Array");return pE(Array.from(n),8,t,!e)},decode:n=>(p$("radix2.decode",n),Uint8Array.from(pE(n,t,8,e)))}}const E$=g$(b$(5),m$("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),w$(5),y$(""));function Py(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Q_(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Py(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Tl(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=Q_(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return Py(n)}function v$(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,y=0,v=p.length;y!==v&&p[y]===0;)y++,g++;for(var w=(v-y)*u+1>>>0,N=new Uint8Array(w);y!==v;){for(var b=p[y],E=0,S=w-1;(b!==0||E<m)&&S!==-1;S--,E++)b+=256*N[S]>>>0,N[S]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");m=E,y++}for(var x=w-m;x!==w&&N[x]===0;)x++;for(var I=c.repeat(g);x<w;++x)I+=t.charAt(N[x]);return I}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,y=0;p[g]===c;)m++,g++;for(var v=(p.length-g)*l+1>>>0,w=new Uint8Array(v);p[g];){var N=n[p.charCodeAt(g)];if(N===255)return;for(var b=0,E=v-1;(N!==0||b<y)&&E!==-1;E--,b++)N+=a*w[E]>>>0,w[E]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");y=b,g++}if(p[g]!==" "){for(var S=v-y;S!==v&&w[S]===0;)S++;for(var x=new Uint8Array(m+(v-S)),I=m;S!==v;)x[I++]=w[S++];return x}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var A$=v$,C$=A$;const I$=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},_$=t=>new TextEncoder().encode(t),N$=t=>new TextDecoder().decode(t);class S${constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class x${constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return X_(this,e)}}class T${constructor(e){this.decoders=e}or(e){return X_(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const X_=(t,e)=>new T$({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class P${constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new S$(e,n,r),this.decoder=new x$(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Uf=({name:t,prefix:e,encode:n,decode:r})=>new P$(t,e,n,r),ed=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=C$(n,e);return Uf({prefix:t,name:e,encode:r,decode:i=>I$(s(i))})},O$=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},R$=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},dn=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>Uf({prefix:e,name:t,encode(s){return R$(s,r,n)},decode(s){return O$(s,r,n,t)}}),k$=Uf({prefix:"\0",name:"identity",encode:t=>N$(t),decode:t=>_$(t)}),D$=Object.freeze(Object.defineProperty({__proto__:null,identity:k$},Symbol.toStringTag,{value:"Module"})),U$=dn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),B$=Object.freeze(Object.defineProperty({__proto__:null,base2:U$},Symbol.toStringTag,{value:"Module"})),$$=dn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),L$=Object.freeze(Object.defineProperty({__proto__:null,base8:$$},Symbol.toStringTag,{value:"Module"})),M$=ed({prefix:"9",name:"base10",alphabet:"0123456789"}),F$=Object.freeze(Object.defineProperty({__proto__:null,base10:M$},Symbol.toStringTag,{value:"Module"})),j$=dn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),H$=dn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),z$=Object.freeze(Object.defineProperty({__proto__:null,base16:j$,base16upper:H$},Symbol.toStringTag,{value:"Module"})),q$=dn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),W$=dn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),V$=dn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),G$=dn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),K$=dn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),J$=dn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Y$=dn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Z$=dn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Q$=dn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),X$=Object.freeze(Object.defineProperty({__proto__:null,base32:q$,base32hex:K$,base32hexpad:Y$,base32hexpadupper:Z$,base32hexupper:J$,base32pad:V$,base32padupper:G$,base32upper:W$,base32z:Q$},Symbol.toStringTag,{value:"Module"})),e4=ed({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),t4=ed({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),n4=Object.freeze(Object.defineProperty({__proto__:null,base36:e4,base36upper:t4},Symbol.toStringTag,{value:"Module"})),r4=ed({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s4=ed({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),i4=Object.freeze(Object.defineProperty({__proto__:null,base58btc:r4,base58flickr:s4},Symbol.toStringTag,{value:"Module"})),o4=dn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),a4=dn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),c4=dn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),l4=dn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),u4=Object.freeze(Object.defineProperty({__proto__:null,base64:o4,base64pad:a4,base64url:c4,base64urlpad:l4},Symbol.toStringTag,{value:"Module"})),e2=Array.from(""),d4=e2.reduce((t,e,n)=>(t[n]=e,t),[]),h4=e2.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function f4(t){return t.reduce((e,n)=>(e+=d4[n],e),"")}function p4(t){const e=[];for(const n of t){const r=h4[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const g4=Uf({prefix:"",name:"base256emoji",encode:f4,decode:p4}),m4=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:g4},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const gE={...D$,...B$,...L$,...F$,...z$,...X$,...n4,...i4,...u4,...m4};function t2(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const mE=t2("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),tg=t2("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=Q_(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),n2={utf8:mE,"utf-8":mE,hex:gE.base16,latin1:tg,ascii:tg,binary:tg,...gE};function Er(t,e="utf8"){const n=n2[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Py(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function Wn(t,e="utf8"){const n=n2[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}const y4={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var ng,yE;function r2(){if(yE)return ng;yE=1;const t="Input must be an string, Buffer or Uint8Array";function e(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(t);return a}function n(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function r(o){return(4294967296+o).toString(16).substring(1)}function s(o,a,c){let l=`
`+o+" = ";for(let u=0;u<a.length;u+=2){if(c===32)l+=r(a[u]).toUpperCase(),l+=" ",l+=r(a[u+1]).toUpperCase();else if(c===64)l+=r(a[u+1]).toUpperCase(),l+=r(a[u]).toUpperCase();else throw new Error("Invalid size "+c);u%6===4?l+=`
`+new Array(o.length+4).join(" "):u<a.length-2&&(l+=" ")}console.log(l)}function i(o,a,c){let l=new Date().getTime();const u=new Uint8Array(a);for(let h=0;h<a;h++)u[h]=h%256;const d=new Date().getTime();console.log("Generated random input in "+(d-l)+"ms"),l=d;for(let h=0;h<c;h++){const f=o(u),p=new Date().getTime(),g=p-l;l=p,console.log("Hashed in "+g+"ms: "+f.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(g/1e3)*100)/100+" MB PER SECOND")}}return ng={normalizeInput:e,toHex:n,debugPrint:s,testSpeed:i},ng}var rg,wE;function w4(){if(wE)return rg;wE=1;const t=r2();function e(y,v,w){const N=y[v]+y[w];let b=y[v+1]+y[w+1];N>=4294967296&&b++,y[v]=N,y[v+1]=b}function n(y,v,w,N){let b=y[v]+w;w<0&&(b+=4294967296);let E=y[v+1]+N;b>=4294967296&&E++,y[v]=b,y[v+1]=E}function r(y,v){return y[v]^y[v+1]<<8^y[v+2]<<16^y[v+3]<<24}function s(y,v,w,N,b,E){const S=l[b],x=l[b+1],I=l[E],O=l[E+1];e(c,y,v),n(c,y,S,x);let P=c[N]^c[y],k=c[N+1]^c[y+1];c[N]=k,c[N+1]=P,e(c,w,N),P=c[v]^c[w],k=c[v+1]^c[w+1],c[v]=P>>>24^k<<8,c[v+1]=k>>>24^P<<8,e(c,y,v),n(c,y,I,O),P=c[N]^c[y],k=c[N+1]^c[y+1],c[N]=P>>>16^k<<16,c[N+1]=k>>>16^P<<16,e(c,w,N),P=c[v]^c[w],k=c[v+1]^c[w+1],c[v]=k>>>31^P<<1,c[v+1]=P>>>31^k<<1}const i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(y){return y*2})),c=new Uint32Array(32),l=new Uint32Array(32);function u(y,v){let w=0;for(w=0;w<16;w++)c[w]=y.h[w],c[w+16]=i[w];for(c[24]=c[24]^y.t,c[25]=c[25]^y.t/4294967296,v&&(c[28]=~c[28],c[29]=~c[29]),w=0;w<32;w++)l[w]=r(y.b,4*w);for(w=0;w<12;w++)s(0,8,16,24,a[w*16+0],a[w*16+1]),s(2,10,18,26,a[w*16+2],a[w*16+3]),s(4,12,20,28,a[w*16+4],a[w*16+5]),s(6,14,22,30,a[w*16+6],a[w*16+7]),s(0,10,20,30,a[w*16+8],a[w*16+9]),s(2,12,22,24,a[w*16+10],a[w*16+11]),s(4,14,16,26,a[w*16+12],a[w*16+13]),s(6,8,18,28,a[w*16+14],a[w*16+15]);for(w=0;w<16;w++)y.h[w]=y.h[w]^c[w]^c[w+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function h(y,v,w,N){if(y===0||y>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(v&&v.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(w&&w.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(N&&N.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const b={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:y};d.fill(0),d[0]=y,v&&(d[1]=v.length),d[2]=1,d[3]=1,w&&d.set(w,32),N&&d.set(N,48);for(let E=0;E<16;E++)b.h[E]=i[E]^r(d,E*4);return v&&(f(b,v),b.c=128),b}function f(y,v){for(let w=0;w<v.length;w++)y.c===128&&(y.t+=y.c,u(y,!1),y.c=0),y.b[y.c++]=v[w]}function p(y){for(y.t+=y.c;y.c<128;)y.b[y.c++]=0;u(y,!0);const v=new Uint8Array(y.outlen);for(let w=0;w<y.outlen;w++)v[w]=y.h[w>>2]>>8*(w&3);return v}function g(y,v,w,N,b){w=w||64,y=t.normalizeInput(y),N&&(N=t.normalizeInput(N)),b&&(b=t.normalizeInput(b));const E=h(w,v,N,b);return f(E,y),p(E)}function m(y,v,w,N,b){const E=g(y,v,w,N,b);return t.toHex(E)}return rg={blake2b:g,blake2bHex:m,blake2bInit:h,blake2bUpdate:f,blake2bFinal:p},rg}var sg,bE;function b4(){if(bE)return sg;bE=1;const t=r2();function e(p,g){return p[g]^p[g+1]<<8^p[g+2]<<16^p[g+3]<<24}function n(p,g,m,y,v,w){o[p]=o[p]+o[g]+v,o[y]=r(o[y]^o[p],16),o[m]=o[m]+o[y],o[g]=r(o[g]^o[m],12),o[p]=o[p]+o[g]+w,o[y]=r(o[y]^o[p],8),o[m]=o[m]+o[y],o[g]=r(o[g]^o[m],7)}function r(p,g){return p>>>g^p<<32-g}const s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),i=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(p,g){let m=0;for(m=0;m<8;m++)o[m]=p.h[m],o[m+8]=s[m];for(o[12]^=p.t,o[13]^=p.t/4294967296,g&&(o[14]=~o[14]),m=0;m<16;m++)a[m]=e(p.b,4*m);for(m=0;m<10;m++)n(0,4,8,12,a[i[m*16+0]],a[i[m*16+1]]),n(1,5,9,13,a[i[m*16+2]],a[i[m*16+3]]),n(2,6,10,14,a[i[m*16+4]],a[i[m*16+5]]),n(3,7,11,15,a[i[m*16+6]],a[i[m*16+7]]),n(0,5,10,15,a[i[m*16+8]],a[i[m*16+9]]),n(1,6,11,12,a[i[m*16+10]],a[i[m*16+11]]),n(2,7,8,13,a[i[m*16+12]],a[i[m*16+13]]),n(3,4,9,14,a[i[m*16+14]],a[i[m*16+15]]);for(m=0;m<8;m++)p.h[m]^=o[m]^o[m+8]}function l(p,g){if(!(p>0&&p<=32))throw new Error("Incorrect output length, should be in [1, 32]");const m=g?g.length:0;if(g&&!(m>0&&m<=32))throw new Error("Incorrect key length, should be in [1, 32]");const y={h:new Uint32Array(s),b:new Uint8Array(64),c:0,t:0,outlen:p};return y.h[0]^=16842752^m<<8^p,m>0&&(u(y,g),y.c=64),y}function u(p,g){for(let m=0;m<g.length;m++)p.c===64&&(p.t+=p.c,c(p,!1),p.c=0),p.b[p.c++]=g[m]}function d(p){for(p.t+=p.c;p.c<64;)p.b[p.c++]=0;c(p,!0);const g=new Uint8Array(p.outlen);for(let m=0;m<p.outlen;m++)g[m]=p.h[m>>2]>>8*(m&3)&255;return g}function h(p,g,m){m=m||32,p=t.normalizeInput(p);const y=l(m,g);return u(y,p),d(y)}function f(p,g,m){const y=h(p,g,m);return t.toHex(y)}return sg={blake2s:h,blake2sHex:f,blake2sInit:l,blake2sUpdate:u,blake2sFinal:d},sg}var ig,EE;function E4(){if(EE)return ig;EE=1;const t=w4(),e=b4();return ig={blake2b:t.blake2b,blake2bHex:t.blake2bHex,blake2bInit:t.blake2bInit,blake2bUpdate:t.blake2bUpdate,blake2bFinal:t.blake2bFinal,blake2s:e.blake2s,blake2sHex:e.blake2sHex,blake2sInit:e.blake2sInit,blake2sUpdate:e.blake2sUpdate,blake2sFinal:e.blake2sFinal},ig}var v4=E4(),A4={};const C4=":";function nc(t){const[e,n]=t.split(C4);return{namespace:e,reference:n}}function s2(t,e){return t.includes(":")?[t]:e.chains||[]}var I4=Object.defineProperty,_4=Object.defineProperties,N4=Object.getOwnPropertyDescriptors,vE=Object.getOwnPropertySymbols,S4=Object.prototype.hasOwnProperty,x4=Object.prototype.propertyIsEnumerable,zm=(t,e,n)=>e in t?I4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,AE=(t,e)=>{for(var n in e||(e={}))S4.call(e,n)&&zm(t,n,e[n]);if(vE)for(var n of vE(e))x4.call(e,n)&&zm(t,n,e[n]);return t},T4=(t,e)=>_4(t,N4(e)),CE=(t,e,n)=>zm(t,typeof e!="symbol"?e+"":e,n);const P4="ReactNative",sr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},O4="js";function zh(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function ao(){return!ai.getDocument()&&!!ai.getNavigator()&&navigator.product===P4}function R4(){return ao()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function k4(){return ao()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Hc(){return!zh()&&!!ai.getNavigator()&&!!ai.getDocument()}function td(){return ao()?sr.reactNative:zh()?sr.node:Hc()?sr.browser:sr.unknown}function IE(){var t;try{return ao()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function D4(t,e){const n=new URLSearchParams(t);for(const r of Object.keys(e).sort())if(e.hasOwnProperty(r)){const s=e[r];s!==void 0&&n.set(r,s)}return n.toString()}function U4(t){var e,n;const r=i2();try{return t!=null&&t.url&&r.url&&new URL(t.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),t.url=r.url),(e=t?.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),T4(AE(AE({},r),t),{url:t?.url||r.url,name:t?.name||r.name,description:t?.description||r.description,icons:(n=t?.icons)!=null&&n.length&&t.icons.length>0?t.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),t||r}}function i2(){return LU.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function B4(){if(td()===sr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const t=OU();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function $4(){var t;const e=td();return e===sr.browser?[e,((t=ai.getLocation())==null?void 0:t.host)||"unknown"].join(":"):e}function o2(t,e,n){const r=B4(),s=$4();return[[t,e].join("-"),[O4,n].join("-"),r,s].join("/")}function L4({protocol:t,version:e,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=n.split("?"),u=o2(t,e,r),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=D4(l[1]||"",d);return l[0]+"?"+h}function Oo(t,e){return t.filter(n=>e.includes(n)).length===t.length}function qm(t){return Object.fromEntries(t.entries())}function Wm(t){return new Map(Object.entries(t))}function Eo(t=Q.FIVE_MINUTES,e){const n=Q.toMiliseconds(t||Q.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},n),r=a,s=c})}}function zi(t,e,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),e);try{const o=await t;r(o)}catch(o){s(o)}clearTimeout(i)})}function a2(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function M4(t){return a2("topic",t)}function F4(t){return a2("id",t)}function c2(t){const[e,n]=t.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof n=="string")r.topic=n;else if(e==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${n}`);return r}function $t(t,e){return Q.fromMiliseconds(Date.now()+Q.toMiliseconds(t))}function ki(t){return Date.now()>=Q.toMiliseconds(t)}function Ze(t,e){return`${t}${e?`:${e}`:""}`}function Es(t=[],e=[]){return[...new Set([...t,...e])]}async function j4({id:t,topic:e,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s?.href;if(typeof i!="string")return;const o=H4(i,t,e),a=td();if(a===sr.browser){if(!((r=ai.getDocument())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}z4(o)}else a===sr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function H4(t,e,n){const r=`requestId=${e}&sessionTopic=${n}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${G4(r,!0)}`}else s=`${s}/wc?${r}`;return s}function z4(t){let e="_self";V4()?e="_top":(W4()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function q4(t,e){let n="";try{if(Hc()&&(n=localStorage.getItem(e),n))return n;n=await t.getItem(e)}catch(r){console.error(r)}return n}function _E(t,e){if(!t.includes(e))return null;const n=t.split(/([&,?,=])/),r=n.indexOf(e);return n[r+2]}function NE(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function Oy(){return typeof process<"u"&&A4.IS_VITEST==="true"}function W4(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function V4(){try{return window.self!==window.top}catch{return!1}}function G4(t,e=!1){const n=Buffer.from(t).toString("base64");return e?n.replace(/[=]/g,""):n}function l2(t){return Buffer.from(t,"base64").toString("utf-8")}function K4(t){return new Promise(e=>setTimeout(e,t))}let J4=class{constructor({limit:e}){CE(this,"limit"),CE(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(e)}}has(e){return this.set.has(e)}};const Rd=BigInt(2**32-1),SE=BigInt(32);function u2(t,e=!1){return e?{h:Number(t&Rd),l:Number(t>>SE&Rd)}:{h:Number(t>>SE&Rd)|0,l:Number(t&Rd)|0}}function d2(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=u2(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const xE=(t,e,n)=>t>>>n,TE=(t,e,n)=>t<<32-n|e>>>n,Di=(t,e,n)=>t>>>n|e<<32-n,Ui=(t,e,n)=>t<<32-n|e>>>n,wl=(t,e,n)=>t<<64-n|e>>>n-32,bl=(t,e,n)=>t>>>n-32|e<<64-n,Y4=(t,e)=>e,Z4=(t,e)=>t,Q4=(t,e,n)=>t<<n|e>>>32-n,X4=(t,e,n)=>e<<n|t>>>32-n,eL=(t,e,n)=>e<<n-32|t>>>64-n,tL=(t,e,n)=>t<<n-32|e>>>64-n;function Lr(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Ry=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),ky=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,nL=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),rL=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,sL=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),iL=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,_a=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Dy(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ci(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Cr(t,...e){if(!Dy(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Uy(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ci(t.outputLen),ci(t.blockLen)}function to(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function By(t,e){Cr(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function gu(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Ir(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function og(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function is(t,e){return t<<32-e|t>>>e}const h2=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function f2(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const js=h2?t=>t:t=>f2(t);function oL(t){for(let e=0;e<t.length;e++)t[e]=f2(t[e]);return t}const Bi=h2?t=>t:oL,p2=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",aL=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function mu(t){if(Cr(t),p2)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=aL[t[n]];return e}const Ls={_0:48,_9:57,A:65,F:70,a:97,f:102};function PE(t){if(t>=Ls._0&&t<=Ls._9)return t-Ls._0;if(t>=Ls.A&&t<=Ls.F)return t-(Ls.A-10);if(t>=Ls.a&&t<=Ls.f)return t-(Ls.a-10)}function $y(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(p2)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=PE(t.charCodeAt(i)),a=PE(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function cL(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Jr(t){return typeof t=="string"&&(t=cL(t)),Cr(t),t}function Ro(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Cr(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let Bf=class{};function nd(t){const e=r=>t().update(Jr(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function lL(t){const e=(r,s)=>t(s).update(Jr(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function zc(t=32){if(_a&&typeof _a.getRandomValues=="function")return _a.getRandomValues(new Uint8Array(t));if(_a&&typeof _a.randomBytes=="function")return Uint8Array.from(_a.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const uL=BigInt(0),il=BigInt(1),dL=BigInt(2),hL=BigInt(7),fL=BigInt(256),pL=BigInt(113),g2=[],m2=[],y2=[];for(let t=0,e=il,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],g2.push(2*(5*r+n)),m2.push((t+1)*(t+2)/2%64);let s=uL;for(let i=0;i<7;i++)e=(e<<il^(e>>hL)*pL)%fL,e&dL&&(s^=il<<(il<<BigInt(i))-il);y2.push(s)}const w2=d2(y2,!0),gL=w2[0],mL=w2[1],OE=(t,e,n)=>n>32?eL(t,e,n):Q4(t,e,n),RE=(t,e,n)=>n>32?tL(t,e,n):X4(t,e,n);function yL(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=OE(l,u,1)^n[a],h=RE(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=m2[o],c=OE(s,i,a),l=RE(s,i,a),u=g2[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=gL[r],t[1]^=mL[r]}Ir(n)}let wL=class b2 extends Bf{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,ci(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=gu(this.state)}clone(){return this._cloneInto()}keccak(){Bi(this.state32),yL(this.state32,this.rounds),Bi(this.state32),this.posOut=0,this.pos=0}update(e){to(this),e=Jr(e),Cr(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){to(this,!1),Cr(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ci(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(By(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Ir(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new b2(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const bL=(t,e,n)=>nd(()=>new wL(e,t,n)),EL=bL(1,136,256/8);function vL(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function AL(t,e,n){return t&e^~t&n}function CL(t,e,n){return t&e^t&n^e&n}let E2=class extends Bf{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=og(this.buffer)}update(e){to(this),e=Jr(e),Cr(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=og(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){to(this),By(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Ir(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;vL(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=og(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const Ai=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),fn=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),pn=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),IL=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ci=new Uint32Array(64);let _L=class extends E2{constructor(e=32){super(64,e,8,!1),this.A=Ai[0]|0,this.B=Ai[1]|0,this.C=Ai[2]|0,this.D=Ai[3]|0,this.E=Ai[4]|0,this.F=Ai[5]|0,this.G=Ai[6]|0,this.H=Ai[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Ci[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=Ci[d-15],f=Ci[d-2],p=is(h,7)^is(h,18)^h>>>3,g=is(f,17)^is(f,19)^f>>>10;Ci[d]=g+Ci[d-7]+p+Ci[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=is(a,6)^is(a,11)^is(a,25),f=u+h+AL(a,c,l)+IL[d]+Ci[d]|0,p=(is(r,2)^is(r,13)^is(r,22))+CL(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+p|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Ir(Ci)}destroy(){this.set(0,0,0,0,0,0,0,0),Ir(this.buffer)}};const v2=d2(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),NL=v2[0],SL=v2[1],Ii=new Uint32Array(80),_i=new Uint32Array(80);let Ly=class extends E2{constructor(e=64){super(128,e,16,!1),this.Ah=pn[0]|0,this.Al=pn[1]|0,this.Bh=pn[2]|0,this.Bl=pn[3]|0,this.Ch=pn[4]|0,this.Cl=pn[5]|0,this.Dh=pn[6]|0,this.Dl=pn[7]|0,this.Eh=pn[8]|0,this.El=pn[9]|0,this.Fh=pn[10]|0,this.Fl=pn[11]|0,this.Gh=pn[12]|0,this.Gl=pn[13]|0,this.Hh=pn[14]|0,this.Hl=pn[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let w=0;w<16;w++,n+=4)Ii[w]=e.getUint32(n),_i[w]=e.getUint32(n+=4);for(let w=16;w<80;w++){const N=Ii[w-15]|0,b=_i[w-15]|0,E=Di(N,b,1)^Di(N,b,8)^xE(N,b,7),S=Ui(N,b,1)^Ui(N,b,8)^TE(N,b,7),x=Ii[w-2]|0,I=_i[w-2]|0,O=Di(x,I,19)^wl(x,I,61)^xE(x,I,6),P=Ui(x,I,19)^bl(x,I,61)^TE(x,I,6),k=nL(S,P,_i[w-7],_i[w-16]),M=rL(k,E,O,Ii[w-7],Ii[w-16]);Ii[w]=M|0,_i[w]=k|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:y,Hl:v}=this;for(let w=0;w<80;w++){const N=Di(d,h,14)^Di(d,h,18)^wl(d,h,41),b=Ui(d,h,14)^Ui(d,h,18)^bl(d,h,41),E=d&f^~d&g,S=h&p^~h&m,x=sL(v,b,S,SL[w],_i[w]),I=iL(x,y,N,E,NL[w],Ii[w]),O=x|0,P=Di(r,s,28)^wl(r,s,34)^wl(r,s,39),k=Ui(r,s,28)^bl(r,s,34)^bl(r,s,39),M=r&i^r&a^i&a,$=s&o^s&c^o&c;y=g|0,v=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Lr(l|0,u|0,I|0,O|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const A=Ry(O,k,$);r=ky(A,I,P,M),s=A|0}({h:r,l:s}=Lr(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Lr(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Lr(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Lr(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Lr(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Lr(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Lr(this.Gh|0,this.Gl|0,g|0,m|0),{h:y,l:v}=Lr(this.Hh|0,this.Hl|0,y|0,v|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,g,m,y,v)}roundClean(){Ir(Ii,_i)}destroy(){Ir(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},xL=class extends Ly{constructor(){super(48),this.Ah=fn[0]|0,this.Al=fn[1]|0,this.Bh=fn[2]|0,this.Bl=fn[3]|0,this.Ch=fn[4]|0,this.Cl=fn[5]|0,this.Dh=fn[6]|0,this.Dl=fn[7]|0,this.Eh=fn[8]|0,this.El=fn[9]|0,this.Fh=fn[10]|0,this.Fl=fn[11]|0,this.Gh=fn[12]|0,this.Gl=fn[13]|0,this.Hh=fn[14]|0,this.Hl=fn[15]|0}};const gn=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class TL extends Ly{constructor(){super(32),this.Ah=gn[0]|0,this.Al=gn[1]|0,this.Bh=gn[2]|0,this.Bl=gn[3]|0,this.Ch=gn[4]|0,this.Cl=gn[5]|0,this.Dh=gn[6]|0,this.Dl=gn[7]|0,this.Eh=gn[8]|0,this.El=gn[9]|0,this.Fh=gn[10]|0,this.Fl=gn[11]|0,this.Gh=gn[12]|0,this.Gl=gn[13]|0,this.Hh=gn[14]|0,this.Hl=gn[15]|0}}const $f=nd(()=>new _L),PL=nd(()=>new Ly),OL=nd(()=>new xL),RL=nd(()=>new TL),kL=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Bt=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ne=new Uint32Array(32);function Ni(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=ne[2*t],l=ne[2*t+1],u=ne[2*e],d=ne[2*e+1],h=ne[2*n],f=ne[2*n+1],p=ne[2*r],g=ne[2*r+1],m=Ry(c,u,o);l=ky(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:Y4(g,p),Dl:Z4(g)},{h:f,l:h}=Lr(f,h,g,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:Di(d,u,24),Bl:Ui(d,u,24)},ne[2*t]=c,ne[2*t+1]=l,ne[2*e]=u,ne[2*e+1]=d,ne[2*n]=h,ne[2*n+1]=f,ne[2*r]=p,ne[2*r+1]=g}function Si(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=ne[2*t],l=ne[2*t+1],u=ne[2*e],d=ne[2*e+1],h=ne[2*n],f=ne[2*n+1],p=ne[2*r],g=ne[2*r+1],m=Ry(c,u,o);l=ky(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:Di(g,p,16),Dl:Ui(g,p,16)},{h:f,l:h}=Lr(f,h,g,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:wl(d,u,63),Bl:bl(d,u,63)},ne[2*t]=c,ne[2*t+1]=l,ne[2*e]=u,ne[2*e+1]=d,ne[2*n]=h,ne[2*n+1]=f,ne[2*r]=p,ne[2*r+1]=g}function DL(t,e={},n,r,s){if(ci(n),t<0||t>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class UL extends Bf{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,ci(e),ci(n),this.blockLen=e,this.outputLen=n,this.buffer=new Uint8Array(e),this.buffer32=gu(this.buffer)}update(e){to(this),e=Jr(e),Cr(e);const{blockLen:n,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===n&&(Bi(s),this.compress(s,0,!1),Bi(s),this.pos=0);const l=Math.min(n-this.pos,i-c),u=o+c;if(l===n&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));Bi(d);for(let h=0;c+n<i;h+=s.length,c+=n)this.length+=n,this.compress(d,h,!1);Bi(d);continue}r.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){to(this),By(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,Ir(this.buffer.subarray(n)),Bi(r),this.compress(r,0,!0),Bi(r);const s=gu(e);this.get().forEach((i,o)=>s[o]=js(i))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(n),e.destroyed=i,e.finished=s,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class BL extends UL{constructor(e={}){const n=e.dkLen===void 0?64:e.dkLen;super(128,n),this.v0l=Bt[0]|0,this.v0h=Bt[1]|0,this.v1l=Bt[2]|0,this.v1h=Bt[3]|0,this.v2l=Bt[4]|0,this.v2h=Bt[5]|0,this.v3l=Bt[6]|0,this.v3h=Bt[7]|0,this.v4l=Bt[8]|0,this.v4h=Bt[9]|0,this.v5l=Bt[10]|0,this.v5h=Bt[11]|0,this.v6l=Bt[12]|0,this.v6h=Bt[13]|0,this.v7l=Bt[14]|0,this.v7h=Bt[15]|0,DL(n,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=Jr(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=Jr(i);const a=gu(i);this.v4l^=js(a[0]),this.v4h^=js(a[1]),this.v5l^=js(a[2]),this.v5h^=js(a[3])}if(s!==void 0){s=Jr(s);const a=gu(s);this.v6l^=js(a[0]),this.v6h^=js(a[1]),this.v7l^=js(a[2]),this.v7h^=js(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:f,v6h:p,v7l:g,v7h:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=f|0,this.v6h=p|0,this.v7l=g|0,this.v7h=m|0}compress(e,n,r){this.get().forEach((c,l)=>ne[l]=c),ne.set(Bt,16);let{h:s,l:i}=u2(BigInt(this.length));ne[24]=Bt[8]^i,ne[25]=Bt[9]^s,r&&(ne[28]=~ne[28],ne[29]=~ne[29]);let o=0;const a=kL;for(let c=0;c<12;c++)Ni(0,4,8,12,e,n+2*a[o++]),Si(0,4,8,12,e,n+2*a[o++]),Ni(1,5,9,13,e,n+2*a[o++]),Si(1,5,9,13,e,n+2*a[o++]),Ni(2,6,10,14,e,n+2*a[o++]),Si(2,6,10,14,e,n+2*a[o++]),Ni(3,7,11,15,e,n+2*a[o++]),Si(3,7,11,15,e,n+2*a[o++]),Ni(0,5,10,15,e,n+2*a[o++]),Si(0,5,10,15,e,n+2*a[o++]),Ni(1,6,11,12,e,n+2*a[o++]),Si(1,6,11,12,e,n+2*a[o++]),Ni(2,7,8,13,e,n+2*a[o++]),Si(2,7,8,13,e,n+2*a[o++]),Ni(3,4,9,14,e,n+2*a[o++]),Si(3,4,9,14,e,n+2*a[o++]);this.v0l^=ne[0]^ne[16],this.v0h^=ne[1]^ne[17],this.v1l^=ne[2]^ne[18],this.v1h^=ne[3]^ne[19],this.v2l^=ne[4]^ne[20],this.v2h^=ne[5]^ne[21],this.v3l^=ne[6]^ne[22],this.v3h^=ne[7]^ne[23],this.v4l^=ne[8]^ne[24],this.v4h^=ne[9]^ne[25],this.v5l^=ne[10]^ne[26],this.v5h^=ne[11]^ne[27],this.v6l^=ne[12]^ne[28],this.v6h^=ne[13]^ne[29],this.v7l^=ne[14]^ne[30],this.v7h^=ne[15]^ne[31],Ir(ne)}destroy(){this.destroyed=!0,Ir(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const $L=lL(t=>new BL(t)),LL="https://rpc.walletconnect.org/v1";function A2(t){const e=`Ethereum Signed Message:
${t.length}`,n=new TextEncoder().encode(e+t);return"0x"+Buffer.from(EL(n)).toString("hex")}async function ML(t,e,n,r,s,i){switch(n.t){case"eip191":return await FL(t,e,n.s);case"eip1271":return await jL(t,e,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}async function FL(t,e,n){return(await xB({hash:A2(e),signature:n})).toLowerCase()===t.toLowerCase()}async function jL(t,e,n,r,s,i){const o=nc(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=n.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:A2(e)).substring(2),h=a+d+c+u+l,f=await fetch(`${i||LL}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:HL(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:h},"latest"]})}),{result:p}=await f.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function HL(){return Date.now()+Math.floor(Math.random()*1e3)}function zL(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return jc.encode(i)}function qL(t){const e=new Uint8Array(Buffer.from(t,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+e.length);r.set(n),r.set(e,n.length);const s=$L(r,{dkLen:32});return jc.encode(s)}function kE(t){const e=new Uint8Array($f(WL(t)));return jc.encode(e)}function WL(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function DE(t){const e=Buffer.from(t,"base64"),n=h$(e).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=r$(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=RL(i);return E$.encode(o).replace(/=+$/,"")}function ag(t){const e=[];let n=BigInt(t);for(;n>=BigInt(128);)e.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return e.push(Number(n)),Buffer.from(e)}function VL(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),n=Buffer.from(t.signed.authInfoBytes,"base64"),r=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(ag(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(ag(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(ag(r.length)),s.push(r);const i=Buffer.concat(s),o=$f(i);return Buffer.from(o).toString("hex").toUpperCase()}var GL=Object.defineProperty,KL=Object.defineProperties,JL=Object.getOwnPropertyDescriptors,UE=Object.getOwnPropertySymbols,YL=Object.prototype.hasOwnProperty,ZL=Object.prototype.propertyIsEnumerable,BE=(t,e,n)=>e in t?GL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,QL=(t,e)=>{for(var n in e||(e={}))YL.call(e,n)&&BE(t,n,e[n]);if(UE)for(var n of UE(e))ZL.call(e,n)&&BE(t,n,e[n]);return t},XL=(t,e)=>KL(t,JL(e));const eM="did:pkh:",My=t=>t?.split(":"),tM=t=>{const e=t&&My(t);if(e)return t.includes(eM)?e[3]:e[1]},Vm=t=>{const e=t&&My(t);if(e)return e[2]+":"+e[3]},qh=t=>{const e=t&&My(t);if(e)return e.pop()};async function $E(t){const{cacao:e,projectId:n}=t,{s:r,p:s}=e,i=C2(s,s.iss),o=qh(s.iss);return await ML(o,i,r,Vm(s.iss),n)}const C2=(t,e)=>{const n=`${t.domain} wants you to sign in with your Ethereum account:`,r=qh(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const i=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${tM(e)}`,c=`Nonce: ${t.nonce}`,l=`Issued At: ${t.iat}`,u=t.exp?`Expiration Time: ${t.exp}`:void 0,d=t.nbf?`Not Before: ${t.nbf}`:void 0,h=t.requestId?`Request ID: ${t.requestId}`:void 0,f=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,p=ch(t.resources);if(p){const g=yu(p);s=uM(s,g)}return[n,r,"",s,"",i,o,a,c,l,u,d,h,f].filter(g=>g!=null).join(`
`)};function nM(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function rM(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function Xo(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(n=>{const r=t.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function sM(t,e,n,r={}){return n?.sort((s,i)=>s.localeCompare(i)),{att:{[t]:iM(e,n,r)}}}function iM(t,e,n={}){e=e?.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${t}/${s}`]:[n]}));return Object.assign({},...r)}function I2(t){return Xo(t),`urn:recap:${nM(t).replace(/=/g,"")}`}function yu(t){const e=rM(t.replace("urn:recap:",""));return Xo(e),e}function oM(t,e,n){const r=sM(t,e,n);return I2(r)}function aM(t){return t&&t.includes("urn:recap:")}function cM(t,e){const n=yu(t),r=yu(e),s=lM(n,r);return I2(s)}function lM(t,e){Xo(t),Xo(e);const n=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[s]=XL(QL({},r.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),r}function uM(t="",e){Xo(e);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(n))return t;const r=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${t?t+" ":""}${o}`}function LE(t){var e;const n=yu(t);Xo(n);const r=(e=n.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function ME(t){const e=yu(t);Xo(e);const n=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s?.[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function ch(t){if(!t)return;const e=t?.[t.length-1];return aM(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function _2(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Gm(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function cg(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Mn(t,...e){if(!_2(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function FE(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function dM(t,e){Mn(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Ki(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function bc(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function hM(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const fM=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function pM(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Km(t){if(typeof t=="string")t=pM(t);else if(_2(t))t=Jm(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function gM(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function mM(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const yM=(t,e)=>{function n(r,...s){if(Mn(r),!fM)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?Mn(l):Mn(l,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&Mn(s[1]);const o=e(r,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");Mn(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Mn(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(Mn(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(n,t),n};function jE(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!bM(e))throw new Error("invalid output, must be aligned");return e}function HE(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);t.setUint32(e+4,o,r),t.setUint32(e+0,a,r)}function wM(t,e,n){Gm(n);const r=new Uint8Array(16),s=hM(r);return HE(s,0,BigInt(e),n),HE(s,8,BigInt(t),n),r}function bM(t){return t.byteOffset%4===0}function Jm(t){return Uint8Array.from(t)}const N2=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),EM=N2("expand 16-byte k"),vM=N2("expand 32-byte k"),AM=Ki(EM),CM=Ki(vM);function qe(t,e){return t<<e|t>>>32-e}function Ym(t){return t.byteOffset%4===0}const kd=64,IM=16,S2=2**32-1,zE=new Uint32Array;function _M(t,e,n,r,s,i,o,a){const c=s.length,l=new Uint8Array(kd),u=Ki(l),d=Ym(s)&&Ym(i),h=d?Ki(s):zE,f=d?Ki(i):zE;for(let p=0;p<c;o++){if(t(e,n,r,u,o,a),o>=S2)throw new Error("arx: counter overflow");const g=Math.min(kd,c-p);if(d&&g===kd){const m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let y=0,v;y<IM;y++)v=m+y,f[v]=h[v]^u[y];p+=kd;continue}for(let m=0,y;m<g;m++)y=p+m,i[y]=s[y]^l[m];p+=g}}function NM(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=gM({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return cg(s),cg(o),Gm(i),Gm(n),(a,c,l,u,d=0)=>{Mn(a),Mn(c),Mn(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),Mn(u),cg(d),d<0||d>=S2)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const f=[];let p=a.length,g,m;if(p===32)f.push(g=Jm(a)),m=CM;else if(p===16&&n)g=new Uint8Array(32),g.set(a),g.set(a,16),m=AM,f.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);Ym(c)||f.push(c=Jm(c));const y=Ki(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,y,Ki(c.subarray(0,16)),y),c=c.subarray(16)}const v=16-s;if(v!==c.length)throw new Error(`arx: nonce must be ${v} or 16 bytes`);if(v!==12){const N=new Uint8Array(12);N.set(c,i?0:12-c.length),c=N,f.push(c)}const w=Ki(c);return _M(t,m,y,w,l,u,d,o),bc(...f),u}}const Qt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class SM{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Km(e),Mn(e,32);const n=Qt(e,0),r=Qt(e,2),s=Qt(e,4),i=Qt(e,6),o=Qt(e,8),a=Qt(e,10),c=Qt(e,12),l=Qt(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Qt(e,16+2*u)}process(e,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],f=o[6],p=o[7],g=o[8],m=o[9],y=Qt(e,n+0),v=Qt(e,n+2),w=Qt(e,n+4),N=Qt(e,n+6),b=Qt(e,n+8),E=Qt(e,n+10),S=Qt(e,n+12),x=Qt(e,n+14);let I=i[0]+(y&8191),O=i[1]+((y>>>13|v<<3)&8191),P=i[2]+((v>>>10|w<<6)&8191),k=i[3]+((w>>>7|N<<9)&8191),M=i[4]+((N>>>4|b<<12)&8191),$=i[5]+(b>>>1&8191),A=i[6]+((b>>>14|E<<2)&8191),_=i[7]+((E>>>11|S<<5)&8191),R=i[8]+((S>>>8|x<<8)&8191),B=i[9]+(x>>>5|s),U=0,L=U+I*a+O*(5*m)+P*(5*g)+k*(5*p)+M*(5*f);U=L>>>13,L&=8191,L+=$*(5*h)+A*(5*d)+_*(5*u)+R*(5*l)+B*(5*c),U+=L>>>13,L&=8191;let j=U+I*c+O*a+P*(5*m)+k*(5*g)+M*(5*p);U=j>>>13,j&=8191,j+=$*(5*f)+A*(5*h)+_*(5*d)+R*(5*u)+B*(5*l),U+=j>>>13,j&=8191;let q=U+I*l+O*c+P*a+k*(5*m)+M*(5*g);U=q>>>13,q&=8191,q+=$*(5*p)+A*(5*f)+_*(5*h)+R*(5*d)+B*(5*u),U+=q>>>13,q&=8191;let X=U+I*u+O*l+P*c+k*a+M*(5*m);U=X>>>13,X&=8191,X+=$*(5*g)+A*(5*p)+_*(5*f)+R*(5*h)+B*(5*d),U+=X>>>13,X&=8191;let K=U+I*d+O*u+P*l+k*c+M*a;U=K>>>13,K&=8191,K+=$*(5*m)+A*(5*g)+_*(5*p)+R*(5*f)+B*(5*h),U+=K>>>13,K&=8191;let se=U+I*h+O*d+P*u+k*l+M*c;U=se>>>13,se&=8191,se+=$*a+A*(5*m)+_*(5*g)+R*(5*p)+B*(5*f),U+=se>>>13,se&=8191;let ge=U+I*f+O*h+P*d+k*u+M*l;U=ge>>>13,ge&=8191,ge+=$*c+A*a+_*(5*m)+R*(5*g)+B*(5*p),U+=ge>>>13,ge&=8191;let Re=U+I*p+O*f+P*h+k*d+M*u;U=Re>>>13,Re&=8191,Re+=$*l+A*c+_*a+R*(5*m)+B*(5*g),U+=Re>>>13,Re&=8191;let Ue=U+I*g+O*p+P*f+k*h+M*d;U=Ue>>>13,Ue&=8191,Ue+=$*u+A*l+_*c+R*a+B*(5*m),U+=Ue>>>13,Ue&=8191;let Ie=U+I*m+O*g+P*p+k*f+M*h;U=Ie>>>13,Ie&=8191,Ie+=$*d+A*u+_*l+R*c+B*a,U+=Ie>>>13,Ie&=8191,U=(U<<2)+U|0,U=U+L|0,L=U&8191,U=U>>>13,j+=U,i[0]=L,i[1]=j,i[2]=q,i[3]=X,i[4]=K,i[5]=se,i[6]=ge,i[7]=Re,i[8]=Ue,i[9]=Ie}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+n[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+n[a]|0)+(o>>>16)|0,e[a]=o&65535;bc(r)}update(e){FE(this),e=Km(e),Mn(e);const{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){bc(this.h,this.r,this.buffer,this.pad)}digestInto(e){FE(this),dM(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function xM(t){const e=(r,s)=>t(s).update(Km(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const TM=xM(t=>new SM(t));function PM(t,e,n,r,s,i=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],d=e[1],h=e[2],f=e[3],p=e[4],g=e[5],m=e[6],y=e[7],v=s,w=n[0],N=n[1],b=n[2],E=o,S=a,x=c,I=l,O=u,P=d,k=h,M=f,$=p,A=g,_=m,R=y,B=v,U=w,L=N,j=b;for(let X=0;X<i;X+=2)E=E+O|0,B=qe(B^E,16),$=$+B|0,O=qe(O^$,12),E=E+O|0,B=qe(B^E,8),$=$+B|0,O=qe(O^$,7),S=S+P|0,U=qe(U^S,16),A=A+U|0,P=qe(P^A,12),S=S+P|0,U=qe(U^S,8),A=A+U|0,P=qe(P^A,7),x=x+k|0,L=qe(L^x,16),_=_+L|0,k=qe(k^_,12),x=x+k|0,L=qe(L^x,8),_=_+L|0,k=qe(k^_,7),I=I+M|0,j=qe(j^I,16),R=R+j|0,M=qe(M^R,12),I=I+M|0,j=qe(j^I,8),R=R+j|0,M=qe(M^R,7),E=E+P|0,j=qe(j^E,16),_=_+j|0,P=qe(P^_,12),E=E+P|0,j=qe(j^E,8),_=_+j|0,P=qe(P^_,7),S=S+k|0,B=qe(B^S,16),R=R+B|0,k=qe(k^R,12),S=S+k|0,B=qe(B^S,8),R=R+B|0,k=qe(k^R,7),x=x+M|0,U=qe(U^x,16),$=$+U|0,M=qe(M^$,12),x=x+M|0,U=qe(U^x,8),$=$+U|0,M=qe(M^$,7),I=I+O|0,L=qe(L^I,16),A=A+L|0,O=qe(O^A,12),I=I+O|0,L=qe(L^I,8),A=A+L|0,O=qe(O^A,7);let q=0;r[q++]=o+E|0,r[q++]=a+S|0,r[q++]=c+x|0,r[q++]=l+I|0,r[q++]=u+O|0,r[q++]=d+P|0,r[q++]=h+k|0,r[q++]=f+M|0,r[q++]=p+$|0,r[q++]=g+A|0,r[q++]=m+_|0,r[q++]=y+R|0,r[q++]=v+B|0,r[q++]=w+U|0,r[q++]=N+L|0,r[q++]=b+j|0}const OM=NM(PM,{counterRight:!1,counterLength:4,allowShortKeys:!1}),RM=new Uint8Array(16),qE=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(RM.subarray(n))},kM=new Uint8Array(32);function WE(t,e,n,r,s){const i=t(e,n,kM),o=TM.create(i);s&&qE(o,s),qE(o,r);const a=wM(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return bc(i,a),c}const DM=t=>(e,n,r)=>({encrypt(s,i){const o=s.length;i=jE(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,n,a,a,1);const c=WE(t,e,n,a,r);return i.set(c,o),bc(c),i},decrypt(s,i){i=jE(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=WE(t,e,n,o,r);if(!mM(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,n,i,i,1),bc(c),i}}),x2=yM({blockSize:64,nonceLength:12,tagLength:16},DM(OM));let T2=class extends Bf{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,Uy(e);const r=Jr(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Ir(i)}update(e){return to(this),this.iHash.update(e),this}digestInto(e){to(this),Cr(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Lf=(t,e,n)=>new T2(t,e).update(n).digest();Lf.create=(t,e)=>new T2(t,e);function UM(t,e,n){return Uy(t),n===void 0&&(n=new Uint8Array(t.outputLen)),Lf(t,Jr(n),Jr(e))}const lg=Uint8Array.from([0]),VE=Uint8Array.of();function BM(t,e,n,r=32){Uy(t),ci(r);const s=t.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=VE);const o=new Uint8Array(i*s),a=Lf.create(t,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)lg[0]=u+1,c.update(u===0?VE:l).update(n).update(lg).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),Ir(l,lg),o.slice(0,r)}const $M=(t,e,n,r,s)=>BM(t,UM(t,e,n),r,s),Mf=$f,Fy=BigInt(0),Zm=BigInt(1);function Wh(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function Dd(t){const e=t.toString(16);return e.length&1?"0"+e:e}function P2(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Fy:BigInt("0x"+t)}function Ff(t){return P2(mu(t))}function Vh(t){return Cr(t),P2(mu(Uint8Array.from(t).reverse()))}function jy(t,e){return $y(t.toString(16).padStart(e*2,"0"))}function Hy(t,e){return jy(t,e).reverse()}function Ln(t,e,n){let r;if(typeof e=="string")try{r=$y(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Dy(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}const ug=t=>typeof t=="bigint"&&Fy<=t;function LM(t,e,n){return ug(t)&&ug(e)&&ug(n)&&e<=t&&t<n}function Qm(t,e,n,r){if(!LM(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function MM(t){let e;for(e=0;t>Fy;t>>=Zm,e+=1);return e}const jf=t=>(Zm<<BigInt(t))-Zm;function FM(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=r(t),o=r(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...h)=>n(o,i,...h),u=(h=r(0))=>{o=l(s(0),h),i=l(),h.length!==0&&(o=l(s(1),h),i=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){i=l();const p=i.slice();f.push(p),h+=i.length}return Ro(...f)};return(h,f)=>{c(),u(h);let p;for(;!(p=f(d()));)u();return c(),p}}function Hf(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function GE(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const zn=BigInt(0),_n=BigInt(1),ko=BigInt(2),jM=BigInt(3),O2=BigInt(4),R2=BigInt(5),k2=BigInt(8);function wr(t,e){const n=t%e;return n>=zn?n:e+n}function $r(t,e,n){let r=t;for(;e-- >zn;)r*=r,r%=n;return r}function KE(t,e){if(t===zn)throw new Error("invert: expected non-zero number");if(e<=zn)throw new Error("invert: expected positive modulus, got "+e);let n=wr(t,e),r=e,s=zn,i=_n;for(;n!==zn;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==_n)throw new Error("invert: does not exist");return wr(s,e)}function D2(t,e){const n=(t.ORDER+_n)/O2,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function HM(t,e){const n=(t.ORDER-R2)/k2,r=t.mul(e,ko),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,ko),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function zM(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-_n,n=0;for(;e%ko===zn;)e/=ko,n++;let r=ko;const s=qc(t);for(;JE(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return D2;let i=s.pow(r,e);const o=(e+_n)/ko;return function(a,c){if(a.is0(c))return c;if(JE(a,c)!==1)throw new Error("Cannot find square root");let l=n,u=a.mul(a.ONE,i),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let f=1,p=a.sqr(d);for(;!a.eql(p,a.ONE);)if(f++,p=a.sqr(p),f===l)throw new Error("Cannot find square root");const g=_n<<BigInt(l-f-1),m=a.pow(u,g);l=f,u=a.sqr(m),d=a.mul(d,u),h=a.mul(h,m)}return h}}function qM(t){return t%O2===jM?D2:t%k2===R2?HM:zM(t)}const WM=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function VM(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=WM.reduce((r,s)=>(r[s]="function",r),e);return Hf(t,n),t}function GM(t,e,n){if(n<zn)throw new Error("invalid exponent, negatives unsupported");if(n===zn)return t.ONE;if(n===_n)return e;let r=t.ONE,s=e;for(;n>zn;)n&_n&&(r=t.mul(r,s)),s=t.sqr(s),n>>=_n;return r}function U2(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function JE(t,e){const n=(t.ORDER-_n)/ko,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function KM(t,e){e!==void 0&&ci(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function qc(t,e,n=!1,r={}){if(t<=zn)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const u=e;u.BITS&&(s=u.BITS),u.sqrt&&(i=u.sqrt),typeof u.isLE=="boolean"&&(n=u.isLE)}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:a}=KM(t,s);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const l=Object.freeze({ORDER:t,isLE:n,BITS:o,BYTES:a,MASK:jf(o),ZERO:zn,ONE:_n,create:u=>wr(u,t),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return zn<=u&&u<t},is0:u=>u===zn,isValidNot0:u=>!l.is0(u)&&l.isValid(u),isOdd:u=>(u&_n)===_n,neg:u=>wr(-u,t),eql:(u,d)=>u===d,sqr:u=>wr(u*u,t),add:(u,d)=>wr(u+d,t),sub:(u,d)=>wr(u-d,t),mul:(u,d)=>wr(u*d,t),pow:(u,d)=>GM(l,u,d),div:(u,d)=>wr(u*KE(d,t),t),sqrN:u=>u*u,addN:(u,d)=>u+d,subN:(u,d)=>u-d,mulN:(u,d)=>u*d,inv:u=>KE(u,t),sqrt:i||(u=>(c||(c=qM(t)),c(l,u))),toBytes:u=>n?Hy(u,a):jy(u,a),fromBytes:u=>{if(u.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+u.length);return n?Vh(u):Ff(u)},invertBatch:u=>U2(l,u),cmov:(u,d,h)=>h?d:u});return Object.freeze(l)}function B2(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function $2(t){const e=B2(t);return e+Math.ceil(e/2)}function JM(t,e,n=!1){const r=t.length,s=B2(e),i=$2(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?Vh(t):Ff(t),a=wr(o,e-_n)+_n;return n?Hy(a,s):jy(a,s)}const Ec=BigInt(0),Do=BigInt(1);function Pl(t,e){const n=e.negate();return t?n:e}function YM(t,e,n){const r=i=>i.pz,s=U2(t.Fp,n.map(r));return n.map((i,o)=>i.toAffine(s[o])).map(t.fromAffine)}function L2(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function dg(t,e){L2(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=jf(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function YE(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=Do);const l=e*r,u=l+Math.abs(a)-1,d=a===0,h=a<0,f=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:f,offsetF:l}}function ZM(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function QM(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const hg=new WeakMap,M2=new WeakMap;function fg(t){return M2.get(t)||1}function ZE(t){if(t!==Ec)throw new Error("invalid wNAF")}function XM(t,e){return{constTimeNegate:Pl,hasPrecomputes(n){return fg(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>Ec;)r&Do&&(s=s.add(i)),i=i.double(),r>>=Do;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=dg(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){let i=t.ZERO,o=t.BASE;const a=dg(n,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:h,isNegF:f,offsetF:p}=YE(s,c,a);s=l,d?o=o.add(Pl(f,r[p])):i=i.add(Pl(h,r[u]))}return ZE(s),{p:i,f:o}},wNAFUnsafe(n,r,s,i=t.ZERO){const o=dg(n,e);for(let a=0;a<o.windows&&s!==Ec;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=YE(s,a,o);if(s=c,!u){const h=r[l];i=i.add(d?h.negate():h)}}return ZE(s),i},getPrecomputes(n,r,s){let i=hg.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&(typeof s=="function"&&(i=s(i)),hg.set(r,i))),i},wNAFCached(n,r,s){const i=fg(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=fg(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){L2(r,e),M2.set(n,r),hg.delete(n)}}}function eF(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>Ec||r>Ec;)n&Do&&(i=i.add(s)),r&Do&&(o=o.add(s)),s=s.double(),n>>=Do,r>>=Do;return{p1:i,p2:o}}function tF(t,e,n,r){ZM(n,t),QM(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=MM(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=jf(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let f=d;f>=0;f-=c){u.fill(o);for(let g=0;g<i;g++){const m=r[g],y=Number(m>>BigInt(f)&l);u[y]=u[y].add(n[g])}let p=o;for(let g=u.length-1,m=o;g>0;g--)m=m.add(u[g]),p=p.add(m);if(h=h.add(p),f!==0)for(let g=0;g<c;g++)h=h.double()}return h}function QE(t,e){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return VM(e),e}else return qc(t)}function nF(t,e,n={}){if(!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const o of["p","n","h"]){const a=e[o];if(!(typeof a=="bigint"&&a>Ec))throw new Error(`CURVE.${o} must be positive bigint`)}const r=QE(e.p,n.Fp),s=QE(e.n,n.Fn),i=["Gx","Gy","a","b"];for(const o of i)if(!r.isValid(e[o]))throw new Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const ol=BigInt(0),Na=BigInt(1),Ud=BigInt(2);function rF(t){return Hf(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function sF(t){const e=rF(t),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||zc,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),f=a?Ud**BigInt(254):Ud**BigInt(447),p=a?BigInt(8)*Ud**BigInt(251)-Na:BigInt(4)*Ud**BigInt(445)-Na,g=f+p+Na,m=I=>wr(I,n),y=v(d);function v(I){return Hy(m(I),u)}function w(I){const O=Ln("u coordinate",I,u);return a&&(O[31]&=127),m(Vh(O))}function N(I){return Vh(s(Ln("scalar",I,u)))}function b(I,O){const P=x(w(O),N(I));if(P===ol)throw new Error("invalid private or public key received");return v(P)}function E(I){return b(I,y)}function S(I,O,P){const k=m(I*(O-P));return O=m(O-k),P=m(P+k),{x_2:O,x_3:P}}function x(I,O){Qm("u",I,ol,n),Qm("scalar",O,f,g);const P=O,k=I;let M=Na,$=ol,A=I,_=Na,R=ol;for(let U=BigInt(l-1);U>=ol;U--){const L=P>>U&Na;R^=L,{x_2:M,x_3:A}=S(R,M,A),{x_2:$,x_3:_}=S(R,$,_),R=L;const j=M+$,q=m(j*j),X=M-$,K=m(X*X),se=q-K,ge=A+_,Re=A-_,Ue=m(Re*j),Ie=m(ge*X),nt=Ue+Ie,Ot=Ue-Ie;A=m(nt*nt),_=m(k*m(Ot*Ot)),M=m(q*K),$=m(se*(q+m(h*se)))}({x_2:M,x_3:A}=S(R,M,A)),{x_2:$,x_3:_}=S(R,$,_);const B=i($);return m(M*B)}return{scalarMult:b,scalarMultBase:E,getSharedSecret:(I,O)=>b(I,O),getPublicKey:I=>E(I),utils:{randomPrivateKey:()=>c(u)},GuBytes:y.slice()}}BigInt(0);const iF=BigInt(1),XE=BigInt(2),oF=BigInt(3),aF=BigInt(5);BigInt(8);const F2={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function cF(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=F2.p,o=t*t%i*t%i,a=$r(o,XE,i)*o%i,c=$r(a,iF,i)*t%i,l=$r(c,aF,i)*c%i,u=$r(l,e,i)*l%i,d=$r(u,n,i)*u%i,h=$r(d,r,i)*d%i,f=$r(h,s,i)*h%i,p=$r(f,s,i)*h%i,g=$r(p,e,i)*l%i;return{pow_p_5_8:$r(g,XE,i)*t%i,b2:o}}function lF(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Xm=(()=>{const t=F2.p;return sF({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:n,b2:r}=cF(e);return wr($r(n,oF,t)*r,t)},adjustScalarBytes:lF})})();function e1(t){t.lowS!==void 0&&Wh("lowS",t.lowS),t.prehash!==void 0&&Wh("prehash",t.prehash)}class uF extends Error{constructor(e=""){super(e)}}const Vs={Err:uF,_tlv:{encode:(t,e)=>{const{Err:n}=Vs;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=Dd(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?Dd(s.length/2|128):"";return Dd(t)+i+s+e},decode(t,e){const{Err:n}=Vs;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=Vs;if(t<Ol)throw new e("integer: negative integers are not allowed");let n=Dd(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=Vs;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Ff(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Vs,s=Ln("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(t){const{_tlv:e,_int:n}=Vs,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},Ol=BigInt(0),Rl=BigInt(1),dF=BigInt(2),Bd=BigInt(3),hF=BigInt(4);function fF(t,e,n){function r(s){const i=t.sqr(s),o=t.mul(i,s);return t.add(t.add(o,t.mul(s,e)),n)}return r}function j2(t,e,n){const{BYTES:r}=t;function s(i){let o;if(typeof i=="bigint")o=i;else{let a=Ln("private key",i);if(e){if(!e.includes(a.length*2))throw new Error("invalid private key");const c=new Uint8Array(r);c.set(a,c.length-a.length),a=c}try{o=t.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(n&&(o=t.create(o)),!t.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return s}function pF(t,e={}){const{Fp:n,Fn:r}=nF("weierstrass",t,e),{h:s,n:i}=t;Hf(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=e;if(o&&(!n.is0(t.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(x,I,O){const{x:P,y:k}=I.toAffine(),M=n.toBytes(P);if(Wh("isCompressed",O),O){a();const $=!n.isOdd(k);return Ro(H2($),M)}else return Ro(Uint8Array.of(4),M,n.toBytes(k))}function l(x){Cr(x);const I=n.BYTES,O=I+1,P=2*I+1,k=x.length,M=x[0],$=x.subarray(1);if(k===O&&(M===2||M===3)){const A=n.fromBytes($);if(!n.isValid(A))throw new Error("bad point: is not on curve, wrong x");const _=h(A);let R;try{R=n.sqrt(_)}catch(U){const L=U instanceof Error?": "+U.message:"";throw new Error("bad point: is not on curve, sqrt error"+L)}a();const B=n.isOdd(R);return(M&1)===1!==B&&(R=n.neg(R)),{x:A,y:R}}else if(k===P&&M===4){const A=n.fromBytes($.subarray(I*0,I*1)),_=n.fromBytes($.subarray(I*1,I*2));if(!f(A,_))throw new Error("bad point: is not on curve");return{x:A,y:_}}else throw new Error(`bad point: got length ${k}, expected compressed=${O} or uncompressed=${P}`)}const u=e.toBytes||c,d=e.fromBytes||l,h=fF(n,t.a,t.b);function f(x,I){const O=n.sqr(I),P=h(x);return n.eql(O,P)}if(!f(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const p=n.mul(n.pow(t.a,Bd),hF),g=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(p,g)))throw new Error("bad curve params: a or b");function m(x,I,O=!1){if(!n.isValid(I)||O&&n.is0(I))throw new Error(`bad point coordinate ${x}`);return I}function y(x){if(!(x instanceof b))throw new Error("ProjectivePoint expected")}const v=GE((x,I)=>{const{px:O,py:P,pz:k}=x;if(n.eql(k,n.ONE))return{x:O,y:P};const M=x.is0();I==null&&(I=M?n.ONE:n.inv(k));const $=n.mul(O,I),A=n.mul(P,I),_=n.mul(k,I);if(M)return{x:n.ZERO,y:n.ZERO};if(!n.eql(_,n.ONE))throw new Error("invZ was invalid");return{x:$,y:A}}),w=GE(x=>{if(x.is0()){if(e.allowInfinityPoint&&!n.is0(x.py))return;throw new Error("bad point: ZERO")}const{x:I,y:O}=x.toAffine();if(!n.isValid(I)||!n.isValid(O))throw new Error("bad point: x or y not field elements");if(!f(I,O))throw new Error("bad point: equation left != right");if(!x.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function N(x,I,O,P,k){return O=new b(n.mul(O.px,x),O.py,O.pz),I=Pl(P,I),O=Pl(k,O),I.add(O)}class b{constructor(I,O,P){this.px=m("x",I),this.py=m("y",O,!0),this.pz=m("z",P),Object.freeze(this)}static fromAffine(I){const{x:O,y:P}=I||{};if(!I||!n.isValid(O)||!n.isValid(P))throw new Error("invalid affine point");if(I instanceof b)throw new Error("projective point not allowed");return n.is0(O)&&n.is0(P)?b.ZERO:new b(O,P,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(I){return YM(b,"pz",I)}static fromBytes(I){return Cr(I),b.fromHex(I)}static fromHex(I){const O=b.fromAffine(d(Ln("pointHex",I)));return O.assertValidity(),O}static fromPrivateKey(I){const O=j2(r,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return b.BASE.multiply(O(I))}static msm(I,O){return tF(b,r,I,O)}precompute(I=8,O=!0){return S.setWindowSize(this,I),O||this.multiply(Bd),this}_setWindowSize(I){this.precompute(I)}assertValidity(){w(this)}hasEvenY(){const{y:I}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(I)}equals(I){y(I);const{px:O,py:P,pz:k}=this,{px:M,py:$,pz:A}=I,_=n.eql(n.mul(O,A),n.mul(M,k)),R=n.eql(n.mul(P,A),n.mul($,k));return _&&R}negate(){return new b(this.px,n.neg(this.py),this.pz)}double(){const{a:I,b:O}=t,P=n.mul(O,Bd),{px:k,py:M,pz:$}=this;let A=n.ZERO,_=n.ZERO,R=n.ZERO,B=n.mul(k,k),U=n.mul(M,M),L=n.mul($,$),j=n.mul(k,M);return j=n.add(j,j),R=n.mul(k,$),R=n.add(R,R),A=n.mul(I,R),_=n.mul(P,L),_=n.add(A,_),A=n.sub(U,_),_=n.add(U,_),_=n.mul(A,_),A=n.mul(j,A),R=n.mul(P,R),L=n.mul(I,L),j=n.sub(B,L),j=n.mul(I,j),j=n.add(j,R),R=n.add(B,B),B=n.add(R,B),B=n.add(B,L),B=n.mul(B,j),_=n.add(_,B),L=n.mul(M,$),L=n.add(L,L),B=n.mul(L,j),A=n.sub(A,B),R=n.mul(L,U),R=n.add(R,R),R=n.add(R,R),new b(A,_,R)}add(I){y(I);const{px:O,py:P,pz:k}=this,{px:M,py:$,pz:A}=I;let _=n.ZERO,R=n.ZERO,B=n.ZERO;const U=t.a,L=n.mul(t.b,Bd);let j=n.mul(O,M),q=n.mul(P,$),X=n.mul(k,A),K=n.add(O,P),se=n.add(M,$);K=n.mul(K,se),se=n.add(j,q),K=n.sub(K,se),se=n.add(O,k);let ge=n.add(M,A);return se=n.mul(se,ge),ge=n.add(j,X),se=n.sub(se,ge),ge=n.add(P,k),_=n.add($,A),ge=n.mul(ge,_),_=n.add(q,X),ge=n.sub(ge,_),B=n.mul(U,se),_=n.mul(L,X),B=n.add(_,B),_=n.sub(q,B),B=n.add(q,B),R=n.mul(_,B),q=n.add(j,j),q=n.add(q,j),X=n.mul(U,X),se=n.mul(L,se),q=n.add(q,X),X=n.sub(j,X),X=n.mul(U,X),se=n.add(se,X),j=n.mul(q,se),R=n.add(R,j),j=n.mul(ge,se),_=n.mul(K,_),_=n.sub(_,j),j=n.mul(K,q),B=n.mul(ge,B),B=n.add(B,j),new b(_,R,B)}subtract(I){return this.add(I.negate())}is0(){return this.equals(b.ZERO)}multiply(I){const{endo:O}=e;if(!r.isValidNot0(I))throw new Error("invalid scalar: out of range");let P,k;const M=$=>S.wNAFCached(this,$,b.normalizeZ);if(O){const{k1neg:$,k1:A,k2neg:_,k2:R}=O.splitScalar(I),{p:B,f:U}=M(A),{p:L,f:j}=M(R);k=U.add(j),P=N(O.beta,B,L,$,_)}else{const{p:$,f:A}=M(I);P=$,k=A}return b.normalizeZ([P,k])[0]}multiplyUnsafe(I){const{endo:O}=e,P=this;if(!r.isValid(I))throw new Error("invalid scalar: out of range");if(I===Ol||P.is0())return b.ZERO;if(I===Rl)return P;if(S.hasPrecomputes(this))return this.multiply(I);if(O){const{k1neg:k,k1:M,k2neg:$,k2:A}=O.splitScalar(I),{p1:_,p2:R}=eF(b,P,M,A);return N(O.beta,_,R,k,$)}else return S.wNAFCachedUnsafe(P,I)}multiplyAndAddUnsafe(I,O,P){const k=this.multiplyUnsafe(O).add(I.multiplyUnsafe(P));return k.is0()?void 0:k}toAffine(I){return v(this,I)}isTorsionFree(){const{isTorsionFree:I}=e;return s===Rl?!0:I?I(b,this):S.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:I}=e;return s===Rl?this:I?I(b,this):this.multiplyUnsafe(s)}toBytes(I=!0){return Wh("isCompressed",I),this.assertValidity(),u(b,this,I)}toRawBytes(I=!0){return this.toBytes(I)}toHex(I=!0){return mu(this.toBytes(I))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}b.BASE=new b(t.Gx,t.Gy,n.ONE),b.ZERO=new b(n.ZERO,n.ONE,n.ZERO),b.Fp=n,b.Fn=r;const E=r.BITS,S=XM(b,e.endo?Math.ceil(E/2):E);return b}function H2(t){return Uint8Array.of(t?2:3)}function gF(t,e,n={}){Hf(e,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=e.randomBytes||zc,s=e.hmac||((P,...k)=>Lf(e.hash,P,Ro(...k))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o;function l(P){const k=a>>Rl;return P>k}function u(P){return l(P)?o.neg(P):P}function d(P,k){if(!o.isValidNot0(k))throw new Error(`invalid signature ${P}: out of range 1..CURVE.n`)}class h{constructor(k,M,$){d("r",k),d("s",M),this.r=k,this.s=M,$!=null&&(this.recovery=$),Object.freeze(this)}static fromCompact(k){const M=o.BYTES,$=Ln("compactSignature",k,M*2);return new h(o.fromBytes($.subarray(0,M)),o.fromBytes($.subarray(M,M*2)))}static fromDER(k){const{r:M,s:$}=Vs.toSig(Ln("DER",k));return new h(M,$)}assertValidity(){}addRecoveryBit(k){return new h(this.r,this.s,k)}recoverPublicKey(k){const M=i.ORDER,{r:$,s:A,recovery:_}=this;if(_==null||![0,1,2,3].includes(_))throw new Error("recovery id invalid");if(a*dF<M&&_>1)throw new Error("recovery id is ambiguous for h>1 curve");const R=_===2||_===3?$+a:$;if(!i.isValid(R))throw new Error("recovery id 2 or 3 invalid");const B=i.toBytes(R),U=t.fromHex(Ro(H2((_&1)===0),B)),L=o.inv(R),j=w(Ln("msgHash",k)),q=o.create(-j*L),X=o.create(A*L),K=t.BASE.multiplyUnsafe(q).add(U.multiplyUnsafe(X));if(K.is0())throw new Error("point at infinify");return K.assertValidity(),K}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,o.neg(this.s),this.recovery):this}toBytes(k){if(k==="compact")return Ro(o.toBytes(this.r),o.toBytes(this.s));if(k==="der")return $y(Vs.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return mu(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return mu(this.toBytes("compact"))}}const f=j2(o,n.allowedPrivateKeyLengths,n.wrapPrivateKey),p={isValidPrivateKey(P){try{return f(P),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const P=a;return JM(r($2(P)),P)},precompute(P=8,k=t.BASE){return k.precompute(P,!1)}};function g(P,k=!0){return t.fromPrivateKey(P).toBytes(k)}function m(P){if(typeof P=="bigint")return!1;if(P instanceof t)return!0;const k=Ln("key",P).length,M=i.BYTES,$=M+1,A=2*M+1;if(!(n.allowedPrivateKeyLengths||o.BYTES===$))return k===$||k===A}function y(P,k,M=!0){if(m(P)===!0)throw new Error("first arg must be private key");if(m(k)===!1)throw new Error("second arg must be public key");return t.fromHex(k).multiply(f(P)).toBytes(M)}const v=e.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const k=Ff(P),M=P.length*8-c;return M>0?k>>BigInt(M):k},w=e.bits2int_modN||function(P){return o.create(v(P))},N=jf(c);function b(P){return Qm("num < 2^"+c,P,Ol,N),o.toBytes(P)}function E(P,k,M=S){if(["recovered","canonical"].some(K=>K in M))throw new Error("sign() legacy options not supported");const{hash:$}=e;let{lowS:A,prehash:_,extraEntropy:R}=M;A==null&&(A=!0),P=Ln("msgHash",P),e1(M),_&&(P=Ln("prehashed msgHash",$(P)));const B=w(P),U=f(k),L=[b(U),b(B)];if(R!=null&&R!==!1){const K=R===!0?r(i.BYTES):R;L.push(Ln("extraEntropy",K))}const j=Ro(...L),q=B;function X(K){const se=v(K);if(!o.isValidNot0(se))return;const ge=o.inv(se),Re=t.BASE.multiply(se).toAffine(),Ue=o.create(Re.x);if(Ue===Ol)return;const Ie=o.create(ge*o.create(q+Ue*U));if(Ie===Ol)return;let nt=(Re.x===Ue?0:2)|Number(Re.y&Rl),Ot=Ie;return A&&l(Ie)&&(Ot=u(Ie),nt^=1),new h(Ue,Ot,nt)}return{seed:j,k2sig:X}}const S={lowS:e.lowS,prehash:!1},x={lowS:e.lowS,prehash:!1};function I(P,k,M=S){const{seed:$,k2sig:A}=E(P,k,M);return FM(e.hash.outputLen,o.BYTES,s)($,A)}t.BASE.precompute(8);function O(P,k,M,$=x){const A=P;k=Ln("msgHash",k),M=Ln("publicKey",M),e1($);const{lowS:_,prehash:R,format:B}=$;if("strict"in $)throw new Error("options.strict was renamed to lowS");if(B!==void 0&&!["compact","der","js"].includes(B))throw new Error('format must be "compact", "der" or "js"');const U=typeof A=="string"||Dy(A),L=!U&&!B&&typeof A=="object"&&A!==null&&typeof A.r=="bigint"&&typeof A.s=="bigint";if(!U&&!L)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let j,q;try{if(L)if(B===void 0||B==="js")j=new h(A.r,A.s);else throw new Error("invalid format");if(U){try{B!=="compact"&&(j=h.fromDER(A))}catch(nt){if(!(nt instanceof Vs.Err))throw nt}!j&&B!=="der"&&(j=h.fromCompact(A))}q=t.fromHex(M)}catch{return!1}if(!j||_&&j.hasHighS())return!1;R&&(k=e.hash(k));const{r:X,s:K}=j,se=w(k),ge=o.inv(K),Re=o.create(se*ge),Ue=o.create(X*ge),Ie=t.BASE.multiplyUnsafe(Re).add(q.multiplyUnsafe(Ue));return Ie.is0()?!1:o.create(Ie.x)===X}return Object.freeze({getPublicKey:g,getSharedSecret:y,sign:I,verify:O,utils:p,Point:t,Signature:h})}function mF(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp,r=qc(e.n,t.nBitLength),s={Fp:n,Fn:r,allowedPrivateKeyLengths:t.allowedPrivateKeyLengths,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,wrapPrivateKey:t.wrapPrivateKey,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:s}}function yF(t){const{CURVE:e,curveOpts:n}=mF(t),r={hash:t.hash,hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,ecdsaOpts:r}}function wF(t,e){return Object.assign({},e,{ProjectivePoint:e.Point,CURVE:t})}function bF(t){const{CURVE:e,curveOpts:n,ecdsaOpts:r}=yF(t),s=pF(e,n),i=gF(s,r,n);return wF(t,i)}function e0(t,e){const n=r=>bF({...t,hash:r});return{...n(e),create:n}}const z2={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},q2={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},W2={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},EF=qc(z2.p),vF=qc(q2.p),AF=qc(W2.p),CF=e0({...z2,Fp:EF,lowS:!1},$f);e0({...q2,Fp:vF,lowS:!1},OL),e0({...W2,Fp:AF,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},PL);const IF=CF,V2="base10",Nn="base16",Gr="base64pad",Mi="base64url",rd="utf8",G2=0,ti=1,sd=2,_F=0,t1=1,kl=12,zy=32;function NF(){const t=Xm.utils.randomPrivateKey(),e=Xm.getPublicKey(t);return{privateKey:Wn(t,Nn),publicKey:Wn(e,Nn)}}function t0(){const t=zc(zy);return Wn(t,Nn)}function SF(t,e){const n=Xm.getSharedSecret(Er(t,Nn),Er(e,Nn)),r=$M(Mf,n,void 0,void 0,zy);return Wn(r,Nn)}function lh(t){const e=Mf(Er(t,Nn));return Wn(e,Nn)}function fs(t){const e=Mf(Er(t,rd));return Wn(e,Nn)}function K2(t){return Er(`${t}`,V2)}function ea(t){return Number(Wn(t,V2))}function J2(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Y2(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4;return e+"=".repeat(n)}function xF(t){const e=K2(typeof t.type<"u"?t.type:G2);if(ea(e)===ti&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof t.senderPublicKey<"u"?Er(t.senderPublicKey,Nn):void 0,r=typeof t.iv<"u"?Er(t.iv,Nn):zc(kl),s=Er(t.symKey,Nn),i=x2(s,r).encrypt(Er(t.message,rd)),o=Z2({type:e,sealed:i,iv:r,senderPublicKey:n});return t.encoding===Mi?J2(o):o}function TF(t){const e=Er(t.symKey,Nn),{sealed:n,iv:r}=wu({encoded:t.encoded,encoding:t.encoding}),s=x2(e,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return Wn(s,rd)}function PF(t,e){const n=K2(sd),r=zc(kl),s=Er(t,rd),i=Z2({type:n,sealed:s,iv:r});return e===Mi?J2(i):i}function OF(t,e){const{sealed:n}=wu({encoded:t,encoding:e});return Wn(n,rd)}function Z2(t){if(ea(t.type)===sd)return Wn(Tl([t.type,t.sealed]),Gr);if(ea(t.type)===ti){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Wn(Tl([t.type,t.senderPublicKey,t.iv,t.sealed]),Gr)}return Wn(Tl([t.type,t.iv,t.sealed]),Gr)}function wu(t){const e=(t.encoding||Gr)===Mi?Y2(t.encoded):t.encoded,n=Er(e,Gr),r=n.slice(_F,t1),s=t1;if(ea(r)===ti){const c=s+zy,l=c+kl,u=n.slice(s,c),d=n.slice(c,l),h=n.slice(l);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(ea(r)===sd){const c=n.slice(s),l=zc(kl);return{type:r,sealed:c,iv:l}}const i=s+kl,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function RF(t,e){const n=wu({encoded:t,encoding:e?.encoding});return Q2({type:ea(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?Wn(n.senderPublicKey,Nn):void 0,receiverPublicKey:e?.receiverPublicKey})}function Q2(t){const e=t?.type||G2;if(e===ti){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function n1(t){return t.type===ti&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function r1(t){return t.type===sd}function kF(t){const e=Buffer.from(t.x,"base64"),n=Buffer.from(t.y,"base64");return Tl([new Uint8Array([4]),e,n])}function DF(t,e){const[n,r,s]=t.split("."),i=Buffer.from(Y2(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${n}.${r}`,l=Mf(c),u=kF(e);if(!IF.verify(Tl([o,a]),l,u))throw new Error("Invalid signature");return Um(t).payload}const UF="irn";function Gh(t){return t?.relay||{protocol:UF}}function El(t){const e=y4[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function BF(t,e="-"){const n={},r="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=t[s];n[i]=o}}),n}function s1(t){if(!t.includes("wc:")){const l=l2(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),n=t.indexOf("?")!==-1?t.indexOf("?"):void 0,r=t.substring(0,e),s=t.substring(e+1,n).split("@"),i=typeof n<"u"?t.substring(n):"",o=new URLSearchParams(i),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:$F(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:BF(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function $F(t){return t.startsWith("//")?t.substring(2):t}function LF(t,e="-"){const n="relay",r={};return Object.keys(t).forEach(s=>{const i=s,o=n+e+i;t[i]&&(r[o]=t[i])}),r}function i1(t){const e=new URLSearchParams,n=LF(t.relay);Object.keys(n).sort().forEach(s=>{e.set(s,n[s])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const r=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${r}`}function $d(t,e,n){return`${t}?wc_ev=${n}&topic=${e}`}var MF=Object.defineProperty,FF=Object.defineProperties,jF=Object.getOwnPropertyDescriptors,o1=Object.getOwnPropertySymbols,HF=Object.prototype.hasOwnProperty,zF=Object.prototype.propertyIsEnumerable,a1=(t,e,n)=>e in t?MF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qF=(t,e)=>{for(var n in e||(e={}))HF.call(e,n)&&a1(t,n,e[n]);if(o1)for(var n of o1(e))zF.call(e,n)&&a1(t,n,e[n]);return t},WF=(t,e)=>FF(t,jF(e));function Wc(t){const e=[];return t.forEach(n=>{const[r,s]=n.split(":");e.push(`${r}:${s}`)}),e}function VF(t){const e=[];return Object.values(t).forEach(n=>{e.push(...Wc(n.accounts))}),e}function GF(t,e){const n=[];return Object.values(t).forEach(r=>{Wc(r.accounts).includes(e)&&n.push(...r.methods)}),n}function KF(t,e){const n=[];return Object.values(t).forEach(r=>{Wc(r.accounts).includes(e)&&n.push(...r.events)}),n}function zf(t){return t.includes(":")}function Ya(t){return zf(t)?t.split(":")[0]:t}function c1(t){var e,n,r;const s={};if(!vs(t))return s;for(const[i,o]of Object.entries(t)){const a=zf(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=Ya(i);s[u]=WF(qF({},s[u]),{chains:Es(a,(e=s[u])==null?void 0:e.chains),methods:Es(c,(n=s[u])==null?void 0:n.methods),events:Es(l,(r=s[u])==null?void 0:r.events)})}return s}function JF(t){const e={};return t?.forEach(n=>{var r;const[s,i]=n.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(n),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function l1(t,e){e=e.map(r=>r.replace("did:pkh:",""));const n=JF(e);for(const[r,s]of Object.entries(n))s.methods?s.methods=Es(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return n}function YF(t,e){var n,r,s,i,o,a;const c=c1(t),l=c1(e),u={},d=Object.keys(c).concat(Object.keys(l));for(const h of d)u[h]={chains:Es((n=c[h])==null?void 0:n.chains,(r=l[h])==null?void 0:r.chains),methods:Es((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:Es((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const ZF={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},QF={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Z(t,e){const{message:n,code:r}=QF[t];return{message:e?`${n} ${e}`:n,code:r}}function bt(t,e){const{message:n,code:r}=ZF[t];return{message:e?`${n} ${e}`:n,code:r}}function ni(t,e){return!!Array.isArray(t)}function vs(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function rn(t){return typeof t>"u"}function kt(t,e){return e&&rn(t)?!0:typeof t=="string"&&!!t.trim().length}function qy(t,e){return e&&rn(t)?!0:typeof t=="number"&&!isNaN(t)}function XF(t,e){const{requiredNamespaces:n}=e,r=Object.keys(t.namespaces),s=Object.keys(n);let i=!0;return Oo(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=Wc(a),d=n[o];(!Oo(s2(o,d),u)||!Oo(d.methods,c)||!Oo(d.events,l))&&(i=!1)}),i):!1}function Kh(t){return kt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function e9(t){if(kt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const n=e[0]+":"+e[1];return!!e[2]&&Kh(n)}}return!1}function t9(t){function e(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(kt(t,!1)){if(e(t))return!0;const n=l2(t);return e(n)}}catch{}return!1}function n9(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function r9(t){return t?.topic}function s9(t,e){let n=null;return kt(t?.publicKey,!1)||(n=Z("MISSING_OR_INVALID",`${e} controller public key should be a string`)),n}function u1(t){let e=!0;return ni(t)?t.length&&(e=t.every(n=>kt(n,!1))):e=!1,e}function i9(t,e,n){let r=null;return ni(e)&&e.length?e.forEach(s=>{r||Kh(s)||(r=bt("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Kh(t)||(r=bt("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function o9(t,e,n){let r=null;return Object.entries(t).forEach(([s,i])=>{if(r)return;const o=i9(s,s2(s,i),`${e} ${n}`);o&&(r=o)}),r}function a9(t,e){let n=null;return ni(t)?t.forEach(r=>{n||e9(r)||(n=bt("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=bt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function c9(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=a9(r?.accounts,`${e} namespace`);s&&(n=s)}),n}function l9(t,e){let n=null;return u1(t?.methods)?u1(t?.events)||(n=bt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):n=bt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),n}function X2(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=l9(r,`${e}, namespace`);s&&(n=s)}),n}function u9(t,e,n){let r=null;if(t&&vs(t)){const s=X2(t,e);s&&(r=s);const i=o9(t,e,n);i&&(r=i)}else r=Z("MISSING_OR_INVALID",`${e}, ${n} should be an object with data`);return r}function pg(t,e){let n=null;if(t&&vs(t)){const r=X2(t,e);r&&(n=r);const s=c9(t,e);s&&(n=s)}else n=Z("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return n}function eN(t){return kt(t.protocol,!0)}function d9(t,e){let n=!1;return t?t&&ni(t)&&t.length&&t.forEach(r=>{n=eN(r)}):n=!0,n}function h9(t){return typeof t=="number"}function Bn(t){return typeof t<"u"&&typeof t!==null}function f9(t){return!(!t||typeof t!="object"||!t.code||!qy(t.code,!1)||!t.message||!kt(t.message,!1))}function p9(t){return!(rn(t)||!kt(t.method,!1))}function g9(t){return!(rn(t)||rn(t.result)&&rn(t.error)||!qy(t.id,!1)||!kt(t.jsonrpc,!1))}function m9(t){return!(rn(t)||!kt(t.name,!1))}function d1(t,e){return!(!Kh(e)||!VF(t).includes(e))}function y9(t,e,n){return kt(n,!1)?GF(t,e).includes(n):!1}function w9(t,e,n){return kt(n,!1)?KF(t,e).includes(n):!1}function h1(t,e,n){let r=null;const s=b9(t),i=E9(e),o=Object.keys(s),a=Object.keys(i),c=f1(Object.keys(t)),l=f1(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(r=Z("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),Oo(o,a)||(r=Z("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||r)return;const h=Wc(e[d].accounts);h.includes(d)||(r=Z("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{r||(Oo(s[d].methods,i[d].methods)?Oo(s[d].events,i[d].events)||(r=Z("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${d}`)):r=Z("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function b9(t){const e={};return Object.keys(t).forEach(n=>{var r;n.includes(":")?e[n]=t[n]:(r=t[n].chains)==null||r.forEach(s=>{e[s]={methods:t[n].methods,events:t[n].events}})}),e}function f1(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function E9(t){const e={};return Object.keys(t).forEach(n=>{n.includes(":")?e[n]=t[n]:Wc(t[n].accounts)?.forEach(s=>{e[s]={accounts:t[n].accounts.filter(i=>i.includes(`${s}:`)),methods:t[n].methods,events:t[n].events}})}),e}function v9(t,e){return qy(t,!1)&&t<=e.max&&t>=e.min}function p1(){const t=td();return new Promise(e=>{switch(t){case sr.browser:e(A9());break;case sr.reactNative:e(C9());break;case sr.node:e(I9());break;default:e(!0)}})}function A9(){return Hc()&&navigator?.onLine}async function C9(){return ao()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function I9(){return!0}function _9(t){switch(td()){case sr.browser:N9(t);break;case sr.reactNative:S9(t);break}}function N9(t){!ao()&&Hc()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function S9(t){ao()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}function x9(){var t;return Hc()&&ai.getDocument()?((t=ai.getDocument())==null?void 0:t.visibilityState)==="visible":!0}const gg={};class al{static get(e){return gg[e]}static set(e,n){gg[e]=n}static delete(e){delete gg[e]}}function T9(t){const e=jc.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function P9({publicKey:t,signature:e,payload:n}){var r;const s=n0(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=k9(n.address),a=n.era==="00"?new Uint8Array([0]):n0(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(n.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${R9(n.tip)}`),d=U9(u),h=new Uint8Array([0,...t,o,...e,...a,...l,...d,...s]),f=D9(h.length+1);return new Uint8Array([...f,i,...h])}function O9(t){const e=n0(t),n=v4.blake2b(e,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function n0(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function R9(t){return t.startsWith("0x")?t.slice(2):t}function k9(t){const e=jc.decode(t)[0];return e===42?0:e===60?2:1}function D9(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function U9(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function B9(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),n=T9(t.transaction.address),r=P9({publicKey:n,signature:e,payload:t.transaction}),s=Buffer.from(r).toString("hex");return O9(s)}const $9="PARSE_ERROR",L9="INVALID_REQUEST",M9="METHOD_NOT_FOUND",F9="INVALID_PARAMS",tN="INTERNAL_ERROR",Wy="SERVER_ERROR",j9=[-32700,-32600,-32601,-32602,-32603],Dl={[$9]:{code:-32700,message:"Parse error"},[L9]:{code:-32600,message:"Invalid Request"},[M9]:{code:-32601,message:"Method not found"},[F9]:{code:-32602,message:"Invalid params"},[tN]:{code:-32603,message:"Internal error"},[Wy]:{code:-32e3,message:"Server error"}},nN=Wy;function H9(t){return j9.includes(t)}function g1(t){return Object.keys(Dl).includes(t)?Dl[t]:Dl[nN]}function z9(t){const e=Object.values(Dl).find(n=>n.code===t);return e||Dl[nN]}function rN(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}var mg={},Ms={},m1;function q9(){if(m1)return Ms;m1=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.isBrowserCryptoAvailable=Ms.getSubtleCrypto=Ms.getBrowerCrypto=void 0;function t(){return hs?.crypto||hs?.msCrypto||{}}Ms.getBrowerCrypto=t;function e(){const r=t();return r.subtle||r.webkitSubtle}Ms.getSubtleCrypto=e;function n(){return!!t()&&!!e()}return Ms.isBrowserCryptoAvailable=n,Ms}var Fs={},y1;function W9(){if(y1)return Fs;y1=1,Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.isBrowser=Fs.isNode=Fs.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Fs.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Fs.isNode=e;function n(){return!t()&&!e()}return Fs.isBrowser=n,Fs}var w1;function V9(){return w1||(w1=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ju;e.__exportStar(q9(),t),e.__exportStar(W9(),t)}(mg)),mg}var G9=V9();function us(t=3){const e=Date.now()*Math.pow(10,t),n=Math.floor(Math.random()*Math.pow(10,t));return e+n}function Uo(t=6){return BigInt(us(t))}function qi(t,e,n){return{id:n||us(),jsonrpc:"2.0",method:t,params:e}}function qf(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Wf(t,e,n){return{id:t,jsonrpc:"2.0",error:K9(e)}}function K9(t,e){return typeof t>"u"?g1(tN):(typeof t=="string"&&(t=Object.assign(Object.assign({},g1(Wy)),{message:t})),H9(t.code)&&(t=z9(t.code)),t)}let J9=class{},Y9=class extends J9{constructor(){super()}},Z9=class extends Y9{constructor(e){super()}};const Q9="^https?:",X9="^wss?:";function e7(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function sN(t,e){const n=e7(t);return typeof n>"u"?!1:new RegExp(e).test(n)}function b1(t){return sN(t,Q9)}function E1(t){return sN(t,X9)}function t7(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function iN(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Vy(t){return iN(t)&&"method"in t}function Vf(t){return iN(t)&&(ds(t)||mr(t))}function ds(t){return"result"in t}function mr(t){return"error"in t}let Tr=class extends Z9{constructor(e){super(e),this.events=new xr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(qi(e.method,e.params||[],e.id||Uo().toString()),n)}async requestStrict(e,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{mr(i)?s(i.error):r(i.result)});try{await this.connection.send(e,n)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Vf(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const n7=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),r7=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",v1=t=>t.split("?")[0],A1=10,s7=n7();let i7=class{constructor(e){if(this.url=e,this.events=new xr.EventEmitter,this.registering=!1,!E1(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(oi(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!E1(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((n,r)=>{const s=G9.isReactNative()?void 0:{rejectUnauthorized:!t7(e)},i=new s7(e,[],s);r7()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(e){e.onmessage=n=>this.onPayload(n),e.onclose=n=>this.onClose(n),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?Qo(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=Wf(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return rN(e,v1(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>A1&&this.events.setMaxListeners(A1)}emitError(e){const n=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${v1(this.url)}`));return this.events.emit("register_error",n),n}};var o7={};const oN="wc",aN=2,r0="core",Ss=`${oN}@2:${r0}:`,a7={logger:"error"},c7={database:":memory:"},l7="crypto",C1="client_ed25519_seed",u7=Q.ONE_DAY,d7="keychain",h7="0.3",f7="messages",p7="0.3",I1=Q.SIX_HOURS,g7="publisher",cN="irn",m7="error",lN="wss://relay.walletconnect.org",y7="relayer",Kt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},w7="_subscription",dr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},b7=.1,s0="2.21.5",ft={link_mode:"link_mode",relay:"relay"},uh={inbound:"inbound",outbound:"outbound"},E7="0.3",v7="WALLETCONNECT_CLIENT_ID",_1="WALLETCONNECT_LINK_MODE_APPS",Qn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},A7="subscription",C7="0.3",I7="pairing",_7="0.3",cl={wc_pairingDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:0},res:{ttl:Q.ONE_DAY,prompt:!1,tag:0}}},Co={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Dr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},N7="history",S7="0.3",x7="expirer",gr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},T7="0.3",P7="verify-api",O7="https://verify.walletconnect.com",uN="https://verify.walletconnect.org",Ul=uN,R7=`${Ul}/v3`,k7=[O7,uN],D7="echo",U7="https://echo.walletconnect.com",ls={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Hs={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Ur={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},fo={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},po={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},ll={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},B7=.1,$7="event-client",L7=86400,M7="https://pulse.walletconnect.org/batch";function F7(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,y=0,v=p.length;y!==v&&p[y]===0;)y++,g++;for(var w=(v-y)*u+1>>>0,N=new Uint8Array(w);y!==v;){for(var b=p[y],E=0,S=w-1;(b!==0||E<m)&&S!==-1;S--,E++)b+=256*N[S]>>>0,N[S]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");m=E,y++}for(var x=w-m;x!==w&&N[x]===0;)x++;for(var I=c.repeat(g);x<w;++x)I+=t.charAt(N[x]);return I}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,y=0;p[g]===c;)m++,g++;for(var v=(p.length-g)*l+1>>>0,w=new Uint8Array(v);p[g];){var N=n[p.charCodeAt(g)];if(N===255)return;for(var b=0,E=v-1;(N!==0||b<y)&&E!==-1;E--,b++)N+=a*w[E]>>>0,w[E]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");y=b,g++}if(p[g]!==" "){for(var S=v-y;S!==v&&w[S]===0;)S++;for(var x=new Uint8Array(m+(v-S)),I=m;S!==v;)x[I++]=w[S++];return x}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var j7=F7,H7=j7;const dN=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},z7=t=>new TextEncoder().encode(t),q7=t=>new TextDecoder().decode(t);class W7{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class V7{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return hN(this,e)}}class G7{constructor(e){this.decoders=e}or(e){return hN(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const hN=(t,e)=>new G7({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class K7{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new W7(e,n,r),this.decoder=new V7(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Gf=({name:t,prefix:e,encode:n,decode:r})=>new K7(t,e,n,r),id=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=H7(n,e);return Gf({prefix:t,name:e,encode:r,decode:i=>dN(s(i))})},J7=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Y7=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},hn=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>Gf({prefix:e,name:t,encode(s){return Y7(s,r,n)},decode(s){return J7(s,r,n,t)}}),Z7=Gf({prefix:"\0",name:"identity",encode:t=>q7(t),decode:t=>z7(t)});var Q7=Object.freeze({__proto__:null,identity:Z7});const X7=hn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ej=Object.freeze({__proto__:null,base2:X7});const tj=hn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var nj=Object.freeze({__proto__:null,base8:tj});const rj=id({prefix:"9",name:"base10",alphabet:"0123456789"});var sj=Object.freeze({__proto__:null,base10:rj});const ij=hn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),oj=hn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var aj=Object.freeze({__proto__:null,base16:ij,base16upper:oj});const cj=hn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),lj=hn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uj=hn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dj=hn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),hj=hn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),fj=hn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pj=hn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gj=hn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),mj=hn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var yj=Object.freeze({__proto__:null,base32:cj,base32upper:lj,base32pad:uj,base32padupper:dj,base32hex:hj,base32hexupper:fj,base32hexpad:pj,base32hexpadupper:gj,base32z:mj});const wj=id({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),bj=id({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ej=Object.freeze({__proto__:null,base36:wj,base36upper:bj});const vj=id({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Aj=id({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Cj=Object.freeze({__proto__:null,base58btc:vj,base58flickr:Aj});const Ij=hn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_j=hn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Nj=hn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Sj=hn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var xj=Object.freeze({__proto__:null,base64:Ij,base64pad:_j,base64url:Nj,base64urlpad:Sj});const fN=Array.from(""),Tj=fN.reduce((t,e,n)=>(t[n]=e,t),[]),Pj=fN.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function Oj(t){return t.reduce((e,n)=>(e+=Tj[n],e),"")}function Rj(t){const e=[];for(const n of t){const r=Pj[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const kj=Gf({prefix:"",name:"base256emoji",encode:Oj,decode:Rj});var Dj=Object.freeze({__proto__:null,base256emoji:kj}),Uj=pN,N1=128,Bj=-128,$j=Math.pow(2,31);function pN(t,e,n){e=e||[],n=n||0;for(var r=n;t>=$j;)e[n++]=t&255|N1,t/=128;for(;t&Bj;)e[n++]=t&255|N1,t>>>=7;return e[n]=t|0,pN.bytes=n-r+1,e}var Lj=i0,Mj=128,S1=127;function i0(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw i0.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&S1)<<s:(o&S1)*Math.pow(2,s),s+=7}while(o>=Mj);return i0.bytes=i-r,n}var Fj=Math.pow(2,7),jj=Math.pow(2,14),Hj=Math.pow(2,21),zj=Math.pow(2,28),qj=Math.pow(2,35),Wj=Math.pow(2,42),Vj=Math.pow(2,49),Gj=Math.pow(2,56),Kj=Math.pow(2,63),Jj=function(t){return t<Fj?1:t<jj?2:t<Hj?3:t<zj?4:t<qj?5:t<Wj?6:t<Vj?7:t<Gj?8:t<Kj?9:10},Yj={encode:Uj,decode:Lj,encodingLength:Jj},gN=Yj;const x1=(t,e,n=0)=>(gN.encode(t,e,n),e),T1=t=>gN.encodingLength(t),o0=(t,e)=>{const n=e.byteLength,r=T1(t),s=r+T1(n),i=new Uint8Array(s+n);return x1(t,i,0),x1(n,i,r),i.set(e,s),new Zj(t,n,e,i)};class Zj{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}}const mN=({name:t,code:e,encode:n})=>new Qj(t,e,n);class Qj{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?o0(this.code,n):n.then(r=>o0(this.code,r))}else throw Error("Unknown type, must be binary type")}}const yN=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Xj=mN({name:"sha2-256",code:18,encode:yN("SHA-256")}),eH=mN({name:"sha2-512",code:19,encode:yN("SHA-512")});var tH=Object.freeze({__proto__:null,sha256:Xj,sha512:eH});const wN=0,nH="identity",bN=dN,rH=t=>o0(wN,bN(t)),sH={code:wN,name:nH,encode:bN,digest:rH};var iH=Object.freeze({__proto__:null,identity:sH});new TextEncoder,new TextDecoder;const P1={...Q7,...ej,...nj,...sj,...aj,...yj,...Ej,...Cj,...xj,...Dj};({...tH,...iH});function EN(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function oH(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?EN(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function vN(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const O1=vN("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),yg=vN("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=oH(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),aH={utf8:O1,"utf-8":O1,hex:P1.base16,latin1:yg,ascii:yg,binary:yg,...P1};function cH(t,e="utf8"){const n=aH[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?EN(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}var lH=Object.defineProperty,uH=(t,e,n)=>e in t?lH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,os=(t,e,n)=>uH(t,typeof e!="symbol"?e+"":e,n);class dH{constructor(e,n){this.core=e,this.logger=n,os(this,"keychain",new Map),os(this,"name",d7),os(this,"version",h7),os(this,"initialized",!1),os(this,"storagePrefix",Ss),os(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),os(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),os(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),os(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),os(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=wn(n,this.name)}get context(){return Jn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,qm(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Wm(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var hH=Object.defineProperty,fH=(t,e,n)=>e in t?hH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xt=(t,e,n)=>fH(t,typeof e!="symbol"?e+"":e,n);class pH{constructor(e,n,r){this.core=e,this.logger=n,Xt(this,"name",l7),Xt(this,"keychain"),Xt(this,"randomSessionIdentifier",t0()),Xt(this,"initialized",!1),Xt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Xt(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Xt(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=eE(s);return S_(i.publicKey)}),Xt(this,"generateKeyPair",()=>{this.isInitialized();const s=NF();return this.setPrivateKey(s.publicKey,s.privateKey)}),Xt(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=eE(i),a=this.randomSessionIdentifier;return await AU(a,s,u7,o)}),Xt(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=SF(a,i);return this.setSymKey(c,o)}),Xt(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||lh(s);return await this.keychain.set(o,s),o}),Xt(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Xt(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Xt(this,"encode",async(s,i,o)=>{this.isInitialized();const a=Q2(o),c=oi(i);if(r1(a))return PF(c,o?.encoding);if(n1(a)){const h=a.senderPublicKey,f=a.receiverPublicKey;s=await this.generateSharedKey(h,f)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return xF({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),Xt(this,"decode",async(s,i,o)=>{this.isInitialized();const a=RF(i,o);if(r1(a)){const c=OF(i,o?.encoding);return Qo(c)}if(n1(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=TF({symKey:c,encoded:i,encoding:o?.encoding});return Qo(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Xt(this,"getPayloadType",(s,i=Gr)=>{const o=wu({encoded:s,encoding:i});return ea(o.type)}),Xt(this,"getPayloadSenderPublicKey",(s,i=Gr)=>{const o=wu({encoded:s,encoding:i});return o.senderPublicKey?Wn(o.senderPublicKey,Nn):void 0}),this.core=e,this.logger=wn(n,this.name),this.keychain=r||new dH(this.core,this.logger)}get context(){return Jn(this.logger)}async setPrivateKey(e,n){return await this.keychain.set(e,n),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(C1)}catch{e=t0(),await this.keychain.set(C1,e)}return cH(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var gH=Object.defineProperty,mH=Object.defineProperties,yH=Object.getOwnPropertyDescriptors,R1=Object.getOwnPropertySymbols,wH=Object.prototype.hasOwnProperty,bH=Object.prototype.propertyIsEnumerable,a0=(t,e,n)=>e in t?gH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,EH=(t,e)=>{for(var n in e||(e={}))wH.call(e,n)&&a0(t,n,e[n]);if(R1)for(var n of R1(e))bH.call(e,n)&&a0(t,n,e[n]);return t},vH=(t,e)=>mH(t,yH(e)),Zn=(t,e,n)=>a0(t,typeof e!="symbol"?e+"":e,n);class AH extends E6{constructor(e,n){super(e,n),this.logger=e,this.core=n,Zn(this,"messages",new Map),Zn(this,"messagesWithoutClientAck",new Map),Zn(this,"name",f7),Zn(this,"version",p7),Zn(this,"initialized",!1),Zn(this,"storagePrefix",Ss),Zn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),Zn(this,"set",async(r,s,i)=>{this.isInitialized();const o=fs(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===uh.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,vH(EH({},c),{[o]:s}))}return await this.persist(),o}),Zn(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),Zn(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),Zn(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=fs(s);return typeof i[o]<"u"}),Zn(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=fs(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),Zn(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=wn(e,this.name),this.core=n}get context(){return Jn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,qm(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,qm(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Wm(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Wm(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var CH=Object.defineProperty,IH=Object.defineProperties,_H=Object.getOwnPropertyDescriptors,k1=Object.getOwnPropertySymbols,NH=Object.prototype.hasOwnProperty,SH=Object.prototype.propertyIsEnumerable,c0=(t,e,n)=>e in t?CH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ld=(t,e)=>{for(var n in e||(e={}))NH.call(e,n)&&c0(t,n,e[n]);if(k1)for(var n of k1(e))SH.call(e,n)&&c0(t,n,e[n]);return t},wg=(t,e)=>IH(t,_H(e)),Br=(t,e,n)=>c0(t,typeof e!="symbol"?e+"":e,n);class xH extends v6{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,Br(this,"events",new xr.EventEmitter),Br(this,"name",g7),Br(this,"queue",new Map),Br(this,"publishTimeout",Q.toMiliseconds(Q.ONE_MINUTE)),Br(this,"initialPublishTimeout",Q.toMiliseconds(Q.ONE_SECOND*15)),Br(this,"needsTransportRestart",!1),Br(this,"publish",async(r,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const a=i?.ttl||I1,c=Gh(i),l=i?.prompt||!1,u=i?.tag||0,d=i?.id||Uo().toString(),h={topic:r,message:s,opts:{ttl:a,relay:c,prompt:l,tag:u,id:d,attestation:i?.attestation,tvf:i?.tvf}},f=`Failed to publish payload, please try again. id:${d} tag:${u}`;try{const p=new Promise(async g=>{const m=({id:v})=>{h.opts.id===v&&(this.removeRequestFromQueue(v),this.relayer.events.removeListener(Kt.publish,m),g(h))};this.relayer.events.on(Kt.publish,m);const y=zi(new Promise((v,w)=>{this.rpcPublish({topic:r,message:s,ttl:a,prompt:l,tag:u,id:d,attestation:i?.attestation,tvf:i?.tvf}).then(v).catch(N=>{this.logger.warn(N,N?.message),w(N)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${d} tag:${u}`);try{await y,this.events.removeListener(Kt.publish,m)}catch(v){this.queue.set(d,wg(Ld({},h),{attempt:1})),this.logger.warn(v,v?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:d,topic:r,message:s,opts:i}}),await zi(p,this.publishTimeout,f)}catch(p){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(p),(o=i?.internal)!=null&&o.throwOnFailedPublish)throw p}finally{this.queue.delete(d)}}),Br(this,"on",(r,s)=>{this.events.on(r,s)}),Br(this,"once",(r,s)=>{this.events.once(r,s)}),Br(this,"off",(r,s)=>{this.events.off(r,s)}),Br(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=wn(n,this.name),this.registerEventListeners()}get context(){return Jn(this.logger)}async rpcPublish(e){var n,r,s,i;const{topic:o,message:a,ttl:c=I1,prompt:l,tag:u,id:d,attestation:h,tvf:f}=e,p={method:El(Gh().protocol).publish,params:Ld({topic:o,message:a,ttl:c,prompt:l,tag:u,attestation:h},f),id:d};rn((n=p.params)==null?void 0:n.prompt)&&((r=p.params)==null||delete r.prompt),rn((s=p.params)==null?void 0:s.tag)&&((i=p.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});const g=await this.relayer.request(p);return this.relayer.events.emit(Kt.publish,e),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,n)=>{const r=e.attempt+1;this.queue.set(n,wg(Ld({},e),{attempt:r}));const{topic:s,message:i,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${r}`),await this.rpcPublish(wg(Ld({},e),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(fa.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Kt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Kt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var TH=Object.defineProperty,PH=(t,e,n)=>e in t?TH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Sa=(t,e,n)=>PH(t,typeof e!="symbol"?e+"":e,n);class OH{constructor(){Sa(this,"map",new Map),Sa(this,"set",(e,n)=>{const r=this.get(e);this.exists(e,n)||this.map.set(e,[...r,n])}),Sa(this,"get",e=>this.map.get(e)||[]),Sa(this,"exists",(e,n)=>this.get(e).includes(n)),Sa(this,"delete",(e,n)=>{if(typeof n>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),Sa(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var RH=Object.defineProperty,kH=Object.defineProperties,DH=Object.getOwnPropertyDescriptors,D1=Object.getOwnPropertySymbols,UH=Object.prototype.hasOwnProperty,BH=Object.prototype.propertyIsEnumerable,l0=(t,e,n)=>e in t?RH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ul=(t,e)=>{for(var n in e||(e={}))UH.call(e,n)&&l0(t,n,e[n]);if(D1)for(var n of D1(e))BH.call(e,n)&&l0(t,n,e[n]);return t},bg=(t,e)=>kH(t,DH(e)),at=(t,e,n)=>l0(t,typeof e!="symbol"?e+"":e,n);class $H extends I6{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,at(this,"subscriptions",new Map),at(this,"topicMap",new OH),at(this,"events",new xr.EventEmitter),at(this,"name",A7),at(this,"version",C7),at(this,"pending",new Map),at(this,"cached",[]),at(this,"initialized",!1),at(this,"storagePrefix",Ss),at(this,"subscribeTimeout",Q.toMiliseconds(Q.ONE_MINUTE)),at(this,"initialSubscribeTimeout",Q.toMiliseconds(Q.ONE_SECOND*15)),at(this,"clientId"),at(this,"batchSubscribeTopicsLimit",500),at(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),at(this,"subscribe",async(r,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const i=Gh(s),o={topic:r,relay:i,transportType:s?.transportType};this.pending.set(r,o);const a=await this.rpcSubscribe(r,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),at(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof s?.id<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),at(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),at(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),at(this,"on",(r,s)=>{this.events.on(r,s)}),at(this,"once",(r,s)=>{this.events.once(r,s)}),at(this,"off",(r,s)=>{this.events.off(r,s)}),at(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),at(this,"start",async()=>{await this.onConnect()}),at(this,"stop",async()=>{await this.onDisconnect()}),at(this,"restart",async()=>{await this.restore(),await this.onRestart()}),at(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),at(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(fa.pulse,async()=>{await this.checkPending()}),this.events.on(Qn.created,async r=>{const s=Qn.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(Qn.deleted,async r=>{const s=Qn.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=wn(n,this.name),this.clientId=""}get context(){return Jn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,n){let r=!1;try{r=this.getSubscription(e).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,n){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,n)))}async unsubscribeById(e,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}});try{const s=Gh(r);await this.restartToComplete({topic:e,id:n,relay:s}),await this.rpcUnsubscribe(e,n,s);const i=bt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,n,r){var s;(!r||r?.transportType===ft.relay)&&await this.restartToComplete({topic:e,id:e,relay:n});const i={method:El(n.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=r?.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if(r?.transportType===ft.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(u=>this.logger.warn(u))},Q.toMiliseconds(Q.ONE_SECOND)),a;const c=new Promise(async u=>{const d=h=>{h.topic===e&&(this.events.removeListener(Qn.created,d),u(h.id))};this.events.on(Qn.created,d);try{const h=await zi(new Promise((f,p)=>{this.relayer.request(i).catch(g=>{this.logger.warn(g,g?.message),p(g)}).then(f)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Qn.created,d),u(h)}catch{}}),l=await zi(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return l?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Kt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const n=e[0].relay,r={method:El(n.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await zi(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Kt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const n=e[0].relay,r={method:El(n.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await zi(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Kt.connection_stalled)}return s}rpcUnsubscribe(e,n,r){const s={method:El(r.protocol).unsubscribe,params:{topic:e,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,n){this.setSubscription(e,bg(ul({},n),{id:e})),this.pending.delete(n.topic)}onBatchSubscribe(e){e.length&&e.forEach(n=>{this.setSubscription(n.id,ul({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(e,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,e)&&this.deleteSubscription(n,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:n}),this.addSubscription(e,n)}addSubscription(e,n){this.subscriptions.set(e,ul({},n)),this.topicMap.set(n.topic,e),this.events.emit(Qn.created,n)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const n=this.subscriptions.get(e);if(!n){const{message:r}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}deleteSubscription(e,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:n});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Qn.deleted,bg(ul({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Qn.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Qn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:n}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async n=>bg(ul({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const n=await this.rpcBatchFetchMessages(e);n&&n.messages&&(await K4(Q.toMiliseconds(Q.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return fs(e+await this.getClientId())}}var LH=Object.defineProperty,U1=Object.getOwnPropertySymbols,MH=Object.prototype.hasOwnProperty,FH=Object.prototype.propertyIsEnumerable,u0=(t,e,n)=>e in t?LH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,B1=(t,e)=>{for(var n in e||(e={}))MH.call(e,n)&&u0(t,n,e[n]);if(U1)for(var n of U1(e))FH.call(e,n)&&u0(t,n,e[n]);return t},We=(t,e,n)=>u0(t,typeof e!="symbol"?e+"":e,n);class jH extends A6{constructor(e){super(e),We(this,"protocol","wc"),We(this,"version",2),We(this,"core"),We(this,"logger"),We(this,"events",new xr.EventEmitter),We(this,"provider"),We(this,"messages"),We(this,"subscriber"),We(this,"publisher"),We(this,"name",y7),We(this,"transportExplicitlyClosed",!1),We(this,"initialized",!1),We(this,"connectionAttemptInProgress",!1),We(this,"relayUrl"),We(this,"projectId"),We(this,"packageName"),We(this,"bundleId"),We(this,"hasExperiencedNetworkDisruption",!1),We(this,"pingTimeout"),We(this,"heartBeatTimeout",Q.toMiliseconds(Q.THIRTY_SECONDS+Q.FIVE_SECONDS)),We(this,"reconnectTimeout"),We(this,"connectPromise"),We(this,"reconnectInProgress",!1),We(this,"requestsInFlight",[]),We(this,"connectTimeout",Q.toMiliseconds(Q.ONE_SECOND*15)),We(this,"request",async n=>{var r,s;this.logger.debug("Publishing Request Payload");const i=n.id||Uo().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:n.method,topic:(r=n.params)==null?void 0:r.topic},"relayer.request - publishing...");const o=`${i}:${((s=n.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),We(this,"resetPingTimeout",()=>{zh()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,r,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(r=(n=this.provider)==null?void 0:n.connection)==null?void 0:r.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o?.message)}},this.heartBeatTimeout))}),We(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),We(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(Kt.connect)}),We(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),We(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(Kt.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),We(this,"registerProviderListeners",()=>{this.provider.on(dr.payload,this.onPayloadHandler),this.provider.on(dr.connect,this.onConnectHandler),this.provider.on(dr.disconnect,this.onDisconnectHandler),this.provider.on(dr.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?wn(e.logger,this.name):Zu($c({level:e.logger||m7})),this.messages=new AH(this.logger,e.core),this.subscriber=new $H(this,this.logger),this.publisher=new xH(this,this.logger),this.relayUrl=e?.relayUrl||lN,this.projectId=e.projectId,R4()?this.packageName=IE():k4()&&(this.bundleId=IE()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return Jn(this.logger)}get connected(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,n,r){this.isInitialized(),await this.publisher.publish(e,n,r),await this.recordMessageEvent({topic:e,message:n,publishedAt:Date.now(),transportType:ft.relay},uh.outbound)}async subscribe(e,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||n?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((r=n?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n?.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(Qn.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Qn.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,B1({internal:{throwOnFailedPublish:o}},n)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,n){this.isInitialized(),await this.subscriber.unsubscribe(e,n)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await zi(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(e).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await p1())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+s?.message)}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(e,n){const{topic:r}=e;if(!n.sessionExists){const s=$t(Q.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(Kt.message,e),await this.recordMessageEvent(e,uh.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(dr.disconnect,i),await zi(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(dr.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(dr.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(dr.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,Q.toMiliseconds(n*1))),n++}}startPingTimeout(){var e,n,r,s,i;if(zh())try{(n=(e=this.provider)==null?void 0:e.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Tr(new i7(L4({sdkVersion:s0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,n){const{topic:r,message:s}=e;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(e){const{topic:n,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Vy(e)){if(!e.method.endsWith(w7))return;const n=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:ft.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(B1({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Vf(e)&&this.events.emit(Kt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,uh.inbound),this.events.emit(Kt.message,e))}async acknowledgePayload(e){const n=qf(e.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(dr.payload,this.onPayloadHandler),this.provider.off(dr.connect,this.onConnectHandler),this.provider.off(dr.disconnect,this.onDisconnectHandler),this.provider.off(dr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await p1();_9(async n=>{e!==n&&(e=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(fa.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&x9())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Kt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Q.toMiliseconds(b7)))))}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function HH(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function $1(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function L1(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const zH="[object RegExp]",qH="[object String]",WH="[object Number]",VH="[object Boolean]",M1="[object Arguments]",GH="[object Symbol]",KH="[object Date]",JH="[object Map]",YH="[object Set]",ZH="[object Array]",QH="[object Function]",XH="[object ArrayBuffer]",Eg="[object Object]",ez="[object Error]",tz="[object DataView]",nz="[object Uint8Array]",rz="[object Uint8ClampedArray]",sz="[object Uint16Array]",iz="[object Uint32Array]",oz="[object BigUint64Array]",az="[object Int8Array]",cz="[object Int16Array]",lz="[object Int32Array]",uz="[object BigInt64Array]",dz="[object Float32Array]",hz="[object Float64Array]";function fz(){}function F1(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function pz(t,e,n){return vl(t,e,void 0,void 0,void 0,void 0,n)}function vl(t,e,n,r,s,i,o){const a=o(t,e,n,r,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Bl(t,e,i,o)}return Bl(t,e,i,o)}function Bl(t,e,n,r){if(Object.is(t,e))return!0;let s=L1(t),i=L1(e);if(s===M1&&(s=Eg),i===M1&&(i=Eg),s!==i)return!1;switch(s){case qH:return t.toString()===e.toString();case WH:{const c=t.valueOf(),l=e.valueOf();return HH(c,l)}case VH:case KH:case GH:return Object.is(t.valueOf(),e.valueOf());case zH:return t.source===e.source&&t.flags===e.flags;case QH:return t===e}n=n??new Map;const o=n.get(t),a=n.get(e);if(o!=null&&a!=null)return o===e;n.set(t,e),n.set(e,t);try{switch(s){case JH:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!vl(l,e.get(c),c,t,e,n,r))return!1;return!0}case YH:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(f=>vl(d,f,void 0,t,e,n,r));if(h===-1)return!1;l.splice(h,1)}return!0}case ZH:case nz:case rz:case sz:case iz:case oz:case az:case cz:case lz:case uz:case dz:case hz:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!vl(t[c],e[c],c,t,e,n,r))return!1;return!0}case XH:return t.byteLength!==e.byteLength?!1:Bl(new Uint8Array(t),new Uint8Array(e),n,r);case tz:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Bl(new Uint8Array(t),new Uint8Array(e),n,r);case ez:return t.name===e.name&&t.message===e.message;case Eg:{if(!(Bl(t.constructor,e.constructor,n,r)||F1(t)&&F1(e)))return!1;const c=[...Object.keys(t),...$1(t)],l=[...Object.keys(e),...$1(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=t[d];if(!Object.hasOwn(e,d))return!1;const f=e[d];if(!vl(h,f,d,t,e,n,r))return!1}return!0}default:return!1}}finally{n.delete(t),n.delete(e)}}function gz(t,e){return pz(t,e,fz)}var mz=Object.defineProperty,j1=Object.getOwnPropertySymbols,yz=Object.prototype.hasOwnProperty,wz=Object.prototype.propertyIsEnumerable,d0=(t,e,n)=>e in t?mz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,H1=(t,e)=>{for(var n in e||(e={}))yz.call(e,n)&&d0(t,n,e[n]);if(j1)for(var n of j1(e))wz.call(e,n)&&d0(t,n,e[n]);return t},Rn=(t,e,n)=>d0(t,typeof e!="symbol"?e+"":e,n);class ga extends C6{constructor(e,n,r,s=Ss,i=void 0){super(e,n,r,s),this.core=e,this.logger=n,this.name=r,Rn(this,"map",new Map),Rn(this,"version",E7),Rn(this,"cached",[]),Rn(this,"initialized",!1),Rn(this,"getKey"),Rn(this,"storagePrefix",Ss),Rn(this,"recentlyDeleted",[]),Rn(this,"recentlyDeletedLimit",200),Rn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!rn(o)?this.map.set(this.getKey(o),o):n9(o)?this.map.set(o.id,o):r9(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Rn(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Rn(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Rn(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>gz(a[c],o[c]))):this.values)),Rn(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=H1(H1({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Rn(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=wn(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return Jn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const n=this.map.get(e);if(!n){if(this.recentlyDeleted.includes(e)){const{message:s}=Z("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:n}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var bz=Object.defineProperty,Ez=(t,e,n)=>e in t?bz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Be=(t,e,n)=>Ez(t,typeof e!="symbol"?e+"":e,n);class vz{constructor(e,n){this.core=e,this.logger=n,Be(this,"name",I7),Be(this,"version",_7),Be(this,"events",new wy),Be(this,"pairings"),Be(this,"initialized",!1),Be(this,"storagePrefix",Ss),Be(this,"ignoredPayloadTypes",[ti]),Be(this,"registeredMethods",[]),Be(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Be(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),Be(this,"create",async r=>{this.isInitialized();const s=t0(),i=await this.core.crypto.setSymKey(s),o=$t(Q.FIVE_MINUTES),a={protocol:cN},c={topic:i,expiry:o,relay:a,active:!1,methods:r?.methods},l=i1({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(Co.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r?.transportType}),{topic:i,uri:l}}),Be(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[ls.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=s1(r.uri);s.props.properties.topic=i,s.addTrace(ls.pairing_uri_validation_success),s.addTrace(ls.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(ls.existing_pairing),u.active)throw s.setError(Hs.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(ls.pairing_not_expired)}const d=c||$t(Q.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(ls.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(Co.create,h),s.addTrace(ls.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(ls.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Hs.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw s.setError(Hs.subscribe_pairing_topic_failure),f}return s.addTrace(ls.subscribe_pairing_topic_success),h}),Be(this,"activate",async({topic:r})=>{this.isInitialized();const s=$t(Q.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),Be(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Eo();this.events.once(Ze("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),Be(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),Be(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),Be(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Be(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",bt("USER_DISCONNECTED")),await this.deletePairing(s))}),Be(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return i1({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),Be(this,"sendRequest",async(r,s,i)=>{const o=qi(s,i),a=await this.core.crypto.encode(r,o),c=cl[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),Be(this,"sendResult",async(r,s,i)=>{const o=qf(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=cl[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Be(this,"sendError",async(r,s,i)=>{const o=Wf(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=cl[c]?cl[c].res:cl.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Be(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,bt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),Be(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>ki(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),Be(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),Be(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),Be(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(Co.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Be(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{ds(s)?this.events.emit(Ze("pairing_ping",i),{}):mr(s)&&this.events.emit(Ze("pairing_ping",i),{error:s.error})},500)}),Be(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(Co.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Be(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=bt("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),Be(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(bt("WC_METHOD_UNSUPPORTED",r))}),Be(this,"isValidPair",(r,s)=>{var i;if(!Bn(r)){const{message:a}=Z("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(Hs.malformed_pairing_uri),new Error(a)}if(!t9(r.uri)){const{message:a}=Z("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(Hs.malformed_pairing_uri),new Error(a)}const o=s1(r?.uri);if(!((i=o?.relay)!=null&&i.protocol)){const{message:a}=Z("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Hs.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=Z("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Hs.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Q.toMiliseconds(o?.expiryTimestamp)<Date.now()){s.setError(Hs.pairing_expired);const{message:a}=Z("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Be(this,"isValidPing",async r=>{if(!Bn(r)){const{message:i}=Z("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Be(this,"isValidDisconnect",async r=>{if(!Bn(r)){const{message:i}=Z("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Be(this,"isValidPairingTopic",async r=>{if(!kt(r,!1)){const{message:s}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(ki(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=Z("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=wn(n,this.name),this.pairings=new ga(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Jn(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Kt.message,async e=>{const{topic:n,message:r,transportType:s}=e;if(this.pairings.keys.includes(n)&&s!==ft.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);Vy(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):Vf(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(gr.expired,async e=>{const{topic:n}=c2(e.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(Co.expire,{topic:n}))})}}var Az=Object.defineProperty,Cz=(t,e,n)=>e in t?Az(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,en=(t,e,n)=>Cz(t,typeof e!="symbol"?e+"":e,n);class Iz extends b6{constructor(e,n){super(e,n),this.core=e,this.logger=n,en(this,"records",new Map),en(this,"events",new xr.EventEmitter),en(this,"name",N7),en(this,"version",S7),en(this,"cached",[]),en(this,"initialized",!1),en(this,"storagePrefix",Ss),en(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),en(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:$t(Q.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Dr.created,o)}),en(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=mr(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(Dr.updated,s))}),en(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),en(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Dr.deleted,i)}}),this.persist()}),en(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),en(this,"on",(r,s)=>{this.events.on(r,s)}),en(this,"once",(r,s)=>{this.events.once(r,s)}),en(this,"off",(r,s)=>{this.events.off(r,s)}),en(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=wn(n,this.name)}get context(){return Jn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:qi(n.request.method,n.request.params,n.id),chainId:n.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const n=this.records.get(e);if(!n){const{message:r}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Dr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:n}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Dr.created,e=>{const n=Dr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Dr.updated,e=>{const n=Dr.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Dr.deleted,e=>{const n=Dr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.core.heartbeat.on(fa.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(n=>{Q.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(Dr.deleted,n,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var _z=Object.defineProperty,Nz=(t,e,n)=>e in t?_z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mn=(t,e,n)=>Nz(t,typeof e!="symbol"?e+"":e,n);class Sz extends _6{constructor(e,n){super(e,n),this.core=e,this.logger=n,mn(this,"expirations",new Map),mn(this,"events",new xr.EventEmitter),mn(this,"name",x7),mn(this,"version",T7),mn(this,"cached",[]),mn(this,"initialized",!1),mn(this,"storagePrefix",Ss),mn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),mn(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),mn(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(gr.created,{target:i,expiration:o})}),mn(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),mn(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(gr.deleted,{target:s,expiration:i})}}),mn(this,"on",(r,s)=>{this.events.on(r,s)}),mn(this,"once",(r,s)=>{this.events.once(r,s)}),mn(this,"off",(r,s)=>{this.events.off(r,s)}),mn(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=wn(n,this.name)}get context(){return Jn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return M4(e);if(typeof e=="number")return F4(e);const{message:n}=Z("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(n)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(gr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:n}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const n=this.expirations.get(e);if(!n){const{message:r}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(e,n){const{expiry:r}=n;Q.toMiliseconds(r)-Date.now()<=0&&this.expire(e,n)}expire(e,n){this.expirations.delete(e),this.events.emit(gr.expired,{target:e,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,n)=>this.checkExpiry(n,e))}registerEventListeners(){this.core.heartbeat.on(fa.pulse,()=>this.checkExpirations()),this.events.on(gr.created,e=>{const n=gr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(gr.expired,e=>{const n=gr.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(gr.deleted,e=>{const n=gr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var xz=Object.defineProperty,Tz=(t,e,n)=>e in t?xz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Rt=(t,e,n)=>Tz(t,typeof e!="symbol"?e+"":e,n);class Pz extends N6{constructor(e,n,r){super(e,n,r),this.core=e,this.logger=n,this.store=r,Rt(this,"name",P7),Rt(this,"abortController"),Rt(this,"isDevEnv"),Rt(this,"verifyUrlV3",R7),Rt(this,"storagePrefix",Ss),Rt(this,"version",aN),Rt(this,"publicKey"),Rt(this,"fetchPromise"),Rt(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Q.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),Rt(this,"register",async s=>{if(!Hc()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=ai.getDocument(),u=this.startAbortTimer(Q.ONE_SECOND*5),d=await new Promise((h,f)=>{const p=()=>{window.removeEventListener("message",m),l.body.removeChild(g),f("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});const m=y=>{if(y.data&&typeof y.data=="string")try{const v=JSON.parse(y.data);if(v.type==="verify_attestation"){if(Um(v.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),h(v.attestation===null?"":v.attestation)}}catch(v){this.logger.warn(v)}};l.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(l){this.logger.warn(l)}return""}),Rt(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Um(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s?.verifyUrl);return this.fetchAttestation(o,c)}),Rt(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(Q.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),Rt(this,"getVerifyUrl",s=>{let i=s||Ul;return k7.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Ul}`),i=Ul),i}),Rt(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(Q.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),Rt(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),Rt(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),Rt(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),Rt(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),Rt(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),Rt(this,"validateAttestation",(s,i)=>{const o=DF(s,i.publicKey),a={hasExpired:Q.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=wn(n,this.name),this.abortController=new AbortController,this.isDevEnv=Oy(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Jn(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Q.toMiliseconds(e))}}var Oz=Object.defineProperty,Rz=(t,e,n)=>e in t?Oz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,z1=(t,e,n)=>Rz(t,typeof e!="symbol"?e+"":e,n);class kz extends S6{constructor(e,n){super(e,n),this.projectId=e,this.logger=n,z1(this,"context",D7),z1(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${U7}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=wn(n,this.context)}}var Dz=Object.defineProperty,q1=Object.getOwnPropertySymbols,Uz=Object.prototype.hasOwnProperty,Bz=Object.prototype.propertyIsEnumerable,h0=(t,e,n)=>e in t?Dz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dl=(t,e)=>{for(var n in e||(e={}))Uz.call(e,n)&&h0(t,n,e[n]);if(q1)for(var n of q1(e))Bz.call(e,n)&&h0(t,n,e[n]);return t},qt=(t,e,n)=>h0(t,typeof e!="symbol"?e+"":e,n);class $z extends x6{constructor(e,n,r=!0){super(e,n,r),this.core=e,this.logger=n,qt(this,"context",$7),qt(this,"storagePrefix",Ss),qt(this,"storageVersion",B7),qt(this,"events",new Map),qt(this,"shouldPersist",!1),qt(this,"init",async()=>{if(!Oy())try{const s={eventId:NE(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:o2(this.core.relayer.protocol,this.core.relayer.version,s0)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),qt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=NE(),u=this.core.projectId||"",d=Date.now(),h=dl({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),qt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return dl(dl({},a),this.setMethods(a.eventId))}),qt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),qt(this,"setEventListeners",()=>{this.core.heartbeat.on(fa.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{Q.fromMiliseconds(Date.now())-Q.fromMiliseconds(s.timestamp)>L7&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),qt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),qt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),qt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),qt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),qt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,dl(dl({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),qt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),qt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${M7}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${s0}${i}`,{method:"POST",body:JSON.stringify(s)})}),qt(this,"getAppDomain",()=>i2().url),this.logger=wn(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var Lz=Object.defineProperty,W1=Object.getOwnPropertySymbols,Mz=Object.prototype.hasOwnProperty,Fz=Object.prototype.propertyIsEnumerable,f0=(t,e,n)=>e in t?Lz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,V1=(t,e)=>{for(var n in e||(e={}))Mz.call(e,n)&&f0(t,n,e[n]);if(W1)for(var n of W1(e))Fz.call(e,n)&&f0(t,n,e[n]);return t},lt=(t,e,n)=>f0(t,typeof e!="symbol"?e+"":e,n);let jz=class AN extends g6{constructor(e){var n;super(e),lt(this,"protocol",oN),lt(this,"version",aN),lt(this,"name",r0),lt(this,"relayUrl"),lt(this,"projectId"),lt(this,"customStoragePrefix"),lt(this,"events",new xr.EventEmitter),lt(this,"logger"),lt(this,"heartbeat"),lt(this,"relayer"),lt(this,"crypto"),lt(this,"storage"),lt(this,"history"),lt(this,"expirer"),lt(this,"pairing"),lt(this,"verify"),lt(this,"echoClient"),lt(this,"linkModeSupportedApps"),lt(this,"eventClient"),lt(this,"initialized",!1),lt(this,"logChunkController"),lt(this,"on",(a,c)=>this.events.on(a,c)),lt(this,"once",(a,c)=>this.events.once(a,c)),lt(this,"off",(a,c)=>this.events.off(a,c)),lt(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),lt(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:ft.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||lN,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=$c({level:typeof e?.logger=="string"&&e.logger?e.logger:a7.logger,name:r0}),{logger:i,chunkLoggerController:o}=Ey({opts:s,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=wn(i,this.name),this.heartbeat=new p5,this.crypto=new pH(this,this.logger,e?.keychain),this.history=new Iz(this,this.logger),this.expirer=new Sz(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Y5(V1(V1({},c7),e?.storageOptions)),this.relayer=new jH({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new vz(this,this.logger),this.verify=new Pz(this,this.logger,this.storage),this.echoClient=new kz(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new $z(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const n=new AN(e);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(v7,r),n}get context(){return Jn(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(_1,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(_1)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${e}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(e){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=e.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&o7.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const Hz=jz,CN="wc",IN=2,_N="client",Gy=`${CN}@${IN}:${_N}:`,vg={name:_N,logger:"error"},G1="WALLETCONNECT_DEEPLINK_CHOICE",zz="proposal",K1="Proposal expired",qz="session",xa=Q.SEVEN_DAYS,Wz="engine",Wt={wc_sessionPropose:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Q.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Q.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1119}}},Ag={min:Q.FIVE_MINUTES,max:Q.SEVEN_DAYS},as={idle:"IDLE",active:"ACTIVE"},Vz={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Gz="request",Kz=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Jz="wc",Yz="auth",Zz="authKeys",Qz="pairingTopics",Xz="requests",Kf=`${Jz}@${1.5}:${Yz}:`,dh=`${Kf}:PUB_KEY`;var eq=Object.defineProperty,tq=Object.defineProperties,nq=Object.getOwnPropertyDescriptors,J1=Object.getOwnPropertySymbols,rq=Object.prototype.hasOwnProperty,sq=Object.prototype.propertyIsEnumerable,p0=(t,e,n)=>e in t?eq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ht=(t,e)=>{for(var n in e||(e={}))rq.call(e,n)&&p0(t,n,e[n]);if(J1)for(var n of J1(e))sq.call(e,n)&&p0(t,n,e[n]);return t},kn=(t,e)=>tq(t,nq(e)),V=(t,e,n)=>p0(t,typeof e!="symbol"?e+"":e,n);class iq extends R6{constructor(e){super(e),V(this,"name",Wz),V(this,"events",new wy),V(this,"initialized",!1),V(this,"requestQueue",{state:as.idle,queue:[]}),V(this,"sessionRequestQueue",{state:as.idle,queue:[]}),V(this,"emittedSessionRequests",new J4({limit:500})),V(this,"requestQueueDelay",Q.ONE_SECOND),V(this,"expectedPairingMethodMap",new Map),V(this,"recentlyDeletedMap",new Map),V(this,"recentlyDeletedLimit",200),V(this,"relayMessageCache",[]),V(this,"pendingSessions",new Map),V(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Wt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Q.toMiliseconds(this.requestQueueDelay)))}),V(this,"connect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const r=kn(ht({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(r),r.optionalNamespaces=YF(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=r;let u=s,d,h=!1;try{if(u){const E=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=E.active}}catch(E){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),E}if(!u||!h){const{topic:E,uri:S}=await this.client.core.pairing.create();u=E,d=S}if(!u){const{message:E}=Z("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(E)}const f=await this.client.core.crypto.generateKeyPair(),p=Wt.wc_sessionPropose.req.ttl||Q.FIVE_MINUTES,g=$t(p),m=kn(ht(ht({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:cN}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:us()}),y=Ze("session_connect",m.id),{reject:v,resolve:w,done:N}=Eo(p,K1),b=({id:E})=>{E===m.id&&(this.client.events.off("proposal_expire",b),this.pendingSessions.delete(m.id),this.events.emit(y,{error:{message:K1,code:0}}))};return this.client.events.on("proposal_expire",b),this.events.once(y,({error:E,session:S})=>{this.client.events.off("proposal_expire",b),E?v(E):S&&w(S)}),await this.sendRequest({topic:u,method:"wc_sessionPropose",params:m,throwOnFailedPublish:!0,clientRpcId:m.id}),await this.setProposal(m.id,m),{uri:d,approval:N}}),V(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),V(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n?.id)==null?void 0:r.toString(),trace:[Ur.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(I){throw o.setError(fo.no_internet_connection),I}try{await this.isValidProposalId(n?.id)}catch(I){throw this.client.logger.error(`approve() -> proposal.get(${n?.id}) failed`),o.setError(fo.proposal_not_found),I}try{await this.isValidApprove(n)}catch(I){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(fo.session_approve_namespace_validation_failure),I}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=n,f=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:p,proposer:g,requiredNamespaces:m,optionalNamespaces:y}=f;let v=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:p});v||(v=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Ur.session_approve_started,properties:{topic:p,trace:[Ur.session_approve_started,Ur.session_namespaces_validation_success]}}));const w=await this.client.core.crypto.generateKeyPair(),N=g.publicKey,b=await this.client.core.crypto.generateSharedKey(w,N),E=ht(ht(ht({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:w,metadata:this.client.metadata},expiry:$t(xa)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),S=ft.relay;v.addTrace(Ur.subscribing_session_topic);try{await this.client.core.relayer.subscribe(b,{transportType:S})}catch(I){throw v.setError(fo.subscribe_session_topic_failure),I}v.addTrace(Ur.subscribe_session_topic_success);const x=kn(ht({},E),{topic:b,requiredNamespaces:m,optionalNamespaces:y,pairingTopic:p,acknowledged:!1,self:E.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:w,transportType:ft.relay});await this.client.session.set(b,x),v.addTrace(Ur.store_session);try{v.addTrace(Ur.publishing_session_settle),await this.sendRequest({topic:b,method:"wc_sessionSettle",params:E,throwOnFailedPublish:!0}).catch(I=>{throw v?.setError(fo.session_settle_publish_failure),I}),v.addTrace(Ur.session_settle_publish_success),v.addTrace(Ur.publishing_session_approve),await this.sendResult({id:a,topic:p,result:{relay:{protocol:c??"irn"},responderPublicKey:w},throwOnFailedPublish:!0}).catch(I=>{throw v?.setError(fo.session_approve_publish_failure),I}),v.addTrace(Ur.session_approve_publish_success)}catch(I){throw this.client.logger.error(I),this.client.session.delete(b,bt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(b),I}return this.client.core.eventClient.deleteEvent({eventId:v.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(b,$t(xa)),{topic:b,acknowledged:()=>Promise.resolve(this.client.session.get(b))}}),V(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:Wt.wc_sessionPropose.reject}),await this.deleteProposal(r)}),V(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=Eo(),c=us(),l=Uo().toString(),u=this.client.session.get(r).namespaces;return this.events.once(Ze("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:u}),a(d)}),{acknowledged:i}}),V(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=n,s=us(),{done:i,resolve:o,reject:a}=Eo();return this.events.once(Ze("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,$t(xa)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),V(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(m){throw this.client.logger.error("request() -> isValidRequest() failed"),m}const{chainId:r,request:s,topic:i,expiry:o=Wt.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);a?.transportType===ft.relay&&await this.confirmOnlineStateOrThrow();const c=us(),l=Uo().toString(),{done:u,resolve:d,reject:h}=Eo(o,"Request expired. Please try again.");this.events.once(Ze("session_request",c),({error:m,result:y})=>{m?h(m):d(y)});const f="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:{request:kn(ht({},s),{expiryTimestamp:$t(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(m=>h(m)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await u();const g={request:kn(ht({},s),{expiryTimestamp:$t(o)}),chainId:r};return await Promise.all([new Promise(async m=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(y=>h(y)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),m()}),new Promise(async m=>{var y;if(!((y=a.sessionConfig)!=null&&y.disableDeepLink)){const v=await q4(this.client.core.storage,G1);await j4({id:c,topic:i,wcDeepLink:v})}m()}),u()]).then(m=>m[2])}),V(this,"respond",async n=>{this.isInitialized(),await this.isValidRespond(n);const{topic:r,response:s}=n,{id:i}=s,o=this.client.session.get(r);o.transportType===ft.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);ds(s)?await this.sendResult({id:i,topic:r,result:s.result,throwOnFailedPublish:!0,appLink:a}):mr(s)&&await this.sendError({id:i,topic:r,error:s.error,appLink:a}),this.cleanupAfterResponse(n)}),V(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=us(),i=Uo().toString(),{done:o,resolve:a,reject:c}=Eo();this.events.once(Ze("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),V(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=Uo().toString(),a=us();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),V(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:bt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=Z("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),V(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>XF(r,n)))),V(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),V(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?ft.link_mode:ft.relay;o===ft.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:f,nbf:p,methods:g=[],expiry:m}=n,y=[...n.resources||[]],{topic:v,uri:w}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:v,uri:w}});const N=await this.client.core.crypto.generateKeyPair(),b=lh(N);if(await Promise.all([this.client.auth.authKeys.set(dh,{responseTopic:b,publicKey:N}),this.client.auth.pairingTopics.set(b,{topic:b,pairingTopic:v})]),await this.client.core.relayer.subscribe(b,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${v}`),g.length>0){const{namespace:U}=nc(a[0]);let L=oM(U,"request",g);ch(y)&&(L=cM(L,y.pop())),y.push(L)}const E=m&&m>Wt.wc_sessionAuthenticate.req.ttl?m:Wt.wc_sessionAuthenticate.req.ttl,S={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:p,resources:y},requester:{publicKey:N,metadata:this.client.metadata},expiryTimestamp:$t(E)},x={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},I={requiredNamespaces:{},optionalNamespaces:x,relays:[{protocol:"irn"}],pairingTopic:v,proposer:{publicKey:N,metadata:this.client.metadata},expiryTimestamp:$t(Wt.wc_sessionPropose.req.ttl),id:us()},{done:O,resolve:P,reject:k}=Eo(E,"Request expired"),M=us(),$=Ze("session_connect",I.id),A=Ze("session_request",M),_=async({error:U,session:L})=>{this.events.off(A,R),U?k(U):L&&P({session:L})},R=async U=>{var L,j,q;if(await this.deletePendingAuthRequest(M,{message:"fulfilled",code:0}),U.error){const Ie=bt("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return U.error.code===Ie.code?void 0:(this.events.off($,_),k(U.error.message))}await this.deleteProposal(I.id),this.events.off($,_);const{cacaos:X,responder:K}=U.result,se=[],ge=[];for(const Ie of X){await $E({cacao:Ie,projectId:this.client.core.projectId})||(this.client.logger.error(Ie,"Signature verification failed"),k(bt("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:nt}=Ie,Ot=ch(nt.resources),zt=[Vm(nt.iss)],Or=qh(nt.iss);if(Ot){const Rr=LE(Ot),ba=ME(Ot);se.push(...Rr),zt.push(...ba)}for(const Rr of zt)ge.push(`${Rr}:${Or}`)}const Re=await this.client.core.crypto.generateSharedKey(N,K.publicKey);let Ue;se.length>0&&(Ue={topic:Re,acknowledged:!0,self:{publicKey:N,metadata:this.client.metadata},peer:K,controller:K.publicKey,expiry:$t(xa),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:v,namespaces:l1([...new Set(se)],[...new Set(ge)]),transportType:o},await this.client.core.relayer.subscribe(Re,{transportType:o}),await this.client.session.set(Re,Ue),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:K.metadata}),Ue=this.client.session.get(Re)),(L=this.client.metadata.redirect)!=null&&L.linkMode&&(j=K.metadata.redirect)!=null&&j.linkMode&&(q=K.metadata.redirect)!=null&&q.universal&&r&&(this.client.core.addLinkModeSupportedApp(K.metadata.redirect.universal),this.client.session.update(Re,{transportType:ft.link_mode})),P({auths:X,session:Ue})};this.events.once($,_),this.events.once(A,R);let B;try{if(i){const U=qi("wc_sessionAuthenticate",S,M);this.client.core.history.set(v,U);const L=await this.client.core.crypto.encode("",U,{type:sd,encoding:Mi});B=$d(r,v,L)}else await Promise.all([this.sendRequest({topic:v,method:"wc_sessionAuthenticate",params:S,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:M}),this.sendRequest({topic:v,method:"wc_sessionPropose",params:I,expiry:Wt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:I.id})])}catch(U){throw this.events.off($,_),this.events.off(A,R),U}return await this.setProposal(I.id,I),await this.setAuthRequest(M,{request:kn(ht({},S),{verifyContext:{}}),pairingTopic:v,transportType:o}),{uri:B??w,response:O}}),V(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[po.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(ll.no_internet_connection),m}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(ll.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||ft.relay;a===ft.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=lh(c),d={type:ti,receiverPublicKey:c,senderPublicKey:l},h=[],f=[];for(const m of s){if(!await $E({cacao:m,projectId:this.client.core.projectId})){i.setError(ll.invalid_cacao);const b=bt("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:b,encodeOpts:d}),new Error(b.message)}i.addTrace(po.cacaos_verified);const{p:y}=m,v=ch(y.resources),w=[Vm(y.iss)],N=qh(y.iss);if(v){const b=LE(v),E=ME(v);h.push(...b),w.push(...E)}for(const b of w)f.push(`${b}:${N}`)}const p=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(po.create_authenticated_session_topic);let g;if(h?.length>0){g={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:$t(xa),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:l1([...new Set(h)],[...new Set(f)]),transportType:a},i.addTrace(po.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw i.setError(ll.subscribe_authenticated_session_topic_failure),m}i.addTrace(po.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),i.addTrace(po.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(po.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(ll.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),V(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===ft.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=lh(o),l={type:ti,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:l,rpcOpts:Wt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),V(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return C2(r,s)}),V(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),V(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),V(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,bt("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(G1).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,bt("USER_DISCONNECTED"))}),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=as.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),V(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n);this.client.core.eventClient.getEvent({topic:s.pairingTopic})?.setError(fo.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,bt("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),V(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=as.idle,this.client.events.emit("session_request_expire",{id:n}))}),V(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),V(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),V(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,$t(Wt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),V(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=ft.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),V(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||$t(Wt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),V(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d}=n,h=qi(s,i,c);let f;const p=!!u;try{const y=p?Mi:Gr;f=await this.client.core.crypto.encode(r,h,{encoding:y})}catch(y){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),y}let g;if(Kz.includes(s)){const y=fs(JSON.stringify(h)),v=fs(f);g=await this.client.core.verify.register({id:v,decryptedId:y})}const m=Wt[s].req;if(m.attestation=g,o&&(m.ttl=o),a&&(m.id=a),this.client.core.history.set(r,h),p){const y=$d(u,r,f);await global.Linking.openURL(y,this.client.name)}else{const y=Wt[s].req;o&&(y.ttl=o),a&&(y.id=a),y.tvf=kn(ht({},d),{correlationId:h.id}),l?(y.internal=kn(ht({},y.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,f,y)):this.client.core.relayer.publish(r,f,y).catch(v=>this.client.logger.error(v))}return h.id}),V(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=n,l=qf(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=d?Mi:Gr;u=await this.client.core.crypto.encode(s,l,kn(ht({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let h,f;try{h=await this.client.core.history.get(s,r);const p=h.request;try{f=this.getTVFParams(r,p.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g?.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),p}if(d){const p=$d(c,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=h.request.method,g=Wt[p].res;g.tvf=kn(ht({},f),{correlationId:r}),o?(g.internal=kn(ht({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),V(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=n,l=Wf(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=d?Mi:Gr;u=await this.client.core.crypto.encode(s,l,kn(ht({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),f}let h;try{h=await this.client.core.history.get(s,r)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),f}if(d){const f=$d(c,s,u);await global.Linking.openURL(f,this.client.name)}else{const f=h.request.method,p=a||Wt[f].res;this.client.core.relayer.publish(s,u,p)}await this.client.core.history.resolve(l)}),V(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;ki(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{ki(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),V(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),V(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),V(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===as.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=as.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=as.idle}),V(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),V(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),V(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=Z("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),V(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),V(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(Hs.proposal_listener_not_found)),this.isValidConnect(ht({},s.params));const u=a.expiryTimestamp||$t(Wt.wc_sessionPropose.req.ttl),d=ht({id:c,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:fs(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(ls.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:Wt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),V(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(ds(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:n,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:n})}else if(mr(r)){await this.deleteProposal(i);const o=Ze("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),V(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=r.params,f=[...this.pendingSessions.values()].find(m=>m.sessionTopic===n);if(!f)return this.client.logger.error(`Pending session not found for topic ${n}`);const p=this.client.proposal.get(f.proposalId),g=kn(ht(ht(ht({topic:n,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:f.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:f.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:ft.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(Ze("session_connect",f.proposalId),{session:g}),this.pendingSessions.delete(f.proposalId),this.deleteProposal(f.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:n,result:!0})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),V(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;ds(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(Ze("session_approve",s),{})):mr(r)&&(await this.client.session.delete(n,bt("USER_DISCONNECTED")),this.events.emit(Ze("session_approve",s),{error:r.error}))}),V(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=al.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:bt("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(ht({topic:n},s));try{al.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(c){throw al.delete(o),c}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),V(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),V(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=Ze("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);ds(r)?this.events.emit(Ze("session_update",s),{}):mr(r)&&this.events.emit(Ze("session_update",s),{error:r.error})}),V(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,$t(xa)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),V(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=Ze("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);ds(r)?this.events.emit(Ze("session_extend",s),{}):mr(r)&&this.events.emit(Ze("session_extend",s),{error:r.error})}),V(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),V(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=Ze("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);ds(r)?this.events.emit(Ze("session_ping",s),{}):mr(r)&&this.events.emit(Ze("session_ping",s),{error:r.error})},500)}),V(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{this.isValidDisconnect({topic:n,reason:r.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(Kt.publish,async()=>{i(await this.deleteSession({topic:n,id:s}))})}),this.sendResult({id:s,topic:n,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:n,error:bt("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),V(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=n,{id:d,params:h}=a;try{await this.isValidRequest(ht({topic:o},h));const f=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:fs(JSON.stringify(qi("wc_sessionRequest",h,d))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),g={id:d,topic:o,params:h,verifyContext:p};await this.setPendingSessionRequest(g),u===ft.link_mode&&(r=f.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=f.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(f){await this.sendError({id:d,topic:o,error:f}),this.client.logger.error(f)}}),V(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=Ze("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);ds(r)?this.events.emit(Ze("session_request",s),{result:r.result}):mr(r)&&this.events.emit(Ze("session_request",s),{error:r.error})}),V(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=al.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(ht({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),al.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),V(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),ds(r)?this.events.emit(Ze("session_request",s),{result:r.result}):mr(r)&&this.events.emit(Ze("session_request",s),{error:r.error})}),V(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=n;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:fs(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:f,pairingTopic:s,transportType:c}),c===ft.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:ti,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:f,rpcOpts:Wt.wc_sessionAuthenticate.autoReject,appLink:h})}}),V(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),V(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=as.idle,this.processSessionRequestQueue()},Q.toMiliseconds(this.requestQueueDelay))}),V(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=Ze("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(Ze("session_request",i.request.id),{error:r})})}),V(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===as.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),V(this,"emitSessionRequest",n=>{if(this.emittedSessionRequests.has(n.id)){this.client.logger.warn({id:n.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${n.id}`);return}this.sessionRequestQueue.state=as.active,this.emittedSessionRequests.add(n.id),this.client.events.emit("session_request",n)}),V(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:qi("wc_sessionPropose",kn(ht({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),V(this,"isValidConnect",async n=>{if(!Bn(n)){const{message:l}=Z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(l)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=n;if(rn(r)||await this.isValidPairingTopic(r),!d9(c)){const{message:l}=Z("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!rn(s)&&vs(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(!rn(i)&&vs(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),rn(o)||this.validateSessionProps(o,"sessionProperties"),!rn(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),V(this,"validateNamespaces",(n,r)=>{const s=u9(n,"connect()",r);if(s)throw new Error(s.message)}),V(this,"isValidApprove",async n=>{if(!Bn(n))throw new Error(Z("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),l=pg(s,"approve()");if(l)throw new Error(l.message);const u=h1(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!kt(i,!0)){const{message:d}=Z("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(rn(o)||this.validateSessionProps(o,"sessionProperties"),!rn(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),V(this,"isValidReject",async n=>{if(!Bn(n)){const{message:i}=Z("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!f9(s)){const{message:i}=Z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),V(this,"isValidSessionSettleRequest",n=>{if(!Bn(n)){const{message:l}=Z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(l)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!eN(r)){const{message:l}=Z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=s9(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=pg(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(ki(o)){const{message:l}=Z("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),V(this,"isValidUpdate",async n=>{if(!Bn(n)){const{message:c}=Z("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(c)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=pg(s,"update()");if(o)throw new Error(o.message);const a=h1(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),V(this,"isValidExtend",async n=>{if(!Bn(n)){const{message:s}=Z("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),V(this,"isValidRequest",async n=>{if(!Bn(n)){const{message:c}=Z("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!d1(a,i)){const{message:c}=Z("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!p9(s)){const{message:c}=Z("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!y9(a,i,s.method)){const{message:c}=Z("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!v9(o,Ag)){const{message:c}=Z("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Ag.min} and ${Ag.max}`);throw new Error(c)}}),V(this,"isValidRespond",async n=>{var r;if(!Bn(n)){const{message:o}=Z("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(o)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(o){throw(r=n?.response)!=null&&r.id&&this.cleanupAfterResponse(n),o}if(!g9(i)){const{message:o}=Z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),V(this,"isValidPing",async n=>{if(!Bn(n)){const{message:s}=Z("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),V(this,"isValidEmit",async n=>{if(!Bn(n)){const{message:a}=Z("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!d1(o,i)){const{message:a}=Z("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!m9(s)){const{message:a}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!w9(o,i,s.name)){const{message:a}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),V(this,"isValidDisconnect",async n=>{if(!Bn(n)){const{message:s}=Z("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),V(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!kt(s,!1))throw new Error("uri is required parameter");if(!kt(i,!1))throw new Error("domain is required parameter");if(!kt(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>nc(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=nc(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),V(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,c={verified:{verifyUrl:o.verifyUrl||Ul,validation:"UNKNOWN",origin:o.url||""}};try{if(a===ft.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),V(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=Z("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),V(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),V(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),V(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=Z("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),V(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,c,l,u,d,h;return!n||r!==ft.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=n?.redirect)==null?void 0:u.universal)!==void 0&&((d=n?.redirect)==null?void 0:d.universal)!==""&&((h=n?.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),V(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n?.redirect)==null?void 0:s.universal:void 0}),V(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=_E(n,"topic")||"",s=decodeURIComponent(_E(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:ft.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),V(this,"registerLinkModeListeners",async()=>{var n;if(Oy()||ao()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),V(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const l=this.extractTxHashesFromResult(r.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn("Error getting TVF params",l)}return c}),V(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=n?.data||((r=n?.[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),V(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=Vz[i];if(i==="sui_signTransaction")return[qL(r.transactionBytes)];if(i==="near_signTransaction")return[kE(r)];if(i==="near_signTransactions")return r.map(c=>kE(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[B9({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return ni(r)?r.map(c=>DE(c)):[DE(r)];if(i==="cosmos_signDirect")return[VL(r)];if(typeof r=="string")return[r];const a=r[o.key];if(ni(a))return i==="solana_signAllTransactions"?a.map(c=>zL(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Kt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:n,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(dh)?this.client.auth.authKeys.get(dh):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===ft.link_mode?Mi:Gr});Vy(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:fs(r)})):Vf(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(gr.expired,async e=>{const{topic:n,id:r}=c2(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,Z("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,Z("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(Co.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Co.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!kt(e,!1)){const{message:n}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:n}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(n)}if(ki(this.client.core.pairing.pairings.get(e).expiry)){const{message:n}=Z("EXPIRED",`pairing topic: ${e}`);throw new Error(n)}}async isValidSessionTopic(e){if(!kt(e,!1)){const{message:n}=Z("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:n}=Z("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(ki(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:n}=Z("EXPIRED",`session topic: ${e}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(e)){const{message:n}=Z("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(n)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(kt(e,!1)){const{message:n}=Z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}else{const{message:n}=Z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}async isValidProposalId(e){if(!h9(e)){const{message:n}=Z("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!this.client.proposal.keys.includes(e)){const{message:n}=Z("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(ki(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:n}=Z("EXPIRED",`proposal id: ${e}`);throw new Error(n)}}}class oq extends ga{constructor(e,n){super(e,n,zz,Gy),this.core=e,this.logger=n}}let aq=class extends ga{constructor(e,n){super(e,n,qz,Gy),this.core=e,this.logger=n}};class cq extends ga{constructor(e,n){super(e,n,Gz,Gy,r=>r.id),this.core=e,this.logger=n}}class lq extends ga{constructor(e,n){super(e,n,Zz,Kf,()=>dh),this.core=e,this.logger=n}}class uq extends ga{constructor(e,n){super(e,n,Qz,Kf),this.core=e,this.logger=n}}class dq extends ga{constructor(e,n){super(e,n,Xz,Kf,r=>r.id),this.core=e,this.logger=n}}var hq=Object.defineProperty,fq=(t,e,n)=>e in t?hq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Cg=(t,e,n)=>fq(t,typeof e!="symbol"?e+"":e,n);class pq{constructor(e,n){this.core=e,this.logger=n,Cg(this,"authKeys"),Cg(this,"pairingTopics"),Cg(this,"requests"),this.authKeys=new lq(this.core,this.logger),this.pairingTopics=new uq(this.core,this.logger),this.requests=new dq(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var gq=Object.defineProperty,mq=(t,e,n)=>e in t?gq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$e=(t,e,n)=>mq(t,typeof e!="symbol"?e+"":e,n);let yq=class NN extends O6{constructor(e){super(e),$e(this,"protocol",CN),$e(this,"version",IN),$e(this,"name",vg.name),$e(this,"metadata"),$e(this,"core"),$e(this,"logger"),$e(this,"events",new xr.EventEmitter),$e(this,"engine"),$e(this,"session"),$e(this,"proposal"),$e(this,"pendingRequest"),$e(this,"auth"),$e(this,"signConfig"),$e(this,"on",(r,s)=>this.events.on(r,s)),$e(this,"once",(r,s)=>this.events.once(r,s)),$e(this,"off",(r,s)=>this.events.off(r,s)),$e(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),$e(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),$e(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),$e(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),$e(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),$e(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=e?.name||vg.name,this.metadata=U4(e?.metadata),this.signConfig=e?.signConfig;const n=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Zu($c({level:e?.logger||vg.logger}));this.core=e?.core||new Hz(e),this.logger=wn(n,this.name),this.session=new aq(this.core,this.logger),this.proposal=new oq(this.core,this.logger),this.pendingRequest=new cq(this.core,this.logger),this.engine=new iq(this),this.auth=new pq(this.core,this.logger)}static async init(e){const n=new NN(e);return await n.initialize(),n}get context(){return Jn(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Md={exports:{}},Y1;function wq(){return Y1||(Y1=1,function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof hs<"u"&&hs,r=function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof hs<"u"&&hs||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(A){return A&&DataView.prototype.isPrototypeOf(A)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(A){return A&&u.indexOf(Object.prototype.toString.call(A))>-1};function h(A){if(typeof A!="string"&&(A=String(A)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(A)||A==="")throw new TypeError('Invalid character in header field name: "'+A+'"');return A.toLowerCase()}function f(A){return typeof A!="string"&&(A=String(A)),A}function p(A){var _={next:function(){var R=A.shift();return{done:R===void 0,value:R}}};return c.iterable&&(_[Symbol.iterator]=function(){return _}),_}function g(A){this.map={},A instanceof g?A.forEach(function(_,R){this.append(R,_)},this):Array.isArray(A)?A.forEach(function(_){if(_.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+_.length);this.append(_[0],_[1])},this):A&&Object.getOwnPropertyNames(A).forEach(function(_){this.append(_,A[_])},this)}g.prototype.append=function(A,_){A=h(A),_=f(_);var R=this.map[A];this.map[A]=R?R+", "+_:_},g.prototype.delete=function(A){delete this.map[h(A)]},g.prototype.get=function(A){return A=h(A),this.has(A)?this.map[A]:null},g.prototype.has=function(A){return this.map.hasOwnProperty(h(A))},g.prototype.set=function(A,_){this.map[h(A)]=f(_)},g.prototype.forEach=function(A,_){for(var R in this.map)this.map.hasOwnProperty(R)&&A.call(_,this.map[R],R,this)},g.prototype.keys=function(){var A=[];return this.forEach(function(_,R){A.push(R)}),p(A)},g.prototype.values=function(){var A=[];return this.forEach(function(_){A.push(_)}),p(A)},g.prototype.entries=function(){var A=[];return this.forEach(function(_,R){A.push([R,_])}),p(A)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function m(A){if(!A._noBody){if(A.bodyUsed)return Promise.reject(new TypeError("Already read"));A.bodyUsed=!0}}function y(A){return new Promise(function(_,R){A.onload=function(){_(A.result)},A.onerror=function(){R(A.error)}})}function v(A){var _=new FileReader,R=y(_);return _.readAsArrayBuffer(A),R}function w(A){var _=new FileReader,R=y(_),B=/charset=([A-Za-z0-9_-]+)/.exec(A.type),U=B?B[1]:"utf-8";return _.readAsText(A,U),R}function N(A){for(var _=new Uint8Array(A),R=new Array(_.length),B=0;B<_.length;B++)R[B]=String.fromCharCode(_[B]);return R.join("")}function b(A){if(A.slice)return A.slice(0);var _=new Uint8Array(A.byteLength);return _.set(new Uint8Array(A)),_.buffer}function E(){return this.bodyUsed=!1,this._initBody=function(A){this.bodyUsed=this.bodyUsed,this._bodyInit=A,A?typeof A=="string"?this._bodyText=A:c.blob&&Blob.prototype.isPrototypeOf(A)?this._bodyBlob=A:c.formData&&FormData.prototype.isPrototypeOf(A)?this._bodyFormData=A:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(A)?this._bodyText=A.toString():c.arrayBuffer&&c.blob&&l(A)?(this._bodyArrayBuffer=b(A.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(A)||d(A))?this._bodyArrayBuffer=b(A):this._bodyText=A=Object.prototype.toString.call(A):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof A=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(A)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var A=m(this);if(A)return A;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var A=m(this);return A||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(v);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var A=m(this);if(A)return A;if(this._bodyBlob)return w(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(N(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}var S=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function x(A){var _=A.toUpperCase();return S.indexOf(_)>-1?_:A}function I(A,_){if(!(this instanceof I))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');_=_||{};var R=_.body;if(A instanceof I){if(A.bodyUsed)throw new TypeError("Already read");this.url=A.url,this.credentials=A.credentials,_.headers||(this.headers=new g(A.headers)),this.method=A.method,this.mode=A.mode,this.signal=A.signal,!R&&A._bodyInit!=null&&(R=A._bodyInit,A.bodyUsed=!0)}else this.url=String(A);if(this.credentials=_.credentials||this.credentials||"same-origin",(_.headers||!this.headers)&&(this.headers=new g(_.headers)),this.method=x(_.method||this.method||"GET"),this.mode=_.mode||this.mode||null,this.signal=_.signal||this.signal||function(){if("AbortController"in a){var L=new AbortController;return L.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&R)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(R),(this.method==="GET"||this.method==="HEAD")&&(_.cache==="no-store"||_.cache==="no-cache")){var B=/([?&])_=[^&]*/;if(B.test(this.url))this.url=this.url.replace(B,"$1_="+new Date().getTime());else{var U=/\?/;this.url+=(U.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}I.prototype.clone=function(){return new I(this,{body:this._bodyInit})};function O(A){var _=new FormData;return A.trim().split("&").forEach(function(R){if(R){var B=R.split("="),U=B.shift().replace(/\+/g," "),L=B.join("=").replace(/\+/g," ");_.append(decodeURIComponent(U),decodeURIComponent(L))}}),_}function P(A){var _=new g,R=A.replace(/\r?\n[\t ]+/g," ");return R.split("\r").map(function(B){return B.indexOf(`
`)===0?B.substr(1,B.length):B}).forEach(function(B){var U=B.split(":"),L=U.shift().trim();if(L){var j=U.join(":").trim();try{_.append(L,j)}catch(q){console.warn("Response "+q.message)}}}),_}E.call(I.prototype);function k(A,_){if(!(this instanceof k))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(_||(_={}),this.type="default",this.status=_.status===void 0?200:_.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=_.statusText===void 0?"":""+_.statusText,this.headers=new g(_.headers),this.url=_.url||"",this._initBody(A)}E.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},k.error=function(){var A=new k(null,{status:200,statusText:""});return A.ok=!1,A.status=0,A.type="error",A};var M=[301,302,303,307,308];k.redirect=function(A,_){if(M.indexOf(_)===-1)throw new RangeError("Invalid status code");return new k(null,{status:_,headers:{location:A}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(_,R){this.message=_,this.name=R;var B=Error(_);this.stack=B.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function $(A,_){return new Promise(function(R,B){var U=new I(A,_);if(U.signal&&U.signal.aborted)return B(new o.DOMException("Aborted","AbortError"));var L=new XMLHttpRequest;function j(){L.abort()}L.onload=function(){var K={statusText:L.statusText,headers:P(L.getAllResponseHeaders()||"")};U.url.indexOf("file://")===0&&(L.status<200||L.status>599)?K.status=200:K.status=L.status,K.url="responseURL"in L?L.responseURL:K.headers.get("X-Request-URL");var se="response"in L?L.response:L.responseText;setTimeout(function(){R(new k(se,K))},0)},L.onerror=function(){setTimeout(function(){B(new TypeError("Network request failed"))},0)},L.ontimeout=function(){setTimeout(function(){B(new TypeError("Network request timed out"))},0)},L.onabort=function(){setTimeout(function(){B(new o.DOMException("Aborted","AbortError"))},0)};function q(K){try{return K===""&&a.location.href?a.location.href:K}catch{return K}}if(L.open(U.method,q(U.url),!0),U.credentials==="include"?L.withCredentials=!0:U.credentials==="omit"&&(L.withCredentials=!1),"responseType"in L&&(c.blob?L.responseType="blob":c.arrayBuffer&&(L.responseType="arraybuffer")),_&&typeof _.headers=="object"&&!(_.headers instanceof g||a.Headers&&_.headers instanceof a.Headers)){var X=[];Object.getOwnPropertyNames(_.headers).forEach(function(K){X.push(h(K)),L.setRequestHeader(K,f(_.headers[K]))}),U.headers.forEach(function(K,se){X.indexOf(se)===-1&&L.setRequestHeader(se,K)})}else U.headers.forEach(function(K,se){L.setRequestHeader(se,K)});U.signal&&(U.signal.addEventListener("abort",j),L.onreadystatechange=function(){L.readyState===4&&U.signal.removeEventListener("abort",j)}),L.send(typeof U._bodyInit>"u"?null:U._bodyInit)})}return $.polyfill=!0,a.fetch||(a.fetch=$,a.Headers=g,a.Request=I,a.Response=k),o.Headers=g,o.Request=I,o.Response=k,o.fetch=$,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e}(Md,Md.exports)),Md.exports}var bq=wq();const Z1=wf(bq);var Eq=Object.defineProperty,vq=Object.defineProperties,Aq=Object.getOwnPropertyDescriptors,Q1=Object.getOwnPropertySymbols,Cq=Object.prototype.hasOwnProperty,Iq=Object.prototype.propertyIsEnumerable,X1=(t,e,n)=>e in t?Eq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ev=(t,e)=>{for(var n in e||(e={}))Cq.call(e,n)&&X1(t,n,e[n]);if(Q1)for(var n of Q1(e))Iq.call(e,n)&&X1(t,n,e[n]);return t},tv=(t,e)=>vq(t,Aq(e));const _q={Accept:"application/json","Content-Type":"application/json"},Nq="POST",nv={headers:_q,method:Nq},rv=10;let es=class{constructor(e,n=!1){if(this.url=e,this.disableProviderPing=n,this.events=new xr.EventEmitter,this.isAvailable=!1,this.registering=!1,!b1(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const n=oi(e),r=await(await Z1(this.url,tv(ev({},nv),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!b1(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const n=oi({id:1,jsonrpc:"2.0",method:"test",params:[]});await Z1(e,tv(ev({},nv),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?Qo(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=Wf(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return rN(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>rv&&this.events.setMaxListeners(rv)}};const sv="error",Sq="wss://relay.walletconnect.org",xq="wc",Tq="universal_provider",Fd=`${xq}@2:${Tq}:`,SN="https://rpc.walletconnect.org/v1/",Wa="generic",Pq=`${SN}bundler`,Pr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Ky(t){return t==null||typeof t!="object"&&typeof t!="function"}function xN(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function TN(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Oq="[object RegExp]",PN="[object String]",ON="[object Number]",RN="[object Boolean]",kN="[object Arguments]",Rq="[object Symbol]",kq="[object Date]",Dq="[object Map]",Uq="[object Set]",Bq="[object Array]",$q="[object ArrayBuffer]",Lq="[object Object]",Mq="[object DataView]",Fq="[object Uint8Array]",jq="[object Uint8ClampedArray]",Hq="[object Uint16Array]",zq="[object Uint32Array]",qq="[object Int8Array]",Wq="[object Int16Array]",Vq="[object Int32Array]",Gq="[object Float32Array]",Kq="[object Float64Array]";function Jy(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Jq(t,e){return Za(t,void 0,t,new Map,e)}function Za(t,e,n,r=new Map,s=void 0){const i=s?.(t,e,n,r);if(i!=null)return i;if(Ky(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=Za(t[a],a,n,r,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[a,c]of t)o.set(a,Za(c,a,n,r,s));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const a of t)o.add(Za(a,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(Jy(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=Za(t[a],a,n,r,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),Io(o,t,n,r,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),Io(o,t,n,r,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),Io(o,t,n,r,s),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Io(o,t,n,r,s),o}if(typeof t=="object"&&Yq(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),Io(o,t,n,r,s),o}return t}function Io(t,e,n=t,r,s){const i=[...Object.keys(e),...xN(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=Za(e[a],a,n,r,s))}}function Yq(t){switch(TN(t)){case kN:case Bq:case $q:case Mq:case RN:case kq:case Gq:case Kq:case qq:case Wq:case Vq:case Dq:case ON:case Lq:case Oq:case Uq:case PN:case Rq:case Fq:case jq:case Hq:case zq:return!0;default:return!1}}function Zq(t,e){return Jq(t,(n,r,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case ON:case PN:case RN:{const o=new t.constructor(t?.valueOf());return Io(o,t),o}case kN:{const o={};return Io(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function iv(t){return Zq(t)}function ov(t){return t!==null&&typeof t=="object"&&TN(t)==="[object Arguments]"}function av(t){return typeof t=="object"&&t!==null}function Qq(){}function Xq(t){return Jy(t)}function eW(t){if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const n=t[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(t,Symbol.toStringTag)?.writable?!1:t.toString()===`[object ${n}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function tW(t){if(Ky(t))return t;if(Array.isArray(t)||Jy(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),n=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new n(t);if(t instanceof RegExp){const r=new n(t);return r.lastIndex=t.lastIndex,r}if(t instanceof DataView)return new n(t.buffer.slice(0));if(t instanceof Error){const r=new n(t.message);return r.stack=t.stack,r.name=t.name,r.cause=t.cause,r}if(typeof File<"u"&&t instanceof File)return new n([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const r=Object.create(e);return Object.assign(r,t)}return t}function nW(t,...e){const n=e.slice(0,-1),r=e[e.length-1];let s=t;for(let i=0;i<n.length;i++){const o=n[i];s=g0(s,o,r,new Map)}return s}function g0(t,e,n,r){if(Ky(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(r.has(e))return tW(r.get(e));if(r.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...xN(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(ov(a)&&(a={...a}),ov(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=iv(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const f=d[h];u[f]=c[f]}c=u}else c=[];const l=n(c,a,o,t,e,r);l!=null?t[o]=l:Array.isArray(a)||av(c)&&av(a)?t[o]=g0(c,a,n,r):c==null&&eW(a)?t[o]=g0({},a,n,r):c==null&&Xq(a)?t[o]=iv(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function rW(t,...e){return nW(t,...e,Qq)}var sW=Object.defineProperty,iW=Object.defineProperties,oW=Object.getOwnPropertyDescriptors,cv=Object.getOwnPropertySymbols,aW=Object.prototype.hasOwnProperty,cW=Object.prototype.propertyIsEnumerable,lv=(t,e,n)=>e in t?sW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jd=(t,e)=>{for(var n in e||(e={}))aW.call(e,n)&&lv(t,n,e[n]);if(cv)for(var n of cv(e))cW.call(e,n)&&lv(t,n,e[n]);return t},lW=(t,e)=>iW(t,oW(e));function ar(t,e,n){var r;const s=nc(t);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${SN}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function ma(t){return t.includes(":")?t.split(":")[1]:t}function DN(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function uW(t,e){const n=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function uv(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>{var r,s;return((r=n?.chains)==null?void 0:r.length)&&((s=n?.chains)==null?void 0:s.length)>0}))}function Hd(t={},e={}){const n=uv(dv(t)),r=uv(dv(e));return rW(n,r)}function dv(t){var e,n,r,s,i;const o={};if(!vs(t))return o;for(const[a,c]of Object.entries(t)){const l=zf(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},f=Ya(a);o[f]=lW(jd(jd({},o[f]),c),{chains:Es(l,(e=o[f])==null?void 0:e.chains),methods:Es(u,(n=o[f])==null?void 0:n.methods),events:Es(d,(r=o[f])==null?void 0:r.events)}),(vs(h)||vs(((s=o[f])==null?void 0:s.rpcMap)||{}))&&(o[f].rpcMap=jd(jd({},h),(i=o[f])==null?void 0:i.rpcMap))}return o}function hv(t){return t.includes(":")?t.split(":")[2]:t}function fv(t){const e={};for(const[n,r]of Object.entries(t)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=zf(n)?[n]:r.chains?r.chains:DN(r.accounts);e[n]={chains:a,methods:s,events:i,accounts:o}}return e}function Ig(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const UN={},Ke=t=>UN[t],_g=(t,e)=>{UN[t]=e};var dW=Object.defineProperty,pv=Object.getOwnPropertySymbols,hW=Object.prototype.hasOwnProperty,fW=Object.prototype.propertyIsEnumerable,gv=(t,e,n)=>e in t?dW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mv=(t,e)=>{for(var n in e||(e={}))hW.call(e,n)&&gv(t,n,e[n]);if(pv)for(var n of pv(e))fW.call(e,n)&&gv(t,n,e[n]);return t};const yv="eip155",pW=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],gW=t=>t&&t.startsWith("0x")?BigInt(t).toString(10):t,Ng=t=>t&&t.startsWith("0x")?t:`0x${BigInt(t).toString(16)}`,wv=t=>Object.keys(t).filter(e=>pW.includes(e)).reduce((e,n)=>(e[n]=t[n],e),{}),mW=(t,e,n)=>{const{sessionProperties:r={},scopedProperties:s={}}=t,i={};if(!vs(s)&&!vs(r))return;const o=wv(r);for(const a of n){const c=gW(a);if(!c)continue;i[Ng(c)]=o;const l=s?.[`${yv}:${c}`];if(l){const u=l?.[`${yv}:${c}:${e}`];i[Ng(c)]=mv(mv({},i[Ng(c)]),wv(u||l))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var yW=Object.defineProperty,wW=(t,e,n)=>e in t?yW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ta=(t,e,n)=>wW(t,typeof e!="symbol"?e+"":e,n);class bW{constructor(e){Ta(this,"name","polkadot"),Ta(this,"client"),Ta(this,"httpProviders"),Ta(this,"events"),Ta(this,"namespace"),Ta(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=ma(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||ar(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Tr(new es(r,Ke("disableProviderPing")))}}var EW=Object.defineProperty,vW=Object.defineProperties,AW=Object.getOwnPropertyDescriptors,bv=Object.getOwnPropertySymbols,CW=Object.prototype.hasOwnProperty,IW=Object.prototype.propertyIsEnumerable,m0=(t,e,n)=>e in t?EW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ev=(t,e)=>{for(var n in e||(e={}))CW.call(e,n)&&m0(t,n,e[n]);if(bv)for(var n of bv(e))IW.call(e,n)&&m0(t,n,e[n]);return t},vv=(t,e)=>vW(t,AW(e)),Pa=(t,e,n)=>m0(t,typeof e!="symbol"?e+"":e,n);class _W{constructor(e){Pa(this,"name","eip155"),Pa(this,"client"),Pa(this,"chainId"),Pa(this,"namespace"),Pa(this,"httpProviders"),Pa(this,"events"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(parseInt(e),n),this.chainId=parseInt(e),this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,n){const r=n||ar(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Tr(new es(r,Ke("disableProviderPing")))}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(ma(n));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}async handleSwitchChain(e){var n,r;let s=e.request.params?(n=e.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var n,r,s,i,o;const a=(r=(n=e.request)==null?void 0:n.params)==null?void 0:r[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,h=u?.[d];if(h)return h;let f;try{f=mW(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(f)return f;const p=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:vv(Ev({},l.sessionProperties||{}),{capabilities:vv(Ev({},u||{}),{[d]:p})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return p}async getCallStatus(e){var n,r;const s=this.client.session.get(e.topic),i=(n=s.sessionProperties)==null?void 0:n.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,n){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(qi("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,n){return`${Pq}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${n}`}}var NW=Object.defineProperty,SW=(t,e,n)=>e in t?NW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Oa=(t,e,n)=>SW(t,typeof e!="symbol"?e+"":e,n);class xW{constructor(e){Oa(this,"name","solana"),Oa(this,"client"),Oa(this,"httpProviders"),Oa(this,"events"),Oa(this,"namespace"),Oa(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=ma(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||ar(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Tr(new es(r,Ke("disableProviderPing")))}}var TW=Object.defineProperty,PW=(t,e,n)=>e in t?TW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ra=(t,e,n)=>PW(t,typeof e!="symbol"?e+"":e,n);class OW{constructor(e){Ra(this,"name","cosmos"),Ra(this,"client"),Ra(this,"httpProviders"),Ra(this,"events"),Ra(this,"namespace"),Ra(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=ma(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||ar(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Tr(new es(r,Ke("disableProviderPing")))}}var RW=Object.defineProperty,kW=(t,e,n)=>e in t?RW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ka=(t,e,n)=>kW(t,typeof e!="symbol"?e+"":e,n);class DW{constructor(e){ka(this,"name","algorand"),ka(this,"client"),ka(this,"httpProviders"),ka(this,"events"),ka(this,"namespace"),ka(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(!this.httpProviders[e]){const r=n||ar(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||ar(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Tr(new es(r,Ke("disableProviderPing")))}}var UW=Object.defineProperty,BW=(t,e,n)=>e in t?UW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Da=(t,e,n)=>BW(t,typeof e!="symbol"?e+"":e,n);class $W{constructor(e){Da(this,"name","cip34"),Da(this,"client"),Da(this,"httpProviders"),Da(this,"events"),Da(this,"namespace"),Da(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{const r=this.getCardanoRPCUrl(n),s=ma(n);e[s]=this.createHttpProvider(s,r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}getCardanoRPCUrl(e){const n=this.namespace.rpcMap;if(n)return n[e]}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Tr(new es(r,Ke("disableProviderPing")))}}var LW=Object.defineProperty,MW=(t,e,n)=>e in t?LW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ua=(t,e,n)=>MW(t,typeof e!="symbol"?e+"":e,n);class FW{constructor(e){Ua(this,"name","elrond"),Ua(this,"client"),Ua(this,"httpProviders"),Ua(this,"events"),Ua(this,"namespace"),Ua(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=ma(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||ar(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Tr(new es(r,Ke("disableProviderPing")))}}var jW=Object.defineProperty,HW=(t,e,n)=>e in t?jW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ba=(t,e,n)=>HW(t,typeof e!="symbol"?e+"":e,n);class zW{constructor(e){Ba(this,"name","multiversx"),Ba(this,"client"),Ba(this,"httpProviders"),Ba(this,"events"),Ba(this,"namespace"),Ba(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=ma(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||ar(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Tr(new es(r,Ke("disableProviderPing")))}}var qW=Object.defineProperty,WW=(t,e,n)=>e in t?qW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$a=(t,e,n)=>WW(t,typeof e!="symbol"?e+"":e,n);class VW{constructor(e){$a(this,"name","near"),$a(this,"client"),$a(this,"httpProviders"),$a(this,"events"),$a(this,"namespace"),$a(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||ar(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||ar(e,this.namespace);return typeof r>"u"?void 0:new Tr(new es(r,Ke("disableProviderPing")))}}var GW=Object.defineProperty,KW=(t,e,n)=>e in t?GW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,La=(t,e,n)=>KW(t,typeof e!="symbol"?e+"":e,n);class JW{constructor(e){La(this,"name","tezos"),La(this,"client"),La(this,"httpProviders"),La(this,"events"),La(this,"namespace"),La(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||ar(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{e[n]=this.createHttpProvider(n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||ar(e,this.namespace);return typeof r>"u"?void 0:new Tr(new es(r))}}var YW=Object.defineProperty,ZW=(t,e,n)=>e in t?YW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ma=(t,e,n)=>ZW(t,typeof e!="symbol"?e+"":e,n);class QW{constructor(e){Ma(this,"name",Wa),Ma(this,"client"),Ma(this,"httpProviders"),Ma(this,"events"),Ma(this,"namespace"),Ma(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Pr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var e,n;const r={};return(n=(e=this.namespace)==null?void 0:e.accounts)==null||n.forEach(s=>{const i=nc(s);r[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),r}getHttpProvider(e){const n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||ar(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Tr(new es(r,Ke("disableProviderPing")))}}var XW=Object.defineProperty,eV=Object.defineProperties,tV=Object.getOwnPropertyDescriptors,Av=Object.getOwnPropertySymbols,nV=Object.prototype.hasOwnProperty,rV=Object.prototype.propertyIsEnumerable,y0=(t,e,n)=>e in t?XW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zd=(t,e)=>{for(var n in e||(e={}))nV.call(e,n)&&y0(t,n,e[n]);if(Av)for(var n of Av(e))rV.call(e,n)&&y0(t,n,e[n]);return t},Sg=(t,e)=>eV(t,tV(e)),hr=(t,e,n)=>y0(t,typeof e!="symbol"?e+"":e,n);class Yy{constructor(e){hr(this,"client"),hr(this,"namespaces"),hr(this,"optionalNamespaces"),hr(this,"sessionProperties"),hr(this,"scopedProperties"),hr(this,"events",new wy),hr(this,"rpcProviders",{}),hr(this,"session"),hr(this,"providerOpts"),hr(this,"logger"),hr(this,"uri"),hr(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Zu($c({level:e?.logger||sv})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const n=new Yy(e);return await n.initialize(),n}async request(e,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:zd({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,n,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>n(null,qf(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:bt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=fv(this.session.namespaces);this.namespaces=Hd(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}removeListener(e,n){this.events.removeListener(e,n)}off(e,n){this.events.off(e,n)}get isWalletConnect(){return!0}async pair(e){const{uri:n,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});n&&(this.uri=n,this.events.emit("display_uri",n));const s=await r();this.session=s;const i=fv(s.namespaces);return this.namespaces=Hd(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,n){try{if(!this.session)return;const[r,s]=this.validateChain(e),i=this.getProvider(r);i.name===Wa?i.setDefaultChain(`${r}:${s}`,n):i.setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(ni(n)){for(const r of n)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,n;if(this.client=this.providerOpts.client||await yq.init({core:this.providerOpts.core,logger:this.providerOpts.logger||sv,relayUrl:this.providerOpts.relayUrl||Sq,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${(n=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(n=>Ya(n)))];_g("client",this.client),_g("events",this.events),_g("disableProviderPing",this.disableProviderPing),e.forEach(n=>{if(!this.session)return;const r=uW(n,this.session);if(r?.length===0)return;const s=DN(r),i=Hd(this.namespaces,this.optionalNamespaces),o=Sg(zd({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new _W({namespace:o});break;case"algorand":this.rpcProviders[n]=new DW({namespace:o});break;case"solana":this.rpcProviders[n]=new xW({namespace:o});break;case"cosmos":this.rpcProviders[n]=new OW({namespace:o});break;case"polkadot":this.rpcProviders[n]=new bW({namespace:o});break;case"cip34":this.rpcProviders[n]=new $W({namespace:o});break;case"elrond":this.rpcProviders[n]=new FW({namespace:o});break;case"multiversx":this.rpcProviders[n]=new zW({namespace:o});break;case"near":this.rpcProviders[n]=new VW({namespace:o});break;case"tezos":this.rpcProviders[n]=new JW({namespace:o});break;default:this.rpcProviders[Wa]?this.rpcProviders[Wa].updateNamespace(o):this.rpcProviders[Wa]=new QW({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var n;const{topic:r}=e;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var n;const{params:r,topic:s}=e;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&ni(o)&&this.events.emit("accountsChanged",o.map(hv))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=Ya(o),l=Ig(o)!==Ig(a)?`${c}:${Ig(a)}`:o;this.onChainChanged(l)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:n})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(e);this.session=Sg(zd({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:n})}),this.client.on("session_delete",async e=>{var n;e.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Sg(zd({},bt("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Pr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[Wa]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var n;this.getProvider(e).updateNamespace((n=this.session)==null?void 0:n.namespaces[e])})}setNamespaces(e){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=Hd(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[n,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>Ya(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=Ya(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,n=!1){if(!this.namespaces)return;const[r,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(r,s),this.events.emit("chainChanged",s);const i=this.getProvider(r).getDefaultChain();n||this.getProvider(r).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:n,newChainId:r}){var s,i;try{if(n===r)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${r}:`)).map(hv);if(!ni(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,n){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${Fd}/${e}${s}`,n)}async getFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${Fd}/${e}${r}`)}async deleteFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${Fd}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(Fd)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn("Failed to cleanup storage",n)}}}let go=null;const br={getSIWX(){return H.state.siwx},async initializeIfEnabled(t=T.getActiveCaipAddress()){const e=H.state.siwx;if(!(e&&t))return;const[n,r,s]=t.split(":");if(T.checkIfSupportedNetwork(n,`${n}:${r}`))try{if(H.state.remoteFeatures?.emailCapture){const o=T.getAccountData(n)?.user;await Fe.open({view:"DataCapture",data:{email:o?.email??void 0}});return}if(go&&await go,(await e.getSessions(`${n}:${r}`,s)).length)return;await Fe.open({view:"SIWXSignMessage"})}catch(i){console.error("SIWXUtil:initializeIfEnabled",i),et.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await ee._getClient()?.disconnect().catch(console.error),Ce.reset("Connect"),ws.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const t=H.state.siwx,e=le.getPlainAddress(T.getActiveCaipAddress()),n=Hi(),r=ee._getClient();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const s=await t.createMessage({chainId:n.caipNetworkId,accountAddress:e}),i=s.toString();Y.getConnectorId(n.chainNamespace)===F.CONNECTOR_ID.AUTH&&Ce.pushTransactionStack({});const a=await r.signMessage(i);await t.addSession({data:s,message:i,signature:a}),T.setLastConnectedSIWECaipNetwork(n),Fe.close(),et.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const i=this.getSIWXEventProperties();(!Fe.state.open||Ce.state.view==="ApproveTransaction")&&await Fe.open({view:"SIWXSignMessage"}),ws.showError("Error signing message"),et.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:i}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){try{const t=this.getSIWX();if(t?.getRequired?.()){const n=T.getLastConnectedSIWECaipNetwork();if(n){const r=await t?.getSessions(n?.caipNetworkId,le.getPlainAddress(T.getActiveCaipAddress())||"");r&&r.length>0?await T.switchActiveNetwork(n):await ee.disconnect()}else await ee.disconnect()}else Fe.close();Fe.close(),et.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(t){console.error("SIWXUtil:cancelSignMessage",t)}},async getAllSessions(){const t=this.getSIWX(),e=T.getAllRequestedCaipNetworks(),n=[];return await Promise.all(e.map(async r=>{const s=await t?.getSessions(r.caipNetworkId,le.getPlainAddress(T.getActiveCaipAddress())||"");s&&n.push(...s)})),n},async getSessions(t){const e=H.state.siwx;let n=t?.address;if(!n){const s=T.getActiveCaipAddress();n=le.getPlainAddress(s)}let r=t?.caipNetworkId;return r||(r=T.getActiveCaipNetwork()?.caipNetworkId),e&&n&&r?e.getSessions(r,n):[]},async isSIWXCloseDisabled(){const t=this.getSIWX();if(t){const e=Ce.state.view==="ApproveTransaction",n=Ce.state.view==="SIWXSignMessage";if(e||n)return t.getRequired?.()&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:n,preferredAccountType:r,chainNamespace:s}){const i=br.getSIWX();if(!i||!s.includes(F.CHAIN.EVM)||H.state.remoteFeatures?.emailCapture){const u=await t.connect({chainId:e,socialUri:n,preferredAccountType:r});return{address:u.address,chainId:u.chainId,accounts:u.accounts}}const o=`${s}:${e}`,a=await i.createMessage({chainId:o,accountAddress:"<<AccountAddress>>"}),c={accountAddress:a.accountAddress,chainId:a.chainId,domain:a.domain,uri:a.uri,version:a.version,nonce:a.nonce,notBefore:a.notBefore,statement:a.statement,resources:a.resources,requestId:a.requestId,issuedAt:a.issuedAt,expirationTime:a.expirationTime,serializedMessage:a.toString()},l=await t.connect({chainId:e,socialUri:n,siwxMessage:c,preferredAccountType:r});return c.accountAddress=l.address,c.serializedMessage=l.message||"",l.signature&&l.message&&await br.addEmbeddedWalletSession(c,l.message,l.signature),{address:l.address,chainId:l.chainId,accounts:l.accounts}},async addEmbeddedWalletSession(t,e,n){if(go)return go;const r=br.getSIWX();return r?(go=r.addSession({data:t,message:e,signature:n}).finally(()=>{go=null}),go):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:n}){const r=br.getSIWX(),s=Hi(),i=new Set(e.map(c=>c.split(":")[0]));if(!r||i.size!==1||!i.has("eip155"))return!1;const o=await r.createMessage({chainId:Hi()?.caipNetworkId||"",accountAddress:""}),a=await t.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:n,chains:[o.chainId,...e.filter(c=>c!==o.chainId)]});if(ws.showLoading("Authenticating...",{autoClose:!1}),fe.setConnectedWalletInfo({...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:a.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"},Array.from(i)[0]),a?.auths?.length){const c=a.auths.map(l=>{const u=t.client.formatAuthMessage({request:l.p,iss:l.p.iss});return{data:{...l.p,accountAddress:l.p.iss.split(":").slice(-1).join(""),chainId:l.p.iss.split(":").slice(2,4).join(":"),uri:l.p.aud,version:l.p.version||o.version,expirationTime:l.p.exp,issuedAt:l.p.iat,notBefore:l.p.nbf},message:u,signature:l.s.s,cacao:l}});try{await r.setSessions(c),s&&T.setLastConnectedSIWECaipNetwork(s),et.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:br.getSIWXEventProperties()})}catch(l){throw console.error("SIWX:universalProviderAuth - failed to set sessions",l),et.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:br.getSIWXEventProperties()}),await t.disconnect().catch(console.error),l}finally{ws.hide()}}return!0},getSIWXEventProperties(){const t=T.state.activeChain;if(!t)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:T.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:or(t)===Ht.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}},gt={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:F.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},nr={ConnectorExplorerIds:{[F.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[F.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[F.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[F.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[F.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[gt.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[gt.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[gt.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[gt.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[gt.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[gt.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[gt.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[gt.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[gt.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[gt.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[gt.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[F.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[F.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[F.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[F.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[F.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[F.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[F.CONNECTOR_ID.INJECTED]:"Browser Wallet",[F.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[F.CONNECTOR_ID.COINBASE]:"Coinbase",[F.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[F.CONNECTOR_ID.LEDGER]:"Ledger",[F.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[F.CONNECTOR_ID.INJECTED]:"INJECTED",[F.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[F.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[F.CONNECTOR_ID.AUTH]:"AUTH",[gt.CONNECTOR_TYPE_AUTH]:"AUTH"}},on={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([n,r])=>{e[`${gt.EIP155}:${n}`]=r}),e},isLowerCaseMatch(t,e){return t?.toLowerCase()===e?.toLowerCase()},getActiveNamespaceConnectedToAuth(){const t=T.state.activeChain;return F.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>Y.getConnectorId(e)===F.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await t()?s(!0):r>=n?s(!1):(setTimeout(i,e),null)}i()})}},sV=new AbortController,Et={EmbeddedWalletAbortController:sV,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${Ja()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com.`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systems date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:t=>`Unable to fetch App Configuration. ${t}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:t=>`[Reown Config Notice] ${t}`}}},iV={createLogger(t,e="error"){const n=$c({level:e}),{logger:r}=Ey({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},r}},oV="rpc.walletconnect.org";function Cv(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()}const xg=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],ps={extendRpcUrlWithProjectId(t,e){let n=!1;try{n=new URL(t).host===oV}catch{n=!1}if(n){const r=new URL(t);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:F.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${F.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,n){const r=t.rpcUrls?.default?.http?.[0];return xg.includes(e)?Cv(e,n):r||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=t.rpcUrls?.default?.http?.[0],a=this.getDefaultRpcUrl(t,i,n),c=t?.rpcUrls?.chainDefault?.http?.[0]||o,l=r?.[i]?.map(h=>h.url)||[],u=[...l,...a?[a]:[]],d=[...l];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:nr.NetworkImageIds[t.id],imageUrl:e?.[t.id]},rpcUrls:{...t.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){return t.map(s=>ps.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:n}))},getViemTransport(t,e,n){const r=[];return n?.forEach(s=>{r.push(Cd(s.url,s.config))}),xg.includes(t.caipNetworkId)&&r.push(Cd(Cv(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),t?.rpcUrls?.default?.http?.forEach(s=>{r.push(Cd(s))}),ub(r)},extendWagmiTransports(t,e,n){if(xg.includes(t.caipNetworkId)){const r=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return ub([n,Cd(r)])}return n},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:F.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){const e=W.getActiveCaipNetworkId(),n=T.getAllRequestedCaipNetworks(),r=Array.from(T.state.chains?.keys()||[]),s=e?.split(":")[0],i=s?r.includes(s):!1,o=n?.find(c=>c.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||n?.[0]}},Jh={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0},Dn=ct({providers:{...Jh},providerIds:{...Jh}}),st={state:Dn,subscribeKey(t,e){return ln(Dn,t,e)},subscribe(t){return cn(Dn,()=>{t(Dn)})},subscribeProviders(t){return cn(Dn.providers,()=>t(Dn.providers))},setProvider(t,e){t&&e&&(Dn.providers[t]=Wo(e))},getProvider(t){if(t)return Dn.providers[t]},setProviderId(t,e){e&&(Dn.providerIds[t]=e)},getProviderId(t){if(t)return Dn.providerIds[t]},reset(){Dn.providers={...Jh},Dn.providerIds={...Jh}},resetChain(t){Dn.providers[t]=void 0,Dn.providerIds[t]=void 0}},Iv={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},tn={set(t,e){rr.isClient&&localStorage.setItem(`${he.STORAGE_KEY}${t}`,e)},get(t){return rr.isClient?localStorage.getItem(`${he.STORAGE_KEY}${t}`):null},delete(t,e){rr.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${he.STORAGE_KEY}${t}`))}},qd=30*1e3,rr={checkIfAllowedToTriggerEmail(){const t=tn.get(he.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<qd){const n=Math.ceil((qd-e)/1e3);throw new Error(`Please try again after ${n} seconds`)}}},getTimeToNextEmailLogin(){const t=tn.get(he.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<qd)return Math.ceil((qd-e)/1e3)}return 0},checkIfRequestExists(t){return Ht.NOT_SAFE_RPC_METHODS.includes(t.method)||Ht.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&(t?.match(Iv.transactionHash)||t?.match(Iv.signedMessage))?he.RPC_RESPONSE_TYPE_TX:he.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return Ht.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var Ge;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Ge||(Ge={}));var w0;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(w0||(w0={}));const ie=Ge.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Fi=t=>{switch(typeof t){case"undefined":return ie.undefined;case"string":return ie.string;case"number":return isNaN(t)?ie.nan:ie.number;case"boolean":return ie.boolean;case"function":return ie.function;case"bigint":return ie.bigint;case"symbol":return ie.symbol;case"object":return Array.isArray(t)?ie.array:t===null?ie.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ie.promise:typeof Map<"u"&&t instanceof Map?ie.map:typeof Set<"u"&&t instanceof Set?ie.set:typeof Date<"u"&&t instanceof Date?ie.date:ie.object;default:return ie.unknown}},J=Ge.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),aV=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Yr extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(n(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ge.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Yr.create=t=>new Yr(t);const bu=(t,e)=>{let n;switch(t.code){case J.invalid_type:t.received===ie.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case J.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Ge.jsonStringifyReplacer)}`;break;case J.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ge.joinValues(t.keys,", ")}`;break;case J.invalid_union:n="Invalid input";break;case J.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ge.joinValues(t.options)}`;break;case J.invalid_enum_value:n=`Invalid enum value. Expected ${Ge.joinValues(t.options)}, received '${t.received}'`;break;case J.invalid_arguments:n="Invalid function arguments";break;case J.invalid_return_type:n="Invalid function return type";break;case J.invalid_date:n="Invalid date";break;case J.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Ge.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case J.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case J.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case J.custom:n="Invalid input";break;case J.invalid_intersection_types:n="Intersection results could not be merged";break;case J.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case J.not_finite:n="Number must be finite";break;default:n=e.defaultError,Ge.assertNever(t)}return{message:n}};let BN=bu;function cV(t){BN=t}function Yh(){return BN}const Zh=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},lV=[];function ce(t,e){const n=Zh({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Yh(),bu].filter(r=>!!r)});t.common.issues.push(n)}class yn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return _e;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return yn.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return _e;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const _e=Object.freeze({status:"aborted"}),$N=t=>({status:"dirty",value:t}),Sn=t=>({status:"valid",value:t}),b0=t=>t.status==="aborted",E0=t=>t.status==="dirty",Eu=t=>t.status==="valid",Qh=t=>typeof Promise<"u"&&t instanceof Promise;var be;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(be||(be={}));class xs{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const _v=(t,e)=>{if(Eu(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Yr(t.common.issues);return this._error=n,this._error}}};function Se(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:n??a.defaultError},description:s}}class Oe{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Fi(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Fi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new yn,ctx:{common:e.parent.common,data:e.data,parsedType:Fi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Qh(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n?.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fi(e)},i=this._parseSync({data:e,path:s.path,parent:s});return _v(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fi(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(Qh(s)?s:Promise.resolve(s));return _v(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:J.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new Qr({schema:this,typeName:Ae.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ri.create(this,this._def)}nullable(){return ra.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Zr.create(this,this._def)}promise(){return Ac.create(this,this._def)}or(e){return Iu.create([this,e],this._def)}and(e){return _u.create(this,e,this._def)}transform(e){return new Qr({...Se(this._def),schema:this,typeName:Ae.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Pu({...Se(this._def),innerType:this,defaultValue:n,typeName:Ae.ZodDefault})}brand(){return new MN({typeName:Ae.ZodBranded,type:this,...Se(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new nf({...Se(this._def),innerType:this,catchValue:n,typeName:Ae.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return od.create(this,e)}readonly(){return sf.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const uV=/^c[^\s-]{8,}$/i,dV=/^[a-z][a-z0-9]*$/,hV=/^[0-9A-HJKMNP-TV-Z]{26}$/,fV=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,pV=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,gV="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Tg;const mV=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,yV=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,wV=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function bV(t,e){return!!((e==="v4"||!e)&&mV.test(t)||(e==="v6"||!e)&&yV.test(t))}class Kr extends Oe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ie.string){const i=this._getOrReturnCtx(e);return ce(i,{code:J.invalid_type,expected:ie.string,received:i.parsedType}),_e}const r=new yn;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:J.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:J.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?ce(s,{code:J.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&ce(s,{code:J.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")pV.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"email",code:J.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Tg||(Tg=new RegExp(gV,"u")),Tg.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"emoji",code:J.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")fV.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"uuid",code:J.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")uV.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"cuid",code:J.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")dV.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"cuid2",code:J.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")hV.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"ulid",code:J.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),ce(s,{validation:"url",code:J.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"regex",code:J.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),ce(s,{code:J.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),ce(s,{code:J.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),ce(s,{code:J.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?wV(i).test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{code:J.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?bV(e.data,i.version)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"ip",code:J.invalid_string,message:i.message}),r.dirty()):Ge.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:J.invalid_string,...be.errToObj(r)})}_addCheck(e){return new Kr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...be.errToObj(e)})}url(e){return this._addCheck({kind:"url",...be.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...be.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...be.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...be.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...be.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...be.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...be.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(n=e?.offset)!==null&&n!==void 0?n:!1,...be.errToObj(e?.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...be.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,...be.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...be.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...be.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...be.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...be.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...be.errToObj(n)})}nonempty(e){return this.min(1,be.errToObj(e))}trim(){return new Kr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Kr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Kr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Kr.create=t=>{var e;return new Kr({checks:[],typeName:Ae.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Se(t)})};function EV(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class no extends Oe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ie.number){const i=this._getOrReturnCtx(e);return ce(i,{code:J.invalid_type,expected:ie.number,received:i.parsedType}),_e}let r;const s=new yn;for(const i of this._def.checks)i.kind==="int"?Ge.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),ce(r,{code:J.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),ce(r,{code:J.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),ce(r,{code:J.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?EV(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),ce(r,{code:J.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),ce(r,{code:J.not_finite,message:i.message}),s.dirty()):Ge.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,be.toString(n))}gt(e,n){return this.setLimit("min",e,!1,be.toString(n))}lte(e,n){return this.setLimit("max",e,!0,be.toString(n))}lt(e,n){return this.setLimit("max",e,!1,be.toString(n))}setLimit(e,n,r,s){return new no({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:be.toString(s)}]})}_addCheck(e){return new no({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:be.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:be.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:be.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:be.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:be.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:be.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ge.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}no.create=t=>new no({checks:[],typeName:Ae.ZodNumber,coerce:t?.coerce||!1,...Se(t)});class ro extends Oe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ie.bigint){const i=this._getOrReturnCtx(e);return ce(i,{code:J.invalid_type,expected:ie.bigint,received:i.parsedType}),_e}let r;const s=new yn;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),ce(r,{code:J.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),ce(r,{code:J.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),ce(r,{code:J.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Ge.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,be.toString(n))}gt(e,n){return this.setLimit("min",e,!1,be.toString(n))}lte(e,n){return this.setLimit("max",e,!0,be.toString(n))}lt(e,n){return this.setLimit("max",e,!1,be.toString(n))}setLimit(e,n,r,s){return new ro({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:be.toString(s)}]})}_addCheck(e){return new ro({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:be.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:be.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ro.create=t=>{var e;return new ro({checks:[],typeName:Ae.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Se(t)})};class vu extends Oe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ie.boolean){const r=this._getOrReturnCtx(e);return ce(r,{code:J.invalid_type,expected:ie.boolean,received:r.parsedType}),_e}return Sn(e.data)}}vu.create=t=>new vu({typeName:Ae.ZodBoolean,coerce:t?.coerce||!1,...Se(t)});class ta extends Oe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ie.date){const i=this._getOrReturnCtx(e);return ce(i,{code:J.invalid_type,expected:ie.date,received:i.parsedType}),_e}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return ce(i,{code:J.invalid_date}),_e}const r=new yn;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:J.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:J.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Ge.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ta({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:be.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:be.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}ta.create=t=>new ta({checks:[],coerce:t?.coerce||!1,typeName:Ae.ZodDate,...Se(t)});class Xh extends Oe{_parse(e){if(this._getType(e)!==ie.symbol){const r=this._getOrReturnCtx(e);return ce(r,{code:J.invalid_type,expected:ie.symbol,received:r.parsedType}),_e}return Sn(e.data)}}Xh.create=t=>new Xh({typeName:Ae.ZodSymbol,...Se(t)});class Au extends Oe{_parse(e){if(this._getType(e)!==ie.undefined){const r=this._getOrReturnCtx(e);return ce(r,{code:J.invalid_type,expected:ie.undefined,received:r.parsedType}),_e}return Sn(e.data)}}Au.create=t=>new Au({typeName:Ae.ZodUndefined,...Se(t)});class Cu extends Oe{_parse(e){if(this._getType(e)!==ie.null){const r=this._getOrReturnCtx(e);return ce(r,{code:J.invalid_type,expected:ie.null,received:r.parsedType}),_e}return Sn(e.data)}}Cu.create=t=>new Cu({typeName:Ae.ZodNull,...Se(t)});class vc extends Oe{constructor(){super(...arguments),this._any=!0}_parse(e){return Sn(e.data)}}vc.create=t=>new vc({typeName:Ae.ZodAny,...Se(t)});class jo extends Oe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Sn(e.data)}}jo.create=t=>new jo({typeName:Ae.ZodUnknown,...Se(t)});class li extends Oe{_parse(e){const n=this._getOrReturnCtx(e);return ce(n,{code:J.invalid_type,expected:ie.never,received:n.parsedType}),_e}}li.create=t=>new li({typeName:Ae.ZodNever,...Se(t)});class ef extends Oe{_parse(e){if(this._getType(e)!==ie.undefined){const r=this._getOrReturnCtx(e);return ce(r,{code:J.invalid_type,expected:ie.void,received:r.parsedType}),_e}return Sn(e.data)}}ef.create=t=>new ef({typeName:Ae.ZodVoid,...Se(t)});class Zr extends Oe{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==ie.array)return ce(n,{code:J.invalid_type,expected:ie.array,received:n.parsedType}),_e;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,a=n.data.length<s.exactLength.value;(o||a)&&(ce(n,{code:o?J.too_big:J.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(ce(n,{code:J.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(ce(n,{code:J.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>s.type._parseAsync(new xs(n,o,n.path,a)))).then(o=>yn.mergeArray(r,o));const i=[...n.data].map((o,a)=>s.type._parseSync(new xs(n,o,n.path,a)));return yn.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Zr({...this._def,minLength:{value:e,message:be.toString(n)}})}max(e,n){return new Zr({...this._def,maxLength:{value:e,message:be.toString(n)}})}length(e,n){return new Zr({...this._def,exactLength:{value:e,message:be.toString(n)}})}nonempty(e){return this.min(1,e)}}Zr.create=(t,e)=>new Zr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ae.ZodArray,...Se(e)});function Va(t){if(t instanceof vt){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=ri.create(Va(r))}return new vt({...t._def,shape:()=>e})}else return t instanceof Zr?new Zr({...t._def,type:Va(t.element)}):t instanceof ri?ri.create(Va(t.unwrap())):t instanceof ra?ra.create(Va(t.unwrap())):t instanceof Ts?Ts.create(t.items.map(e=>Va(e))):t}class vt extends Oe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Ge.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==ie.object){const l=this._getOrReturnCtx(e);return ce(l,{code:J.invalid_type,expected:ie.object,received:l.parsedType}),_e}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof li&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new xs(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof li){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(ce(s,{code:J.unrecognized_keys,keys:a}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new xs(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key;l.push({key:d,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>yn.mergeObjectSync(r,l)):yn.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return be.errToObj,new vt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(a=be.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new vt({...this._def,unknownKeys:"strip"})}passthrough(){return new vt({...this._def,unknownKeys:"passthrough"})}extend(e){return new vt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new vt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ae.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new vt({...this._def,catchall:e})}pick(e){const n={};return Ge.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new vt({...this._def,shape:()=>n})}omit(e){const n={};return Ge.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new vt({...this._def,shape:()=>n})}deepPartial(){return Va(this)}partial(e){const n={};return Ge.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new vt({...this._def,shape:()=>n})}required(e){const n={};return Ge.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof ri;)i=i._def.innerType;n[r]=i}}),new vt({...this._def,shape:()=>n})}keyof(){return LN(Ge.objectKeys(this.shape))}}vt.create=(t,e)=>new vt({shape:()=>t,unknownKeys:"strip",catchall:li.create(),typeName:Ae.ZodObject,...Se(e)});vt.strictCreate=(t,e)=>new vt({shape:()=>t,unknownKeys:"strict",catchall:li.create(),typeName:Ae.ZodObject,...Se(e)});vt.lazycreate=(t,e)=>new vt({shape:t,unknownKeys:"strip",catchall:li.create(),typeName:Ae.ZodObject,...Se(e)});class Iu extends Oe{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new Yr(a.ctx.common.issues));return ce(n,{code:J.invalid_union,unionErrors:o}),_e}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const l={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new Yr(c));return ce(n,{code:J.invalid_union,unionErrors:a}),_e}}get options(){return this._def.options}}Iu.create=(t,e)=>new Iu({options:t,typeName:Ae.ZodUnion,...Se(e)});const hh=t=>t instanceof Su?hh(t.schema):t instanceof Qr?hh(t.innerType()):t instanceof xu?[t.value]:t instanceof so?t.options:t instanceof Tu?Object.keys(t.enum):t instanceof Pu?hh(t._def.innerType):t instanceof Au?[void 0]:t instanceof Cu?[null]:null;class Jf extends Oe{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ie.object)return ce(n,{code:J.invalid_type,expected:ie.object,received:n.parsedType}),_e;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(ce(n,{code:J.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),_e)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=hh(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new Jf({typeName:Ae.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...Se(r)})}}function v0(t,e){const n=Fi(t),r=Fi(e);if(t===e)return{valid:!0,data:t};if(n===ie.object&&r===ie.object){const s=Ge.objectKeys(e),i=Ge.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=v0(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(n===ie.array&&r===ie.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=v0(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===ie.date&&r===ie.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class _u extends Oe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(b0(i)||b0(o))return _e;const a=v0(i.value,o.value);return a.valid?((E0(i)||E0(o))&&n.dirty(),{status:n.value,value:a.data}):(ce(r,{code:J.invalid_intersection_types}),_e)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}_u.create=(t,e,n)=>new _u({left:t,right:e,typeName:Ae.ZodIntersection,...Se(n)});class Ts extends Oe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.array)return ce(r,{code:J.invalid_type,expected:ie.array,received:r.parsedType}),_e;if(r.data.length<this._def.items.length)return ce(r,{code:J.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),_e;!this._def.rest&&r.data.length>this._def.items.length&&(ce(r,{code:J.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new xs(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>yn.mergeArray(n,o)):yn.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Ts({...this._def,rest:e})}}Ts.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ts({items:t,typeName:Ae.ZodTuple,rest:null,...Se(e)})};class Nu extends Oe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.object)return ce(r,{code:J.invalid_type,expected:ie.object,received:r.parsedType}),_e;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new xs(r,a,r.path,a)),value:o._parse(new xs(r,r.data[a],r.path,a))});return r.common.async?yn.mergeObjectAsync(n,s):yn.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof Oe?new Nu({keyType:e,valueType:n,typeName:Ae.ZodRecord,...Se(r)}):new Nu({keyType:Kr.create(),valueType:e,typeName:Ae.ZodRecord,...Se(n)})}}class tf extends Oe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.map)return ce(r,{code:J.invalid_type,expected:ie.map,received:r.parsedType}),_e;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,c],l)=>({key:s._parse(new xs(r,a,r.path,[l,"key"])),value:i._parse(new xs(r,c,r.path,[l,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return _e;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return _e;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}}}}tf.create=(t,e,n)=>new tf({valueType:e,keyType:t,typeName:Ae.ZodMap,...Se(n)});class na extends Oe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.set)return ce(r,{code:J.invalid_type,expected:ie.set,received:r.parsedType}),_e;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(ce(r,{code:J.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(ce(r,{code:J.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return _e;u.status==="dirty"&&n.dirty(),l.add(u.value)}return{status:n.value,value:l}}const a=[...r.data.values()].map((c,l)=>i._parse(new xs(r,c,r.path,l)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,n){return new na({...this._def,minSize:{value:e,message:be.toString(n)}})}max(e,n){return new na({...this._def,maxSize:{value:e,message:be.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}na.create=(t,e)=>new na({valueType:t,minSize:null,maxSize:null,typeName:Ae.ZodSet,...Se(e)});class rc extends Oe{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ie.function)return ce(n,{code:J.invalid_type,expected:ie.function,received:n.parsedType}),_e;function r(a,c){return Zh({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Yh(),bu].filter(l=>!!l),issueData:{code:J.invalid_arguments,argumentsError:c}})}function s(a,c){return Zh({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Yh(),bu].filter(l=>!!l),issueData:{code:J.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof Ac){const a=this;return Sn(async function(...c){const l=new Yr([]),u=await a._def.args.parseAsync(c,i).catch(f=>{throw l.addIssue(r(c,f)),l}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(f=>{throw l.addIssue(s(d,f)),l})})}else{const a=this;return Sn(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new Yr([r(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new Yr([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new rc({...this._def,args:Ts.create(e).rest(jo.create())})}returns(e){return new rc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new rc({args:e||Ts.create([]).rest(jo.create()),returns:n||jo.create(),typeName:Ae.ZodFunction,...Se(r)})}}class Su extends Oe{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Su.create=(t,e)=>new Su({getter:t,typeName:Ae.ZodLazy,...Se(e)});class xu extends Oe{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return ce(n,{received:n.data,code:J.invalid_literal,expected:this._def.value}),_e}return{status:"valid",value:e.data}}get value(){return this._def.value}}xu.create=(t,e)=>new xu({value:t,typeName:Ae.ZodLiteral,...Se(e)});function LN(t,e){return new so({values:t,typeName:Ae.ZodEnum,...Se(e)})}class so extends Oe{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return ce(n,{expected:Ge.joinValues(r),received:n.parsedType,code:J.invalid_type}),_e}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return ce(n,{received:n.data,code:J.invalid_enum_value,options:r}),_e}return Sn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return so.create(e)}exclude(e){return so.create(this.options.filter(n=>!e.includes(n)))}}so.create=LN;class Tu extends Oe{_parse(e){const n=Ge.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ie.string&&r.parsedType!==ie.number){const s=Ge.objectValues(n);return ce(r,{expected:Ge.joinValues(s),received:r.parsedType,code:J.invalid_type}),_e}if(n.indexOf(e.data)===-1){const s=Ge.objectValues(n);return ce(r,{received:r.data,code:J.invalid_enum_value,options:s}),_e}return Sn(e.data)}get enum(){return this._def.values}}Tu.create=(t,e)=>new Tu({values:t,typeName:Ae.ZodNativeEnum,...Se(e)});class Ac extends Oe{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ie.promise&&n.common.async===!1)return ce(n,{code:J.invalid_type,expected:ie.promise,received:n.parsedType}),_e;const r=n.parsedType===ie.promise?n.data:Promise.resolve(n.data);return Sn(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Ac.create=(t,e)=>new Ac({type:t,typeName:Ae.ZodPromise,...Se(e)});class Qr extends Oe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ae.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{ce(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?_e:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?_e:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Eu(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Eu(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:n.value,value:a})):o);Ge.assertNever(s)}}Qr.create=(t,e,n)=>new Qr({schema:t,typeName:Ae.ZodEffects,effect:e,...Se(n)});Qr.createWithPreprocess=(t,e,n)=>new Qr({schema:e,effect:{type:"preprocess",transform:t},typeName:Ae.ZodEffects,...Se(n)});class ri extends Oe{_parse(e){return this._getType(e)===ie.undefined?Sn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ri.create=(t,e)=>new ri({innerType:t,typeName:Ae.ZodOptional,...Se(e)});class ra extends Oe{_parse(e){return this._getType(e)===ie.null?Sn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ra.create=(t,e)=>new ra({innerType:t,typeName:Ae.ZodNullable,...Se(e)});class Pu extends Oe{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===ie.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Pu.create=(t,e)=>new Pu({innerType:t,typeName:Ae.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Se(e)});class nf extends Oe{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Qh(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Yr(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Yr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}nf.create=(t,e)=>new nf({innerType:t,typeName:Ae.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Se(e)});class rf extends Oe{_parse(e){if(this._getType(e)!==ie.nan){const r=this._getOrReturnCtx(e);return ce(r,{code:J.invalid_type,expected:ie.nan,received:r.parsedType}),_e}return{status:"valid",value:e.data}}}rf.create=t=>new rf({typeName:Ae.ZodNaN,...Se(t)});const vV=Symbol("zod_brand");class MN extends Oe{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class od extends Oe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?_e:i.status==="dirty"?(n.dirty(),$N(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?_e:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new od({in:e,out:n,typeName:Ae.ZodPipeline})}}class sf extends Oe{_parse(e){const n=this._def.innerType._parse(e);return Eu(n)&&(n.value=Object.freeze(n.value)),n}}sf.create=(t,e)=>new sf({innerType:t,typeName:Ae.ZodReadonly,...Se(e)});const FN=(t,e={},n)=>t?vc.create().superRefine((r,s)=>{var i,o;if(!t(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):vc.create(),AV={object:vt.lazycreate};var Ae;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ae||(Ae={}));const CV=(t,e={message:`Input not instance of ${t.name}`})=>FN(n=>n instanceof t,e),jN=Kr.create,HN=no.create,IV=rf.create,_V=ro.create,zN=vu.create,NV=ta.create,SV=Xh.create,xV=Au.create,TV=Cu.create,PV=vc.create,OV=jo.create,RV=li.create,kV=ef.create,DV=Zr.create,UV=vt.create,BV=vt.strictCreate,$V=Iu.create,LV=Jf.create,MV=_u.create,FV=Ts.create,jV=Nu.create,HV=tf.create,zV=na.create,qV=rc.create,WV=Su.create,VV=xu.create,GV=so.create,KV=Tu.create,JV=Ac.create,Nv=Qr.create,YV=ri.create,ZV=ra.create,QV=Qr.createWithPreprocess,XV=od.create,eG=()=>jN().optional(),tG=()=>HN().optional(),nG=()=>zN().optional(),rG={string:t=>Kr.create({...t,coerce:!0}),number:t=>no.create({...t,coerce:!0}),boolean:t=>vu.create({...t,coerce:!0}),bigint:t=>ro.create({...t,coerce:!0}),date:t=>ta.create({...t,coerce:!0})},sG=_e;var C=Object.freeze({__proto__:null,defaultErrorMap:bu,setErrorMap:cV,getErrorMap:Yh,makeIssue:Zh,EMPTY_PATH:lV,addIssueToContext:ce,ParseStatus:yn,INVALID:_e,DIRTY:$N,OK:Sn,isAborted:b0,isDirty:E0,isValid:Eu,isAsync:Qh,get util(){return Ge},get objectUtil(){return w0},ZodParsedType:ie,getParsedType:Fi,ZodType:Oe,ZodString:Kr,ZodNumber:no,ZodBigInt:ro,ZodBoolean:vu,ZodDate:ta,ZodSymbol:Xh,ZodUndefined:Au,ZodNull:Cu,ZodAny:vc,ZodUnknown:jo,ZodNever:li,ZodVoid:ef,ZodArray:Zr,ZodObject:vt,ZodUnion:Iu,ZodDiscriminatedUnion:Jf,ZodIntersection:_u,ZodTuple:Ts,ZodRecord:Nu,ZodMap:tf,ZodSet:na,ZodFunction:rc,ZodLazy:Su,ZodLiteral:xu,ZodEnum:so,ZodNativeEnum:Tu,ZodPromise:Ac,ZodEffects:Qr,ZodTransformer:Qr,ZodOptional:ri,ZodNullable:ra,ZodDefault:Pu,ZodCatch:nf,ZodNaN:rf,BRAND:vV,ZodBranded:MN,ZodPipeline:od,ZodReadonly:sf,custom:FN,Schema:Oe,ZodSchema:Oe,late:AV,get ZodFirstPartyTypeKind(){return Ae},coerce:rG,any:PV,array:DV,bigint:_V,boolean:zN,date:NV,discriminatedUnion:LV,effect:Nv,enum:GV,function:qV,instanceof:CV,intersection:MV,lazy:WV,literal:VV,map:HV,nan:IV,nativeEnum:KV,never:RV,null:TV,nullable:ZV,number:HN,object:UV,oboolean:nG,onumber:tG,optional:YV,ostring:eG,pipeline:XV,preprocess:QV,promise:JV,record:jV,set:zV,strictObject:BV,string:jN,symbol:SV,transformer:Nv,tuple:FV,undefined:xV,union:$V,unknown:OV,void:kV,NEVER:sG,ZodIssueCode:J,quotelessJson:aV,ZodError:Yr});const Ct=C.object({message:C.string()});function oe(t){return C.literal(he[t])}const Yf=C.object({serializedMessage:C.string().optional(),accountAddress:C.string(),chainId:C.string(),notBefore:C.string().optional(),domain:C.string(),uri:C.string(),version:C.string(),nonce:C.string(),statement:C.string().optional(),resources:C.array(C.string()).optional(),requestId:C.string().optional(),issuedAt:C.string().optional(),expirationTime:C.string().optional()});C.object({accessList:C.array(C.string()),blockHash:C.string().nullable(),blockNumber:C.string().nullable(),chainId:C.string().or(C.number()),from:C.string(),gas:C.string(),hash:C.string(),input:C.string().nullable(),maxFeePerGas:C.string(),maxPriorityFeePerGas:C.string(),nonce:C.string(),r:C.string(),s:C.string(),to:C.string(),transactionIndex:C.string().nullable(),type:C.string(),v:C.string(),value:C.string()});const iG=C.object({chainId:C.string().or(C.number()),rpcUrl:C.optional(C.string())}),oG=C.object({email:C.string().email()}),aG=C.object({otp:C.string()}),cG=C.object({uri:C.string(),preferredAccountType:C.optional(C.string()),chainId:C.optional(C.string().or(C.number())),siwxMessage:C.optional(Yf),rpcUrl:C.optional(C.string())}),lG=C.object({chainId:C.optional(C.string().or(C.number())),preferredAccountType:C.optional(C.string()),socialUri:C.optional(C.string()),siwxMessage:C.optional(Yf),rpcUrl:C.optional(C.string())}),uG=C.object({provider:C.enum(["google","github","apple","facebook","x","discord"])}),dG=C.object({email:C.string().email()}),hG=C.object({otp:C.string()}),fG=C.object({otp:C.string()}),pG=C.object({themeMode:C.optional(C.enum(["light","dark"])),themeVariables:C.optional(C.record(C.string(),C.string().or(C.number()))),w3mThemeVariables:C.optional(C.record(C.string(),C.string()))}),gG=C.object({metadata:C.object({name:C.string(),description:C.string(),url:C.string(),icons:C.array(C.string())}).optional(),sdkVersion:C.string().optional(),sdkType:C.string().optional(),projectId:C.string()}),mG=C.object({type:C.string()}),yG=C.object({action:C.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),wG=C.object({url:C.string()}),bG=C.object({userName:C.string()}),EG=C.object({email:C.string().optional().nullable(),address:C.string(),chainId:C.string().or(C.number()),accounts:C.array(C.object({address:C.string(),type:C.enum([Ht.ACCOUNT_TYPES.EOA,Ht.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:C.string().optional().nullable(),preferredAccountType:C.optional(C.string()),signature:C.string().optional(),message:C.string().optional(),siwxMessage:C.optional(Yf)}),vG=C.object({action:C.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),AG=C.object({email:C.string().email().optional().nullable(),address:C.string(),chainId:C.string().or(C.number()),smartAccountDeployed:C.optional(C.boolean()),accounts:C.array(C.object({address:C.string(),type:C.enum([Ht.ACCOUNT_TYPES.EOA,Ht.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:C.optional(C.string()),signature:C.string().optional(),message:C.string().optional(),siwxMessage:C.optional(Yf)}),CG=C.object({uri:C.string()}),IG=C.object({isConnected:C.boolean()}),_G=C.object({chainId:C.string().or(C.number())}),NG=C.object({chainId:C.string().or(C.number())}),SG=C.object({newEmail:C.string().email()}),xG=C.object({smartAccountEnabledNetworks:C.array(C.number())});C.object({address:C.string(),isDeployed:C.boolean()});const TG=C.object({version:C.string().optional()}),PG=C.object({type:C.string(),address:C.string()}),OG=C.any(),RG=C.object({method:C.literal("eth_accounts")}),kG=C.object({method:C.literal("eth_blockNumber")}),DG=C.object({method:C.literal("eth_call"),params:C.array(C.any())}),UG=C.object({method:C.literal("eth_chainId")}),BG=C.object({method:C.literal("eth_estimateGas"),params:C.array(C.any())}),$G=C.object({method:C.literal("eth_feeHistory"),params:C.array(C.any())}),LG=C.object({method:C.literal("eth_gasPrice")}),MG=C.object({method:C.literal("eth_getAccount"),params:C.array(C.any())}),FG=C.object({method:C.literal("eth_getBalance"),params:C.array(C.any())}),jG=C.object({method:C.literal("eth_getBlockByHash"),params:C.array(C.any())}),HG=C.object({method:C.literal("eth_getBlockByNumber"),params:C.array(C.any())}),zG=C.object({method:C.literal("eth_getBlockReceipts"),params:C.array(C.any())}),qG=C.object({method:C.literal("eth_getBlockTransactionCountByHash"),params:C.array(C.any())}),WG=C.object({method:C.literal("eth_getBlockTransactionCountByNumber"),params:C.array(C.any())}),VG=C.object({method:C.literal("eth_getCode"),params:C.array(C.any())}),GG=C.object({method:C.literal("eth_getFilterChanges"),params:C.array(C.any())}),KG=C.object({method:C.literal("eth_getFilterLogs"),params:C.array(C.any())}),JG=C.object({method:C.literal("eth_getLogs"),params:C.array(C.any())}),YG=C.object({method:C.literal("eth_getProof"),params:C.array(C.any())}),ZG=C.object({method:C.literal("eth_getStorageAt"),params:C.array(C.any())}),QG=C.object({method:C.literal("eth_getTransactionByBlockHashAndIndex"),params:C.array(C.any())}),XG=C.object({method:C.literal("eth_getTransactionByBlockNumberAndIndex"),params:C.array(C.any())}),eK=C.object({method:C.literal("eth_getTransactionByHash"),params:C.array(C.any())}),tK=C.object({method:C.literal("eth_getTransactionCount"),params:C.array(C.any())}),nK=C.object({method:C.literal("eth_getTransactionReceipt"),params:C.array(C.any())}),rK=C.object({method:C.literal("eth_getUncleCountByBlockHash"),params:C.array(C.any())}),sK=C.object({method:C.literal("eth_getUncleCountByBlockNumber"),params:C.array(C.any())}),iK=C.object({method:C.literal("eth_maxPriorityFeePerGas")}),oK=C.object({method:C.literal("eth_newBlockFilter")}),aK=C.object({method:C.literal("eth_newFilter"),params:C.array(C.any())}),cK=C.object({method:C.literal("eth_newPendingTransactionFilter")}),lK=C.object({method:C.literal("eth_sendRawTransaction"),params:C.array(C.any())}),uK=C.object({method:C.literal("eth_syncing"),params:C.array(C.any())}),dK=C.object({method:C.literal("eth_uninstallFilter"),params:C.array(C.any())}),Sv=C.object({method:C.literal("personal_sign"),params:C.array(C.any())}),hK=C.object({method:C.literal("eth_signTypedData_v4"),params:C.array(C.any())}),fK=C.object({method:C.literal("eth_sendTransaction"),params:C.array(C.any())}),pK=C.object({method:C.literal("solana_signMessage"),params:C.object({message:C.string(),pubkey:C.string()})}),gK=C.object({method:C.literal("solana_signTransaction"),params:C.object({transaction:C.string()})}),mK=C.object({method:C.literal("solana_signAllTransactions"),params:C.object({transactions:C.array(C.string())})}),yK=C.object({method:C.literal("solana_signAndSendTransaction"),params:C.object({transaction:C.string(),options:C.object({skipPreflight:C.boolean().optional(),preflightCommitment:C.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:C.number().optional(),minContextSlot:C.number().optional()}).optional()})}),wK=C.object({method:C.literal("wallet_sendCalls"),params:C.array(C.object({chainId:C.string().or(C.number()).optional(),from:C.string().optional(),version:C.string().optional(),capabilities:C.any().optional(),calls:C.array(C.object({to:C.string().startsWith("0x"),data:C.string().startsWith("0x").optional(),value:C.string().optional()}))}))}),bK=C.object({method:C.literal("wallet_getCallsStatus"),params:C.array(C.string())}),EK=C.object({method:C.literal("wallet_getCapabilities"),params:C.array(C.string().or(C.number()).optional()).optional()}),vK=C.object({method:C.literal("wallet_grantPermissions"),params:C.array(C.any())}),AK=C.object({method:C.literal("wallet_revokePermissions"),params:C.any()}),CK=C.object({method:C.literal("wallet_getAssets"),params:C.any()}),xv=C.object({token:C.string()}),ae=C.object({id:C.string().optional()}),Pg={appEvent:ae.extend({type:oe("APP_SWITCH_NETWORK"),payload:iG}).or(ae.extend({type:oe("APP_CONNECT_EMAIL"),payload:oG})).or(ae.extend({type:oe("APP_CONNECT_DEVICE")})).or(ae.extend({type:oe("APP_CONNECT_OTP"),payload:aG})).or(ae.extend({type:oe("APP_CONNECT_SOCIAL"),payload:cG})).or(ae.extend({type:oe("APP_GET_FARCASTER_URI")})).or(ae.extend({type:oe("APP_CONNECT_FARCASTER")})).or(ae.extend({type:oe("APP_GET_USER"),payload:C.optional(lG)})).or(ae.extend({type:oe("APP_GET_SOCIAL_REDIRECT_URI"),payload:uG})).or(ae.extend({type:oe("APP_SIGN_OUT")})).or(ae.extend({type:oe("APP_IS_CONNECTED"),payload:C.optional(xv)})).or(ae.extend({type:oe("APP_GET_CHAIN_ID")})).or(ae.extend({type:oe("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(ae.extend({type:oe("APP_INIT_SMART_ACCOUNT")})).or(ae.extend({type:oe("APP_SET_PREFERRED_ACCOUNT"),payload:mG})).or(ae.extend({type:oe("APP_RPC_REQUEST"),payload:Sv.or(CK).or(RG).or(kG).or(DG).or(UG).or(BG).or($G).or(LG).or(MG).or(FG).or(jG).or(HG).or(zG).or(qG).or(WG).or(VG).or(GG).or(KG).or(JG).or(YG).or(ZG).or(QG).or(XG).or(eK).or(tK).or(nK).or(rK).or(sK).or(iK).or(oK).or(aK).or(cK).or(lK).or(uK).or(dK).or(Sv).or(hK).or(fK).or(pK).or(gK).or(mK).or(yK).or(bK).or(wK).or(EK).or(vK).or(AK).and(C.object({chainId:C.string().or(C.number()).optional(),chainNamespace:C.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:C.string().optional()}))})).or(ae.extend({type:oe("APP_UPDATE_EMAIL"),payload:dG})).or(ae.extend({type:oe("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:hG})).or(ae.extend({type:oe("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:fG})).or(ae.extend({type:oe("APP_SYNC_THEME"),payload:pG})).or(ae.extend({type:oe("APP_SYNC_DAPP_DATA"),payload:gG})).or(ae.extend({type:oe("APP_RELOAD")})).or(ae.extend({type:oe("APP_RPC_ABORT")})),frameEvent:ae.extend({type:oe("FRAME_SWITCH_NETWORK_ERROR"),payload:Ct}).or(ae.extend({type:oe("FRAME_SWITCH_NETWORK_SUCCESS"),payload:NG})).or(ae.extend({type:oe("FRAME_CONNECT_EMAIL_SUCCESS"),payload:yG})).or(ae.extend({type:oe("FRAME_CONNECT_EMAIL_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:wG})).or(ae.extend({type:oe("FRAME_GET_FARCASTER_URI_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:bG})).or(ae.extend({type:oe("FRAME_CONNECT_FARCASTER_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_CONNECT_OTP_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_CONNECT_OTP_SUCCESS")})).or(ae.extend({type:oe("FRAME_CONNECT_DEVICE_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_CONNECT_DEVICE_SUCCESS")})).or(ae.extend({type:oe("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:EG})).or(ae.extend({type:oe("FRAME_CONNECT_SOCIAL_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_GET_USER_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_GET_USER_SUCCESS"),payload:AG})).or(ae.extend({type:oe("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:CG})).or(ae.extend({type:oe("FRAME_SIGN_OUT_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_SIGN_OUT_SUCCESS")})).or(ae.extend({type:oe("FRAME_IS_CONNECTED_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_IS_CONNECTED_SUCCESS"),payload:IG})).or(ae.extend({type:oe("FRAME_GET_CHAIN_ID_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_GET_CHAIN_ID_SUCCESS"),payload:_G})).or(ae.extend({type:oe("FRAME_RPC_REQUEST_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_RPC_REQUEST_SUCCESS"),payload:OG})).or(ae.extend({type:oe("FRAME_SESSION_UPDATE"),payload:xv})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_SUCCESS"),payload:vG})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:SG})).or(ae.extend({type:oe("FRAME_SYNC_THEME_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_SYNC_THEME_SUCCESS")})).or(ae.extend({type:oe("FRAME_SYNC_DAPP_DATA_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(ae.extend({type:oe("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:xG})).or(ae.extend({type:oe("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:PG})).or(ae.extend({type:oe("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_READY"),payload:TG})).or(ae.extend({type:oe("FRAME_RELOAD_ERROR"),payload:Ct})).or(ae.extend({type:oe("FRAME_RELOAD_SUCCESS")}))};function Og(t,e={}){return typeof e?.type=="string"&&e?.type?.includes(t)}function IK({projectId:t,chainId:e,enableLogger:n,rpcUrl:r=F.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:s=!1}){const i=new URL(BT);return i.searchParams.set("projectId",t),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",LT),i.searchParams.set("enableLogger",String(n)),i.searchParams.set("rpcUrl",r),s&&i.searchParams.set("enableCloudAuthAccount","true"),i.toString()}class _K{constructor({projectId:e,isAppClient:n=!1,chainId:r="eip155:1",enableLogger:s=!0,enableCloudAuthAccount:i=!1,rpcUrl:o=F.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const a=document.getElementById("w3m-iframe");this.iframe&&!a&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(a,c,l)=>{function u({data:d}){if(!Og(he.FRAME_EVENT_KEY,d))return;const h=Pg.frameEvent.safeParse(d);if(!h.success){console.warn("W3mFrame: invalid frame event",h.error.message);return}h.data?.id===a&&(c(h.data),window.removeEventListener("message",u))}rr.isClient&&(window.addEventListener("message",u),l.addEventListener("abort",()=>{window.removeEventListener("message",u)}))},onFrameEvent:a=>{rr.isClient&&window.addEventListener("message",({data:c})=>{if(!Og(he.FRAME_EVENT_KEY,c))return;const l=Pg.frameEvent.safeParse(c);l.success?a(l.data):console.warn("W3mFrame: invalid frame event",l.error.message)})},onAppEvent:a=>{rr.isClient&&window.addEventListener("message",({data:c})=>{if(!Og(he.APP_EVENT_KEY,c))return;const l=Pg.appEvent.safeParse(c);l.success||console.warn("W3mFrame: invalid app event",l.error.message),a(c)})},postAppEvent:a=>{if(rr.isClient){if(!this.iframe?.contentWindow)throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(a,"*")}},postFrameEvent:a=>{if(rr.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(a,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),this.rpcUrl=o,n&&(this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),rr.isClient)){const a=document.createElement("iframe");a.id="w3m-iframe",a.src=IK({projectId:e,chainId:r,enableLogger:s,rpcUrl:this.rpcUrl,enableCloudAuthAccount:i}),a.name="w3m-secure-iframe",a.style.position="fixed",a.style.zIndex="999999",a.style.display="none",a.style.border="none",a.style.animationDelay="0s, 50ms",a.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",a.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=a,this.iframe.onerror=()=>{this.frameLoadPromiseResolver?.reject("Unable to load email login dependency")},this.events.onFrameEvent(c=>{c.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,this.frameLoadPromiseResolver?.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(n=>({[n]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${n}&projectId=${this.projectId}`,chainId:n}}));return Object.assign({},...e)}}class NK{constructor(e){const n=$c({level:$T}),{logger:r,chunkLoggerController:s}=Ey({opts:n});this.logger=wn(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&this.chunkLoggerController?.downloadLogsBlobInBrowser&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{this.chunkLoggerController?.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class SK{constructor({projectId:e,chainId:n,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:c}){this.openRpcRequests=[],this.isInitialized=!1,r&&(this.w3mLogger=new NK(e)),this.abortController=i,this.getActiveCaipNetwork=o,this.getCaipNetworks=a;const l=this.getRpcUrl(n);this.w3mFrame=new _K({projectId:e,isAppClient:!0,chainId:n,enableLogger:r,rpcUrl:l,enableCloudAuthAccount:c}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(n=>{n.type===he.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!tn.get(he.EMAIL_LOGIN_USED_KEY)}getEmail(){return tn.get(he.EMAIL)}getUsername(){return tn.get(he.SOCIAL_USERNAME)}async reload(){try{await this.appEvent({type:he.APP_RELOAD})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error reloading iframe"),e}}async connectEmail(e){try{rr.checkIfAllowedToTriggerEmail(),await this.init();const n=await this.appEvent({type:he.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting email"),n}}async connectDevice(){try{return this.appEvent({type:he.APP_CONNECT_DEVICE})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting device"),e}}async connectOtp(e){try{return this.appEvent({type:he.APP_CONNECT_OTP,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting otp"),n}}async isConnected(){try{if(!this.getLoginEmailUsed())return{isConnected:!1};const e=await this.appEvent({type:he.APP_IS_CONNECTED});return e?.isConnected||this.deleteAuthLoginCache(),e}catch(e){throw this.deleteAuthLoginCache(),this.w3mLogger?.logger.error({error:e},"Error checking connection"),e}}async getChainId(){try{const e=await this.appEvent({type:he.APP_GET_CHAIN_ID});return this.setLastUsedChainId(e.chainId),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting chain id"),e}}async getSocialRedirectUri(e){try{return await this.init(),this.appEvent({type:he.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error getting social redirect uri"),n}}async updateEmail(e){try{const n=await this.appEvent({type:he.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email"),n}}async updateEmailPrimaryOtp(e){try{return this.appEvent({type:he.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email primary otp"),n}}async updateEmailSecondaryOtp(e){try{const n=await this.appEvent({type:he.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(n.newEmail),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email secondary otp"),n}}async syncTheme(e){try{return this.appEvent({type:he.APP_SYNC_THEME,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error syncing theme"),n}}async syncDappData(e){try{return this.appEvent({type:he.APP_SYNC_DAPP_DATA,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error syncing dapp data"),n}}async getSmartAccountEnabledNetworks(){try{const e=await this.appEvent({type:he.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(e.smartAccountEnabledNetworks),e}catch(e){throw this.persistSmartAccountEnabledNetworks([]),this.w3mLogger?.logger.error({error:e},"Error getting smart account enabled networks"),e}}async setPreferredAccount(e){try{return this.appEvent({type:he.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error setting preferred account"),n}}async connect(e){if(e?.socialUri)try{await this.init();const n=this.getRpcUrl(e.chainId),r=await this.appEvent({type:he.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:n}});return r.userName&&this.setSocialLoginSuccess(r.userName),this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting social"),n}else try{const n=e?.chainId||this.getLastUsedChainId()||1,r=await this.getUser({chainId:n,preferredAccountType:e?.preferredAccountType,siwxMessage:e?.siwxMessage,rpcUrl:this.getRpcUrl(n)});return this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting"),n}}async getUser(e){try{await this.init();const n=e?.chainId||this.getLastUsedChainId()||1,r=await this.appEvent({type:he.APP_GET_USER,payload:{...e,chainId:n,rpcUrl:this.getRpcUrl(n)}});return this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting"),n}}async connectSocial({uri:e,chainId:n,preferredAccountType:r}){try{await this.init();const s=this.getRpcUrl(n),i=await this.appEvent({type:he.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:n,rpcUrl:s,preferredAccountType:r}});return i.userName&&this.setSocialLoginSuccess(i.userName),i}catch(s){throw this.w3mLogger?.logger.error({error:s},"Error connecting social"),s}}async getFarcasterUri(){try{return await this.init(),await this.appEvent({type:he.APP_GET_FARCASTER_URI})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting farcaster uri"),e}}async connectFarcaster(){try{const e=await this.appEvent({type:he.APP_CONNECT_FARCASTER});return e.userName&&this.setSocialLoginSuccess(e.userName),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting farcaster"),e}}async switchNetwork({chainId:e}){try{const n=this.getRpcUrl(e),r=await this.appEvent({type:he.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:n}});return this.setLastUsedChainId(r.chainId),r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error switching network"),n}}async disconnect(){try{return this.deleteAuthLoginCache(),await new Promise(async n=>{const r=setTimeout(()=>{n()},3e3);await this.appEvent({type:he.APP_SIGN_OUT}),clearTimeout(r),n()})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error disconnecting"),e}}async request(e){const n=e;try{if(Ht.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const r=e.chainNamespace||"eip155",s=this.getActiveCaipNetwork(r)?.id;n.chainNamespace=r,n.chainId=s,n.rpcUrl=this.getRpcUrl(s),this.rpcRequestHandler?.(e);const i=await this.appEvent({type:he.APP_RPC_REQUEST,payload:n});return this.rpcSuccessHandler?.(i,n),i}catch(r){throw this.rpcErrorHandler?.(r,n),this.w3mLogger?.logger.error({error:r},"Error requesting"),r}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===he.FRAME_IS_CONNECTED_SUCCESS&&n.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===he.FRAME_IS_CONNECTED_ERROR&&e(),n.type===he.FRAME_IS_CONNECTED_SUCCESS&&!n.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===he.FRAME_GET_USER_SUCCESS&&e(n.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===he.FRAME_CONNECT_SOCIAL_SUCCESS&&e(n.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===he.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(n.payload):n.type===he.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:Ht.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){try{await Promise.all(this.openRpcRequests.map(async({abortController:e,method:n})=>{Ht.SAFE_RPC_METHODS.includes(n)||e.abort(),await this.appEvent({type:he.APP_RPC_ABORT})})),this.openRpcRequests=[]}catch(e){this.w3mLogger?.logger.error({error:e},"Error aborting RPC request")}}async appEvent(e){let n,r;function s(c){return c.replace("@w3m-app/","")}const i=[he.APP_SYNC_DAPP_DATA,he.APP_SYNC_THEME,he.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{this.onTimeout?.("iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[he.APP_CONNECT_EMAIL,he.APP_CONNECT_DEVICE,he.APP_CONNECT_OTP,he.APP_CONNECT_SOCIAL,he.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(n=setTimeout(()=>{this.onTimeout?.("iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,l)=>{const u=Math.random().toString(36).substring(7);this.w3mLogger?.logger.info?.({event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const d=new AbortController;if(o==="RPC_REQUEST"){const f=e;this.openRpcRequests=[...this.openRpcRequests,{...f.payload,abortController:d}]}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});function h(f,p){f.id===u&&(p?.logger.info?.({framEvent:f,id:u},"Received frame response"),f.type===`@w3m-frame/${o}_SUCCESS`?(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in f&&c(f.payload),c(void 0)):f.type===`@w3m-frame/${o}_ERROR`&&(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in f&&l(new Error(f.payload?.message||"An error occurred")),l(new Error("An error occurred"))))}this.w3mFrame.events.registerFrameEventHandler(u,f=>h(f,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){tn.set(he.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){tn.set(he.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&tn.set(he.EMAIL,e),tn.set(he.EMAIL_LOGIN_USED_KEY,"true"),tn.delete(he.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){tn.delete(he.EMAIL_LOGIN_USED_KEY),tn.delete(he.EMAIL),tn.delete(he.LAST_USED_CHAIN_KEY),tn.delete(he.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&tn.set(he.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=tn.get(he.LAST_USED_CHAIN_KEY)??void 0,n=Number(e);return isNaN(n)?e:n}persistSmartAccountEnabledNetworks(e){tn.set(he.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){let n=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?n=jn.parseCaipNetworkId(e)?.chainNamespace:Number.isInteger(Number(e))?n="eip155":n="solana");const r=this.getCaipNetworks(n);return(e?r.find(i=>String(i.id)===String(e)||i.caipNetworkId===e):r[0])?.rpcUrls.default.http?.[0]}}class Ho{constructor(){}static getInstance({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a}){return Ho.instance||(Ho.instance=new SK({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:!!H.state.remoteFeatures?.emailCapture})),Ho.instance}}var Tv={};const xK={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof Tv<"u"?Tv.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},A0={filterOutDuplicatesByRDNS(t){const e=H.state.enableEIP6963?Y.state.connectors:[],n=W.getRecentWallets(),r=e.map(a=>a.info?.rdns).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&le.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!(a?.rdns&&i.includes(String(a.rdns))||!a?.rdns&&e.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(t){const e=Y.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),n=W.getRecentWallets(),r=e.map(a=>a.explorerId),s=n.map(a=>a.id),i=r.concat(s);return t.filter(a=>!i.includes(a?.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=Y.state,{featuredWalletIds:n}=H.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>(a.info?.rdns&&(o[a.info.rdns]=!0),o),{});return t.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(n?.length){const l=n.indexOf(o.id),u=n.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(t,e){const n=t?.connectMethodsOrder||H.state.features?.connectMethodsOrder,r=e||Y.state.connectors;if(n)return n;const{injected:s,announced:i}=fh.getConnectorsByType(r,ye.state.recommended,ye.state.featured),o=s.filter(fh.showConnector),a=i.filter(fh.showConnector);return o.length||a.length?["wallet","email","social"]:xK.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&ye.state.excludedWallets.some(r=>r.rdns===t.rdns),n=!!t.name&&ye.state.excludedWallets.some(r=>on.isLowerCaseMatch(r.name,t.name));return e||n},markWalletsWithDisplayIndex(t){return t.map((e,n)=>({...e,display_index:n}))}},fh={getConnectorsByType(t,e,n){const{customWallets:r}=H.state,s=W.getRecentWallets(),i=A0.filterOutDuplicateWallets(e),o=A0.filterOutDuplicateWallets(n),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),l=t.filter(d=>d.type==="INJECTED"),u=t.filter(d=>d.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(t){const e=t.info?.rdns,n=!!e&&ye.state.excludedWallets.some(s=>!!s.rdns&&s.rdns===e),r=!!t.name&&ye.state.excludedWallets.some(s=>on.isLowerCaseMatch(s.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!le.isMobile()||le.isMobile()&&!e&&!ee.checkInstalled())||n||r)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(T.state.chains.values()).some(n=>Y.getConnectorId(n.namespace)===F.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=H.state.features?.connectorTypeOrder??[]}){const d=[{type:"walletConnect",isEnabled:H.state.enableWalletConnect},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(g=>g.isEnabled),h=new Set(d.map(g=>g.type)),f=c.filter(g=>h.has(g)).map(g=>({type:g,isEnabled:!0})),p=d.filter(({type:g})=>!f.some(({type:y})=>y===g));return Array.from(new Set([...f,...p].map(({type:g})=>g)))},getAuthName({email:t,socialUsername:e,socialProvider:n}){return e?n&&n==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){try{if(t.name==="Browser Wallet"&&!le.isMobile())return{accounts:[],chainId:void 0};if(t.id===F.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[e,n]=await Promise.all([t.provider?.request({method:"eth_accounts"}),t.provider?.request({method:"eth_chainId"}).then(r=>Number(r))]);return{accounts:e,chainId:n}}catch(e){return console.warn(`Failed to fetch provider data for ${t.name}`,e),{accounts:[],chainId:void 0}}}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ph=globalThis,Zy=ph.ShadowRoot&&(ph.ShadyCSS===void 0||ph.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Qy=Symbol(),Pv=new WeakMap;let qN=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==Qy)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(Zy&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=Pv.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&Pv.set(n,e))}return e}toString(){return this.cssText}};const pr=t=>new qN(typeof t=="string"?t:t+"",void 0,Qy),sc=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1],t[0]);return new qN(n,t,Qy)},TK=(t,e)=>{if(Zy)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),s=ph.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,t.appendChild(r)}},Ov=Zy?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return pr(n)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:PK,defineProperty:OK,getOwnPropertyDescriptor:RK,getOwnPropertyNames:kK,getOwnPropertySymbols:DK,getPrototypeOf:UK}=Object,Zf=globalThis,Rv=Zf.trustedTypes,BK=Rv?Rv.emptyScript:"",$K=Zf.reactiveElementPolyfillSupport,$l=(t,e)=>t,C0={toAttribute(t,e){switch(e){case Boolean:t=t?BK:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},WN=(t,e)=>!PK(t,e),kv={attribute:!0,type:String,converter:C0,reflect:!1,useDefault:!1,hasChanged:WN};Symbol.metadata??=Symbol("metadata"),Zf.litPropertyMetadata??=new WeakMap;let Ga=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=kv){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,n);s!==void 0&&OK(this.prototype,e,s)}}static getPropertyDescriptor(e,n,r){const{get:s,set:i}=RK(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s?.call(this);i?.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??kv}static _$Ei(){if(this.hasOwnProperty($l("elementProperties")))return;const e=UK(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty($l("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty($l("properties"))){const n=this.properties,r=[...kK(n),...DK(n)];for(const s of r)this.createProperty(s,n[s])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)n.unshift(Ov(s))}else e!==void 0&&n.push(Ov(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return TK(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const i=(r.converter?.toAttribute!==void 0?r.converter:C0).toAttribute(n,r.type);this._$Em=e,i==null?this.removeAttribute(s):this.setAttribute(s,i),this._$Em=null}}_$AK(e,n){const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const i=r.getPropertyOptions(s),o=typeof i.converter=="function"?{fromAttribute:i.converter}:i.converter?.fromAttribute!==void 0?i.converter:C0;this._$Em=s;const a=o.fromAttribute(n,i.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(e,n,r){if(e!==void 0){const s=this.constructor,i=this[e];if(r??=s.getPropertyOptions(e),!((r.hasChanged??WN)(i,n)||r.useDefault&&r.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(s._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??n??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),s===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,i]of this._$Ep)this[s]=i;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[s,i]of r){const{wrapped:o}=i,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,i,a)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),this._$EO?.forEach(r=>r.hostUpdate?.()),this.update(n)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(n)}willUpdate(e){}_$AE(e){this._$EO?.forEach(n=>n.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(n=>this._$ET(n,this[n])),this._$EM()}updated(e){}firstUpdated(e){}};Ga.elementStyles=[],Ga.shadowRootOptions={mode:"open"},Ga[$l("elementProperties")]=new Map,Ga[$l("finalized")]=new Map,$K?.({ReactiveElement:Ga}),(Zf.reactiveElementVersions??=[]).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Xy=globalThis,of=Xy.trustedTypes,Dv=of?of.createPolicy("lit-html",{createHTML:t=>t}):void 0,VN="$lit$",ji=`lit$${Math.random().toFixed(9).slice(2)}$`,GN="?"+ji,LK=`<${GN}>`,sa=document,Ou=()=>sa.createComment(""),Ru=t=>t===null||typeof t!="object"&&typeof t!="function",ew=Array.isArray,MK=t=>ew(t)||typeof t?.[Symbol.iterator]=="function",Rg=`[ 	
\f\r]`,hl=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Uv=/-->/g,Bv=/>/g,mo=RegExp(`>|${Rg}(?:([^\\s"'>=/]+)(${Rg}*=${Rg}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),$v=/'/g,Lv=/"/g,KN=/^(?:script|style|textarea|title)$/i,JN=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),kne=JN(1),Dne=JN(2),Cc=Symbol.for("lit-noChange"),Jt=Symbol.for("lit-nothing"),Mv=new WeakMap,Bo=sa.createTreeWalker(sa,129);function YN(t,e){if(!ew(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Dv!==void 0?Dv.createHTML(e):e}const FK=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=hl;for(let a=0;a<n;a++){const c=t[a];let l,u,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,u=o.exec(c),u!==null);)h=o.lastIndex,o===hl?u[1]==="!--"?o=Uv:u[1]!==void 0?o=Bv:u[2]!==void 0?(KN.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=mo):u[3]!==void 0&&(o=mo):o===mo?u[0]===">"?(o=s??hl,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?mo:u[3]==='"'?Lv:$v):o===Lv||o===$v?o=mo:o===Uv||o===Bv?o=hl:(o=mo,s=void 0);const f=o===mo&&t[a+1].startsWith("/>")?" ":"";i+=o===hl?c+LK:d>=0?(r.push(l),c.slice(0,d)+VN+c.slice(d)+ji+f):c+ji+(d===-2?a:f)}return[YN(t,i+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class ku{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=FK(e,n);if(this.el=ku.createElement(l,r),Bo.currentNode=this.el.content,n===2||n===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=Bo.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(VN)){const h=u[o++],f=s.getAttribute(d).split(ji),p=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:p[2],strings:f,ctor:p[1]==="."?HK:p[1]==="?"?zK:p[1]==="@"?qK:Qf}),s.removeAttribute(d)}else d.startsWith(ji)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(KN.test(s.tagName)){const d=s.textContent.split(ji),h=d.length-1;if(h>0){s.textContent=of?of.emptyScript:"";for(let f=0;f<h;f++)s.append(d[f],Ou()),Bo.nextNode(),c.push({type:2,index:++i});s.append(d[h],Ou())}}}else if(s.nodeType===8)if(s.data===GN)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(ji,d+1))!==-1;)c.push({type:7,index:i}),d+=ji.length-1}i++}}static createElement(e,n){const r=sa.createElement("template");return r.innerHTML=e,r}}function Ic(t,e,n=t,r){if(e===Cc)return e;let s=r!==void 0?n._$Co?.[r]:n._$Cl;const i=Ru(e)?void 0:e._$litDirective$;return s?.constructor!==i&&(s?._$AO?.(!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,n,r)),r!==void 0?(n._$Co??=[])[r]=s:n._$Cl=s),s!==void 0&&(e=Ic(t,s._$AS(t,e.values),s,r)),e}class jK{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,s=(e?.creationScope??sa).importNode(n,!0);Bo.currentNode=s;let i=Bo.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new ad(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new WK(i,this,e)),this._$AV.push(l),c=r[++a]}o!==c?.index&&(i=Bo.nextNode(),o++)}return Bo.currentNode=sa,s}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class ad{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,n,r,s){this.type=2,this._$AH=Jt,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&e?.nodeType===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=Ic(this,e,n),Ru(e)?e===Jt||e==null||e===""?(this._$AH!==Jt&&this._$AR(),this._$AH=Jt):e!==this._$AH&&e!==Cc&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):MK(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Jt&&Ru(this._$AH)?this._$AA.nextSibling.data=e:this.T(sa.createTextNode(e)),this._$AH=e}$(e){const{values:n,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=ku.createElement(YN(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===s)this._$AH.p(n);else{const i=new jK(s,this),o=i.u(this.options);i.p(n),this.T(o),this._$AH=i}}_$AC(e){let n=Mv.get(e.strings);return n===void 0&&Mv.set(e.strings,n=new ku(e)),n}k(e){ew(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new ad(this.O(Ou()),this.O(Ou()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);e!==this._$AB;){const r=e.nextSibling;e.remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class Qf{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,s,i){this.type=1,this._$AH=Jt,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=Jt}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=Ic(this,e,n,0),o=!Ru(e)||e!==this._$AH&&e!==Cc,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=Ic(this,a[r+c],n,c),l===Cc&&(l=this._$AH[c]),o||=!Ru(l)||l!==this._$AH[c],l===Jt?e=Jt:e!==Jt&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===Jt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class HK extends Qf{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Jt?void 0:e}}class zK extends Qf{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Jt)}}class qK extends Qf{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){if((e=Ic(this,e,n,0)??Jt)===Cc)return;const r=this._$AH,s=e===Jt&&r!==Jt||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==Jt&&(r===Jt||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class WK{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Ic(this,e)}}const VK=Xy.litHtmlPolyfillSupport;VK?.(ku,ad),(Xy.litHtmlVersions??=[]).push("3.3.1");const GK=(t,e,n)=>{const r=n?.renderBefore??e;let s=r._$litPart$;if(s===void 0){const i=n?.renderBefore??null;r._$litPart$=s=new ad(e.insertBefore(Ou(),i),i,void 0,n??{})}return s._$AI(t),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const tw=globalThis;class gh extends Ga{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=GK(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Cc}}gh._$litElement$=!0,gh.finalized=!0,tw.litElementHydrateSupport?.({LitElement:gh});const KK=tw.litElementPolyfillSupport;KK?.({LitElement:gh});(tw.litElementVersions??=[]).push("4.2.1");let Ll,Ji,Yi;function Une(t,e){Ll=document.createElement("style"),Ji=document.createElement("style"),Yi=document.createElement("style"),Ll.textContent=ic(t).core.cssText,Ji.textContent=ic(t).dark.cssText,Yi.textContent=ic(t).light.cssText,document.head.appendChild(Ll),document.head.appendChild(Ji),document.head.appendChild(Yi),ZN(e)}function ZN(t){Ji&&Yi&&(t==="light"?(Ji.removeAttribute("media"),Yi.media="enabled"):(Yi.removeAttribute("media"),Ji.media="enabled"))}function JK(t){Ll&&Ji&&Yi&&(Ll.textContent=ic(t).core.cssText,Ji.textContent=ic(t).dark.cssText,Yi.textContent=ic(t).light.cssText)}function ic(t){return{core:sc`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${pr(t?.["--w3m-color-mix-strength"]?`${t["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${pr(t?.["--w3m-font-family"]||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${pr(t?.["--w3m-font-size-master"]||"10px")};
        --w3m-border-radius-master: ${pr(t?.["--w3m-border-radius-master"]||"4px")};
        --w3m-z-index: ${pr(t?.["--w3m-z-index"]||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:sc`
      :root {
        --w3m-color-mix: ${pr(t?.["--w3m-color-mix"]||"#fff")};
        --w3m-accent: ${pr(Zs(t,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${pr(Zs(t,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:sc`
      :root {
        --w3m-color-mix: ${pr(t?.["--w3m-color-mix"]||"#000")};
        --w3m-accent: ${pr(Zs(t,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${pr(Zs(t,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const Bne=sc`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,$ne=sc`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,Lne=sc`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,mh={hexStringToNumber(t){const e=t.startsWith("0x")?t.slice(2):t;return parseInt(e,16)},numberToHexString(t){return`0x${t.toString(16)}`},async getUserInfo(t){const[e,n]=await Promise.all([mh.getAddresses(t),mh.getChainId(t)]);return{chainId:n,addresses:e}},async getChainId(t){const e=await t.request({method:"eth_chainId"});return Number(e)},async getAddress(t){const[e]=await t.request({method:"eth_accounts"});return e},async getAddresses(t){return await t.request({method:"eth_accounts"})},async addEthereumChain(t,e){const n=e.rpcUrls.chainDefault?.http||[];await t.request({method:"wallet_addEthereumChain",params:[{chainId:mh.numberToHexString(e.id),rpcUrls:[...n],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[e.blockExplorers?.default.url],iconUrls:[nr.NetworkImageIds[e.id]]}]})}},Fa={ACCOUNT_INDEXES:{PAYMENT:0,ORDINAL:1}},QN=Ak({id:421614,name:"Arbitrum Sepolia",blockTime:250,nativeCurrency:{name:"Arbitrum Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia-rollup.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://sepolia.arbiscan.io",apiUrl:"https://api-sepolia.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:81930}},testnet:!0});function cd(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}const Fv=cd({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),jv=cd({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});cd({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});cd({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});cd({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const YK={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},As={getMethodsByChainNamespace(t){return YK[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const n={...t},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[c]=o)})}return n},createNamespaces(t,e){const n=t.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=r[o];switch(u.chains.push(l),l){case Fv.caipNetworkId:u.chains.push(Fv.deprecatedCaipNetworkId);break;case jv.caipNetworkId:u.chains.push(jv.deprecatedCaipNetworkId);break}return u?.rpcMap&&c&&(u.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(n,e)},resolveReownName:async t=>{const e=await Sl.resolveName(t);return(Object.values(e?.addresses)||[])[0]?.address||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const n=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isOriginAllowed(t,e,n){for(const r of[...e,...n])if(r.includes("*")){const i=`^${r.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(t))return!0}else try{if(new URL(r).origin===t)return!0}catch{if(r===t)return!0}return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&t.on("connect",()=>{const a=As.getWalletConnectAccounts(t,e);n(a)}),r&&t.on("disconnect",()=>{r()}),s&&t.on("session_event",a=>{if(As.isSessionEventData(a)){const{name:c,data:l}=a.params.event;if(c==="accountsChanged"&&Array.isArray(l)){const u=l.filter(d=>le.isCaipAddress(d)).map(d=>jn.parseCaipAddress(d)).filter(d=>d.chainNamespace===e);s(u)}}}),i&&t.on("chainChanged",a=>{i(a)}),o&&t.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(t,e){const n=new Set,r=t?.session?.namespaces?.[e]?.accounts?.map(s=>jn.parseCaipAddress(s)).filter(({address:s})=>n.has(s.toLowerCase())?!1:(n.add(s.toLowerCase()),!0));return r&&r.length>0?r:[]}};class ZK{constructor(e){this.namespace=e.namespace}async syncConnections(e){switch(this.namespace){case F.CHAIN.EVM:await this.syncEVMConnections(e);break;case F.CHAIN.SOLANA:await this.syncSolanaConnections(e);break;case F.CHAIN.BITCOIN:await this.syncBitcoinConnections(e);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:e,caipNetworks:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===F.CONNECTOR_ID.WALLET_CONNECT){const c=As.getWalletConnectAccounts(r,this.namespace),l=n.find(u=>u.chainNamespace===this.namespace&&u.id.toString()===c[0]?.chainId?.toString());c.length>0&&i({connectorId:a.id,accounts:c.map(u=>({address:u.address})),caipNetwork:l})}else{const{accounts:c,chainId:l}=await fh.fetchProviderData(a);if(c.length>0&&l){const u=n.find(d=>d.chainNamespace===this.namespace&&d.id.toString()===l.toString());i({connectorId:a.id,accounts:c.map(d=>({address:d})),caipNetwork:u}),a.provider&&a.id!==F.CONNECTOR_ID.AUTH&&a.id!==F.CONNECTOR_ID.WALLET_CONNECT&&o(a.id,a.provider)}}}))}async syncSolanaConnections({connectors:e,caipNetwork:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===F.CONNECTOR_ID.WALLET_CONNECT){const c=As.getWalletConnectAccounts(r,this.namespace);c.length>0&&i({connectorId:a.id,accounts:c.map(l=>({address:l.address})),caipNetwork:n})}else{const c=await a.connect({chainId:n?.id});c&&(i({connectorId:a.id,accounts:[{address:c}],caipNetwork:n}),o(a.id,a.provider))}}))}async syncBitcoinConnections({connectors:e,caipNetwork:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===F.CONNECTOR_ID.WALLET_CONNECT){const h=As.getWalletConnectAccounts(r,this.namespace);h.length>0&&i({connectorId:a.id,accounts:h.map(f=>({address:f.address})),caipNetwork:n});return}const c=await a.connect();let u=(await a.getAccountAddresses())?.map(h=>le.createAccount(F.CHAIN.BITCOIN,h.address,h.purpose||"payment",h.publicKey,h.path));if(u&&u.length>1&&(u=[{namespace:F.CHAIN.BITCOIN,publicKey:u[Fa.ACCOUNT_INDEXES.PAYMENT]?.publicKey??"",path:u[Fa.ACCOUNT_INDEXES.PAYMENT]?.path??"",address:u[Fa.ACCOUNT_INDEXES.PAYMENT]?.address??"",type:"payment"},{namespace:F.CHAIN.BITCOIN,publicKey:u[Fa.ACCOUNT_INDEXES.ORDINAL]?.publicKey??"",path:u[Fa.ACCOUNT_INDEXES.ORDINAL]?.path??"",address:u[Fa.ACCOUNT_INDEXES.ORDINAL]?.address??"",type:"ordinal"}]),!(a.chains.find(h=>h.id===n?.id)||a.chains[0]))throw new Error("The connector does not support any of the requested chains");c&&(o(a.id,a.provider),i({connectorId:a.id,accounts:u.map(h=>({address:h.address,type:h.type})),caipNetwork:n}))}))}getConnection({address:e,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(l=>on.isLowerCaseMatch(l.connectorId,n));if(!o)return null;const a=s.find(l=>on.isLowerCaseMatch(l.id,o.connectorId)),c=e?o.accounts.find(l=>on.isLowerCaseMatch(l.address,e)):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>on.isLowerCaseMatch(a.id,o.connectorId)));if(i){const[o]=i.accounts,a=s.find(c=>on.isLowerCaseMatch(c.id,i.connectorId));return{...i,account:o,connector:a}}return null}}const Al={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};class nw{constructor({provider:e,namespace:n}){this.id=F.CONNECTOR_ID.WALLET_CONNECT,this.name=nr.ConnectorNamesMap[F.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=nr.ConnectorImageIds[F.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=T.getCaipNetworks.bind(T),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=H.state.universalProviderConfigOverride,s=As.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(n=>n.caipNetworkId);return br.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:QK})}}const QK=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],XK=[F.CONNECTOR_ID.AUTH,F.CONNECTOR_ID.WALLET_CONNECT];class XN{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>T.getCaipNetworks(n),this.getConnectorId=n=>Y.getConnectorId(n),e&&this.construct(e),e?.namespace&&(this.connectionManager=new ZK({namespace:e.namespace}))}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===n?.toString());e&&r&&this.addConnection({connectorId:F.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:F.CONNECTOR_ID.AUTH,type:"AUTH",name:F.CONNECTOR_NAMES.AUTH,provider:e,imageId:nr.ConnectorImageIds[F.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const n=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const n=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(n=>!on.isLowerCaseMatch(n.connectorId,e)),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,n){fe.setStatus(e,n)}on(e,n){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(n)}off(e,n){const r=this.eventListeners.get(e);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,n){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(n))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){const{caipNetwork:n,providerType:r}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(s&&r==="AUTH"){const i=s,o=or(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const a=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(n=>n instanceof nw);if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,n){if(e.length>0){const{address:r,chainId:s}=le.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===s?.toString()),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:e.map(a=>{const{address:c}=le.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(e,n,r=!0){if(e.length>0){const{address:s}=le.getAccount(e[0]),i=this.connectionManager?.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});s&&on.isLowerCaseMatch(this.getConnectorId(F.CHAIN.EVM),n)&&this.emit("accountChanged",{address:s,chainId:i?.caipNetwork?.id,connector:i?.connector}),this.addConnection({connectorId:n,accounts:e.map(o=>{const{address:a}=le.getAccount(o);return{address:a}}),caipNetwork:i?.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),on.isLowerCaseMatch(this.getConnectorId(F.CHAIN.EVM),e)&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,n){const r=typeof e=="string"&&e.startsWith("0x")?mh.hexStringToNumber(e).toString():e.toString(),s=this.connectionManager?.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(o=>o.chainNamespace===this.namespace).find(o=>o.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),on.isLowerCaseMatch(this.getConnectorId(F.CHAIN.EVM),n)&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,n){if(XK.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[e]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){const e=this.connectionManager?.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[n]=e.accounts;this.emit("accountChanged",{address:n?.address,chainId:e.caipNetwork?.id,connector:e.connector})}}}class eJ extends XN{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new nw({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){const r=this.provider?.session?.namespaces?.[e]?.accounts?.map(s=>{const[,,i]=s.split(":");return i}).filter((s,i,o)=>o.indexOf(s)===i)||[];return Promise.resolve({accounts:r.map(s=>le.createAccount(e,s,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&Ye.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};if(fe.state.balanceLoading&&e.chainId===T.state.activeCaipNetwork?.id)return{balance:fe.state.balance||"0.00",symbol:fe.state.balanceSymbol||""};const s=(await fe.fetchTokenBalance()).find(i=>i.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&i.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:s?.quantity.numeric||"0.00",symbol:s?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){const{provider:n,message:r,address:s}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return T.state.activeCaipNetwork?.chainNamespace===F.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:jc.encode(new TextEncoder().encode(r)),pubkey:s}},T.state.activeCaipNetwork?.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},T.state.activeCaipNetwork?.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){const{caipNetwork:n}=e,r=this.getWalletConnectConnector();if(n.chainNamespace===F.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:pc(n.id)}]})}catch(s){if(s.code===Al.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||s.code===Al.ERROR_INVALID_CHAIN_ID||s.code===Al.ERROR_CODE_DEFAULT||s?.data?.originalError?.code===Al.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:pc(n.id),rpcUrls:[n?.rpcUrls.chainDefault?.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[n.blockExplorers?.default.url]}]})}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){return this.connectors.find(r=>r.type==="WALLET_CONNECT")?.provider}}const tJ=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture"],Wd={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(n=>n!=="email"):!1},processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?Ye.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?Ye.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?Ye.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>t.isEnabled&&(t.config??[]),processFallback:t=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Ye.DEFAULT_REMOTE_FEATURES.multiWallet}},nJ={localSettingsOverridden:new Set,getApiConfig(t,e){return e?.find(n=>n.id===t)},addWarning(t,e){if(t!==void 0){const n=Wd[e],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(t,e,n,r,s){const i=Wd[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return a?.config===null?this.processFallbackFeature(t,o):a?.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return Wd[t].processApi(e)},processFallbackFeature(t,e){return Wd[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,n=t.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await ye.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?Ye.DEFAULT_REMOTE_FEATURES:Ye.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of tJ){const a=this.processFeature(o,n,r,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Ye.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;pt.open({debugMessage:Et.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class rJ{constructor(e){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{if(n){const s=T.getCaipNetworks(n)?.find(a=>a.id===r);if(s)return s;const i=T.getNetworkData(n)?.caipNetwork;return i||T.getRequestedCaipNetworks(n).filter(a=>a.chainNamespace===n)?.[0]}return T.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>T.getCaipNetworks(n),this.getActiveChainNamespace=()=>T.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{T.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>T.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>T.state.activeChain===n||!n?T.state.activeCaipAddress:T.state.chains.get(n)?.accountState?.caipAddress,this.setClientId=n=>{Ee.setClientId(n)},this.getProvider=n=>st.getProvider(n),this.getProviderType=n=>st.getProviderId(n),this.getPreferredAccountType=n=>or(n),this.setCaipAddress=(n,r)=>{fe.setCaipAddress(n,r)},this.setBalance=(n,r,s)=>{fe.setBalance(n,r,s)},this.setProfileName=(n,r)=>{fe.setProfileName(n,r)},this.setProfileImage=(n,r)=>{fe.setProfileImage(n,r)},this.setUser=(n,r)=>{fe.setUser(n,r)},this.resetAccount=n=>{fe.resetAccount(n)},this.setCaipNetwork=n=>{T.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{T.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{fe.setStatus(n,r),Y.isConnected()?W.setConnectionStatus("connected"):W.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>T.state.chains.get(n)?.accountState?.address,this.setConnectors=n=>{const r=[...Y.state.allConnectors,...n];Y.setConnectors(r)},this.setConnections=(n,r)=>{W.setConnections(n,r),ee.setConnections(n,r)},this.fetchIdentity=n=>Ee.fetchIdentity(n),this.getReownName=n=>Sl.getNamesForAddress(n),this.getConnectors=()=>Y.getConnectors(),this.getConnectorImage=n=>mC.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?Ch.getConnectionsData(n).connections:(pt.open(F.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?Ch.getConnectionsData(n).recentConnections:(pt.open(F.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){pt.open(F.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await ee.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){pt.open(F.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}W.deleteAddressFromConnection(n),ee.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=st.getProviderId(r),i=n?{...n,type:s}:void 0;fe.setConnectedWalletInfo(i,r)},this.getIsConnectedState=()=>!!T.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{fe.addAddressLabel(n,r,s)},this.removeAddressLabel=(n,r)=>{fe.removeAddressLabel(n,r)},this.getAddress=n=>T.state.activeChain===n||!n?fe.state.address:T.state.chains.get(n)?.accountState?.address,this.setApprovedCaipNetworksData=n=>T.setApprovedCaipNetworksData(n),this.resetNetwork=n=>{T.resetNetwork(n)},this.addConnector=n=>{Y.addConnector(n)},this.resetWcConnection=()=>{ee.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{fe.setAddressExplorerUrl(n,r)},this.setSmartAccountDeployed=(n,r)=>{fe.setSmartAccountDeployed(n,r)},this.setPreferredAccountType=(n,r)=>{T.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{H.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,n){const r=e?.map(i=>i.namespace).filter(i=>!!i);if(r?.length)return[...new Set(r)];const s=n?.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),H.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await nJ.fetchRemoteFeatures(e),H.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&_m.setOnrampProviders(this.remoteFeatures.onramp),(H.state.remoteFeatures?.email||Array.isArray(H.state.remoteFeatures?.socials)&&H.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){try{const e=await ye.fetchAllowedOrigins();if(!e||!le.isClient()){pt.open(Et.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}const n=window.location.origin;As.isOriginAllowed(n,e,Al.DEFAULT_ALLOWED_ANCESTORS)||pt.open(Et.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error)){pt.open(Et.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}switch(e.message){case"RATE_LIMITED":pt.open(Et.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=e.cause instanceof Error?e.cause:e;pt.open({displayMessage:Et.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:Et.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(n.message)},"error");break}default:pt.open(Et.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}}}sendInitializeEvent(e){const{...n}=e;delete n.adapters,delete n.universalProvider,et.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:e.networks.map(r=>r.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&$n.setThemeMode(e.themeMode),e.themeVariables&&$n.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");T.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const n=this.getDefaultNetwork();n&&T.setActiveCaipNetwork(n)}initializeConnectionController(e){ee.initialize(e.adapters??[]),ee.setWcBasic(e.basic??!1)}initializeConnectorController(){Y.initialize(this.chainNamespaces)}initializeProjectSettings(e){H.setProjectId(e.projectId),H.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){H.setDebug(e.debug!==!1),H.setEnableWalletConnect(e.enableWalletConnect!==!1),H.setEnableWalletGuide(e.enableWalletGuide!==!1),H.setEnableWallets(e.enableWallets!==!1),H.setEIP6963Enabled(e.enableEIP6963!==!1),H.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),H.setEnableReconnect(e.enableReconnect!==!1),H.setEnableAuthLogger(e.enableAuthLogger!==!1),H.setCustomRpcUrls(e.customRpcUrls),H.setEnableEmbedded(e.enableEmbedded),H.setAllWallets(e.allWallets),H.setIncludeWalletIds(e.includeWalletIds),H.setExcludeWalletIds(e.excludeWalletIds),H.setFeaturedWalletIds(e.featuredWalletIds),H.setTokens(e.tokens),H.setTermsConditionsUrl(e.termsConditionsUrl),H.setPrivacyPolicyUrl(e.privacyPolicyUrl),H.setCustomWallets(e.customWallets),H.setFeatures(e.features),H.setAllowUnsupportedChain(e.allowUnsupportedChain),H.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),H.setPreferUniversalLinks(e.experimental_preferUniversalLinks),H.setDefaultAccountTypes(e.defaultAccountTypes);const n=this.getDefaultMetaData();if(!e.metadata&&n&&(e.metadata=n),H.setMetadata(e.metadata),H.setDisableAppend(e.disableAppend),H.setEnableEmbedded(e.enableEmbedded),H.setSIWX(e.siwx),!e.projectId){pt.open(Et.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(e.adapters?.find(s=>s.namespace===F.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");H.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return le.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){const n=this.getActiveChainNamespace();if(n){const r=ps.getUnsupportedNetwork(`${n}:${e}`);T.setActiveCaipNetwork(r)}}getDefaultNetwork(){return ps.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,n){return ps.extendCaipNetwork(e,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(e){return ps.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const n=e.networks.find(s=>s.id===e.defaultNetwork?.id);return n?ps.extendCaipNetwork(n,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectNamespace(e,n){try{this.setLoading(!0,e);let r={connections:[]};const s=this.getAdapter(e);return(T.state.chains.get(e)?.accountState?.caipAddress||!H.state.enableReconnect)&&s?.disconnect&&(r=await s.disconnect({id:n})),this.setLoading(!1,e),r}catch(r){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const e=T.state.activeChain,n=this.getAdapter(e),r=this.getCaipNetwork(e)?.id,s=ee.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId(a?.clientId||null),W.setConnectedNamespaces([...T.state.chains.keys()]),await this.syncWalletConnectAccount(),await br.initializeIfEnabled()},connectExternal:async({id:e,address:n,info:r,type:s,provider:i,chain:o,caipNetwork:a,socialUri:c})=>{const l=T.state.activeChain,u=o||l,d=this.getAdapter(u);if(o&&o!==l&&!a){const p=this.getCaipNetworks().find(g=>g.chainNamespace===o);p&&this.setCaipNetwork(p)}if(!u)throw new Error("connectExternal: namespace not found");if(!d)throw new Error("connectExternal: adapter not found");const h=this.getCaipNetwork(u),f=await d.connect({id:e,address:n,info:r,type:s,provider:i,socialUri:c,chainId:a?.id||h?.id,rpcUrl:a?.rpcUrls?.default?.http?.[0]||h?.rpcUrls?.default?.http?.[0]});if(f)return W.addConnectedNamespace(u),this.syncProvider({...f,chainNamespace:u}),this.setStatus("connected",u),this.syncConnectedWalletInfo(u),W.removeDisconnectedConnectorId(e,u),{address:f.address}},reconnectExternal:async({id:e,info:n,type:r,provider:s})=>{const i=T.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:e,info:n,type:r,provider:s,chainId:this.getCaipNetwork()?.id}),W.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async e=>{const{id:n,chainNamespace:r,initialDisconnect:s}=e||{},i=r||T.state.activeChain,o=Y.getConnectorId(i),a=n===F.CONNECTOR_ID.AUTH||o===F.CONNECTOR_ID.AUTH,c=n===F.CONNECTOR_ID.WALLET_CONNECT||o===F.CONNECTOR_ID.WALLET_CONNECT;try{const l=Array.from(T.state.chains.keys());let u=r?[r]:l;(c||a)&&(u=l);const d=u.map(async p=>{const g=Y.getConnectorId(p),m=await this.disconnectNamespace(p,n||g);m&&(a&&W.deleteConnectedSocialProvider(),m.connections.forEach(y=>{W.addDisconnectedConnectorId(y.connectorId,p)})),s&&this.onDisconnectNamespace({chainNamespace:p,closeModal:!1})}),h=await Promise.allSettled(d);Je.resetSend(),ee.resetWcConnection(),br.getSIWX()?.signOutOnDisconnect&&await br.clearSessions(),Y.setFilterByNamespace(void 0),ee.syncStorageConnections();const f=h.filter(p=>p.status==="rejected");if(f.length>0)throw new Error(f.map(p=>p.reason.message).join(", "));et.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(l){throw new Error(`Failed to disconnect chains: ${l.message}`)}},checkInstalled:e=>e?e.some(n=>!!window.ethereum?.[String(n)]):!!window.ethereum,signMessage:async e=>{const n=T.state.activeChain,r=this.getAdapter(T.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");return(await r?.signMessage({message:e,address:fe.state.address,provider:st.getProvider(n)}))?.signature||""},sendTransaction:async e=>{const n=e.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(Ye.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=st.getProvider(n);return(await r?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}))?.hash||""}return""},estimateGas:async e=>{const n=e.chainNamespace;if(n===F.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=st.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");return(await r?.estimateGas({...e,provider:s,caipNetwork:i}))?.gas||0n}return 0n},getEnsAvatar:async()=>{const e=T.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");return await this.syncIdentity({address:fe.state.address,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:e}),fe.state.profileImage||!1},getEnsAddress:async e=>await As.resolveReownName(e),writeContract:async e=>{const n=T.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=st.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await r?.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}))?.hash},parseUnits:(e,n)=>{const r=this.getAdapter(T.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return r?.parseUnits({value:e,decimals:n})??0n},formatUnits:(e,n)=>{const r=this.getAdapter(T.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return r?.formatUnits({value:e,decimals:n})??"0"},getCapabilities:async e=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await n?.getCapabilities(e)},grantPermissions:async e=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await n?.grantPermissions(e)},revokePermissions:async e=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n?.revokePermissions?await n.revokePermissions(e):"0x"},walletGetAssets:async e=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await n?.walletGetAssets(e)??{}},updateBalance:e=>{const n=this.getCaipNetwork(e);!n||!fe.state.address||this.updateNativeBalance(fe.state.address,n?.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},ee.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){if(st.getProviderId(T.state.activeChain)===gt.CONNECTOR_TYPE_WALLET_CONNECT){const n=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(n)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const n=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=st.getProvider(n),i=st.getProviderId(n);if(e.chainNamespace===T.state.activeChain)await this.getAdapter(n)?.switchNetwork({caipNetwork:e,provider:s,providerType:i});else if(this.setCaipNetwork(e),i===gt.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(n);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:n})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=jn.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{const s=e?.find(i=>i.namespace===r);return s?(s.construct({namespace:r,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),n[r]=s):n[r]=new eJ({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e),await this.chainAdapters?.[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){this.getAdapter(e)?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const n=this.getAdapter(e);if(!n)return;const r=W.getConnectionStatus();H.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(W.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),n.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id.toString()===i.toString()||l.caipNetworkId.toString()===i.toString()),a=T.state.activeChain===e,c=T.state.chains.get(e)?.accountState?.address;if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(ee.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!s||i.length===0})}),n.on("connections",s=>{this.setConnections(s,e)}),n.on("pendingTransactions",()=>{const s=fe.state.address,i=T.state.activeCaipNetwork;!s||!i?.id||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{const a=T.state.activeChain===e;o?.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e)),a&&i?this.syncAccount({address:s,chainId:i,chainNamespace:e}):a&&T.state.activeCaipNetwork?.id?this.syncAccount({address:s,chainId:T.state.activeCaipNetwork?.id,chainNamespace:e}):this.syncAccountInfo(s,i,e),W.addConnectedNamespace(e)})}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>ee.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async syncNamespaceConnection(e){try{e===F.CHAIN.EVM&&le.isSafeApp()&&Y.setConnectorId(F.CONNECTOR_ID.SAFE,e);const n=Y.getConnectorId(e);switch(this.setStatus("connecting",e),n){case F.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case F.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:n,closeModal:r}=e||{};T.resetAccount(n),T.resetNetwork(n),W.removeConnectedNamespace(n);const s=Array.from(T.state.chains.keys());(n?[n]:s).forEach(o=>W.addDisconnectedConnectorId(Y.getConnectorId(o)||"",o)),Y.removeConnectorId(n),st.resetChain(n),this.setUser(void 0,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(void 0,n),r!==!1&&Fe.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const n=this.getCaipAddress(e),r=this.getCaipNetwork(e);return this.chainAdapters?.[e].syncConnections({connectToFirstConnector:!n,caipNetwork:r,getConnectorStorageInfo(s){const o=W.getConnections()[e]??[];return{hasDisconnected:W.isConnectorDisconnected(s,e),hasConnected:o.some(a=>on.isLowerCaseMatch(a.connectorId,s))}}})}))}async syncAdapterConnection(e){const n=this.getAdapter(e),r=Y.getConnectorId(e),s=this.getCaipNetwork(e),o=Y.getConnectors(e).find(a=>a.id===r);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!s?.id)throw new Error("CaipNetwork not found");const a=await n?.syncConnection({namespace:e,id:o.id,chainId:s.id,rpcUrl:s?.rpcUrls?.default?.http?.[0]});a?(this.syncProvider({...a,chainNamespace:e}),await this.syncAccount({...a,chainNamespace:e}),this.setStatus("connected",e)):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){const e=Object.keys(this.universalProvider?.session?.namespaces||{}),n=this.chainNamespaces.map(async r=>{const s=this.getAdapter(r);if(!s)return;const i=this.universalProvider?.session?.namespaces?.[r]?.accounts||[],o=T.state.activeCaipNetwork?.id,a=i.find(c=>{const{chainId:l}=jn.parseCaipAddress(c);return l===o?.toString()})||i[0];if(a){const c=jn.validateCaipAddress(a),{chainId:l,address:u}=jn.parseCaipAddress(c);if(st.setProviderId(r,gt.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&T.state.activeCaipNetwork&&s.namespace!==F.CHAIN.EVM){const d=s.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:T.state.activeCaipNetwork});st.setProvider(r,d)}else st.setProvider(r,this.universalProvider);Y.setConnectorId(F.CONNECTOR_ID.WALLET_CONNECT,r),W.addConnectedNamespace(r),await this.syncAccount({address:u,chainId:l,chainNamespace:r})}else e.includes(r)&&this.setStatus("disconnected",r);this.syncConnectedWalletInfo(r),await T.setApprovedCaipNetworksData(r)});await Promise.all(n)}syncProvider({type:e,provider:n,id:r,chainNamespace:s}){st.setProviderId(s,e),st.setProvider(s,n),Y.setConnectorId(r,s)}async syncAccount(e){const n=e.chainNamespace===T.state.activeChain,r=T.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=W.getActiveNetworkProps(),c=i||a,l=T.state.activeCaipNetwork?.name===F.UNSUPPORTED_NETWORK_NAME,u=T.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let d=this.getCaipNetworks().find(p=>p.id.toString()===c.toString()),h=this.getCaipNetworks().find(p=>p.chainNamespace===o);if(!u&&!d&&!h){const p=this.getApprovedCaipNetworkIds()||[],g=p.find(y=>jn.parseCaipNetworkId(y)?.chainId===c.toString()),m=p.find(y=>jn.parseCaipNetworkId(y)?.chainNamespace===o);d=this.getCaipNetworks().find(y=>y.caipNetworkId===g),h=this.getCaipNetworks().find(y=>y.caipNetworkId===m||"deprecatedCaipNetworkId"in y&&y.deprecatedCaipNetworkId===m)}const f=d||h;f?.chainNamespace===T.state.activeChain?H.state.enableNetworkSwitch&&!H.state.allowUnsupportedChain&&T.state.activeCaipNetwork?.name===F.UNSUPPORTED_NETWORK_NAME?T.showUnsupportedChainUI():this.setCaipNetwork(f):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o),on.isLowerCaseMatch(s,fe.state.address)||this.syncAccountInfo(s,f?.id,o),n?await this.syncBalance({address:s,chainId:f?.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r?.id,chainNamespace:o}),this.syncIdentity({address:s,chainId:i,chainNamespace:o})}}async syncAccountInfo(e,n,r){const s=this.getCaipAddress(r),i=n||s?.split(":")[1];if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,n){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(e){const n=Y.getConnectorId(e),r=st.getProviderId(e);if(r===gt.CONNECTOR_TYPE_ANNOUNCED||r===gt.CONNECTOR_TYPE_INJECTED){if(n){const i=this.getConnectors().find(o=>{const a=o.id===n,c=o.info?.rdns===n,l=o.connectors?.some(u=>u.id===n||u.info?.rdns===n);return a||c||!!l});if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(r===gt.CONNECTOR_TYPE_WALLET_CONNECT){const s=st.getProvider(e);s?.session&&this.setConnectedWalletInfo({...s.session.peer.metadata,name:s.session.peer.metadata.name,icon:s.session.peer.metadata.icons?.[0]},e)}else if(n&&(n===F.CONNECTOR_ID.COINBASE_SDK||n===F.CONNECTOR_ID.COINBASE)){const s=this.getConnectors().find(c=>c.id===n),i=s?.name||"Coinbase Wallet",o=s?.imageUrl||this.getConnectorImage(s),a=s?.info;this.setConnectedWalletInfo({...a,name:i,icon:o},e)}}async syncBalance(e){!ql.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>r.id.toString()===e.chainId?.toString())||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,n,r){const s=this.getAdapter(r),i=T.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:e,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){const e=iV.createLogger((r,...s)=>{r&&this.handleAlertError(r),console.error(...s)}),n={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};H.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await Yy.init(n),H.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{As.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:n=>{ee.setUri(n)},onConnect:n=>{const{address:r}=le.getAccount(n[0]);ee.finalizeWcConnection(r)},onDisconnect:()=>{T.state.noAdapters&&this.resetAccount(e),ee.resetWcConnection()},onChainChanged:n=>{const r=T.state.activeChain,s=r&&Y.state.activeConnectorIds[r]===F.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(T.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}o?.id.toString()!==i?.id.toString()&&o?.chainNamespace===i?.chainNamespace&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=T.state.activeChain,s=r&&Y.state.activeConnectorIds[r]===F.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(T.state.noAdapters||s)&&n.length>0){const i=n[0];this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&le.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){et.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const n=Object.entries(Et.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=Et.ALERT_ERRORS[o];a&&(pt.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;const n=e.namespace;if(!n)return;this.createClients();const r=e;r.namespace=n,r.construct({namespace:n,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(e){if(await this.injectModalUi(),e?.uri&&ee.setUri(e.uri),e?.arguments)switch(e?.view){case"Swap":return Fe.open({...e,data:{swap:e.arguments}})}return Fe.open(e)}async close(){await this.injectModalUi(),Fe.close()}setLoading(e,n){Fe.setLoading(e,n)}async disconnect(e){await ee.disconnect({namespace:e})}getSIWX(){return H.state.siwx}getError(){return""}getChainId(){return T.state.activeCaipNetwork?.id}async switchNetwork(e){const n=this.getCaipNetworks().find(r=>r.id===e.id);if(!n){pt.open(Et.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await T.switchActiveNetwork(n)}getWalletProvider(){return T.state.activeChain?st.state.providers[T.state.activeChain]:null}getWalletProviderType(){return st.getProviderId(T.state.activeChain)}subscribeProviders(e){return st.subscribeProviders(e)}getThemeMode(){return $n.state.themeMode}getThemeVariables(){return $n.state.themeVariables}setThemeMode(e){$n.setThemeMode(e),ZN($n.state.themeMode)}setTermsConditionsUrl(e){H.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){H.setPrivacyPolicyUrl(e)}setThemeVariables(e){$n.setThemeVariables(e),JK($n.state.themeVariables)}subscribeTheme(e){return $n.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?ee.subscribe(e):(pt.open(F.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?T.state.chains.get(e)?.accountState?.connectedWalletInfo:fe.state.connectedWalletInfo}getAccount(e){const n=e||T.state.activeChain,r=Y.getAuthConnector(n),s=T.getAccountData(n),i=W.getConnectedConnectorId(T.state.activeChain),o=ee.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u,publicKey:d})=>le.createAccount(n,l,u||"eoa",d)));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:le.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===F.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:W.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:or(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,n){const r=()=>{const s=this.getAccount(n);s&&e(s)};n?T.subscribeChainProp("accountState",r,n):T.subscribe(r),Y.subscribe(r)}subscribeNetwork(e){return T.subscribe(({activeCaipNetwork:n})=>{e({caipNetwork:n,chainId:n?.id,caipNetworkId:n?.caipNetworkId})})}subscribeWalletInfo(e,n){return n?fe.subscribeKey("connectedWalletInfo",e,n):fe.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){fe.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){T.subscribeKey("activeCaipNetwork",e)}getState(){return Vr.state}getRemoteFeatures(){return H.state.remoteFeatures}subscribeState(e){return Vr.subscribe(e)}subscribeRemoteFeatures(e){return H.subscribeKey("remoteFeatures",e)}showErrorMessage(e){ws.showError(e)}showSuccessMessage(e){ws.showSuccess(e)}getEvent(){return{...et.state}}subscribeEvents(e){return et.subscribe(e)}replace(e){Ce.replace(e)}redirect(e){Ce.push(e)}popTransactionStack(e){Ce.popTransactionStack(e)}isOpen(){return Fe.state.open}isTransactionStackEmpty(){return Ce.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){H.setFeatures(e)}updateRemoteFeatures(e){H.setRemoteFeatures(e)}updateOptions(e){const r={...H.state||{},...e};H.setOptions(r)}setConnectMethodsOrder(e){H.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){H.setWalletFeaturesOrder(e)}setCollapseWallets(e){H.setCollapseWallets(e)}setSocialsOrder(e){H.setSocialsOrder(e)}getConnectMethodsOrder(){return A0.getConnectOrderMethod(H.state.features,Y.getConnectors())}addNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||T.addNetwork(r)}removeNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&T.removeNetwork(e,n)}}let Hv=!1;class sJ extends rJ{async onAuthProviderConnected(e){e.message&&e.signature&&e.siwxMessage&&await br.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature);const n=T.state.activeChain;if(!n)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=n===F.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=H.state.defaultAccountTypes[n],i=or(n),o=e.preferredAccountType||i||s;this.setCaipAddress(r,n);const{signature:a,siwxMessage:c,message:l,...u}=e;this.setUser({...fe.state.user||{},...u},n),this.setSmartAccountDeployed(!!e.smartAccountDeployed,n),this.setPreferredAccountType(o,n),this.setLoading(!1,n)}setupAuthConnectorListeners(e){e.onRpcRequest(n=>{rr.checkIfRequestExists(n)?rr.checkIfRequestIsSafe(n)||this.handleUnsafeRPCRequest():(this.open(),console.error(Ht.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:n.method}),setTimeout(()=>{this.showErrorMessage(Ht.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((n,r)=>{const s=rr.checkIfRequestIsSafe(r),i=fe.state.address,o=T.state.activeCaipNetwork;s||(i&&o?.id&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const n=T.state.activeChain;if(!n)throw new Error("AppKit:onNotConnected - namespace is required");Y.getConnectorId(n)===F.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,n),this.setLoading(!1,n))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:n,type:r})=>{const s=T.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");n&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const n=$n.getSnapshot(),r=H.getSnapshot();await Promise.all([e.syncDappData({metadata:r.metadata,sdkVersion:r.sdkVersion,projectId:r.projectId,sdkType:r.sdkType}),e.syncTheme({themeMode:n.themeMode,themeVariables:n.themeVariables,w3mThemeVariables:Zs(n.themeVariables,n.themeMode)})])}async syncAuthConnector(e,n){const r=F.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n),s=n===T.state.activeChain;if(!r)return;this.setLoading(!0,n);const i=e.getLoginEmailUsed();this.setLoading(i,n),i&&this.setStatus("connecting",n);const o=e.getEmail(),a=e.getUsername();this.setUser({...fe.state?.user||{},username:a,email:o},n),this.setupAuthConnectorListeners(e);const{isConnected:c}=await e.isConnected();if(await this.syncAuthConnectorTheme(e),n&&r&&s){const l=await e.getSmartAccountEnabledNetworks();T.setSmartAccountEnabledNetworks(l?.smartAccountEnabledNetworks||[],n),c&&this.connectionControllerClient?.connectExternal?(await this.connectionControllerClient?.connectExternal({id:F.CONNECTOR_ID.AUTH,info:{name:F.CONNECTOR_ID.AUTH},type:gt.CONNECTOR_TYPE_AUTH,provider:e,chainId:T.state.activeCaipNetwork?.id,chain:n}),this.setStatus("connected",n)):Y.getConnectorId(n)===F.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",n),W.removeConnectedNamespace(n))}this.setLoading(!1,n)}async checkExistingTelegramSocialConnection(e){try{if(!le.isTelegram())return;const n=W.getTelegramSocialProvider();if(!n||!le.isClient())return;const s=new URL(window.location.href).searchParams.get("result_uri");if(!s)return;fe.setSocialProvider(n,e),await this.authProvider?.init();const i=Y.getAuthConnector();n&&i&&(this.setLoading(!0,e),await ee.connectExternal({id:i.id,type:i.type,socialUri:s},i.chain),W.setConnectedSocialProvider(n),W.removeTelegramSocialProvider(),et.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:n,caipNetworkId:T.getActiveCaipNetwork()?.caipNetworkId}}))}catch(n){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",n)}try{const n=new URL(window.location.href);n.searchParams.delete("result_uri"),window.history.replaceState({},document.title,n.toString())}catch(n){console.error("tma social login failed",n)}}createAuthProvider(e){if(!F.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=this.remoteFeatures?.email,s=Array.isArray(this.remoteFeatures?.socials)&&this.remoteFeatures.socials.length>0,i=r||s,a=on.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&this.options?.projectId&&i&&(this.authProvider=Ho.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:this.getCaipNetwork(a)?.caipNetworkId,abortController:Et.EmbeddedWalletAbortController,onTimeout:l=>{l==="iframe_load_failed"?pt.open(Et.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):l==="iframe_request_timeout"?pt.open(Et.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):l==="unverified_domain"&&pt.open(Et.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:l=>Hi(l),getCaipNetworks:l=>T.getCaipNetworks(l)}),Vr.subscribeOpen(l=>{!l&&this.isTransactionStackEmpty()&&this.authProvider?.rejectRpcRequests()}));const c=e===T.state.activeChain&&H.state.enableReconnect;H.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){this.createAuthProvider(e),this.authProvider&&this.chainAdapters?.[e]?.setAuthProvider?.(this.authProvider)}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&ye.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){if(!e)return;const n=T.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===n&&s){const o=this.getAdapter(r),a=st.getProvider(r),c=st.getProviderId(r);await o?.switchNetwork({caipNetwork:e,provider:a,providerType:c}),this.setCaipNetwork(e)}else{const a=st.getProviderId(n)===gt.CONNECTOR_TYPE_AUTH,c=st.getProviderId(r),l=c===gt.CONNECTOR_TYPE_AUTH,u=F.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((a&&c===void 0||l)&&u)try{T.state.activeChain=e.chainNamespace,s?await this.getAdapter(r)?.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:c}):await this.connectionControllerClient?.connectExternal?.({id:F.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:gt.CONNECTOR_TYPE_AUTH,caipNetwork:e}),this.setCaipNetwork(e)}catch{await this.getAdapter(r)?.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:c})}else if(c===gt.CONNECTOR_TYPE_WALLET_CONNECT){if(!T.state.noAdapters){const d=this.getAdapter(r),h=st.getProvider(r),f=st.getProviderId(r);await d?.switchNetwork({caipNetwork:e,provider:h,providerType:f})}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r})}}async initialize(e){await super.initialize(e),this.chainNamespaces?.forEach(n=>{this.createAuthProviderForAdapter(n)}),await this.injectModalUi(),Vr.set({initialized:!0})}async syncIdentity({address:e,chainId:n,chainNamespace:r}){const s=`${r}:${n}`,i=this.caipNetworks?.find(a=>a.caipNetworkId===s);if(r!==F.CHAIN.EVM||i?.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}const o=Y.getConnectorId(r)===F.CONNECTOR_ID.AUTH;try{const{name:a,avatar:c}=await this.fetchIdentity({address:e,caipNetworkId:s});!a&&o?await this.syncReownName(e,r):(this.setProfileName(a,r),this.setProfileImage(c,r))}catch{n!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const n=st.getProviderId(e);if(n===gt.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=W.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:n,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(le.isClient()&&!Hv)try{const e={...Ye.DEFAULT_FEATURES,...this.options.features},n=this.remoteFeatures;if(await this.loadModalComponents(e,n),le.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!H.state.disableAppend&&!H.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}Hv=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,n){if(!le.isClient())return;const r=[];(n.email||n.socials&&n.socials.length>0)&&r.push(nn(()=>import("./embedded-wallet-BpBqZBvO.js"),__vite__mapDeps([2,3,4,5,6,7,8,9,10,11,12,13]))),n.email&&r.push(nn(()=>import("./email-H-P4SjTi.js"),__vite__mapDeps([14,3,13,7,12,6,11,15,8]))),n.socials&&r.push(nn(()=>import("./socials-DHX7MTLB.js"),__vite__mapDeps([16,3,17,6,18,19,12,20,11,7,13,21,5,22]))),n.swaps&&n.swaps.length>0&&r.push(nn(()=>import("./swaps-DJUfOb1D.js"),__vite__mapDeps([23,3,11,7,24,25,26,22,27,5,12,8,6]))),e.send&&r.push(nn(()=>import("./send-Cp77UUf_.js"),__vite__mapDeps([28,3,11,7,12,6,18,13,27,5,22,26,8,29,30]))),e.receive&&r.push(nn(()=>import("./receive-LNPDuEgS.js"),__vite__mapDeps([31,3,32,5,21]))),n.onramp&&n.onramp.length>0&&r.push(nn(()=>import("./onramp-COsBJmGz.js"),__vite__mapDeps([33,3,34,5,7,12,17,6,18,35,13,11,20,8]))),n.activity&&r.push(nn(()=>import("./transactions-BKEr4tHk.js"),__vite__mapDeps([36,3,37,12,13,5,22]))),e.pay&&r.push(nn(()=>import("./index--gSvzbrs.js"),__vite__mapDeps([38,3,11,7,39,5,12,9,34,30,20]))),n.emailCapture&&r.push(nn(()=>import("./ui-B-tSXs1C.js"),__vite__mapDeps([40,3,14,13,7,12,6,11,15,8]))),await Promise.all([...r,nn(()=>import("./index-Cs4_L2Nv.js"),__vite__mapDeps([41,3,5,7,29,12,42,25,9,34,11,10,39,37,13,22,24,30,6,8,15,17,18,19,4,20,32,21,35])),nn(()=>import("./w3m-modal-CfOUKDZZ.js"),__vite__mapDeps([43,3,9,5,12,10,7,25,42,26]))])}}const iJ="1.7.18";function oJ(t){return new sJ({...t,sdkVersion:le.generateSdkVersion(t.adapters??[],"html",iJ)})}function Ar(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}const yh="2.18.1",aJ=()=>`@wagmi/core@${yh}`;var eS=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},af,tS;class Xr extends Error{get docsBaseUrl(){return"https://wagmi.sh/core"}get version(){return aJ()}constructor(e,n={}){super(),af.add(this),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiCoreError"});const r=n.cause instanceof Xr?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof Xr&&n.cause.docsPath||n.docsPath;this.message=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: ${this.docsBaseUrl}${s}.html${n.docsSlug?`#${n.docsSlug}`:""}`]:[],...r?[`Details: ${r}`]:[],`Version: ${this.version}`].join(`
`),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}walk(e){return eS(this,af,"m",tS).call(this,this,e)}}af=new WeakSet,tS=function t(e,n){return n?.(e)?e:e.cause?eS(this,af,"m",t).call(this,e.cause,n):e};class Du extends Xr{constructor(){super("Chain not configured."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainNotConfiguredError"})}}class cJ extends Xr{constructor(){super("Connector already connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAlreadyConnectedError"})}}class lJ extends Xr{constructor(){super("Connector not connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorNotConnectedError"})}}class uJ extends Xr{constructor({address:e,connector:n}){super(`Account "${e}" not found for connector "${n.name}".`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAccountNotFoundError"})}}class dJ extends Xr{constructor({connectionChainId:e,connectorChainId:n}){super(`The current chain of the connector (id: ${n}) does not match the connection's chain (id: ${e}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorChainMismatchError"})}}class hJ extends Xr{constructor({connector:e}){super(`Connector "${e.name}" unavailable while reconnecting.`,{details:["During the reconnection step, the only connector methods guaranteed to be available are: `id`, `name`, `type`, `uid`.","All other methods are not guaranteed to be available until reconnection completes and connectors are fully restored.","This error commonly occurs for connectors that asynchronously inject after reconnection has already started."].join(" ")}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorUnavailableReconnectingError"})}}async function kg(t,e){let n;if(typeof e.connector=="function"?n=t._internal.connectors.setup(e.connector):n=e.connector,n.uid===t.state.current)throw new cJ;try{t.setState(a=>({...a,status:"connecting"})),n.emitter.emit("message",{type:"connecting"});const{connector:r,...s}=e,i=await n.connect(s),o=i.accounts;return n.emitter.off("connect",t._internal.events.connect),n.emitter.on("change",t._internal.events.change),n.emitter.on("disconnect",t._internal.events.disconnect),await t.storage?.setItem("recentConnectorId",n.id),t.setState(a=>({...a,connections:new Map(a.connections).set(n.uid,{accounts:o,chainId:i.chainId,connector:n}),current:n.uid,status:"connected"})),{accounts:o,chainId:i.chainId}}catch(r){throw t.setState(s=>({...s,status:s.current?"connected":"disconnected"})),r}}async function Xf(t,e={}){let n;if(e.connector){const{connector:l}=e;if(t.state.status==="reconnecting"&&!l.getAccounts&&!l.getChainId)throw new hJ({connector:l});const[u,d]=await Promise.all([l.getAccounts().catch(h=>{if(e.account===null)return[];throw h}),l.getChainId()]);n={accounts:u,chainId:d,connector:l}}else n=t.state.connections.get(t.state.current);if(!n)throw new lJ;const r=e.chainId??n.chainId,s=await n.connector.getChainId();if(s!==n.chainId)throw new dJ({connectionChainId:n.chainId,connectorChainId:s});const i=n.connector;if(i.getClient)return i.getClient({chainId:r});const o=Ps(e.account??n.accounts[0]);if(o&&(o.address=xo(o.address)),e.account&&!n.accounts.some(l=>l.toLowerCase()===o.address.toLowerCase()))throw new uJ({address:o.address,connector:i});const a=t.chains.find(l=>l.id===r),c=await n.connector.getProvider({chainId:r});return WI({account:o,chain:a,name:"Connector Client",transport:l=>gk(c)({...l,retryCount:0})})}async function zv(t,e={}){let n;if(e.connector)n=e.connector;else{const{connections:s,current:i}=t.state;n=s.get(i)?.connector}const r=t.state.connections;n&&(await n.disconnect(),n.emitter.off("change",t._internal.events.change),n.emitter.off("disconnect",t._internal.events.disconnect),n.emitter.on("connect",t._internal.events.connect),r.delete(n.uid)),t.setState(s=>{if(r.size===0)return{...s,connections:new Map,current:null,status:"disconnected"};const i=r.values().next().value;return{...s,connections:new Map(r),current:i.connector.uid}});{const s=t.state.current;if(!s)return;const i=t.state.connections.get(s)?.connector;if(!i)return;await t.storage?.setItem("recentConnectorId",i.id)}}function nS(t){return typeof t=="number"?t:t==="wei"?0:Math.abs(vR[t])}async function fJ(t,e){const{chainId:n,connector:r,...s}=e;let i;e.account?i=e.account:i=(await Xf(t,{account:e.account,chainId:n,connector:r})).account;const o=t.getClient({chainId:n});return Ar(o,SI,"estimateGas")({...s,account:i})}function Ml(t){const e=t.state.current,n=t.state.connections.get(e),r=n?.accounts,s=r?.[0],i=t.chains.find(a=>a.id===n?.chainId),o=t.state.status;switch(o){case"connected":return{address:s,addresses:r,chain:i,chainId:n?.chainId,connector:n?.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:o};case"reconnecting":return{address:s,addresses:r,chain:i,chainId:n?.chainId,connector:n?.connector,isConnected:!!s,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:o};case"connecting":return{address:s,addresses:r,chain:i,chainId:n?.chainId,connector:n?.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:o};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:o}}}async function pJ(t,e){const{allowFailure:n=!0,chainId:r,contracts:s,...i}=e,o=t.getClient({chainId:r});return Ar(o,_k,"multicall")({allowFailure:n,contracts:s,...i})}function gJ(t,e){const{chainId:n,...r}=e,s=t.getClient({chainId:n});return Ar(s,jI,"readContract")(r)}async function mJ(t,e){const{allowFailure:n=!0,blockNumber:r,blockTag:s,...i}=e,o=e.contracts;try{const a={};for(const[d,h]of o.entries()){const f=h.chainId??t.state.chainId;a[f]||(a[f]=[]),a[f]?.push({contract:h,index:d})}const c=()=>Object.entries(a).map(([d,h])=>pJ(t,{...i,allowFailure:n,blockNumber:r,blockTag:s,chainId:Number.parseInt(d),contracts:h.map(({contract:f})=>f)})),l=(await Promise.all(c())).flat(),u=Object.values(a).flatMap(d=>d.map(({index:h})=>h));return l.reduce((d,h,f)=>(d&&(d[u[f]]=h),d),[])}catch(a){if(a instanceof uI)throw a;const c=()=>o.map(l=>gJ(t,{...l,blockNumber:r,blockTag:s}));return n?(await Promise.allSettled(c())).map(l=>l.status==="fulfilled"?{result:l.value,status:"success"}:{error:l.reason,result:void 0,status:"failure"}):await Promise.all(c())}}async function yJ(t,e){const{address:n,blockNumber:r,blockTag:s,chainId:i,token:o,unit:a="ether"}=e;if(o)try{return await qv(t,{balanceAddress:n,chainId:i,symbolType:"string",tokenAddress:o})}catch(h){if(h.name==="ContractFunctionExecutionError"){const f=await qv(t,{balanceAddress:n,chainId:i,symbolType:"bytes32",tokenAddress:o}),p=HC(Vi(f.symbol,{dir:"right"}));return{...f,symbol:p}}throw h}const c=t.getClient({chainId:i}),u=await Ar(c,NI,"getBalance")(r?{address:n,blockNumber:r}:{address:n,blockTag:s}),d=t.chains.find(h=>h.id===i)??c.chain;return{decimals:d.nativeCurrency.decimals,formatted:Uc(u,nS(a)),symbol:d.nativeCurrency.symbol,value:u}}async function qv(t,e){const{balanceAddress:n,chainId:r,symbolType:s,tokenAddress:i,unit:o}=e,a={abi:[{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:s}]}],address:i},[c,l,u]=await mJ(t,{allowFailure:!1,contracts:[{...a,functionName:"balanceOf",args:[n],chainId:r},{...a,functionName:"decimals",chainId:r},{...a,functionName:"symbol",chainId:r}]}),d=Uc(c??"0",nS(o??l));return{decimals:l,formatted:d,symbol:u,value:c}}function Uu(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;let n,r;if(Array.isArray(t)&&Array.isArray(e)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Uu(t[r],e[r]))return!1;return!0}if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const s=Object.keys(t);if(n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.hasOwn(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(i&&!Uu(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}let Vd=[];function zs(t){const e=[...t.state.connections.values()];return t.state.status==="reconnecting"||Uu(Vd,e)?Vd:(Vd=e,e)}async function wJ(t,e){const{account:n,chainId:r,...s}=e,i=n??Ml(t).address,o=t.getClient({chainId:r});return Ar(o,fy,"prepareTransactionRequest")({...s,...i?{account:i}:{}})}let Dg=!1;async function Wv(t,e={}){if(Dg)return[];Dg=!0,t.setState(l=>({...l,status:l.current?"reconnecting":"connecting"}));const n=[];if(e.connectors?.length)for(const l of e.connectors){let u;typeof l=="function"?u=t._internal.connectors.setup(l):u=l,n.push(u)}else n.push(...t.connectors);let r;try{r=await t.storage?.getItem("recentConnectorId")}catch{}const s={};for(const[,l]of t.state.connections)s[l.connector.id]=1;r&&(s[r]=0);const i=Object.keys(s).length>0?[...n].sort((l,u)=>(s[l.id]??10)-(s[u.id]??10)):n;let o=!1;const a=[],c=[];for(const l of i){const u=await l.getProvider().catch(()=>{});if(!u||c.some(f=>f===u)||!await l.isAuthorized())continue;const h=await l.connect({isReconnecting:!0}).catch(()=>null);h&&(l.emitter.off("connect",t._internal.events.connect),l.emitter.on("change",t._internal.events.change),l.emitter.on("disconnect",t._internal.events.disconnect),t.setState(f=>{const p=new Map(o?f.connections:new Map).set(l.uid,{accounts:h.accounts,chainId:h.chainId,connector:l});return{...f,current:o?f.current:l.uid,connections:p}}),a.push({accounts:h.accounts,chainId:h.chainId,connector:l}),c.push(u),o=!0)}return(t.state.status==="reconnecting"||t.state.status==="connecting")&&(o?t.setState(l=>({...l,status:"connected"})):t.setState(l=>({...l,connections:new Map,current:null,status:"disconnected"}))),Dg=!1,a}async function bJ(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&n?.type==="local"?o=t.getClient({chainId:r}):o=await Xf(t,{account:n??void 0,chainId:r,connector:s}),await Ar(o,zI,"sendTransaction")({...i,...n?{account:n}:{},chain:r?{id:r}:null,gas:i.gas??void 0})}async function EJ(t,e){const{account:n,connector:r,...s}=e;let i;return typeof n=="object"&&n.type==="local"?i=t.getClient():i=await Xf(t,{account:n,connector:r}),Ar(i,Tk,"signMessage")({...s,...n?{account:n}:{}})}class $i extends Xr{constructor(){super("Provider not found."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderNotFoundError"})}}class vJ extends Xr{constructor({connector:e}){super(`"${e.name}" does not support programmatic chain switching.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainNotSupportedError"})}}async function Vv(t,e){const{addEthereumChainParameter:n,chainId:r}=e,s=t.state.connections.get(e.connector?.uid??t.state.current);if(s){const o=s.connector;if(!o.switchChain)throw new vJ({connector:o});return await o.switchChain({addEthereumChainParameter:n,chainId:r})}const i=t.chains.find(o=>o.id===r);if(!i)throw new Du;return t.setState(o=>({...o,chainId:r})),i}async function AJ(t,e){const{chainId:n,timeout:r=0,...s}=e,i=t.getClient({chainId:n}),a=await Ar(i,Sk,"waitForTransactionReceipt")({...s,timeout:r});if(a.status==="reverted"){const l=await Ar(i,GI,"getTransaction")({hash:a.transactionHash}),d=await Ar(i,FI,"call")({...l,data:l.input,gasPrice:l.type!=="eip1559"?l.gasPrice:void 0,maxFeePerGas:l.type==="eip1559"?l.maxFeePerGas:void 0,maxPriorityFeePerGas:l.type==="eip1559"?l.maxPriorityFeePerGas:void 0}),h=d?.data?HC(`0x${d.data.substring(138)}`):"unknown reason";throw new Error(h)}return{...a,chainId:i.chain.id}}function CJ(t,e){const{onChange:n}=e;return t.subscribe(()=>Ml(t),n,{equalityFn(r,s){const{connector:i,...o}=r,{connector:a,...c}=s;return Uu(o,c)&&i?.id===a?.id&&i?.uid===a?.uid}})}function IJ(t,e){const{onChange:n}=e;return t.subscribe(()=>zs(t),n,{equalityFn:Uu})}function _J(t,e){const{onChange:n}=e;return t._internal.connectors.subscribe((r,s)=>{n(Object.values(r),s)})}function NJ(t,e){const{syncConnectedChain:n=t._internal.syncConnectedChain,...r}=e;let s;const i=c=>{s&&s();const l=t.getClient({chainId:c});return s=Ar(l,xk,"watchPendingTransactions")(r),s},o=i(e.chainId);let a;return n&&!e.chainId&&(a=t.subscribe(({chainId:c})=>c,async c=>i(c))),()=>{o?.(),a?.()}}async function SJ(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&n?.type==="local"?o=t.getClient({chainId:r}):o=await Xf(t,{account:n??void 0,chainId:r,connector:s}),await Ar(o,lk,"writeContract")({...i,...n?{account:n}:{},chain:r?{id:r}:null})}function Mne(t){return t}ep.type="injected";function ep(t={}){const{shimDisconnect:e=!0,unstable_shimAsyncInject:n}=t;function r(){const c=t.target;if(typeof c=="function"){const l=c();if(l)return l}return typeof c=="object"?c:typeof c=="string"?{...xJ[c]??{id:c,name:`${c[0].toUpperCase()}${c.slice(1)}`,provider:`is${c[0].toUpperCase()}${c.slice(1)}`}}:{id:"injected",name:"Injected",provider(l){return l?.ethereum}}}let s,i,o,a;return c=>({get icon(){return r().icon},get id(){return r().id},get name(){return r().name},get supportsSimulation(){return!0},type:ep.type,async setup(){const l=await this.getProvider();l?.on&&t.target&&(o||(o=this.onConnect.bind(this),l.on("connect",o)),s||(s=this.onAccountsChanged.bind(this),l.on("accountsChanged",s)))},async connect({chainId:l,isReconnecting:u}={}){const d=await this.getProvider();if(!d)throw new $i;let h=[];if(u)h=await this.getAccounts().catch(()=>[]);else if(e)try{h=(await d.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]}))[0]?.caveats?.[0]?.value?.map(p=>xo(p)),h.length>0&&(h=await this.getAccounts())}catch(f){const p=f;if(p.code===Lt.code)throw new Lt(p);if(p.code===Gi.code)throw p}try{!h?.length&&!u&&(h=(await d.request({method:"eth_requestAccounts"})).map(g=>xo(g))),o&&(d.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),d.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),d.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),d.on("disconnect",a));let f=await this.getChainId();return l&&f!==l&&(f=(await this.switchChain({chainId:l}).catch(g=>{if(g.code===Lt.code)throw g;return{id:f}}))?.id??f),e&&await c.storage?.removeItem(`${this.id}.disconnected`),t.target||await c.storage?.setItem("injected.connected",!0),{accounts:h,chainId:f}}catch(f){const p=f;throw p.code===Lt.code?new Lt(p):p.code===Gi.code?new Gi(p):p}},async disconnect(){const l=await this.getProvider();if(!l)throw new $i;i&&(l.removeListener("chainChanged",i),i=void 0),a&&(l.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),l.on("connect",o));try{await VI(()=>l.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]}),{timeout:100})}catch{}e&&await c.storage?.setItem(`${this.id}.disconnected`,!0),t.target||await c.storage?.removeItem("injected.connected")},async getAccounts(){const l=await this.getProvider();if(!l)throw new $i;return(await l.request({method:"eth_accounts"})).map(d=>xo(d))},async getChainId(){const l=await this.getProvider();if(!l)throw new $i;const u=await l.request({method:"eth_chainId"});return Number(u)},async getProvider(){if(typeof window>"u")return;let l;const u=r();return typeof u.provider=="function"?l=u.provider(window):typeof u.provider=="string"?l=wh(window,u.provider):l=u.provider,l&&!l.removeListener&&("off"in l&&typeof l.off=="function"?l.removeListener=l.off:l.removeListener=()=>{}),l},async isAuthorized(){try{if(e&&await c.storage?.getItem(`${this.id}.disconnected`)||!t.target&&!await c.storage?.getItem("injected.connected"))return!1;if(!await this.getProvider()){if(n!==void 0&&n!==!1){const h=async()=>(typeof window<"u"&&window.removeEventListener("ethereum#initialized",h),!!await this.getProvider()),f=typeof n=="number"?n:1e3;if(await Promise.race([...typeof window<"u"?[new Promise(g=>window.addEventListener("ethereum#initialized",()=>g(h()),{once:!0}))]:[],new Promise(g=>setTimeout(()=>g(h()),f))]))return!0}throw new $i}return!!(await kh(()=>this.getAccounts())).length}catch{return!1}},async switchChain({addEthereumChainParameter:l,chainId:u}){const d=await this.getProvider();if(!d)throw new $i;const h=c.chains.find(p=>p.id===u);if(!h)throw new Ns(new Du);const f=new Promise(p=>{const g=m=>{"chainId"in m&&m.chainId===u&&(c.emitter.off("change",g),p())};c.emitter.on("change",g)});try{return await Promise.all([d.request({method:"wallet_switchEthereumChain",params:[{chainId:De(u)}]}).then(async()=>{await this.getChainId()===u&&c.emitter.emit("change",{chainId:u})}),f]),h}catch(p){const g=p;if(g.code===4902||g?.data?.originalError?.code===4902)try{const{default:m,...y}=h.blockExplorers??{};let v;l?.blockExplorerUrls?v=l.blockExplorerUrls:m&&(v=[m.url,...Object.values(y).map(b=>b.url)]);let w;l?.rpcUrls?.length?w=l.rpcUrls:w=[h.rpcUrls.default?.http[0]??""];const N={blockExplorerUrls:v,chainId:De(u),chainName:l?.chainName??h.name,iconUrls:l?.iconUrls,nativeCurrency:l?.nativeCurrency??h.nativeCurrency,rpcUrls:w};return await Promise.all([d.request({method:"wallet_addEthereumChain",params:[N]}).then(async()=>{if(await this.getChainId()===u)c.emitter.emit("change",{chainId:u});else throw new Lt(new Error("User rejected switch after adding network."))}),f]),h}catch(m){throw new Lt(m)}throw g.code===Lt.code?new Lt(g):new Ns(g)}},async onAccountsChanged(l){if(l.length===0)this.onDisconnect();else if(c.emitter.listenerCount("connect")){const u=(await this.getChainId()).toString();this.onConnect({chainId:u}),e&&await c.storage?.removeItem(`${this.id}.disconnected`)}else c.emitter.emit("change",{accounts:l.map(u=>xo(u))})},onChainChanged(l){const u=Number(l);c.emitter.emit("change",{chainId:u})},async onConnect(l){const u=await this.getAccounts();if(u.length===0)return;const d=Number(l.chainId);c.emitter.emit("connect",{accounts:u,chainId:d});const h=await this.getProvider();h&&(o&&(h.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),h.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),h.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),h.on("disconnect",a)))},async onDisconnect(l){const u=await this.getProvider();l&&l.code===1013&&u&&(await this.getAccounts()).length||(c.emitter.emit("disconnect"),u&&(i&&(u.removeListener("chainChanged",i),i=void 0),a&&(u.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),u.on("connect",o))))}})}const xJ={coinbaseWallet:{id:"coinbaseWallet",name:"Coinbase Wallet",provider(t){return t?.coinbaseWalletExtension?t.coinbaseWalletExtension:wh(t,"isCoinbaseWallet")}},metaMask:{id:"metaMask",name:"MetaMask",provider(t){return wh(t,e=>{if(!e.isMetaMask||e.isBraveWallet&&!e._events&&!e._state)return!1;const n=["isApexWallet","isAvalanche","isBitKeep","isBlockWallet","isKuCoinWallet","isMathWallet","isOkxWallet","isOKExWallet","isOneInchIOSWallet","isOneInchAndroidWallet","isOpera","isPhantom","isPortal","isRabby","isTokenPocket","isTokenary","isUniswapWallet","isZerion"];for(const r of n)if(e[r])return!1;return!0})}},phantom:{id:"phantom",name:"Phantom",provider(t){return t?.phantom?.ethereum?t.phantom?.ethereum:wh(t,"isPhantom")}}};function wh(t,e){function n(s){return typeof e=="function"?e(s):typeof e=="string"?s[e]:!0}const r=t.ethereum;if(r?.providers)return r.providers.find(s=>n(s));if(r&&n(r))return r}function TJ(t){if(typeof window>"u")return;const e=n=>t(n.detail);return window.addEventListener("eip6963:announceProvider",e),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",e)}function PJ(){const t=new Set;let e=[];const n=()=>TJ(s=>{e.some(({info:i})=>i.uuid===s.info.uuid)||(e=[...e,s],t.forEach(i=>i(e,{added:[s]})))});let r=n();return{_listeners(){return t},clear(){t.forEach(s=>s([],{removed:[...e]})),e=[]},destroy(){this.clear(),t.clear(),r?.()},findProvider({rdns:s}){return e.find(i=>i.info.rdns===s)},getProviders(){return e},reset(){this.clear(),r?.(),r=n()},subscribe(s,{emitImmediately:i}={}){return t.add(s),i&&s(e,{added:e}),()=>t.delete(s)}}}const OJ=t=>(e,n,r)=>{const s=r.subscribe;return r.subscribe=(o,a,c)=>{let l=o;if(a){const u=c?.equalityFn||Object.is;let d=o(r.getState());l=h=>{const f=o(h);if(!u(d,f)){const p=d;a(d=f,p)}},c?.fireImmediately&&a(d,d)}return s(l)},t(e,n,r)},RJ=OJ;function kJ(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),a=(i=n.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const I0=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return I0(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return I0(r)(n)}}}},DJ=(t,e)=>(n,r,s)=>{let i={storage:kJ(()=>localStorage),partialize:g=>g,version:0,merge:(g,m)=>({...m,...g}),...e},o=!1;const a=new Set,c=new Set;let l=i.storage;if(!l)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...g)},r,s);const u=()=>{const g=i.partialize({...r()});return l.setItem(i.name,{state:g,version:i.version})},d=s.setState;s.setState=(g,m)=>{d(g,m),u()};const h=t((...g)=>{n(...g),u()},r,s);s.getInitialState=()=>h;let f;const p=()=>{var g,m;if(!l)return;o=!1,a.forEach(v=>{var w;return v((w=r())!=null?w:h)});const y=((m=i.onRehydrateStorage)==null?void 0:m.call(i,(g=r())!=null?g:h))||void 0;return I0(l.getItem.bind(l))(i.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return[!0,i.migrate(v.state,v.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var w;const[N,b]=v;if(f=i.merge(b,(w=r())!=null?w:h),n(f,!0),N)return u()}).then(()=>{y?.(f,void 0),f=r(),o=!0,c.forEach(v=>v(f))}).catch(v=>{y?.(void 0,v)})};return s.persist={setOptions:g=>{i={...i,...g},g.storage&&(l=g.storage)},clearStorage:()=>{l?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:g=>(a.add(g),()=>{a.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||p(),f||h},UJ=DJ,Gv=t=>{let e;const n=new Set,r=(l,u)=>{const d=typeof l=="function"?l(e):l;if(!Object.is(d,e)){const h=e;e=u??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(f=>f(e,h))}},s=()=>e,a={setState:r,getState:s,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(r,s,a);return a},Ug=t=>t?Gv(t):Gv;var Bg={exports:{}},Kv;function BJ(){return Kv||(Kv=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function i(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new s(u,d||c,h),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],f]:c._events[p].push(f):(c._events[p]=f,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,f,p){var g=n?n+l:l;if(!this._events[g])return!1;var m=this._events[g],y=arguments.length,v,w;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),y){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,d),!0;case 4:return m.fn.call(m.context,u,d,h),!0;case 5:return m.fn.call(m.context,u,d,h,f),!0;case 6:return m.fn.call(m.context,u,d,h,f,p),!0}for(w=1,v=new Array(y-1);w<y;w++)v[w-1]=arguments[w];m.fn.apply(m.context,v)}else{var N=m.length,b;for(w=0;w<N;w++)switch(m[w].once&&this.removeListener(l,m[w].fn,void 0,!0),y){case 1:m[w].fn.call(m[w].context);break;case 2:m[w].fn.call(m[w].context,u);break;case 3:m[w].fn.call(m[w].context,u,d);break;case 4:m[w].fn.call(m[w].context,u,d,h);break;default:if(!v)for(b=1,v=new Array(y-1);b<y;b++)v[b-1]=arguments[b];m[w].fn.apply(m[w].context,v)}}return!0},a.prototype.on=function(l,u,d){return i(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return i(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var f=n?n+l:l;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&o(this,f);else{for(var g=0,m=[],y=p.length;g<y;g++)(p[g].fn!==u||h&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}(Bg)),Bg.exports}var $J=BJ();const LJ=wf($J);class MJ{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:new LJ})}on(e,n){this._emitter.on(e,n)}once(e,n){this._emitter.once(e,n)}off(e,n){this._emitter.off(e,n)}emit(e,...n){const r=n[0];this._emitter.emit(e,{uid:this.uid,...r})}listenerCount(e){return this._emitter.listenerCount(e)}}function FJ(t){return new MJ(t)}function jJ(t,e){return JSON.parse(t,(n,r)=>{let s=r;return s?.__type==="bigint"&&(s=BigInt(s.value)),s?.__type==="Map"&&(s=new Map(s.value)),e?.(n,s)??s})}function Jv(t,e){return t.slice(0,e).join(".")||"."}function Yv(t,e){const{length:n}=t;for(let r=0;r<n;++r)if(t[r]===e)return r+1;return 0}function HJ(t,e){const n=typeof t=="function",r=typeof e=="function",s=[],i=[];return function(a,c){if(typeof c=="object")if(s.length){const l=Yv(s,this);l===0?s[s.length]=this:(s.splice(l),i.splice(l)),i[i.length]=a;const u=Yv(s,c);if(u!==0)return r?e.call(this,a,c,Jv(i,u)):`[ref=${Jv(i,u)}]`}else s[0]=c,i[0]=a;return n?t.call(this,a,c):c}}function zJ(t,e,n,r){return JSON.stringify(t,HJ((s,i)=>{let o=i;return typeof o=="bigint"&&(o={__type:"bigint",value:i.toString()}),o instanceof Map&&(o={__type:"Map",value:Array.from(i.entries())}),e?.(s,o)??o},r),n??void 0)}function qJ(t){const{deserialize:e=jJ,key:n="wagmi",serialize:r=zJ,storage:s=rS}=t;function i(o){return o instanceof Promise?o.then(a=>a).catch(()=>null):o}return{...s,key:n,async getItem(o,a){const c=s.getItem(`${n}.${o}`),l=await i(c);return l?e(l)??null:a??null},async setItem(o,a){const c=`${n}.${o}`;a===null?await i(s.removeItem(c)):await i(s.setItem(c,r(a)))},async removeItem(o){await i(s.removeItem(`${n}.${o}`))}}}const rS={getItem:()=>null,setItem:()=>{},removeItem:()=>{}};function WJ(){const t=typeof window<"u"&&window.localStorage?window.localStorage:rS;return{getItem(e){return t.getItem(e)},removeItem(e){t.removeItem(e)},setItem(e,n){try{t.setItem(e,n)}catch{}}}}const _0=256;let Gd=_0,Kd;function VJ(t=11){if(!Kd||Gd+t>_0*2){Kd="",Gd=0;for(let e=0;e<_0;e++)Kd+=(256+Math.random()*256|0).toString(16).substring(1)}return Kd.substring(Gd,Gd+++t)}function GJ(t){const{multiInjectedProviderDiscovery:e=!0,storage:n=qJ({storage:WJ()}),syncConnectedChain:r=!0,ssr:s=!1,...i}=t,o=typeof window<"u"&&e?PJ():void 0,a=Ug(()=>i.chains),c=Ug(()=>{const b=[],E=new Set;for(const S of i.connectors??[]){const x=l(S);if(b.push(x),!s&&x.rdns){const I=typeof x.rdns=="string"?[x.rdns]:x.rdns;for(const O of I)E.add(O)}}if(!s&&o){const S=o.getProviders();for(const x of S)E.has(x.info.rdns)||b.push(l(u(x)))}return b});function l(b){const E=FJ(VJ()),S={...b({emitter:E,chains:a.getState(),storage:n,transports:i.transports}),emitter:E,uid:E.uid};return E.on("connect",w),S.setup?.(),S}function u(b){const{info:E}=b,S=b.provider;return ep({target:{...E,id:E.rdns,provider:S}})}const d=new Map;function h(b={}){const E=b.chainId??m.getState().chainId,S=a.getState().find(I=>I.id===E);if(b.chainId&&!S)throw new Du;{const I=d.get(m.getState().chainId);if(I&&!S)return I;if(!S)throw new Du}{const I=d.get(E);if(I)return I}let x;if(i.client)x=i.client({chain:S});else{const I=S.id,O=a.getState().map(M=>M.id),P={},k=Object.entries(i);for(const[M,$]of k)if(!(M==="chains"||M==="client"||M==="connectors"||M==="transports"))if(typeof $=="object")if(I in $)P[M]=$[I];else{if(O.some(_=>_ in $))continue;P[M]=$}else P[M]=$;x=WI({...P,chain:S,batch:P.batch??{multicall:!0},transport:M=>i.transports[I]({...M,connectors:c})})}return d.set(E,x),x}function f(){return{chainId:a.getState()[0].id,connections:new Map,current:null,status:"disconnected"}}let p;const g="0.0.0-canary-";yh.startsWith(g)?p=Number.parseInt(yh.replace(g,"")):p=Number.parseInt(yh.split(".")[0]??"0");const m=Ug(RJ(n?UJ(f,{migrate(b,E){if(E===p)return b;const S=f(),x=y(b,S.chainId);return{...S,chainId:x}},name:"store",partialize(b){return{connections:{__type:"Map",value:Array.from(b.connections.entries()).map(([E,S])=>{const{id:x,name:I,type:O,uid:P}=S.connector;return[E,{...S,connector:{id:x,name:I,type:O,uid:P}}]})},chainId:b.chainId,current:b.current}},merge(b,E){typeof b=="object"&&b&&"status"in b&&delete b.status;const S=y(b,E.chainId);return{...E,...b,chainId:S}},skipHydration:s,storage:n,version:p}):f));m.setState(f());function y(b,E){return b&&typeof b=="object"&&"chainId"in b&&typeof b.chainId=="number"&&a.getState().some(S=>S.id===b.chainId)?b.chainId:E}r&&m.subscribe(({connections:b,current:E})=>E?b.get(E)?.chainId:void 0,b=>{if(a.getState().some(S=>S.id===b))return m.setState(S=>({...S,chainId:b??S.chainId}))}),o?.subscribe(b=>{const E=new Set,S=new Set;for(const I of c.getState())if(E.add(I.id),I.rdns){const O=typeof I.rdns=="string"?[I.rdns]:I.rdns;for(const P of O)S.add(P)}const x=[];for(const I of b){if(S.has(I.info.rdns))continue;const O=l(u(I));E.has(O.id)||x.push(O)}n&&!m.persist.hasHydrated()||c.setState(I=>[...I,...x],!0)});function v(b){m.setState(E=>{const S=E.connections.get(b.uid);return S?{...E,connections:new Map(E.connections).set(b.uid,{accounts:b.accounts??S.accounts,chainId:b.chainId??S.chainId,connector:S.connector})}:E})}function w(b){m.getState().status==="connecting"||m.getState().status==="reconnecting"||m.setState(E=>{const S=c.getState().find(x=>x.uid===b.uid);return S?(S.emitter.listenerCount("connect")&&S.emitter.off("connect",v),S.emitter.listenerCount("change")||S.emitter.on("change",v),S.emitter.listenerCount("disconnect")||S.emitter.on("disconnect",N),{...E,connections:new Map(E.connections).set(b.uid,{accounts:b.accounts,chainId:b.chainId,connector:S}),current:b.uid,status:"connected"}):E})}function N(b){m.setState(E=>{const S=E.connections.get(b.uid);if(S){const I=S.connector;I.emitter.listenerCount("change")&&S.connector.emitter.off("change",v),I.emitter.listenerCount("disconnect")&&S.connector.emitter.off("disconnect",N),I.emitter.listenerCount("connect")||S.connector.emitter.on("connect",w)}if(E.connections.delete(b.uid),E.connections.size===0)return{...E,connections:new Map,current:null,status:"disconnected"};const x=E.connections.values().next().value;return{...E,connections:new Map(E.connections),current:x.connector.uid}})}return{get chains(){return a.getState()},get connectors(){return c.getState()},storage:n,getClient:h,get state(){return m.getState()},setState(b){let E;typeof b=="function"?E=b(m.getState()):E=b;const S=f();typeof E!="object"&&(E=S),Object.keys(S).some(I=>!(I in E))&&(E=S),m.setState(E,!0)},subscribe(b,E,S){return m.subscribe(b,E,S?{...S,fireImmediately:S.emitImmediately}:void 0)},_internal:{mipd:o,store:m,ssr:!!s,syncConnectedChain:r,transports:i.transports,chains:{setState(b){const E=typeof b=="function"?b(a.getState()):b;if(E.length!==0)return a.setState(E,!0)},subscribe(b){return a.subscribe(b)}},connectors:{providerDetailToConnector:u,setup:l,setState(b){return c.setState(typeof b=="function"?b(c.getState()):b,!0)},subscribe(b){return c.subscribe(b)}},events:{change:v,connect:w,disconnect:N}}}}function KJ(t){let e=[],n,r;function s(a){return ql.parseEvmChainId(a)||1}function i(){return n||(n=Ho.getInstance({projectId:t.options.projectId,chainId:Hi()?.caipNetworkId,enableLogger:t.options.enableAuthLogger,onTimeout:a=>{a==="iframe_load_failed"?pt.open(Et.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):a==="iframe_request_timeout"?pt.open(Et.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):a==="unverified_domain"&&pt.open(Et.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},abortController:Et.EmbeddedWalletAbortController,getActiveCaipNetwork:a=>Hi(a),getCaipNetworks:a=>T.getCaipNetworks(a)})),n}async function o(a={}){const c=i();let l=a.chainId;if(a.isReconnecting){const g=ql.parseEvmChainId(c.getLastUsedChainId()||""),m=t.chains?.[0].id;if(l=g||m,!l)throw new Error("ChainId not found in provider")}const u=or("eip155"),{address:d,chainId:h,accounts:f}=await br.authConnectorAuthenticate({authConnector:c,chainId:l,preferredAccountType:u,socialUri:a.socialUri,chainNamespace:F.CHAIN.EVM});e=f?.map(g=>g.address)||[d];const p=s(h);return{accounts:e,account:d,chainId:p,chain:{id:p,unsuported:!1}}}return a=>({id:F.CONNECTOR_ID.AUTH,name:F.CONNECTOR_NAMES.AUTH,type:"AUTH",chain:F.CHAIN.EVM,async connect(c={}){if(r)return r;r||(r=new Promise(u=>{u(o(c))}));const l=await r;return r=void 0,l},async disconnect(){await(await this.getProvider()).disconnect()},getAccounts(){return e?.length?(a.emitter.emit("change",{accounts:e}),Promise.resolve(e)):Promise.resolve([])},async getProvider(){return this.provider||(this.provider=Ho.getInstance({projectId:t.options.projectId,chainId:Hi()?.caipNetworkId,enableLogger:t.options.enableAuthLogger,abortController:Et.EmbeddedWalletAbortController,onTimeout:c=>{c==="iframe_load_failed"?pt.open(Et.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):c==="iframe_request_timeout"?pt.open(Et.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):c==="unverified_domain"&&pt.open(Et.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:c=>Hi(c),getCaipNetworks:c=>T.getCaipNetworks(c)})),Promise.resolve(this.provider)},async getChainId(){const c=await this.getProvider(),{chainId:l}=await c.getChainId();return s(l)},async isAuthorized(){const l=T.state.activeChain===F.CHAIN.EVM;if(F.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(h=>Y.getConnectorId(h)===F.CONNECTOR_ID.AUTH)&&!l)return!1;const d=await this.getProvider();return Promise.resolve(d.getLoginEmailUsed())},async switchChain({chainId:c}){try{const l=a.chains.find(f=>f.id===c);if(!l)throw new Ns(new Error("chain not found on connector."));const u=await this.getProvider(),d=or("eip155"),h=await u.connect({chainId:c,preferredAccountType:d});return e=h?.accounts?.map(f=>f.address)||[h.address],a.emitter.emit("change",{chainId:Number(c),accounts:e}),l}catch(l){throw l instanceof Error?new Ns(l):l}},onAccountsChanged(c){c.length===0?this.onDisconnect():a.emitter.emit("change",{accounts:c.map(xo)})},onChainChanged(c){const l=Number(c);a.emitter.emit("change",{chainId:l})},async onDisconnect(c){await(await this.getProvider()).disconnect()}})}rw.type="walletConnect";function rw(t,e){const n=t.isNewChainsStale??!0;let r,s,i,o,a,c,l;return u=>({id:"walletConnect",name:"WalletConnect",type:rw.type,async setup(){const d=await this.getProvider().catch(()=>null);d&&(o||(o=this.onConnect.bind(this),d.on("connect",o)),c||(c=this.onSessionDelete.bind(this),d.on("session_delete",c)))},async connect({...d}={}){try{const h=T.getCaipNetworks(),f=await this.getProvider();if(!f)throw new $i;a||(a=this.onDisplayUri,f.on("display_uri",a));const p=await this.isChainsStale();f.session&&p&&await f.disconnect();const g=H.state.universalProviderConfigOverride;if(!f.session||p){const E=As.createNamespaces(h,g);await f.connect({optionalNamespaces:E,..."pairingTopic"in d?{pairingTopic:d.pairingTopic}:{}}),this.setRequestedChainsIds(h.map(S=>Number(S.id)))}const m=await this.getAccounts(),y=await this.getChainId(),v=f.session?.namespaces?.eip155?.chains,w=v?.some(E=>Number(E.split(":")[1])===y);let N=1;w?N=y:v?.[0]&&(N=Number(v[0].split(":")[1])),a&&(f.removeListener("display_uri",a),a=void 0),o&&(f.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),f.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),f.on("chainChanged",i)),l||(l=this.onDisconnect.bind(this),f.on("disconnect",l)),c||(c=this.onSessionDelete.bind(this),f.on("session_delete",c));const b=g?.defaultChain;return f.setDefaultChain(b??`eip155:${N}`),{accounts:m,chainId:N}}catch(h){throw/(user rejected|connection request reset)/i.test(h?.message)?new Lt(h):h}},async disconnect(){const d=await this.getProvider();try{await d?.disconnect()}catch(h){if(!/No matching key/i.test(h.message))throw h}finally{i&&(d?.removeListener("chainChanged",i),i=void 0),l&&(d?.removeListener("disconnect",l),l=void 0),o||(o=this.onConnect.bind(this),d?.on("connect",o)),s&&(d?.removeListener("accountsChanged",s),s=void 0),c&&(d?.removeListener("session_delete",c),c=void 0),this.setRequestedChainsIds([])}},async getAccounts(){const d=await this.getProvider();if(!d?.session?.namespaces)return[];const f=d?.session?.namespaces[F.CHAIN.EVM]?.accounts?.map(m=>m.split(":")[2])??[],p=new Set;return f.filter(m=>{const y=m?.toLowerCase();return p.has(y)?!1:(p.add(y),!0)})},async getProvider({chainId:d}={}){r||(r=await e.getUniversalProvider(),r?.events.setMaxListeners(Number.POSITIVE_INFINITY));const h=W.getActiveNamespace(),f=e.getCaipNetwork()?.id;if(d&&f!==d&&h){const p=W.getStoredActiveCaipNetworkId(),m=(h?e.getCaipNetworks(h):[])?.find(y=>y.id===p);m&&m.chainNamespace===F.CHAIN.EVM&&await this.switchChain?.({chainId:Number(m.id)})}return r},async getChainId(){const d=e.getCaipNetwork(F.CHAIN.EVM)?.id;if(d)return d;const f=(await this.getProvider()).session?.namespaces[F.CHAIN.EVM]?.chains?.[0];return T.getCaipNetworks().find(g=>g.id===f)?.id},async isAuthorized(){try{const[d,h]=await Promise.all([this.getAccounts(),this.getProvider()]);return d.length?await this.isChainsStale()&&h.session?(await h.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:d,chainId:h}){const f=await this.getProvider();if(!f)throw new $i;const p=T.getCaipNetworks().find(g=>g.id===h);if(!p)throw new Ns(new Du);try{await f.request({method:"wallet_switchEthereumChain",params:[{chainId:De(h)}]}),p?.caipNetworkId&&f.setDefaultChain(p?.caipNetworkId),u.emitter.emit("change",{chainId:Number(h)});const g=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...g,h]),{...p,id:p.id}}catch(g){const m=g;if(/(?:user rejected)/iu.test(m.message))throw new Lt(m);try{let y;d?.blockExplorerUrls?y=d.blockExplorerUrls:y=p.blockExplorers?.default.url?[p.blockExplorers?.default.url]:[];const v=p.rpcUrls?.chainDefault?.http||[],w={blockExplorerUrls:y,chainId:De(h),chainName:p.name,iconUrls:d?.iconUrls,nativeCurrency:p.nativeCurrency,rpcUrls:v};await f.request({method:"wallet_addEthereumChain",params:[w]});const N=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...N,h]),{...p,id:p.id}}catch(y){throw new Lt(y)}}},onAccountsChanged(d){d.length===0?this.onDisconnect():u.emitter.emit("change",{accounts:d.map(h=>xo(h))})},onChainChanged(d){const h=Number(d);u.emitter.emit("change",{chainId:h})},onConnect(d){this.setRequestedChainsIds(T.getCaipNetworks().map(h=>Number(h.id)))},async onDisconnect(d){this.setRequestedChainsIds([]),u.emitter.emit("disconnect");const h=await this.getProvider();s&&(h.removeListener("accountsChanged",s),s=void 0),i&&(h.removeListener("chainChanged",i),i=void 0),l&&(h.removeListener("disconnect",l),l=void 0),c&&(h.removeListener("session_delete",c),c=void 0),o||(o=this.onConnect.bind(this),h.on("connect",o))},onDisplayUri(d){u.emitter.emit("message",{type:"display_uri",data:d})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){return r?.session?.namespaces?r?.session?.namespaces[F.CHAIN.EVM]?.accounts?.map(f=>Number.parseInt(f.split(":")[1]??""))??[]:[]},async getRequestedChainsIds(){const d=await u.storage?.getItem(this.requestedChainsStorageKey)??[];return[...new Set(d)]},async isChainsStale(){if(!n)return!1;const d=u.chains.map(p=>p.id),h=this.getNamespaceChainsIds();if(h.length&&!h.some(p=>d.includes(p)))return!1;const f=await this.getRequestedChainsIds();return!d.every(p=>f.includes(Number(p)))},async setRequestedChainsIds(d){await u.storage?.setItem(this.requestedChainsStorageKey,d)},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}})}const fl=ct({pendingTransactions:0}),Zv={state:fl,subscribeKey(t,e){return ln(fl,t,e)},increase(t){fl[t]+=1},decrease(t){fl[t]-=1},reset(t){fl[t]=0}};function JJ(t){try{return JSON.parse(t)}catch{throw new Error("Error parsing wallet capabilities")}}async function YJ(t){if(le.isSafeApp()){const{safe:e}=await nn(async()=>{const{safe:n}=await import("./index-OMGDjK__.js");return{safe:n}},[]);if(e&&!t.some(n=>n.type==="safe"))return e()}return null}async function ZJ(t){try{const{coinbaseWallet:e}=await nn(async()=>{const{coinbaseWallet:n}=await import("./index-OMGDjK__.js");return{coinbaseWallet:n}},[]);if(e&&!t.some(n=>n.id==="coinbaseWalletSDK"))return e()}catch(e){console.error("Failed to import Coinbase Wallet SDK:",e)}return null}const QJ={enable:!1,pollingInterval:3e4};class XJ extends XN{constructor(e){const n=ps.extendCaipNetworks(e.networks,{projectId:e.projectId,customNetworkImageUrls:{},customRpcUrls:e.customRpcUrls});super(),this.balancePromises={},this.namespace=F.CHAIN.EVM,this.adapterType=F.ADAPTER_TYPES.WAGMI,this.projectId=e.projectId,this.pendingTransactionsFilter={...QJ,...e.pendingTransactionsFilter??{}},this.createConfig({...e,networks:n}),this.checkChainId()}construct(e){this.checkChainId(),this.setupWatchers()}async getAccounts(e){const n=this.getWagmiConnector(e.id);if(!n)return{accounts:[]};if(n.id===F.CONNECTOR_ID.AUTH){const i=await n.getProvider();if(!i?.user)return{accounts:[]};const{address:o,accounts:a}=i.user;return Promise.resolve({accounts:(a||[{address:o,type:"eoa"}]).map(c=>le.createAccount("eip155",c.address,c.type))})}const{addresses:r,address:s}=Ml(this.wagmiConfig);return Promise.resolve({accounts:[...new Set(r||[s])].map(i=>le.createAccount("eip155",i||"","eoa"))})}checkChainId(){const{chainId:e}=Ml(this.wagmiConfig);e&&this.emit("switchNetwork",{chainId:e})}getWagmiConnector(e){return this.wagmiConfig.connectors.find(n=>n.id===e)}createConfig(e){this.wagmiChains=e.networks.filter(s=>s.chainNamespace===F.CHAIN.EVM);const n={},r=[...e.connectors??[]];this.wagmiChains.forEach(s=>{const i=e.transports?.[s.id],o=ps.getCaipNetworkId(s);i?n[s.id]=ps.extendWagmiTransports(s,e.projectId,i):n[s.id]=ps.getViemTransport(s,e.projectId,e.customRpcUrls?.[o])}),this.wagmiConfig=GJ({...e,chains:this.wagmiChains,connectors:r,transports:n})}setupWatchPendingTransactions(){if(!this.pendingTransactionsFilter.enable||this.unwatchPendingTransactions)return;this.unwatchPendingTransactions=NJ(this.wagmiConfig,{pollingInterval:this.pendingTransactionsFilter.pollingInterval,onError:()=>{},onTransactions:()=>{this.emit("pendingTransactions"),Zv.increase("pendingTransactions")}});const e=Zv.subscribeKey("pendingTransactions",n=>{n>=F.LIMITS.PENDING_TRANSACTIONS&&(this.unwatchPendingTransactions?.(),e())})}setupWatchers(){IJ(this.wagmiConfig,{onChange:e=>{this.clearConnections(),this.addConnection(...e.map(n=>{const r=this.getCaipNetworks().find(i=>i.id===n.chainId),s=n.connector.id===F.CONNECTOR_ID.AUTH;return{accounts:n.accounts.map(i=>({address:i})),caipNetwork:r,connectorId:n.connector.id,auth:s?{name:W.getConnectedSocialProvider(),username:W.getConnectedSocialUsername()}:void 0}}))}}),CJ(this.wagmiConfig,{onChange:(e,n)=>{if(e.status==="disconnected"&&n.address&&this.emit("disconnect"),e?.chainId&&e?.chainId!==n?.chainId&&this.emit("switchNetwork",{chainId:e.chainId}),e.status==="connected"){const r=e.address!==n?.address,s=e.connector.id!==n.connector?.id,i=n.status!=="connected";(r||s||i)&&(this.setupWatchPendingTransactions(),this.handleAccountChanged({address:e.address,chainId:e.chainId,connector:e.connector}))}}})}async addThirdPartyConnectors(e){const n=[];if(e.enableCoinbase!==!1){const s=await ZJ(this.wagmiConfig.connectors);s&&n.push(s)}const r=await YJ(this.wagmiConfig.connectors);r&&n.push(r),await Promise.all(n.map(s=>{const i=this.wagmiConfig._internal.connectors.setup(s);return this.wagmiConfig._internal.connectors.setState(o=>[...o,i]),this.addWagmiConnector(i,e)}))}addWagmiConnectors(e,n){const r=[];e.enableWalletConnect!==!1&&r.push(rw(e,n)),e.enableEIP6963!==!1&&r.push(ep({shimDisconnect:!0}));const s=n?.remoteFeatures?.email??!0,i=Array.isArray(n?.remoteFeatures?.socials)&&n?.remoteFeatures?.socials?.length>0;(s||i)&&r.push(KJ({chains:this.wagmiChains,options:{projectId:e.projectId,enableAuthLogger:e.enableAuthLogger}})),r.forEach(o=>{const a=this.wagmiConfig._internal.connectors.setup(o);this.wagmiConfig._internal.connectors.setState(c=>[...c,a])})}async handleAccountChanged({address:e,chainId:n,connector:r}){if(!this.namespace)throw new Error("WagmiAdapter:handleAccountChanged - namespace is required");const s=await r.getProvider().catch(()=>{});this.emit("accountChanged",{address:e,chainId:n,connector:{id:r.id,name:nr.ConnectorNamesMap[r.id]??r.name,imageId:nr.ConnectorImageIds[r.id],type:nr.ConnectorTypesMap[r.type]??"EXTERNAL",info:r.id===F.CONNECTOR_ID.INJECTED?void 0:{rdns:r.id},provider:s,chain:this.namespace,chains:[]}})}async signMessage(e){try{return{signature:await EJ(this.wagmiConfig,{message:e.message,account:e.address})}}catch{throw new Error("WagmiAdapter:signMessage - Sign message failed")}}async sendTransaction(e){const{chainId:n,address:r}=Ml(this.wagmiConfig),s={account:r,to:e.to,value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,data:e.data,chainId:n,type:"legacy",parameters:["nonce"]};await wJ(this.wagmiConfig,s);const i=await bJ(this.wagmiConfig,s);return await AJ(this.wagmiConfig,{hash:i,timeout:25e3}),{hash:i}}async writeContract(e){const{caipNetwork:n,...r}=e,s=Number(ql.caipNetworkIdToNumber(n.caipNetworkId));return{hash:await SJ(this.wagmiConfig,{chain:this.wagmiChains?.[s],chainId:s,address:r.tokenAddress,account:r.fromAddress,abi:r.abi,functionName:r.method,args:r.args,__mode:"prepared"})}}async estimateGas(e){try{return{gas:await fJ(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}}catch{throw new Error("WagmiAdapter:estimateGas - error estimating gas")}}parseUnits(e){return Ik(e.value,e.decimals)}formatUnits(e){return Uc(e.value,e.decimals)}async addWagmiConnector(e,n){if(!this.namespace)throw new Error("WagmiAdapter:addWagmiConnector - namespace is required");if(e.type===F.CONNECTOR_ID.INJECTED&&n.enableEIP6963===!1||e.id===F.CONNECTOR_ID.AUTH||e.id===F.CONNECTOR_ID.WALLET_CONNECT)return;const r=await e.getProvider().catch(()=>{});this.addConnector({id:e.id,explorerId:nr.ConnectorExplorerIds[e.id],imageUrl:n?.connectorImages?.[e.id]??e.icon,name:nr.ConnectorNamesMap[e.id]??e.name,imageId:nr.ConnectorImageIds[e.id],type:nr.ConnectorTypesMap[e.type]??"EXTERNAL",info:e.id===F.CONNECTOR_ID.INJECTED?void 0:{rdns:e.id},provider:r,chain:this.namespace,chains:[]})}async syncConnectors(e,n){_J(this.wagmiConfig,{onChange:r=>{r.forEach(s=>this.addWagmiConnector(s,e))}}),this.addWagmiConnectors(e,n),await Promise.all(this.wagmiConfig.connectors.map(r=>this.addWagmiConnector(r,e))),this.addThirdPartyConnectors(e)}async syncConnections(){return Promise.resolve()}async syncConnection(e){const{id:n,chainId:r}=e,i=zs(this.wagmiConfig).find(l=>l.connector.id===n),a=await this.getWagmiConnector(n)?.getProvider();if(le.isSafeApp()&&n===F.CONNECTOR_ID.SAFE&&!i?.accounts.length){const l=this.getWagmiConnector("safe");if(l){const u=await kg(this.wagmiConfig,{connector:l,chainId:Number(r)}),d=await l.getProvider();return{chainId:Number(r),address:u.accounts[0],provider:d,type:i?.connector.type?.toUpperCase(),id:i?.connector.id}}}return{chainId:Number(i?.chainId),address:i?.accounts[0],provider:a,type:i?.connector.type?.toUpperCase(),id:i?.connector.id}}async connectWalletConnect(e){const n=this.getWalletConnectConnector();await n.authenticate();const r=this.getWagmiConnector("walletConnect");if(!r)throw new Error("UniversalAdapter:connectWalletConnect - connector not found");const s=await kg(this.wagmiConfig,{connector:r,chainId:e?Number(e):void 0});return s.chainId!==Number(e)&&await Vv(this.wagmiConfig,{chainId:s.chainId}),{clientId:await n.provider.client.core.crypto.getClientId()}}async connect(e){const{id:n,address:r,provider:s,type:i,info:o,chainId:a,socialUri:c}=e,l=this.getWagmiConnector(n);if(!l)throw new Error("connectionControllerClient:connectExternal - connector is undefined");s&&o&&l.id===F.CONNECTOR_ID.EIP6963&&l.setEip6963Wallet?.({provider:s,info:o});const u=this.wagmiConfig.state?.connections?.get(l.uid);if(u){await this.wagmiConfig.storage?.setItem("recentConnectorId",l.id);const h=[...u.accounts].sort((f,p)=>on.isLowerCaseMatch(f,r)?-1:on.isLowerCaseMatch(p,r)?1:0);return this.wagmiConfig?.setState(f=>({...f,connections:new Map(f.connections).set(l.uid,{accounts:h,chainId:u.chainId,connector:u.connector}),current:l.uid,status:"connected"})),{address:h[0],chainId:u.chainId,provider:s,type:i,id:n}}const d=await kg(this.wagmiConfig,{connector:l,chainId:a?Number(a):void 0,socialUri:c});return{address:d.accounts[0],chainId:d.chainId,provider:s,type:i,id:n}}get connections(){return Array.from(this.wagmiConfig.state.connections.values()).map(e=>({accounts:e.accounts.map(n=>({address:n})),connectorId:e.connector.id}))}async reconnect(e){const{id:n}=e,r=this.getWagmiConnector(n);if(!r)throw new Error("connectionControllerClient:connectExternal - connector is undefined");await Wv(this.wagmiConfig,{connectors:[r]})}async getBalance(e){const n=e.address,r=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!n)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&this.wagmiConfig){const s=`${r.caipNetworkId}:${e.address}`,i=this.balancePromises[s];if(i)return i;const o=W.getNativeBalanceCacheForCaipAddress(s);return o?{balance:o.balance,symbol:o.symbol}:(this.balancePromises[s]=new Promise(async a=>{try{const c=Number(e.chainId),l=await yJ(this.wagmiConfig,{address:e.address,chainId:c,token:e.tokens?.[r.caipNetworkId]?.address});W.updateNativeBalanceCache({caipAddress:s,balance:l.formatted,symbol:l.symbol,timestamp:Date.now()}),a({balance:l.formatted,symbol:l.symbol})}catch(c){console.warn("Appkit:WagmiAdapter:getBalance - Error getting balance",c),a({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"})}return{balance:"",symbol:""}}getWalletConnectProvider(){return this.getWagmiConnector("walletConnect")?.provider}async disconnect(e){if(e.id){const n=this.getWagmiConnector(e.id),s=zs(this.wagmiConfig).find(i=>on.isLowerCaseMatch(i.connector.id,e.id));return await zv(this.wagmiConfig,{connector:n}),H.state.enableReconnect===!1&&this.deleteConnection(e.id),s?{connections:[{accounts:s.accounts.map(i=>({address:i})),connectorId:s.connector.id}]}:{connections:[]}}return this.disconnectAll()}async disconnectAll(){const e=zs(this.wagmiConfig),n=await Promise.allSettled(e.map(async r=>{const s=this.getWagmiConnector(r.connector.id);return s&&await zv(this.wagmiConfig,{connector:s}),r}));return this.wagmiConfig.state.connections.clear(),{connections:n.filter(r=>r.status==="fulfilled").map(({value:r})=>({accounts:r.accounts.map(s=>({address:s})),connectorId:r.connector.id}))}}async switchNetwork(e){const{caipNetwork:n}=e,r=this.wagmiConfig.chains.find(s=>s.id.toString()===n.id.toString());await Vv(this.wagmiConfig,{chainId:n.id,addEthereumChainParameter:{chainName:r?.name??n.name,nativeCurrency:r?.nativeCurrency??n.nativeCurrency,rpcUrls:[n.rpcUrls?.chainDefault?.http?.[0]??r?.rpcUrls?.default?.http?.[0]??""],blockExplorerUrls:[r?.blockExplorers?.default?.url??n.blockExplorers?.default?.url??""]}}),await super.switchNetwork(e)}async getCapabilities(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:getCapabilities - wagmiConfig is undefined");const r=zs(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:getCapabilities - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:getCapabilities - provider is undefined");const o=i.session?.sessionProperties?.capabilities;if(o){const c=JJ(o)[e];if(c)return c}return await i.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:grantPermissions - wagmiConfig is undefined");const r=zs(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:grantPermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:grantPermissions - provider is undefined");return i.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:revokePermissions - wagmiConfig is undefined");const r=zs(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:revokePermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:revokePermissions - provider is undefined");return i.request({method:"wallet_revokePermissions",params:e})}async walletGetAssets(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:walletGetAssets - wagmiConfig is undefined");const r=zs(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:walletGetAssets - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:walletGetAssets - provider is undefined");return i.request({method:"wallet_getAssets",params:[e]})}setAuthProvider(e){if(!this.namespace)throw new Error("WagmiAdapter:setAuthProvider - namespace is required");this.addConnector({id:F.CONNECTOR_ID.AUTH,type:"AUTH",name:F.CONNECTOR_NAMES.AUTH,provider:e,imageId:nr.ConnectorImageIds[F.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}async setUniversalProvider(e){return e.on("connect",()=>{const n=zs(this.wagmiConfig),r=this.getWagmiConnector("walletConnect");if(r&&!n.find(s=>s.connector.id===r.id)){if(T.state.activeChain==="eip155")return;Wv(this.wagmiConfig,{connectors:[r]})}}),this.addConnector(new nw({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"})),Promise.resolve()}}const eY="6.15.0";function tY(t,e,n){const r=e.split("|").map(i=>i.trim());for(let i=0;i<r.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${n}`,s.value=t,s}async function En(t){const e=Object.keys(t);return(await Promise.all(e.map(r=>Promise.resolve(t[r])))).reduce((r,s,i)=>(r[e[i]]=s,r),{})}function ve(t,e,n){for(let r in e){let s=e[r];const i=n?n[r]:null;i&&tY(s,i,r),Object.defineProperty(t,r,{enumerable:!0,value:s,writable:!1})}}function Qa(t,e){if(t==null)return"null";if(e==null&&(e=new Set),typeof t=="object"){if(e.has(t))return"[Circular]";e.add(t)}if(Array.isArray(t))return"[ "+t.map(n=>Qa(n,e)).join(", ")+" ]";if(t instanceof Uint8Array){const n="0123456789abcdef";let r="0x";for(let s=0;s<t.length;s++)r+=n[t[s]>>4],r+=n[t[s]&15];return r}if(typeof t=="object"&&typeof t.toJSON=="function")return Qa(t.toJSON(),e);switch(typeof t){case"boolean":case"number":case"symbol":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const n=Object.keys(t);return n.sort(),"{ "+n.map(r=>`${Qa(r,e)}: ${Qa(t[r],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function an(t,e){return t&&t.code===e}function sw(t){return an(t,"CALL_EXCEPTION")}function wt(t,e,n){let r=t;{const i=[];if(n){if("message"in n||"code"in n||"name"in n)throw new Error(`value will overwrite populated values: ${Qa(n)}`);for(const o in n){if(o==="shortMessage")continue;const a=n[o];i.push(o+"="+Qa(a))}}i.push(`code=${e}`),i.push(`version=${eY}`),i.length&&(t+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(t);break;default:s=new Error(t)}return ve(s,{code:e}),n&&Object.assign(s,n),s.shortMessage==null&&ve(s,{shortMessage:r}),s}function z(t,e,n,r){if(!t)throw wt(e,n,r)}function D(t,e,n,r){z(t,e,"INVALID_ARGUMENT",{argument:n,value:r})}function sS(t,e,n){n==null&&(n=""),n&&(n=": "+n),z(t>=e,"missing argument"+n,"MISSING_ARGUMENT",{count:t,expectedCount:e}),z(t<=e,"too many arguments"+n,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"".normalize("NFD")!=="e")throw new Error("broken");t.push(e)}catch{}return t},[]);function ld(t,e,n){if(n==null&&(n=""),t!==e){let r=n,s="new";n&&(r+=".",s+=" "+n),z(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function iS(t,e,n){if(t instanceof Uint8Array)return n?new Uint8Array(t):t;if(typeof t=="string"&&t.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const r=new Uint8Array((t.length-2)/2);let s=2;for(let i=0;i<r.length;i++)r[i]=parseInt(t.substring(s,s+2),16),s+=2;return r}D(!1,"invalid BytesLike value",e||"value",t)}function ke(t,e){return iS(t,e,!1)}function vn(t,e){return iS(t,e,!0)}function dt(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&t.length!==2+2*e||e===!0&&t.length%2!==0)}function iw(t){return dt(t,!0)||t instanceof Uint8Array}const Qv="0123456789abcdef";function re(t){const e=ke(t);let n="0x";for(let r=0;r<e.length;r++){const s=e[r];n+=Qv[(s&240)>>4]+Qv[s&15]}return n}function St(t){return"0x"+t.map(e=>re(e).substring(2)).join("")}function oc(t){return dt(t,!0)?(t.length-2)/2:ke(t).length}function It(t,e,n){const r=ke(t);return n!=null&&n>r.length&&z(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n}),re(r.slice(e??0,n??r.length))}function oS(t,e,n){const r=ke(t);z(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),n?s.set(r,e-r.length):s.set(r,0),re(s)}function ui(t,e){return oS(t,e,!0)}function nY(t,e){return oS(t,e,!1)}const tp=BigInt(0),Wr=BigInt(1),Xa=9007199254740991;function cf(t,e){const n=np(t,"value"),r=BigInt(xe(e,"width"));if(z(n>>r===tp,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),n>>r-Wr){const s=(Wr<<r)-Wr;return-((~n&s)+Wr)}return n}function aS(t,e){let n=de(t,"value");const r=BigInt(xe(e,"width")),s=Wr<<r-Wr;if(n<tp){n=-n,z(n<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});const i=(Wr<<r)-Wr;return(~n&i)+Wr}else z(n<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});return n}function $o(t,e){const n=np(t,"value"),r=BigInt(xe(e,"bits"));return n&(Wr<<r)-Wr}function de(t,e){switch(typeof t){case"bigint":return t;case"number":return D(Number.isInteger(t),"underflow",e||"value",t),D(t>=-Xa&&t<=Xa,"overflow",e||"value",t),BigInt(t);case"string":try{if(t==="")throw new Error("empty string");return t[0]==="-"&&t[1]!=="-"?-BigInt(t.substring(1)):BigInt(t)}catch(n){D(!1,`invalid BigNumberish string: ${n.message}`,e||"value",t)}}D(!1,"invalid BigNumberish value",e||"value",t)}function np(t,e){const n=de(t,e);return z(n>=tp,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),n}const Xv="0123456789abcdef";function rp(t){if(t instanceof Uint8Array){let e="0x0";for(const n of t)e+=Xv[n>>4],e+=Xv[n&15];return BigInt(e)}return de(t)}function xe(t,e){switch(typeof t){case"bigint":return D(t>=-Xa&&t<=Xa,"overflow",e||"value",t),Number(t);case"number":return D(Number.isInteger(t),"underflow",e||"value",t),D(t>=-Xa&&t<=Xa,"overflow",e||"value",t),t;case"string":try{if(t==="")throw new Error("empty string");return xe(BigInt(t),e)}catch(n){D(!1,`invalid numeric string: ${n.message}`,e||"value",t)}}D(!1,"invalid numeric value",e||"value",t)}function rY(t){return xe(rp(t))}function io(t,e){let r=np(t,"value").toString(16);if(e==null)r.length%2&&(r="0"+r);else{const s=xe(e,"width");for(z(s*2>=r.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});r.length<s*2;)r="0"+r}return"0x"+r}function jt(t){const e=np(t,"value");if(e===tp)return new Uint8Array([]);let n=e.toString(16);n.length%2&&(n="0"+n);const r=new Uint8Array(n.length/2);for(let s=0;s<r.length;s++){const i=s*2;r[s]=parseInt(n.substring(i,i+2),16)}return r}function zr(t){let e=re(iw(t)?t:jt(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const eA="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const tA=BigInt(58);function sY(t){const e=ke(t);let n=rp(e),r="";for(;n;)r=eA[Number(n%tA)]+r,n/=tA;for(let s=0;s<e.length&&!e[s];s++)r=eA[0]+r;return r}function iY(t){t=atob(t);const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return ke(e)}function oY(t){const e=ke(t);let n="";for(let r=0;r<e.length;r++)n+=String.fromCharCode(e[r]);return btoa(n)}class cS{filter;emitter;#e;constructor(e,n,r){this.#e=n,ve(this,{emitter:e,filter:r})}async removeListener(){this.#e!=null&&await this.emitter.off(this.filter,this.#e)}}function aY(t,e,n,r,s){D(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",n)}function lS(t,e,n,r,s){if(t==="BAD_PREFIX"||t==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<n.length&&n[o]>>6===2;o++)i++;return i}return t==="OVERRUN"?n.length-e-1:0}function cY(t,e,n,r,s){return t==="OVERLONG"?(D(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),r.push(s),0):(r.push(65533),lS(t,e,n))}const lY=Object.freeze({error:aY,ignore:lS,replace:cY});function uY(t,e){e==null&&(e=lY.error);const n=ke(t,"bytes"),r=[];let s=0;for(;s<n.length;){const i=n[s++];if(i>>7===0){r.push(i);continue}let o=null,a=null;if((i&224)===192)o=1,a=127;else if((i&240)===224)o=2,a=2047;else if((i&248)===240)o=3,a=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,n,r):s+=e("BAD_PREFIX",s-1,n,r);continue}if(s-1+o>=n.length){s+=e("OVERRUN",s-1,n,r);continue}let c=i&(1<<8-o-1)-1;for(let l=0;l<o;l++){let u=n[s];if((u&192)!=128){s+=e("MISSING_CONTINUE",s,n,r),c=null;break}c=c<<6|u&63,s++}if(c!==null){if(c>1114111){s+=e("OUT_OF_RANGE",s-1-o,n,r,c);continue}if(c>=55296&&c<=57343){s+=e("UTF16_SURROGATE",s-1-o,n,r,c);continue}if(c<=a){s+=e("OVERLONG",s-1-o,n,r,c);continue}r.push(c)}}return r}function si(t,e){D(typeof t=="string","invalid string value","str",t);let n=[];for(let r=0;r<t.length;r++){const s=t.charCodeAt(r);if(s<128)n.push(s);else if(s<2048)n.push(s>>6|192),n.push(s&63|128);else if((s&64512)==55296){r++;const i=t.charCodeAt(r);D(r<t.length&&(i&64512)===56320,"invalid surrogate pair","str",t);const o=65536+((s&1023)<<10)+(i&1023);n.push(o>>18|240),n.push(o>>12&63|128),n.push(o>>6&63|128),n.push(o&63|128)}else n.push(s>>12|224),n.push(s>>6&63|128),n.push(s&63|128)}return new Uint8Array(n)}function dY(t){return t.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function lf(t,e){return dY(uY(t,e))}function uS(t){async function e(n,r){z(r==null||!r.cancelled,"request cancelled before sending","CANCELLED");const s=n.url.split(":")[0].toLowerCase();z(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),z(s==="https"||!n.credentials||n.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,a=setTimeout(()=>{i=wt("request timeout","TIMEOUT"),o.abort()},n.timeout);r&&r.addListener(()=>{i=wt("request cancelled","CANCELLED"),o.abort()});const c=Object.assign({},t,{method:n.method,headers:new Headers(Array.from(n)),body:n.body||void 0,signal:o.signal});let l;try{l=await fetch(n.url,c)}catch(f){throw clearTimeout(a),i||f}clearTimeout(a);const u={};l.headers.forEach((f,p)=>{u[p.toLowerCase()]=f});const d=await l.arrayBuffer(),h=d==null?null:new Uint8Array(d);return{statusCode:l.status,statusMessage:l.statusText,headers:u,body:h}}return e}const hY=12,fY=250;let nA=uS();const pY=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),gY=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let $g=!1;async function dS(t,e){try{const n=t.match(pY);if(!n)throw new Error("invalid data");return new Zi(200,"OK",{"content-type":n[1]||"text/plain"},n[2]?iY(n[3]):yY(n[3]))}catch{return new Zi(599,"BAD REQUEST (invalid data: URI)",{},null,new di(t))}}function hS(t){async function e(n,r){try{const s=n.match(gY);if(!s)throw new Error("invalid link");return new di(`${t}${s[2]}`)}catch{return new Zi(599,"BAD REQUEST (invalid IPFS URI)",{},null,new di(n))}}return e}const Jd={data:dS,ipfs:hS("https://gateway.ipfs.io/ipfs/")},fS=new WeakMap;class mY{#e;#t;constructor(e){this.#e=[],this.#t=!1,fS.set(e,()=>{if(!this.#t){this.#t=!0;for(const n of this.#e)setTimeout(()=>{n()},0);this.#e=[]}})}addListener(e){z(!this.#t,"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),this.#e.push(e)}get cancelled(){return this.#t}checkSignal(){z(!this.cancelled,"cancelled","CANCELLED",{})}}function Yd(t){if(t==null)throw new Error("missing signal; should not happen");return t.checkSignal(),t}class di{#e;#t;#n;#r;#s;#o;#i;#a;#d;#l;#p;#g;#c;#u;#h;get url(){return this.#o}set url(e){this.#o=String(e)}get body(){return this.#i==null?null:new Uint8Array(this.#i)}set body(e){if(e==null)this.#i=void 0,this.#a=void 0;else if(typeof e=="string")this.#i=si(e),this.#a="text/plain";else if(e instanceof Uint8Array)this.#i=e,this.#a="application/octet-stream";else if(typeof e=="object")this.#i=si(JSON.stringify(e)),this.#a="application/json";else throw new Error("invalid body")}hasBody(){return this.#i!=null}get method(){return this.#r?this.#r:this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),this.#r=String(e).toUpperCase()}get headers(){const e=Object.assign({},this.#n);return this.#d&&(e.authorization=`Basic ${oY(si(this.#d))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&this.#a&&(e["content-type"]=this.#a),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,n){this.#n[String(e).toLowerCase()]=String(n)}clearHeaders(){this.#n={}}[Symbol.iterator](){const e=this.headers,n=Object.keys(e);let r=0;return{next:()=>{if(r<n.length){const s=n[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return this.#d||null}setCredentials(e,n){D(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),this.#d=`${e}:${n}`}get allowGzip(){return this.#t}set allowGzip(e){this.#t=!!e}get allowInsecureAuthentication(){return!!this.#e}set allowInsecureAuthentication(e){this.#e=!!e}get timeout(){return this.#s}set timeout(e){D(e>=0,"timeout must be non-zero","timeout",e),this.#s=e}get preflightFunc(){return this.#l||null}set preflightFunc(e){this.#l=e}get processFunc(){return this.#p||null}set processFunc(e){this.#p=e}get retryFunc(){return this.#g||null}set retryFunc(e){this.#g=e}get getUrlFunc(){return this.#h||nA}set getUrlFunc(e){this.#h=e}constructor(e){this.#o=String(e),this.#e=!1,this.#t=!0,this.#n={},this.#r="",this.#s=3e5,this.#u={slotInterval:fY,maxAttempts:hY},this.#h=null}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${this.#i?re(this.#i):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(this.#u.slotInterval=e.slotInterval),e.maxAttempts!=null&&(this.#u.maxAttempts=e.maxAttempts)}async#f(e,n,r,s,i){if(e>=this.#u.maxAttempts)return i.makeServerError("exceeded maximum retry limit");z(rA()<=n,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),r>0&&await wY(r);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in Jd){const u=await Jd[a](o.url,Yd(s.#c));if(u instanceof Zi){let d=u;if(this.processFunc){Yd(s.#c);try{d=await this.processFunc(o,d)}catch(h){(h.throttle==null||typeof h.stall!="number")&&d.makeServerError("error in post-processing function",h).assertOk()}}return d}o=u}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,Yd(s.#c));let l=new Zi(c.statusCode,c.statusMessage,c.headers,c.body,s);if(l.statusCode===301||l.statusCode===302){try{const u=l.headers.location||"";return o.redirect(u).#f(e+1,n,0,s,l)}catch{}return l}else if(l.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,l,e))){const u=l.headers["retry-after"];let d=this.#u.slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof u=="string"&&u.match(/^[1-9][0-9]*$/)&&(d=parseInt(u)),o.clone().#f(e+1,n,d,s,l)}if(this.processFunc){Yd(s.#c);try{l=await this.processFunc(o,l)}catch(u){(u.throttle==null||typeof u.stall!="number")&&l.makeServerError("error in post-processing function",u).assertOk();let d=this.#u.slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return u.stall>=0&&(d=u.stall),o.clone().#f(e+1,n,d,s,l)}}return l}send(){return z(this.#c==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),this.#c=new mY(this),this.#f(0,rA()+this.timeout,0,this,new Zi(0,"",{},null,this))}cancel(){z(this.#c!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=fS.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const n=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();z(this.method==="GET"&&(n!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new di(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,s.#n=Object.assign({},this.#n),this.#i&&(s.#i=new Uint8Array(this.#i)),s.#a=this.#a,s}clone(){const e=new di(this.url);return e.#r=this.#r,this.#i&&(e.#i=this.#i),e.#a=this.#a,e.#n=Object.assign({},this.#n),e.#d=this.#d,this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),e.#l=this.#l,e.#p=this.#p,e.#g=this.#g,e.#u=Object.assign({},this.#u),e.#h=this.#h,e}static lockConfig(){$g=!0}static getGateway(e){return Jd[e.toLowerCase()]||null}static registerGateway(e,n){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if($g)throw new Error("gateways locked");Jd[e]=n}static registerGetUrl(e){if($g)throw new Error("gateways locked");nA=e}static createGetUrlFunc(e){return uS(e)}static createDataGateway(){return dS}static createIpfsGatewayFunc(e){return hS(e)}}class Zi{#e;#t;#n;#r;#s;#o;toString(){return`<FetchResponse status=${this.statusCode} body=${this.#r?re(this.#r):"null"}>`}get statusCode(){return this.#e}get statusMessage(){return this.#t}get headers(){return Object.assign({},this.#n)}get body(){return this.#r==null?null:new Uint8Array(this.#r)}get bodyText(){try{return this.#r==null?"":lf(this.#r)}catch{z(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{z(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,n=Object.keys(e);let r=0;return{next:()=>{if(r<n.length){const s=n[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}constructor(e,n,r,s,i){this.#e=e,this.#t=n,this.#n=Object.keys(r).reduce((o,a)=>(o[a.toLowerCase()]=String(r[a]),o),{}),this.#r=s==null?null:new Uint8Array(s),this.#s=i||null,this.#o={message:""}}makeServerError(e,n){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new Zi(599,r,this.headers,this.body,this.#s||void 0);return s.#o={message:e,error:n},s}throwThrottleError(e,n){n==null?n=-1:D(Number.isInteger(n)&&n>=0,"invalid stall timeout","stall",n);const r=new Error(e||"throttling requests");throw ve(r,{stall:n,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return this.#r!=null}get request(){return this.#s}ok(){return this.#o.message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:n}=this.#o;e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let s=null;try{this.#r&&(s=lf(this.#r))}catch{}z(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:n,info:{requestUrl:r,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}}function rA(){return new Date().getTime()}function yY(t){return si(t.replace(/%([0-9a-f][0-9a-f])/gi,(e,n)=>String.fromCharCode(parseInt(n,16))))}function wY(t){return new Promise(e=>setTimeout(e,t))}const bY=BigInt(-1),Mr=BigInt(0),ec=BigInt(1),EY=BigInt(5),ja={};let ac="0000";for(;ac.length<80;)ac+=ac;function yo(t){let e=ac;for(;e.length<t;)e+=e;return BigInt("1"+e.substring(0,t))}function pl(t,e,n){const r=BigInt(e.width);if(e.signed){const s=ec<<r-ec;z(n==null||t>=-s&&t<s,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:t}),t>Mr?t=cf($o(t,r),r):t=-cf($o(-t,r),r)}else{const s=ec<<r;z(n==null||t>=0&&t<s,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:t}),t=(t%s+s)%s&s-ec}return t}function Lg(t){typeof t=="number"&&(t=`fixed128x${t}`);let e=!0,n=128,r=18;if(typeof t=="string"){if(t!=="fixed")if(t==="ufixed")e=!1;else{const i=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);D(i,"invalid fixed format","format",t),e=i[1]!=="u",n=parseInt(i[2]),r=parseInt(i[3])}}else if(t){const i=t,o=(a,c,l)=>i[a]==null?l:(D(typeof i[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,i[a]),i[a]);e=o("signed","boolean",e),n=o("width","number",n),r=o("decimals","number",r)}D(n%8===0,"invalid FixedNumber width (not byte aligned)","format.width",n),D(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);const s=(e?"":"u")+"fixed"+String(n)+"x"+String(r);return{signed:e,width:n,decimals:r,name:s}}function vY(t,e){let n="";t<Mr&&(n="-",t*=bY);let r=t.toString();if(e===0)return n+r;for(;r.length<=e;)r=ac+r;const s=r.length-e;for(r=r.substring(0,s)+"."+r.substring(s);r[0]==="0"&&r[1]!==".";)r=r.substring(1);for(;r[r.length-1]==="0"&&r[r.length-2]!==".";)r=r.substring(0,r.length-1);return n+r}class Gs{format;#e;#t;#n;_value;constructor(e,n,r){ld(e,ja,"FixedNumber"),this.#t=n,this.#e=r;const s=vY(n,r.decimals);ve(this,{format:r.name,_value:s}),this.#n=yo(r.decimals)}get signed(){return this.#e.signed}get width(){return this.#e.width}get decimals(){return this.#e.decimals}get value(){return this.#t}#r(e){D(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)}#s(e,n){return e=pl(e,this.#e,n),new Gs(ja,e,this.#e)}#o(e,n){return this.#r(e),this.#s(this.#t+e.#t,n)}addUnsafe(e){return this.#o(e)}add(e){return this.#o(e,"add")}#i(e,n){return this.#r(e),this.#s(this.#t-e.#t,n)}subUnsafe(e){return this.#i(e)}sub(e){return this.#i(e,"sub")}#a(e,n){return this.#r(e),this.#s(this.#t*e.#t/this.#n,n)}mulUnsafe(e){return this.#a(e)}mul(e){return this.#a(e,"mul")}mulSignal(e){this.#r(e);const n=this.#t*e.#t;return z(n%this.#n===Mr,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),this.#s(n/this.#n,"mulSignal")}#d(e,n){return z(e.#t!==Mr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#r(e),this.#s(this.#t*this.#n/e.#t,n)}divUnsafe(e){return this.#d(e)}div(e){return this.#d(e,"div")}divSignal(e){z(e.#t!==Mr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#r(e);const n=this.#t*this.#n;return z(n%e.#t===Mr,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),this.#s(n/e.#t,"divSignal")}cmp(e){let n=this.value,r=e.value;const s=this.decimals-e.decimals;return s>0?r*=yo(s):s<0&&(n*=yo(-s)),n<r?-1:n>r?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=this.#t;return this.#t<Mr&&(e-=this.#n-ec),e=this.#t/this.#n*this.#n,this.#s(e,"floor")}ceiling(){let e=this.#t;return this.#t>Mr&&(e+=this.#n-ec),e=this.#t/this.#n*this.#n,this.#s(e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const n=this.decimals-e,r=EY*yo(n-1);let s=this.value+r;const i=yo(n);return s=s/i*i,pl(s,this.#e,"round"),new Gs(ja,s,this.#e)}isZero(){return this.#t===Mr}isNegative(){return this.#t<Mr}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return Gs.fromString(this.toString(),e)}static fromValue(e,n,r){const s=n==null?0:xe(n),i=Lg(r);let o=de(e,"value");const a=s-i.decimals;if(a>0){const c=yo(a);z(o%c===Mr,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=yo(-a));return pl(o,i,"fromValue"),new Gs(ja,o,i)}static fromString(e,n){const r=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);D(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",e);const s=Lg(n);let i=r[2]||"0",o=r[3]||"";for(;o.length<s.decimals;)o+=ac;z(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const a=BigInt(r[1]+i+o);return pl(a,s,"fromString"),new Gs(ja,a,s)}static fromBytes(e,n){let r=rp(ke(e,"value"));const s=Lg(n);return s.signed&&(r=cf(r,s.width)),pl(r,s,"fromBytes"),new Gs(ja,r,s)}}function AY(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function sA(t,e,n){let r=0;for(let s=0;s<n;s++)r=r*256+t[e+s];return r}function iA(t,e,n,r){const s=[];for(;n<e+1+r;){const i=pS(t,n);s.push(i.result),n+=i.consumed,z(n<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:t,length:r,offset:e})}return{consumed:1+r,result:s}}function pS(t,e){z(t.length!==0,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const n=r=>{z(r<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:r})};if(t[e]>=248){const r=t[e]-247;n(e+1+r);const s=sA(t,e+1,r);return n(e+1+r+s),iA(t,e,e+1+r,r+s)}else if(t[e]>=192){const r=t[e]-192;return n(e+1+r),iA(t,e,e+1,r)}else if(t[e]>=184){const r=t[e]-183;n(e+1+r);const s=sA(t,e+1,r);n(e+1+r+s);const i=re(t.slice(e+1+r,e+1+r+s));return{consumed:1+r+s,result:i}}else if(t[e]>=128){const r=t[e]-128;n(e+1+r);const s=re(t.slice(e+1,e+1+r));return{consumed:1+r,result:s}}return{consumed:1,result:AY(t[e])}}function ud(t){const e=ke(t,"data"),n=pS(e,0);return D(n.consumed===e.length,"unexpected junk after rlp payload","data",t),n.result}function oA(t){const e=[];for(;t;)e.unshift(t&255),t>>=8;return e}function gS(t){if(Array.isArray(t)){let r=[];if(t.forEach(function(i){r=r.concat(gS(i))}),r.length<=55)return r.unshift(192+r.length),r;const s=oA(r.length);return s.unshift(247+s.length),s.concat(r)}const e=Array.prototype.slice.call(ke(t,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const n=oA(e.length);return n.unshift(183+n.length),n.concat(e)}const aA="0123456789abcdef";function oo(t){let e="0x";for(const n of gS(t))e+=aA[n>>4],e+=aA[n&15];return e}const CY=["wei","kwei","mwei","gwei","szabo","finney","ether"];function mS(t,e){let n=18;if(typeof e=="string"){const r=CY.indexOf(e);D(r>=0,"invalid unit","unit",e),n=3*r}else e!=null&&(n=xe(e,"unit"));return Gs.fromValue(t,n,{decimals:n,width:512}).toString()}function IY(t,e){D(typeof t=="string","value must be a string","value",t);let n=18;return n=xe(e,"unit"),Gs.fromString(t,{decimals:n,width:512}).value}function _Y(t){return mS(t,18)}function NY(t){return IY(t,18)}const An=32,N0=new Uint8Array(An),SY=["then"],Zd={},yS=new WeakMap;function _o(t){return yS.get(t)}function cA(t,e){yS.set(t,e)}function gl(t,e){const n=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw n.error=e,n}function S0(t,e,n){return t.indexOf(null)>=0?e.map((r,s)=>r instanceof Qs?S0(_o(r),r,n):r):t.reduce((r,s,i)=>{let o=e.getValue(s);return s in r||(n&&o instanceof Qs&&(o=S0(_o(o),o,n)),r[s]=o),r},{})}class Qs extends Array{#e;constructor(...e){const n=e[0];let r=e[1],s=(e[2]||[]).slice(),i=!0;n!==Zd&&(r=e,s=[],i=!1),super(r.length),r.forEach((c,l)=>{this[l]=c});const o=s.reduce((c,l)=>(typeof l=="string"&&c.set(l,(c.get(l)||0)+1),c),new Map);if(cA(this,Object.freeze(r.map((c,l)=>{const u=s[l];return u!=null&&o.get(u)===1?u:null}))),this.#e=[],this.#e==null&&this.#e,!i)return;Object.freeze(this);const a=new Proxy(this,{get:(c,l,u)=>{if(typeof l=="string"){if(l.match(/^[0-9]+$/)){const h=xe(l,"%index");if(h<0||h>=this.length)throw new RangeError("out of result range");const f=c[h];return f instanceof Error&&gl(`index ${h}`,f),f}if(SY.indexOf(l)>=0)return Reflect.get(c,l,u);const d=c[l];if(d instanceof Function)return function(...h){return d.apply(this===u?c:this,h)};if(!(l in c))return c.getValue.apply(this===u?c:this,[l])}return Reflect.get(c,l,u)}});return cA(a,_o(this)),a}toArray(e){const n=[];return this.forEach((r,s)=>{r instanceof Error&&gl(`index ${s}`,r),e&&r instanceof Qs&&(r=r.toArray(e)),n.push(r)}),n}toObject(e){const n=_o(this);return n.reduce((r,s,i)=>(z(s!=null,`value at index ${i} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),S0(n,this,e)),{})}slice(e,n){e==null&&(e=0),e<0&&(e+=this.length,e<0&&(e=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const r=_o(this),s=[],i=[];for(let o=e;o<n;o++)s.push(this[o]),i.push(r[o]);return new Qs(Zd,s,i)}filter(e,n){const r=_o(this),s=[],i=[];for(let o=0;o<this.length;o++){const a=this[o];a instanceof Error&&gl(`index ${o}`,a),e.call(n,a,o,this)&&(s.push(a),i.push(r[o]))}return new Qs(Zd,s,i)}map(e,n){const r=[];for(let s=0;s<this.length;s++){const i=this[s];i instanceof Error&&gl(`index ${s}`,i),r.push(e.call(n,i,s,this))}return r}getValue(e){const n=_o(this).indexOf(e);if(n===-1)return;const r=this[n];return r instanceof Error&&gl(`property ${JSON.stringify(e)}`,r.error),r}static fromItems(e,n){return new Qs(Zd,e,n)}}function lA(t){let e=jt(t);return z(e.length<=An,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:An,offset:e.length}),e.length!==An&&(e=vn(St([N0.slice(e.length%An),e]))),e}class pi{name;type;localName;dynamic;constructor(e,n,r,s){ve(this,{name:e,type:n,localName:r,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,n){D(!1,e,this.localName,n)}}class x0{#e;#t;constructor(){this.#e=[],this.#t=0}get data(){return St(this.#e)}get length(){return this.#t}#n(e){return this.#e.push(e),this.#t+=e.length,e.length}appendWriter(e){return this.#n(vn(e.data))}writeBytes(e){let n=vn(e);const r=n.length%An;return r&&(n=vn(St([n,N0.slice(r)]))),this.#n(n)}writeValue(e){return this.#n(lA(e))}writeUpdatableValue(){const e=this.#e.length;return this.#e.push(N0),this.#t+=An,n=>{this.#e[e]=lA(n)}}}class ow{allowLoose;#e;#t;#n;#r;#s;constructor(e,n,r){ve(this,{allowLoose:!!n}),this.#e=vn(e),this.#n=0,this.#r=null,this.#s=r??1024,this.#t=0}get data(){return re(this.#e)}get dataLength(){return this.#e.length}get consumed(){return this.#t}get bytes(){return new Uint8Array(this.#e)}#o(e){if(this.#r)return this.#r.#o(e);this.#n+=e,z(this.#s<1||this.#n<=this.#s*this.dataLength,`compressed ABI data exceeds inflation ratio of ${this.#s} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:vn(this.#e),offset:this.#t,length:e,info:{bytesRead:this.#n,dataLength:this.dataLength}})}#i(e,n,r){let s=Math.ceil(n/An)*An;return this.#t+s>this.#e.length&&(this.allowLoose&&r&&this.#t+n<=this.#e.length?s=n:z(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:vn(this.#e),length:this.#e.length,offset:this.#t+s})),this.#e.slice(this.#t,this.#t+s)}subReader(e){const n=new ow(this.#e.slice(this.#t+e),this.allowLoose,this.#s);return n.#r=this,n}readBytes(e,n){let r=this.#i(0,e,!!n);return this.#o(e),this.#t+=r.length,r.slice(0,e)}readValue(){return rp(this.readBytes(An))}readIndex(){return rY(this.readBytes(An))}}function uf(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function aw(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function xY(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");uf(t.outputLen),uf(t.blockLen)}function _c(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function wS(t,e){aw(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Mg=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const bS=t=>t instanceof Uint8Array,TY=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Fg=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),cs=(t,e)=>t<<32-e|t>>>e,PY=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!PY)throw new Error("Non little-endian hardware is not supported");function OY(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function sp(t){if(typeof t=="string"&&(t=OY(t)),!bS(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function RY(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;return t.forEach(r=>{if(!bS(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}class cw{clone(){return this._cloneInto()}}function lw(t){const e=r=>t().update(sp(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function kY(t=32){if(Mg&&typeof Mg.getRandomValues=="function")return Mg.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class ES extends cw{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,xY(e);const r=sp(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return _c(this),this.iHash.update(e),this}digestInto(e){_c(this),aw(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const vS=(t,e,n)=>new ES(t,e).update(n).digest();vS.create=(t,e)=>new ES(t,e);function DY(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}class AS extends cw{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Fg(this.buffer)}update(e){_c(this);const{view:n,buffer:r,blockLen:s}=this;e=sp(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Fg(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){_c(this),wS(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;DY(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Fg(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}}const UY=(t,e,n)=>t&e^~t&n,BY=(t,e,n)=>t&e^t&n^e&n,$Y=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xi=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ti=new Uint32Array(64);class LY extends AS{constructor(){super(64,32,8,!1),this.A=xi[0]|0,this.B=xi[1]|0,this.C=xi[2]|0,this.D=xi[3]|0,this.E=xi[4]|0,this.F=xi[5]|0,this.G=xi[6]|0,this.H=xi[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Ti[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=Ti[d-15],f=Ti[d-2],p=cs(h,7)^cs(h,18)^h>>>3,g=cs(f,17)^cs(f,19)^f>>>10;Ti[d]=g+Ti[d-7]+p+Ti[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=cs(a,6)^cs(a,11)^cs(a,25),f=u+h+UY(a,c,l)+$Y[d]+Ti[d]|0,g=(cs(r,2)^cs(r,13)^cs(r,22))+BY(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Ti.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const CS=lw(()=>new LY),Qd=BigInt(2**32-1),T0=BigInt(32);function IS(t,e=!1){return e?{h:Number(t&Qd),l:Number(t>>T0&Qd)}:{h:Number(t>>T0&Qd)|0,l:Number(t&Qd)|0}}function _S(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=IS(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const MY=(t,e)=>BigInt(t>>>0)<<T0|BigInt(e>>>0),FY=(t,e,n)=>t>>>n,jY=(t,e,n)=>t<<32-n|e>>>n,HY=(t,e,n)=>t>>>n|e<<32-n,zY=(t,e,n)=>t<<32-n|e>>>n,qY=(t,e,n)=>t<<64-n|e>>>n-32,WY=(t,e,n)=>t>>>n-32|e<<64-n,VY=(t,e)=>e,GY=(t,e)=>t,NS=(t,e,n)=>t<<n|e>>>32-n,SS=(t,e,n)=>e<<n|t>>>32-n,xS=(t,e,n)=>e<<n-32|t>>>64-n,TS=(t,e,n)=>t<<n-32|e>>>64-n;function KY(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const JY=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),YY=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,ZY=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),QY=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,XY=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),eZ=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Pe={fromBig:IS,split:_S,toBig:MY,shrSH:FY,shrSL:jY,rotrSH:HY,rotrSL:zY,rotrBH:qY,rotrBL:WY,rotr32H:VY,rotr32L:GY,rotlSH:NS,rotlSL:SS,rotlBH:xS,rotlBL:TS,add:KY,add3L:JY,add3H:YY,add4L:ZY,add4H:QY,add5H:eZ,add5L:XY},[tZ,nZ]=Pe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Pi=new Uint32Array(80),Oi=new Uint32Array(80);class rZ extends AS{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let w=0;w<16;w++,n+=4)Pi[w]=e.getUint32(n),Oi[w]=e.getUint32(n+=4);for(let w=16;w<80;w++){const N=Pi[w-15]|0,b=Oi[w-15]|0,E=Pe.rotrSH(N,b,1)^Pe.rotrSH(N,b,8)^Pe.shrSH(N,b,7),S=Pe.rotrSL(N,b,1)^Pe.rotrSL(N,b,8)^Pe.shrSL(N,b,7),x=Pi[w-2]|0,I=Oi[w-2]|0,O=Pe.rotrSH(x,I,19)^Pe.rotrBH(x,I,61)^Pe.shrSH(x,I,6),P=Pe.rotrSL(x,I,19)^Pe.rotrBL(x,I,61)^Pe.shrSL(x,I,6),k=Pe.add4L(S,P,Oi[w-7],Oi[w-16]),M=Pe.add4H(k,E,O,Pi[w-7],Pi[w-16]);Pi[w]=M|0,Oi[w]=k|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:y,Hl:v}=this;for(let w=0;w<80;w++){const N=Pe.rotrSH(d,h,14)^Pe.rotrSH(d,h,18)^Pe.rotrBH(d,h,41),b=Pe.rotrSL(d,h,14)^Pe.rotrSL(d,h,18)^Pe.rotrBL(d,h,41),E=d&f^~d&g,S=h&p^~h&m,x=Pe.add5L(v,b,S,nZ[w],Oi[w]),I=Pe.add5H(x,y,N,E,tZ[w],Pi[w]),O=x|0,P=Pe.rotrSH(r,s,28)^Pe.rotrBH(r,s,34)^Pe.rotrBH(r,s,39),k=Pe.rotrSL(r,s,28)^Pe.rotrBL(r,s,34)^Pe.rotrBL(r,s,39),M=r&i^r&a^i&a,$=s&o^s&c^o&c;y=g|0,v=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Pe.add(l|0,u|0,I|0,O|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const A=Pe.add3L(O,k,$);r=Pe.add3H(A,I,P,M),s=A|0}({h:r,l:s}=Pe.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Pe.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Pe.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Pe.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Pe.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Pe.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Pe.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:y,l:v}=Pe.add(this.Hh|0,this.Hl|0,y|0,v|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,g,m,y,v)}roundClean(){Pi.fill(0),Oi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const sZ=lw(()=>new rZ);function iZ(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const uA=iZ();uA.crypto||uA.msCrypto;function oZ(t){switch(t){case"sha256":return CS.create();case"sha512":return sZ.create()}D(!1,"invalid hashing algorithm name","algorithm",t)}const[PS,OS,RS]=[[],[],[]],aZ=BigInt(0),ml=BigInt(1),cZ=BigInt(2),lZ=BigInt(7),uZ=BigInt(256),dZ=BigInt(113);for(let t=0,e=ml,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],PS.push(2*(5*r+n)),OS.push((t+1)*(t+2)/2%64);let s=aZ;for(let i=0;i<7;i++)e=(e<<ml^(e>>lZ)*dZ)%uZ,e&cZ&&(s^=ml<<(ml<<BigInt(i))-ml);RS.push(s)}const[hZ,fZ]=_S(RS,!0),dA=(t,e,n)=>n>32?xS(t,e,n):NS(t,e,n),hA=(t,e,n)=>n>32?TS(t,e,n):SS(t,e,n);function pZ(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=dA(l,u,1)^n[a],h=hA(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=OS[o],c=dA(s,i,a),l=hA(s,i,a),u=PS[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=hZ[r],t[1]^=fZ[r]}n.fill(0)}class uw extends cw{constructor(e,n,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,uf(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=TY(this.state)}keccak(){pZ(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){_c(this);const{blockLen:n,state:r}=this;e=sp(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){_c(this,!1),aw(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return uf(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(wS(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new uw(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const gZ=(t,e,n)=>lw(()=>new uw(e,t,n)),mZ=gZ(1,136,256/8);let kS=!1;const DS=function(t){return mZ(t)};let US=DS;function Dt(t){const e=ke(t,"data");return re(US(e))}Dt._=DS;Dt.lock=function(){kS=!0};Dt.register=function(t){if(kS)throw new TypeError("keccak256 is locked");US=t};Object.freeze(Dt);const BS=function(t){return oZ("sha256").update(t).digest()};let $S=BS,LS=!1;function Vc(t){const e=ke(t,"data");return re($S(e))}Vc._=BS;Vc.lock=function(){LS=!0};Vc.register=function(t){if(LS)throw new Error("sha256 is locked");$S=t};Object.freeze(Vc);Object.freeze(Vc);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const MS=BigInt(0),ip=BigInt(1),yZ=BigInt(2),op=t=>t instanceof Uint8Array,wZ=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Nc(t){if(!op(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=wZ[t[n]];return e}function FS(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function dw(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function Sc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const s=r*2,i=t.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");n[r]=o}return n}function zo(t){return dw(Nc(t))}function hw(t){if(!op(t))throw new Error("Uint8Array expected");return dw(Nc(Uint8Array.from(t).reverse()))}function xc(t,e){return Sc(t.toString(16).padStart(e*2,"0"))}function fw(t,e){return xc(t,e).reverse()}function bZ(t){return Sc(FS(t))}function Fr(t,e,n){let r;if(typeof e=="string")try{r=Sc(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(op(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(`${t} expected ${n} bytes, got ${s}`);return r}function Bu(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;return t.forEach(r=>{if(!op(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function EZ(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function vZ(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function AZ(t){let e;for(e=0;t>MS;t>>=ip,e+=1);return e}function CZ(t,e){return t>>BigInt(e)&ip}const IZ=(t,e,n)=>t|(n?ip:MS)<<BigInt(e),pw=t=>(yZ<<BigInt(t-1))-ip,jg=t=>new Uint8Array(t),fA=t=>Uint8Array.from(t);function jS(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=jg(t),s=jg(t),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...d)=>n(s,r,...d),c=(d=jg())=>{s=a(fA([0]),d),r=a(),d.length!==0&&(s=a(fA([1]),d),r=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){r=a();const f=r.slice();h.push(f),d+=r.length}return Bu(...h)};return(d,h)=>{o(),c(d);let f;for(;!(f=h(l()));)c();return o(),f}}const _Z={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function dd(t,e,n={}){const r=(s,i,o)=>{const a=_Z[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}const NZ=Object.freeze(Object.defineProperty({__proto__:null,bitGet:CZ,bitLen:AZ,bitMask:pw,bitSet:IZ,bytesToHex:Nc,bytesToNumberBE:zo,bytesToNumberLE:hw,concatBytes:Bu,createHmacDrbg:jS,ensureBytes:Fr,equalBytes:EZ,hexToBytes:Sc,hexToNumber:dw,numberToBytesBE:xc,numberToBytesLE:fw,numberToHexUnpadded:FS,numberToVarBytesBE:bZ,utf8ToBytes:vZ,validateObject:dd},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Zt=BigInt(0),Pt=BigInt(1),No=BigInt(2),SZ=BigInt(3),P0=BigInt(4),pA=BigInt(5),gA=BigInt(8);BigInt(9);BigInt(16);function Fn(t,e){const n=t%e;return n>=Zt?n:e+n}function xZ(t,e,n){if(n<=Zt||e<Zt)throw new Error("Expected power/modulo > 0");if(n===Pt)return Zt;let r=Pt;for(;e>Zt;)e&Pt&&(r=r*t%n),t=t*t%n,e>>=Pt;return r}function fr(t,e,n){let r=t;for(;e-- >Zt;)r*=r,r%=n;return r}function O0(t,e){if(t===Zt||e<=Zt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=Fn(t,e),r=e,s=Zt,i=Pt;for(;n!==Zt;){const a=r/n,c=r%n,l=s-i*a;r=n,n=c,s=i,i=l}if(r!==Pt)throw new Error("invert: does not exist");return Fn(s,e)}function TZ(t){const e=(t-Pt)/No;let n,r,s;for(n=t-Pt,r=0;n%No===Zt;n/=No,r++);for(s=No;s<t&&xZ(s,e,t)!==t-Pt;s++);if(r===1){const o=(t+Pt)/P0;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(n+Pt)/No;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=r,u=a.pow(a.mul(a.ONE,s),n),d=a.pow(c,i),h=a.pow(c,n);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let f=1;for(let g=a.sqr(h);f<l&&!a.eql(g,a.ONE);f++)g=a.sqr(g);const p=a.pow(u,Pt<<BigInt(l-f-1));u=a.sqr(p),d=a.mul(d,p),h=a.mul(h,u),l=f}return d}}function PZ(t){if(t%P0===SZ){const e=(t+Pt)/P0;return function(r,s){const i=r.pow(s,e);if(!r.eql(r.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%gA===pA){const e=(t-pA)/gA;return function(r,s){const i=r.mul(s,No),o=r.pow(i,e),a=r.mul(s,o),c=r.mul(r.mul(a,No),o),l=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(l),s))throw new Error("Cannot find square root");return l}}return TZ(t)}const OZ=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function RZ(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=OZ.reduce((r,s)=>(r[s]="function",r),e);return dd(t,n)}function kZ(t,e,n){if(n<Zt)throw new Error("Expected power > 0");if(n===Zt)return t.ONE;if(n===Pt)return e;let r=t.ONE,s=e;for(;n>Zt;)n&Pt&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Pt;return r}function DZ(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function HS(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function UZ(t,e,n=!1,r={}){if(t<=Zt)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:i}=HS(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=PZ(t),a=Object.freeze({ORDER:t,BITS:s,BYTES:i,MASK:pw(s),ZERO:Zt,ONE:Pt,create:c=>Fn(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Zt<=c&&c<t},is0:c=>c===Zt,isOdd:c=>(c&Pt)===Pt,neg:c=>Fn(-c,t),eql:(c,l)=>c===l,sqr:c=>Fn(c*c,t),add:(c,l)=>Fn(c+l,t),sub:(c,l)=>Fn(c-l,t),mul:(c,l)=>Fn(c*l,t),pow:(c,l)=>kZ(a,c,l),div:(c,l)=>Fn(c*O0(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>O0(c,t),sqrt:r.sqrt||(c=>o(a,c)),invertBatch:c=>DZ(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?fw(c,i):xc(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return n?hw(c):zo(c)}});return Object.freeze(a)}function zS(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function qS(t){const e=zS(t);return e+Math.ceil(e/2)}function BZ(t,e,n=!1){const r=t.length,s=zS(e),i=qS(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const o=n?zo(t):hw(t),a=Fn(o,e-Pt)+Pt;return n?fw(a,s):xc(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $Z=BigInt(0),Hg=BigInt(1);function LZ(t,e){const n=(s,i)=>{const o=i.negate();return s?o:i},r=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:n,unsafeLadder(s,i){let o=t.ZERO,a=s;for(;i>$Z;)i&Hg&&(o=o.add(a)),a=a.double(),i>>=Hg;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=r(i),c=[];let l=s,u=l;for(let d=0;d<o;d++){u=l,c.push(u);for(let h=1;h<a;h++)u=u.add(l),c.push(u);l=u.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=r(s);let l=t.ZERO,u=t.BASE;const d=BigInt(2**s-1),h=2**s,f=BigInt(s);for(let p=0;p<a;p++){const g=p*c;let m=Number(o&d);o>>=f,m>c&&(m-=h,o+=Hg);const y=g,v=g+Math.abs(m)-1,w=p%2!==0,N=m<0;m===0?u=u.add(n(w,i[y])):l=l.add(n(N,i[v]))}return{p:l,f:u}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,c),c!==1&&i.set(s,a(l))),this.wNAF(c,l,o)}}}function WS(t){return RZ(t.Fp),dd(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...HS(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function MZ(t){const e=WS(t);dd(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:FZ,hexToBytes:jZ}=NZ,Lo={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=Lo;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:FZ(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=Lo,n=typeof t=="string"?jZ(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=Lo._parseInt(n.subarray(2)),{d:o,l:a}=Lo._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(t){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,n=l=>{const u=l.toString(16);return u.length&1?`0${u}`:u},r=e(n(t.s)),s=e(n(t.r)),i=r.length/2,o=s.length/2,a=n(i),c=n(o);return`30${n(o+i+4)}02${c}${s}02${a}${r}`}},Js=BigInt(0),yr=BigInt(1);BigInt(2);const mA=BigInt(3);BigInt(4);function HZ(t){const e=MZ(t),{Fp:n}=e,r=e.toBytes||((p,g,m)=>{const y=g.toAffine();return Bu(Uint8Array.from([4]),n.toBytes(y.x),n.toBytes(y.y))}),s=e.fromBytes||(p=>{const g=p.subarray(1),m=n.fromBytes(g.subarray(0,n.BYTES)),y=n.fromBytes(g.subarray(n.BYTES,2*n.BYTES));return{x:m,y}});function i(p){const{a:g,b:m}=e,y=n.sqr(p),v=n.mul(y,p);return n.add(n.add(v,n.mul(p,g)),m)}if(!n.eql(n.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&Js<p&&p<e.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(p){const{allowedPrivateKeyLengths:g,nByteLength:m,wrapPrivateKey:y,n:v}=e;if(g&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=Nc(p)),typeof p!="string"||!g.includes(p.length))throw new Error("Invalid key");p=p.padStart(m*2,"0")}let w;try{w=typeof p=="bigint"?p:zo(Fr("private key",p,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof p}`)}return y&&(w=Fn(w,v)),a(w),w}const l=new Map;function u(p){if(!(p instanceof d))throw new Error("ProjectivePoint expected")}class d{constructor(g,m,y){if(this.px=g,this.py=m,this.pz=y,g==null||!n.isValid(g))throw new Error("x required");if(m==null||!n.isValid(m))throw new Error("y required");if(y==null||!n.isValid(y))throw new Error("z required")}static fromAffine(g){const{x:m,y}=g||{};if(!g||!n.isValid(m)||!n.isValid(y))throw new Error("invalid affine point");if(g instanceof d)throw new Error("projective point not allowed");const v=w=>n.eql(w,n.ZERO);return v(m)&&v(y)?d.ZERO:new d(m,y,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const m=n.invertBatch(g.map(y=>y.pz));return g.map((y,v)=>y.toAffine(m[v])).map(d.fromAffine)}static fromHex(g){const m=d.fromAffine(s(Fr("pointHex",g)));return m.assertValidity(),m}static fromPrivateKey(g){return d.BASE.multiply(c(g))}_setWindowSize(g){this._WINDOW_SIZE=g,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:g,y:m}=this.toAffine();if(!n.isValid(g)||!n.isValid(m))throw new Error("bad point: x or y not FE");const y=n.sqr(m),v=i(g);if(!n.eql(y,v))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:g}=this.toAffine();if(n.isOdd)return!n.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){u(g);const{px:m,py:y,pz:v}=this,{px:w,py:N,pz:b}=g,E=n.eql(n.mul(m,b),n.mul(w,v)),S=n.eql(n.mul(y,b),n.mul(N,v));return E&&S}negate(){return new d(this.px,n.neg(this.py),this.pz)}double(){const{a:g,b:m}=e,y=n.mul(m,mA),{px:v,py:w,pz:N}=this;let b=n.ZERO,E=n.ZERO,S=n.ZERO,x=n.mul(v,v),I=n.mul(w,w),O=n.mul(N,N),P=n.mul(v,w);return P=n.add(P,P),S=n.mul(v,N),S=n.add(S,S),b=n.mul(g,S),E=n.mul(y,O),E=n.add(b,E),b=n.sub(I,E),E=n.add(I,E),E=n.mul(b,E),b=n.mul(P,b),S=n.mul(y,S),O=n.mul(g,O),P=n.sub(x,O),P=n.mul(g,P),P=n.add(P,S),S=n.add(x,x),x=n.add(S,x),x=n.add(x,O),x=n.mul(x,P),E=n.add(E,x),O=n.mul(w,N),O=n.add(O,O),x=n.mul(O,P),b=n.sub(b,x),S=n.mul(O,I),S=n.add(S,S),S=n.add(S,S),new d(b,E,S)}add(g){u(g);const{px:m,py:y,pz:v}=this,{px:w,py:N,pz:b}=g;let E=n.ZERO,S=n.ZERO,x=n.ZERO;const I=e.a,O=n.mul(e.b,mA);let P=n.mul(m,w),k=n.mul(y,N),M=n.mul(v,b),$=n.add(m,y),A=n.add(w,N);$=n.mul($,A),A=n.add(P,k),$=n.sub($,A),A=n.add(m,v);let _=n.add(w,b);return A=n.mul(A,_),_=n.add(P,M),A=n.sub(A,_),_=n.add(y,v),E=n.add(N,b),_=n.mul(_,E),E=n.add(k,M),_=n.sub(_,E),x=n.mul(I,A),E=n.mul(O,M),x=n.add(E,x),E=n.sub(k,x),x=n.add(k,x),S=n.mul(E,x),k=n.add(P,P),k=n.add(k,P),M=n.mul(I,M),A=n.mul(O,A),k=n.add(k,M),M=n.sub(P,M),M=n.mul(I,M),A=n.add(A,M),P=n.mul(k,A),S=n.add(S,P),P=n.mul(_,A),E=n.mul($,E),E=n.sub(E,P),P=n.mul($,k),x=n.mul(_,x),x=n.add(x,P),new d(E,S,x)}subtract(g){return this.add(g.negate())}is0(){return this.equals(d.ZERO)}wNAF(g){return f.wNAFCached(this,l,g,m=>{const y=n.invertBatch(m.map(v=>v.pz));return m.map((v,w)=>v.toAffine(y[w])).map(d.fromAffine)})}multiplyUnsafe(g){const m=d.ZERO;if(g===Js)return m;if(a(g),g===yr)return this;const{endo:y}=e;if(!y)return f.unsafeLadder(this,g);let{k1neg:v,k1:w,k2neg:N,k2:b}=y.splitScalar(g),E=m,S=m,x=this;for(;w>Js||b>Js;)w&yr&&(E=E.add(x)),b&yr&&(S=S.add(x)),x=x.double(),w>>=yr,b>>=yr;return v&&(E=E.negate()),N&&(S=S.negate()),S=new d(n.mul(S.px,y.beta),S.py,S.pz),E.add(S)}multiply(g){a(g);let m=g,y,v;const{endo:w}=e;if(w){const{k1neg:N,k1:b,k2neg:E,k2:S}=w.splitScalar(m);let{p:x,f:I}=this.wNAF(b),{p:O,f:P}=this.wNAF(S);x=f.constTimeNegate(N,x),O=f.constTimeNegate(E,O),O=new d(n.mul(O.px,w.beta),O.py,O.pz),y=x.add(O),v=I.add(P)}else{const{p:N,f:b}=this.wNAF(m);y=N,v=b}return d.normalizeZ([y,v])[0]}multiplyAndAddUnsafe(g,m,y){const v=d.BASE,w=(b,E)=>E===Js||E===yr||!b.equals(v)?b.multiplyUnsafe(E):b.multiply(E),N=w(this,m).add(w(g,y));return N.is0()?void 0:N}toAffine(g){const{px:m,py:y,pz:v}=this,w=this.is0();g==null&&(g=w?n.ONE:n.inv(v));const N=n.mul(m,g),b=n.mul(y,g),E=n.mul(v,g);if(w)return{x:n.ZERO,y:n.ZERO};if(!n.eql(E,n.ONE))throw new Error("invZ was invalid");return{x:N,y:b}}isTorsionFree(){const{h:g,isTorsionFree:m}=e;if(g===yr)return!0;if(m)return m(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:m}=e;return g===yr?this:m?m(d,this):this.multiplyUnsafe(e.h)}toRawBytes(g=!0){return this.assertValidity(),r(d,this,g)}toHex(g=!0){return Nc(this.toRawBytes(g))}}d.BASE=new d(e.Gx,e.Gy,n.ONE),d.ZERO=new d(n.ZERO,n.ONE,n.ZERO);const h=e.nBitLength,f=LZ(d,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function zZ(t){const e=WS(t);return dd(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function qZ(t){const e=zZ(t),{Fp:n,n:r}=e,s=n.BYTES+1,i=2*n.BYTES+1;function o(A){return Js<A&&A<n.ORDER}function a(A){return Fn(A,r)}function c(A){return O0(A,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:d,isWithinCurveOrder:h}=HZ({...e,toBytes(A,_,R){const B=_.toAffine(),U=n.toBytes(B.x),L=Bu;return R?L(Uint8Array.from([_.hasEvenY()?2:3]),U):L(Uint8Array.from([4]),U,n.toBytes(B.y))},fromBytes(A){const _=A.length,R=A[0],B=A.subarray(1);if(_===s&&(R===2||R===3)){const U=zo(B);if(!o(U))throw new Error("Point is not on curve");const L=d(U);let j=n.sqrt(L);const q=(j&yr)===yr;return(R&1)===1!==q&&(j=n.neg(j)),{x:U,y:j}}else if(_===i&&R===4){const U=n.fromBytes(B.subarray(0,n.BYTES)),L=n.fromBytes(B.subarray(n.BYTES,2*n.BYTES));return{x:U,y:L}}else throw new Error(`Point of length ${_} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),f=A=>Nc(xc(A,e.nByteLength));function p(A){const _=r>>yr;return A>_}function g(A){return p(A)?a(-A):A}const m=(A,_,R)=>zo(A.slice(_,R));class y{constructor(_,R,B){this.r=_,this.s=R,this.recovery=B,this.assertValidity()}static fromCompact(_){const R=e.nByteLength;return _=Fr("compactSignature",_,R*2),new y(m(_,0,R),m(_,R,2*R))}static fromDER(_){const{r:R,s:B}=Lo.toSig(Fr("DER",_));return new y(R,B)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(_){return new y(this.r,this.s,_)}recoverPublicKey(_){const{r:R,s:B,recovery:U}=this,L=S(Fr("msgHash",_));if(U==null||![0,1,2,3].includes(U))throw new Error("recovery id invalid");const j=U===2||U===3?R+e.n:R;if(j>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const q=(U&1)===0?"02":"03",X=l.fromHex(q+f(j)),K=c(j),se=a(-L*K),ge=a(B*K),Re=l.BASE.multiplyAndAddUnsafe(X,se,ge);if(!Re)throw new Error("point at infinify");return Re.assertValidity(),Re}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Sc(this.toDERHex())}toDERHex(){return Lo.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Sc(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const v={isValidPrivateKey(A){try{return u(A),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const A=qS(e.n);return BZ(e.randomBytes(A),e.n)},precompute(A=8,_=l.BASE){return _._setWindowSize(A),_.multiply(BigInt(3)),_}};function w(A,_=!0){return l.fromPrivateKey(A).toRawBytes(_)}function N(A){const _=A instanceof Uint8Array,R=typeof A=="string",B=(_||R)&&A.length;return _?B===s||B===i:R?B===2*s||B===2*i:A instanceof l}function b(A,_,R=!0){if(N(A))throw new Error("first arg must be private key");if(!N(_))throw new Error("second arg must be public key");return l.fromHex(_).multiply(u(A)).toRawBytes(R)}const E=e.bits2int||function(A){const _=zo(A),R=A.length*8-e.nBitLength;return R>0?_>>BigInt(R):_},S=e.bits2int_modN||function(A){return a(E(A))},x=pw(e.nBitLength);function I(A){if(typeof A!="bigint")throw new Error("bigint expected");if(!(Js<=A&&A<x))throw new Error(`bigint expected < 2^${e.nBitLength}`);return xc(A,e.nByteLength)}function O(A,_,R=P){if(["recovered","canonical"].some(Ie=>Ie in R))throw new Error("sign() legacy options not supported");const{hash:B,randomBytes:U}=e;let{lowS:L,prehash:j,extraEntropy:q}=R;L==null&&(L=!0),A=Fr("msgHash",A),j&&(A=Fr("prehashed msgHash",B(A)));const X=S(A),K=u(_),se=[I(K),I(X)];if(q!=null){const Ie=q===!0?U(n.BYTES):q;se.push(Fr("extraEntropy",Ie))}const ge=Bu(...se),Re=X;function Ue(Ie){const nt=E(Ie);if(!h(nt))return;const Ot=c(nt),zt=l.BASE.multiply(nt).toAffine(),Or=a(zt.x);if(Or===Js)return;const Rr=a(Ot*a(Re+Or*K));if(Rr===Js)return;let ba=(zt.x===Or?0:2)|Number(zt.y&yr),md=Rr;return L&&p(Rr)&&(md=g(Rr),ba^=1),new y(Or,md,ba)}return{seed:ge,k2sig:Ue}}const P={lowS:e.lowS,prehash:!1},k={lowS:e.lowS,prehash:!1};function M(A,_,R=P){const{seed:B,k2sig:U}=O(A,_,R),L=e;return jS(L.hash.outputLen,L.nByteLength,L.hmac)(B,U)}l.BASE._setWindowSize(8);function $(A,_,R,B=k){const U=A;if(_=Fr("msgHash",_),R=Fr("publicKey",R),"strict"in B)throw new Error("options.strict was renamed to lowS");const{lowS:L,prehash:j}=B;let q,X;try{if(typeof U=="string"||U instanceof Uint8Array)try{q=y.fromDER(U)}catch(zt){if(!(zt instanceof Lo.Err))throw zt;q=y.fromCompact(U)}else if(typeof U=="object"&&typeof U.r=="bigint"&&typeof U.s=="bigint"){const{r:zt,s:Or}=U;q=new y(zt,Or)}else throw new Error("PARSE");X=l.fromHex(R)}catch(zt){if(zt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(L&&q.hasHighS())return!1;j&&(_=e.hash(_));const{r:K,s:se}=q,ge=S(_),Re=c(se),Ue=a(ge*Re),Ie=a(K*Re),nt=l.BASE.multiplyAndAddUnsafe(X,Ue,Ie)?.toAffine();return nt?a(nt.x)===K:!1}return{CURVE:e,getPublicKey:w,getSharedSecret:b,sign:M,verify:$,ProjectivePoint:l,Signature:y,utils:v}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function WZ(t){return{hash:t,hmac:(e,...n)=>vS(t,e,RY(...n)),randomBytes:kY}}function VZ(t,e){const n=r=>qZ({...t,...WZ(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const VS=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),yA=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),GZ=BigInt(1),R0=BigInt(2),wA=(t,e)=>(t+e/R0)/e;function KZ(t){const e=VS,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,d=fr(u,n,e)*u%e,h=fr(d,n,e)*u%e,f=fr(h,R0,e)*l%e,p=fr(f,s,e)*f%e,g=fr(p,i,e)*p%e,m=fr(g,a,e)*g%e,y=fr(m,c,e)*m%e,v=fr(y,a,e)*g%e,w=fr(v,n,e)*u%e,N=fr(w,o,e)*p%e,b=fr(N,r,e)*l%e,E=fr(b,R0,e);if(!k0.eql(k0.sqr(E),t))throw new Error("Cannot find square root");return E}const k0=UZ(VS,void 0,void 0,{sqrt:KZ}),Ri=VZ({a:BigInt(0),b:BigInt(7),Fp:k0,n:yA,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=yA,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-GZ*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=wA(i*t,e),c=wA(-r*t,e);let l=Fn(t-a*n-c*s,e),u=Fn(-a*r-c*i,e);const d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},CS);BigInt(0);Ri.ProjectivePoint;const $u="0x0000000000000000000000000000000000000000",bA="0x0000000000000000000000000000000000000000000000000000000000000000",EA=BigInt(0),vA=BigInt(1),AA=BigInt(2),CA=BigInt(27),IA=BigInt(28),Xd=BigInt(35),Ha={};function _A(t){return ui(jt(t),32)}class _t{#e;#t;#n;#r;get r(){return this.#e}set r(e){D(oc(e)===32,"invalid r","value",e),this.#e=re(e)}get s(){return D(parseInt(this.#t.substring(0,3))<8,"non-canonical s; use ._s","s",this.#t),this.#t}set s(e){D(oc(e)===32,"invalid s","value",e),this.#t=re(e)}get _s(){return this.#t}isValid(){return parseInt(this.#t.substring(0,3))<8}get v(){return this.#n}set v(e){const n=xe(e,"value");D(n===27||n===28,"invalid v","v",e),this.#n=n}get networkV(){return this.#r}get legacyChainId(){const e=this.networkV;return e==null?null:_t.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=ke(this.s);return this.yParity&&(e[0]|=128),re(e)}get compactSerialized(){return St([this.r,this.yParityAndS])}get serialized(){return St([this.r,this.s,this.yParity?"0x1c":"0x1b"])}constructor(e,n,r,s){ld(e,Ha,"Signature"),this.#e=n,this.#t=r,this.#n=s,this.#r=null}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new _t(Ha,this.r,this._s,this.v);return this.networkV&&(e.#r=this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const n=de(e,"v");return n==CA||n==IA?EA:(D(n>=Xd,"invalid EIP-155 v","v",e),(n-Xd)/AA)}static getChainIdV(e,n){return de(e)*AA+BigInt(35+n-27)}static getNormalizedV(e){const n=de(e);return n===EA||n===CA?27:n===vA||n===IA?28:(D(n>=Xd,"invalid v","v",e),n&vA?27:28)}static from(e){function n(l,u){D(l,u,"signature",e)}if(e==null)return new _t(Ha,bA,bA,27);if(typeof e=="string"){const l=ke(e,"signature");if(l.length===64){const u=re(l.slice(0,32)),d=l.slice(32,64),h=d[0]&128?28:27;return d[0]&=127,new _t(Ha,u,re(d),h)}if(l.length===65){const u=re(l.slice(0,32)),d=re(l.slice(32,64)),h=_t.getNormalizedV(l[64]);return new _t(Ha,u,d,h)}n(!1,"invalid raw signature length")}if(e instanceof _t)return e.clone();const r=e.r;n(r!=null,"missing r");const s=_A(r),i=function(l,u){if(l!=null)return _A(l);if(u!=null){n(dt(u,32),"invalid yParityAndS");const d=ke(u);return d[0]&=127,re(d)}n(!1,"missing s")}(e.s,e.yParityAndS),{networkV:o,v:a}=function(l,u,d){if(l!=null){const h=de(l);return{networkV:h>=Xd?h:void 0,v:_t.getNormalizedV(h)}}if(u!=null)return n(dt(u,32),"invalid yParityAndS"),{v:ke(u)[0]&128?28:27};if(d!=null){switch(xe(d,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}n(!1,"invalid yParity")}n(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new _t(Ha,s,i,a);return o&&(c.#r=o),n(e.yParity==null||xe(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),n(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}}class Ys{#e;constructor(e){D(oc(e)===32,"invalid private key","privateKey","[REDACTED]"),this.#e=re(e)}get privateKey(){return this.#e}get publicKey(){return Ys.computePublicKey(this.#e)}get compressedPublicKey(){return Ys.computePublicKey(this.#e,!0)}sign(e){D(oc(e)===32,"invalid digest length","digest",e);const n=Ri.sign(vn(e),vn(this.#e),{lowS:!0});return _t.from({r:io(n.r,32),s:io(n.s,32),v:n.recovery?28:27})}computeSharedSecret(e){const n=Ys.computePublicKey(e);return re(Ri.getSharedSecret(vn(this.#e),ke(n),!1))}static computePublicKey(e,n){let r=ke(e,"key");if(r.length===32){const i=Ri.getPublicKey(r,!!n);return re(i)}if(r.length===64){const i=new Uint8Array(65);i[0]=4,i.set(r,1),r=i}const s=Ri.ProjectivePoint.fromHex(r);return re(s.toRawBytes(n))}static recoverPublicKey(e,n){D(oc(e)===32,"invalid digest length","digest",e);const r=_t.from(n);let s=Ri.Signature.fromCompact(vn(St([r.r,r.s])));s=s.addRecoveryBit(r.yParity);const i=s.recoverPublicKey(vn(e));return D(i!=null,"invalid signature for digest","signature",n),"0x"+i.toHex(!1)}static addPoints(e,n,r){const s=Ri.ProjectivePoint.fromHex(Ys.computePublicKey(e).substring(2)),i=Ri.ProjectivePoint.fromHex(Ys.computePublicKey(n).substring(2));return"0x"+s.add(i).toHex(!!r)}}const JZ=BigInt(0),YZ=BigInt(36);function NA(t){t=t.toLowerCase();const e=t.substring(2).split(""),n=new Uint8Array(40);for(let s=0;s<40;s++)n[s]=e[s].charCodeAt(0);const r=ke(Dt(n));for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(r[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const gw={};for(let t=0;t<10;t++)gw[String(t)]=String(t);for(let t=0;t<26;t++)gw[String.fromCharCode(65+t)]=String(10+t);const SA=15;function ZZ(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(r=>gw[r]).join("");for(;e.length>=SA;){let r=e.substring(0,SA);e=parseInt(r,10)%97+e.substring(r.length)}let n=String(98-parseInt(e,10)%97);for(;n.length<2;)n="0"+n;return n}const QZ=function(){const t={};for(let e=0;e<36;e++){const n="0123456789abcdefghijklmnopqrstuvwxyz"[e];t[n]=BigInt(e)}return t}();function XZ(t){t=t.toLowerCase();let e=JZ;for(let n=0;n<t.length;n++)e=e*YZ+QZ[t[n]];return e}function Qe(t){if(D(typeof t=="string","invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=NA(t);return D(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){D(t.substring(2,4)===ZZ(t),"bad icap checksum","address",t);let e=XZ(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return NA("0x"+e)}D(!1,"invalid address","address",t)}function eQ(t){const e=Qe(t.from);let r=de(t.nonce,"tx.nonce").toString(16);return r==="0"?r="0x":r.length%2?r="0x0"+r:r="0x"+r,Qe(It(Dt(oo([e,r])),12))}function GS(t){return t&&typeof t.getAddress=="function"}async function zg(t,e){const n=await e;return(n==null||n==="0x0000000000000000000000000000000000000000")&&(z(typeof t!="string","unconfigured name","UNCONFIGURED_NAME",{value:t}),D(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),Qe(n)}function Cn(t,e){if(typeof t=="string")return t.match(/^0x[0-9a-f]{40}$/i)?Qe(t):(z(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),zg(t,e.resolveName(t)));if(GS(t))return zg(t,t.getAddress());if(t&&typeof t.then=="function")return zg(t,t);D(!1,"unsupported addressable value","target",t)}const qs={};function ue(t,e){let n=!1;return e<0&&(n=!0,e*=-1),new Nt(qs,`${n?"":"u"}int${e}`,t,{signed:n,width:e})}function Ve(t,e){return new Nt(qs,`bytes${e||""}`,t,{size:e})}const xA=Symbol.for("_ethers_typed");class Nt{type;value;#e;_typedSymbol;constructor(e,n,r,s){s==null&&(s=null),ld(qs,e,"Typed"),ve(this,{_typedSymbol:xA,type:n,value:r}),this.#e=s,this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return this.#e}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return this.#e===!0?-1:this.#e===!1?this.value.length:null}static from(e,n){return new Nt(qs,e,n)}static uint8(e){return ue(e,8)}static uint16(e){return ue(e,16)}static uint24(e){return ue(e,24)}static uint32(e){return ue(e,32)}static uint40(e){return ue(e,40)}static uint48(e){return ue(e,48)}static uint56(e){return ue(e,56)}static uint64(e){return ue(e,64)}static uint72(e){return ue(e,72)}static uint80(e){return ue(e,80)}static uint88(e){return ue(e,88)}static uint96(e){return ue(e,96)}static uint104(e){return ue(e,104)}static uint112(e){return ue(e,112)}static uint120(e){return ue(e,120)}static uint128(e){return ue(e,128)}static uint136(e){return ue(e,136)}static uint144(e){return ue(e,144)}static uint152(e){return ue(e,152)}static uint160(e){return ue(e,160)}static uint168(e){return ue(e,168)}static uint176(e){return ue(e,176)}static uint184(e){return ue(e,184)}static uint192(e){return ue(e,192)}static uint200(e){return ue(e,200)}static uint208(e){return ue(e,208)}static uint216(e){return ue(e,216)}static uint224(e){return ue(e,224)}static uint232(e){return ue(e,232)}static uint240(e){return ue(e,240)}static uint248(e){return ue(e,248)}static uint256(e){return ue(e,256)}static uint(e){return ue(e,256)}static int8(e){return ue(e,-8)}static int16(e){return ue(e,-16)}static int24(e){return ue(e,-24)}static int32(e){return ue(e,-32)}static int40(e){return ue(e,-40)}static int48(e){return ue(e,-48)}static int56(e){return ue(e,-56)}static int64(e){return ue(e,-64)}static int72(e){return ue(e,-72)}static int80(e){return ue(e,-80)}static int88(e){return ue(e,-88)}static int96(e){return ue(e,-96)}static int104(e){return ue(e,-104)}static int112(e){return ue(e,-112)}static int120(e){return ue(e,-120)}static int128(e){return ue(e,-128)}static int136(e){return ue(e,-136)}static int144(e){return ue(e,-144)}static int152(e){return ue(e,-152)}static int160(e){return ue(e,-160)}static int168(e){return ue(e,-168)}static int176(e){return ue(e,-176)}static int184(e){return ue(e,-184)}static int192(e){return ue(e,-192)}static int200(e){return ue(e,-200)}static int208(e){return ue(e,-208)}static int216(e){return ue(e,-216)}static int224(e){return ue(e,-224)}static int232(e){return ue(e,-232)}static int240(e){return ue(e,-240)}static int248(e){return ue(e,-248)}static int256(e){return ue(e,-256)}static int(e){return ue(e,-256)}static bytes1(e){return Ve(e,1)}static bytes2(e){return Ve(e,2)}static bytes3(e){return Ve(e,3)}static bytes4(e){return Ve(e,4)}static bytes5(e){return Ve(e,5)}static bytes6(e){return Ve(e,6)}static bytes7(e){return Ve(e,7)}static bytes8(e){return Ve(e,8)}static bytes9(e){return Ve(e,9)}static bytes10(e){return Ve(e,10)}static bytes11(e){return Ve(e,11)}static bytes12(e){return Ve(e,12)}static bytes13(e){return Ve(e,13)}static bytes14(e){return Ve(e,14)}static bytes15(e){return Ve(e,15)}static bytes16(e){return Ve(e,16)}static bytes17(e){return Ve(e,17)}static bytes18(e){return Ve(e,18)}static bytes19(e){return Ve(e,19)}static bytes20(e){return Ve(e,20)}static bytes21(e){return Ve(e,21)}static bytes22(e){return Ve(e,22)}static bytes23(e){return Ve(e,23)}static bytes24(e){return Ve(e,24)}static bytes25(e){return Ve(e,25)}static bytes26(e){return Ve(e,26)}static bytes27(e){return Ve(e,27)}static bytes28(e){return Ve(e,28)}static bytes29(e){return Ve(e,29)}static bytes30(e){return Ve(e,30)}static bytes31(e){return Ve(e,31)}static bytes32(e){return Ve(e,32)}static address(e){return new Nt(qs,"address",e)}static bool(e){return new Nt(qs,"bool",!!e)}static bytes(e){return new Nt(qs,"bytes",e)}static string(e){return new Nt(qs,"string",e)}static array(e,n){throw new Error("not implemented yet")}static tuple(e,n){throw new Error("not implemented yet")}static overrides(e){return new Nt(qs,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===xA}static dereference(e,n){if(Nt.isTyped(e)){if(e.type!==n)throw new Error(`invalid type: expecetd ${n}, got ${e.type}`);return e.value}return e}}class tQ extends pi{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,n){let r=Nt.dereference(n,"string");try{r=Qe(r)}catch(s){return this._throwError(s.message,n)}return e.writeValue(r)}decode(e){return Qe(io(e.readValue(),20))}}class nQ extends pi{coder;constructor(e){super(e.name,e.type,"_",e.dynamic),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,n){return this.coder.encode(e,n)}decode(e){return this.coder.decode(e)}}function KS(t,e,n){let r=[];if(Array.isArray(n))r=n;else if(n&&typeof n=="object"){let c={};r=e.map(l=>{const u=l.localName;return z(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:n}),z(!c[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:n}),c[u]=!0,n[u]})}else D(!1,"invalid tuple value","tuple",n);D(e.length===r.length,"types/value length mismatch","tuple",n);let s=new x0,i=new x0,o=[];e.forEach((c,l)=>{let u=r[l];if(c.dynamic){let d=i.length;c.encode(i,u);let h=s.writeUpdatableValue();o.push(f=>{h(f+d)})}else c.encode(s,u)}),o.forEach(c=>{c(s.length)});let a=t.appendWriter(s);return a+=t.appendWriter(i),a}function JS(t,e){let n=[],r=[],s=t.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=t.readIndex(),c=s.subReader(a);try{o=i.decode(c)}catch(l){if(an(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(t)}catch(a){if(an(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");n.push(o),r.push(i.localName||null)}),Qs.fromItems(n,r)}class rQ extends pi{coder;length;constructor(e,n,r){const s=e.type+"["+(n>=0?n:"")+"]",i=n===-1||e.dynamic;super("array",s,r,i),ve(this,{coder:e,length:n})}defaultValue(){const e=this.coder.defaultValue(),n=[];for(let r=0;r<this.length;r++)n.push(e);return n}encode(e,n){const r=Nt.dereference(n,"array");Array.isArray(r)||this._throwError("expected array value",r);let s=this.length;s===-1&&(s=r.length,e.writeValue(r.length)),sS(r.length,s,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let o=0;o<r.length;o++)i.push(this.coder);return KS(e,i,r)}decode(e){let n=this.length;n===-1&&(n=e.readIndex(),z(n*An<=e.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:e.bytes,offset:n*An,length:e.dataLength}));let r=[];for(let s=0;s<n;s++)r.push(new nQ(this.coder));return JS(e,r)}}class sQ extends pi{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,n){const r=Nt.dereference(n,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}}class YS extends pi{constructor(e,n){super(e,e,n,!0)}defaultValue(){return"0x"}encode(e,n){n=vn(n);let r=e.writeValue(n.length);return r+=e.writeBytes(n),r}decode(e){return e.readBytes(e.readIndex(),!0)}}class iQ extends YS{constructor(e){super("bytes",e)}decode(e){return re(super.decode(e))}}class oQ extends pi{size;constructor(e,n){let r="bytes"+String(e);super(r,r,n,!1),ve(this,{size:e},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(e,n){let r=vn(Nt.dereference(n,this.type));return r.length!==this.size&&this._throwError("incorrect data length",n),e.writeBytes(r)}decode(e){return re(e.readBytes(this.size))}}const aQ=new Uint8Array([]);class cQ extends pi{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,n){return n!=null&&this._throwError("not null",n),e.writeBytes(aQ)}decode(e){return e.readBytes(0),null}}const lQ=BigInt(0),uQ=BigInt(1),dQ=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class hQ extends pi{size;signed;constructor(e,n,r){const s=(n?"int":"uint")+e*8;super(s,s,r,!1),ve(this,{size:e,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(e,n){let r=de(Nt.dereference(n,this.type)),s=$o(dQ,An*8);if(this.signed){let i=$o(s,this.size*8-1);(r>i||r<-(i+uQ))&&this._throwError("value out-of-bounds",n),r=aS(r,8*An)}else(r<lQ||r>$o(s,this.size*8))&&this._throwError("value out-of-bounds",n);return e.writeValue(r)}decode(e){let n=$o(e.readValue(),this.size*8);return this.signed&&(n=cf(n,this.size*8)),n}}class fQ extends YS{constructor(e){super("string",e)}defaultValue(){return""}encode(e,n){return super.encode(e,si(Nt.dereference(n,"string")))}decode(e){return lf(super.decode(e))}}class eh extends pi{coders;constructor(e,n){let r=!1;const s=[];e.forEach(o=>{o.dynamic&&(r=!0),s.push(o.type)});const i="tuple("+s.join(",")+")";super("tuple",i,n,r),ve(this,{coders:Object.freeze(e.slice())})}defaultValue(){const e=[];this.coders.forEach(r=>{e.push(r.defaultValue())});const n=this.coders.reduce((r,s)=>{const i=s.localName;return i&&(r[i]||(r[i]=0),r[i]++),r},{});return this.coders.forEach((r,s)=>{let i=r.localName;!i||n[i]!==1||(i==="length"&&(i="_length"),e[i]==null&&(e[i]=e[s]))}),Object.freeze(e)}encode(e,n){const r=Nt.dereference(n,"tuple");return KS(e,this.coders,r)}decode(e){return JS(e,this.coders)}}function qg(t,e){return{address:Qe(t),storageKeys:e.map((n,r)=>(D(dt(n,32),"invalid slot",`storageKeys[${r}]`,n),n.toLowerCase()))}}function ya(t){if(Array.isArray(t))return t.map((n,r)=>Array.isArray(n)?(D(n.length===2,"invalid slot set",`value[${r}]`,n),qg(n[0],n[1])):(D(n!=null&&typeof n=="object","invalid address-slot set","value",t),qg(n.address,n.storageKeys)));D(t!=null&&typeof t=="object","invalid access list","value",t);const e=Object.keys(t).map(n=>{const r=t[n].reduce((s,i)=>(s[i]=!0,s),{});return qg(n,Object.keys(r).sort())});return e.sort((n,r)=>n.address.localeCompare(r.address)),e}function ZS(t){return{address:Qe(t.address),nonce:de(t.nonce!=null?t.nonce:0),chainId:de(t.chainId!=null?t.chainId:0),signature:_t.from(t.signature)}}function pQ(t){let e;return typeof t=="string"?e=Ys.computePublicKey(t,!1):e=t.publicKey,Qe(Dt("0x"+e.substring(4)).substring(26))}function gQ(t,e){return pQ(Ys.recoverPublicKey(t,e))}const Gt=BigInt(0),mQ=BigInt(2),yQ=BigInt(27),wQ=BigInt(28),bQ=BigInt(35),EQ=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Wg=4096*32;function vQ(t){return{blobToKzgCommitment:r=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return ke(t.blobToKzgCommitment(re(r)))}else if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return ke(t.blobToKzgCommitment(r));if("blobToKZGCommitment"in t&&typeof t.blobToKZGCommitment=="function")return ke(t.blobToKZGCommitment(re(r)));D(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(r,s)=>{if("computeBlobProof"in t&&typeof t.computeBlobProof=="function")return ke(t.computeBlobProof(re(r),re(s)));if("computeBlobKzgProof"in t&&typeof t.computeBlobKzgProof=="function")return t.computeBlobKzgProof(r,s);if("computeBlobKZGProof"in t&&typeof t.computeBlobKZGProof=="function")return ke(t.computeBlobKZGProof(re(r),re(s)));D(!1,"unsupported KZG library","kzg",t)}}}function TA(t,e){let n=t.toString(16);for(;n.length<2;)n="0"+n;return n+=Vc(e).substring(4),"0x"+n}function Gc(t){return t==="0x"?null:Qe(t)}function ap(t,e){try{return ya(t)}catch(n){D(!1,n.message,e,t)}}function AQ(t,e){try{if(!Array.isArray(t))throw new Error("authorizationList: invalid array");const n=[];for(let r=0;r<t.length;r++){const s=t[r];if(!Array.isArray(s))throw new Error(`authorization[${r}]: invalid array`);if(s.length!==6)throw new Error(`authorization[${r}]: wrong length`);if(!s[1])throw new Error(`authorization[${r}]: null address`);n.push({address:Gc(s[1]),nonce:it(s[2],"nonce"),chainId:it(s[0],"chainId"),signature:_t.from({yParity:wa(s[3],"yParity"),r:ui(s[4],32),s:ui(s[5],32)})})}return n}catch(n){D(!1,n.message,e,t)}}function wa(t,e){return t==="0x"?0:xe(t,e)}function it(t,e){if(t==="0x")return Gt;const n=de(t,e);return D(n<=EQ,"value exceeds uint size",e,n),n}function Me(t,e){const n=de(t,"value"),r=jt(n);return D(r.length<=32,"value too large",`tx.${e}`,n),r}function cp(t){return ya(t).map(e=>[e.address,e.storageKeys])}function CQ(t){return t.map(e=>[Me(e.chainId,"chainId"),e.address,Me(e.nonce,"nonce"),Me(e.signature.yParity,"yParity"),jt(e.signature.r),jt(e.signature.s)])}function IQ(t,e){D(Array.isArray(t),`invalid ${e}`,"value",t);for(let n=0;n<t.length;n++)D(dt(t[n],32),"invalid ${ param } hash",`value[${n}]`,t[n]);return t}function _Q(t){const e=ud(t);D(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",t);const n={type:0,nonce:wa(e[0],"nonce"),gasPrice:it(e[1],"gasPrice"),gasLimit:it(e[2],"gasLimit"),to:Gc(e[3]),value:it(e[4],"value"),data:re(e[5]),chainId:Gt};if(e.length===6)return n;const r=it(e[6],"v"),s=it(e[7],"r"),i=it(e[8],"s");if(s===Gt&&i===Gt)n.chainId=r;else{let o=(r-bQ)/mQ;o<Gt&&(o=Gt),n.chainId=o,D(o!==Gt||r===yQ||r===wQ,"non-canonical legacy v","v",e[6]),n.signature=_t.from({r:ui(e[7],32),s:ui(e[8],32),v:r})}return n}function NQ(t,e){const n=[Me(t.nonce,"nonce"),Me(t.gasPrice||0,"gasPrice"),Me(t.gasLimit,"gasLimit"),t.to||"0x",Me(t.value,"value"),t.data];let r=Gt;if(t.chainId!=Gt)r=de(t.chainId,"tx.chainId"),D(!e||e.networkV==null||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const i=t.signature.legacyChainId;i!=null&&(r=i)}if(!e)return r!==Gt&&(n.push(jt(r)),n.push("0x"),n.push("0x")),oo(n);let s=BigInt(27+e.yParity);return r!==Gt?s=_t.getChainIdV(r,e.v):BigInt(e.v)!==s&&D(!1,"tx.chainId/sig.v mismatch","sig",e),n.push(jt(s)),n.push(jt(e.r)),n.push(jt(e.s)),oo(n)}function lp(t,e){let n;try{if(n=wa(e[0],"yParity"),n!==0&&n!==1)throw new Error("bad yParity")}catch{D(!1,"invalid yParity","yParity",e[0])}const r=ui(e[1],32),s=ui(e[2],32),i=_t.from({r,s,yParity:n});t.signature=i}function SQ(t){const e=ud(ke(t).slice(1));D(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",re(t));const n={type:2,chainId:it(e[0],"chainId"),nonce:wa(e[1],"nonce"),maxPriorityFeePerGas:it(e[2],"maxPriorityFeePerGas"),maxFeePerGas:it(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:it(e[4],"gasLimit"),to:Gc(e[5]),value:it(e[6],"value"),data:re(e[7]),accessList:ap(e[8],"accessList")};return e.length===9||lp(n,e.slice(9)),n}function xQ(t,e){const n=[Me(t.chainId,"chainId"),Me(t.nonce,"nonce"),Me(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Me(t.maxFeePerGas||0,"maxFeePerGas"),Me(t.gasLimit,"gasLimit"),t.to||"0x",Me(t.value,"value"),t.data,cp(t.accessList||[])];return e&&(n.push(Me(e.yParity,"yParity")),n.push(jt(e.r)),n.push(jt(e.s))),St(["0x02",oo(n)])}function TQ(t){const e=ud(ke(t).slice(1));D(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",re(t));const n={type:1,chainId:it(e[0],"chainId"),nonce:wa(e[1],"nonce"),gasPrice:it(e[2],"gasPrice"),gasLimit:it(e[3],"gasLimit"),to:Gc(e[4]),value:it(e[5],"value"),data:re(e[6]),accessList:ap(e[7],"accessList")};return e.length===8||lp(n,e.slice(8)),n}function PQ(t,e){const n=[Me(t.chainId,"chainId"),Me(t.nonce,"nonce"),Me(t.gasPrice||0,"gasPrice"),Me(t.gasLimit,"gasLimit"),t.to||"0x",Me(t.value,"value"),t.data,cp(t.accessList||[])];return e&&(n.push(Me(e.yParity,"recoveryParam")),n.push(jt(e.r)),n.push(jt(e.s))),St(["0x01",oo(n)])}function OQ(t){let e=ud(ke(t).slice(1)),n="3",r=null;if(e.length===4&&Array.isArray(e[0])){n="3 (network format)";const i=e[1],o=e[2],a=e[3];D(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),D(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),D(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),D(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),D(i.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),r=[];for(let c=0;c<e[1].length;c++)r.push({data:i[c],commitment:o[c],proof:a[c]});e=e[0]}D(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${n}`,"data",re(t));const s={type:3,chainId:it(e[0],"chainId"),nonce:wa(e[1],"nonce"),maxPriorityFeePerGas:it(e[2],"maxPriorityFeePerGas"),maxFeePerGas:it(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:it(e[4],"gasLimit"),to:Gc(e[5]),value:it(e[6],"value"),data:re(e[7]),accessList:ap(e[8],"accessList"),maxFeePerBlobGas:it(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};r&&(s.blobs=r),D(s.to!=null,`invalid address for transaction type: ${n}`,"data",t),D(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let i=0;i<s.blobVersionedHashes.length;i++)D(dt(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",t);return e.length===11||lp(s,e.slice(11)),s}function RQ(t,e,n){const r=[Me(t.chainId,"chainId"),Me(t.nonce,"nonce"),Me(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Me(t.maxFeePerGas||0,"maxFeePerGas"),Me(t.gasLimit,"gasLimit"),t.to||$u,Me(t.value,"value"),t.data,cp(t.accessList||[]),Me(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),IQ(t.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(r.push(Me(e.yParity,"yParity")),r.push(jt(e.r)),r.push(jt(e.s)),n)?St(["0x03",oo([r,n.map(s=>s.data),n.map(s=>s.commitment),n.map(s=>s.proof)])]):St(["0x03",oo(r)])}function kQ(t){const e=ud(ke(t).slice(1));D(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",re(t));const n={type:4,chainId:it(e[0],"chainId"),nonce:wa(e[1],"nonce"),maxPriorityFeePerGas:it(e[2],"maxPriorityFeePerGas"),maxFeePerGas:it(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:it(e[4],"gasLimit"),to:Gc(e[5]),value:it(e[6],"value"),data:re(e[7]),accessList:ap(e[8],"accessList"),authorizationList:AQ(e[9],"authorizationList")};return e.length===10||lp(n,e.slice(10)),n}function DQ(t,e){const n=[Me(t.chainId,"chainId"),Me(t.nonce,"nonce"),Me(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Me(t.maxFeePerGas||0,"maxFeePerGas"),Me(t.gasLimit,"gasLimit"),t.to||"0x",Me(t.value,"value"),t.data,cp(t.accessList||[]),CQ(t.authorizationList||[])];return e&&(n.push(Me(e.yParity,"yParity")),n.push(jt(e.r)),n.push(jt(e.s))),St(["0x04",oo(n)])}class jr{#e;#t;#n;#r;#s;#o;#i;#a;#d;#l;#p;#g;#c;#u;#h;#f;#y;get type(){return this.#e}set type(e){switch(e){case null:this.#e=null;break;case 0:case"legacy":this.#e=0;break;case 1:case"berlin":case"eip-2930":this.#e=1;break;case 2:case"london":case"eip-1559":this.#e=2;break;case 3:case"cancun":case"eip-4844":this.#e=3;break;case 4:case"pectra":case"eip-7702":this.#e=4;break;default:D(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=this.#t;return e==null&&this.type===3?$u:e}set to(e){this.#t=e==null?null:Qe(e)}get nonce(){return this.#r}set nonce(e){this.#r=xe(e,"value")}get gasLimit(){return this.#s}set gasLimit(e){this.#s=de(e)}get gasPrice(){const e=this.#o;return e==null&&(this.type===0||this.type===1)?Gt:e}set gasPrice(e){this.#o=e==null?null:de(e,"gasPrice")}get maxPriorityFeePerGas(){const e=this.#i;return e??(this.type===2||this.type===3?Gt:null)}set maxPriorityFeePerGas(e){this.#i=e==null?null:de(e,"maxPriorityFeePerGas")}get maxFeePerGas(){const e=this.#a;return e??(this.type===2||this.type===3?Gt:null)}set maxFeePerGas(e){this.#a=e==null?null:de(e,"maxFeePerGas")}get data(){return this.#n}set data(e){this.#n=re(e)}get value(){return this.#d}set value(e){this.#d=de(e,"value")}get chainId(){return this.#l}set chainId(e){this.#l=de(e)}get signature(){return this.#p||null}set signature(e){this.#p=e==null?null:_t.from(e)}get accessList(){const e=this.#g||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){this.#g=e==null?null:ya(e)}get authorizationList(){const e=this.#y||null;return e==null&&this.type===4?[]:e}set authorizationList(e){this.#y=e==null?null:e.map(n=>ZS(n))}get maxFeePerBlobGas(){const e=this.#c;return e==null&&this.type===3?Gt:e}set maxFeePerBlobGas(e){this.#c=e==null?null:de(e,"maxFeePerBlobGas")}get blobVersionedHashes(){let e=this.#u;return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){D(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let n=0;n<e.length;n++)D(dt(e[n],32),"invalid blobVersionedHash",`value[${n}]`,e[n])}this.#u=e}get blobs(){return this.#f==null?null:this.#f.map(e=>Object.assign({},e))}set blobs(e){if(e==null){this.#f=null;return}const n=[],r=[];for(let s=0;s<e.length;s++){const i=e[s];if(iw(i)){z(this.#h,"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=ke(i);if(D(o.length<=Wg,"blob is too large",`blobs[${s}]`,i),o.length!==Wg){const l=new Uint8Array(Wg);l.set(o),o=l}const a=this.#h.blobToKzgCommitment(o),c=re(this.#h.computeBlobKzgProof(o,a));n.push({data:re(o),commitment:re(a),proof:c}),r.push(TA(1,a))}else{const o=re(i.commitment);n.push({data:re(i.data),commitment:o,proof:re(i.proof)}),r.push(TA(1,o))}}this.#f=n,this.#u=r}get kzg(){return this.#h}set kzg(e){e==null?this.#h=null:this.#h=vQ(e)}constructor(){this.#e=null,this.#t=null,this.#r=0,this.#s=Gt,this.#o=null,this.#i=null,this.#a=null,this.#n="0x",this.#d=Gt,this.#l=Gt,this.#p=null,this.#g=null,this.#c=null,this.#u=null,this.#h=null,this.#f=null,this.#y=null}get hash(){return this.signature==null?null:Dt(this.#m(!0,!1))}get unsignedHash(){return Dt(this.unsignedSerialized)}get from(){return this.signature==null?null:gQ(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:Ys.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}#m(e,n){z(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const r=e?this.signature:null;switch(this.inferType()){case 0:return NQ(this,r);case 1:return PQ(this,r);case 2:return xQ(this,r);case 3:return RQ(this,r,n?this.blobs:null);case 4:return DQ(this,r)}z(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})}get serialized(){return this.#m(!0,!0)}get unsignedSerialized(){return this.#m(!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,n=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,r=this.accessList!=null,s=this.#c!=null||this.#u;this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&z(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),z(!n||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),z(this.type!==0||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):n?i.push(2):e?(i.push(1),r||i.push(0)):r?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return jr.from(this)}toJSON(){const e=n=>n==null?null:n.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new jr;if(typeof e=="string"){const r=ke(e);if(r[0]>=127)return jr.from(_Q(r));switch(r[0]){case 1:return jr.from(TQ(r));case 2:return jr.from(SQ(r));case 3:return jr.from(OQ(r));case 4:return jr.from(kQ(r))}z(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const n=new jr;return e.type!=null&&(n.type=e.type),e.to!=null&&(n.to=e.to),e.nonce!=null&&(n.nonce=e.nonce),e.gasLimit!=null&&(n.gasLimit=e.gasLimit),e.gasPrice!=null&&(n.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(n.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(n.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(n.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(n.data=e.data),e.value!=null&&(n.value=e.value),e.chainId!=null&&(n.chainId=e.chainId),e.signature!=null&&(n.signature=_t.from(e.signature)),e.accessList!=null&&(n.accessList=e.accessList),e.authorizationList!=null&&(n.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(n.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(n.kzg=e.kzg),e.blobs!=null&&(n.blobs=e.blobs),e.hash!=null&&(D(n.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),D(n.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(D(n.isSigned(),"unsigned transaction cannot define '.from'","tx",e),D(n.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),n}}function ia(t){return Dt(si(t))}var UQ="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const PA=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),OA=4;function BQ(t){let e=0;function n(){return t[e++]<<8|t[e++]}let r=n(),s=1,i=[0,1];for(let b=1;b<r;b++)i.push(s+=n());let o=n(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|t[e++],c=8),l>>--c&1}const d=31,h=2**d,f=h>>>1,p=f>>1,g=h-1;let m=0;for(let b=0;b<d;b++)m=m<<1|u();let y=[],v=0,w=h;for(;;){let b=Math.floor(((m-v+1)*s-1)/w),E=0,S=r;for(;S-E>1;){let O=E+S>>>1;b<i[O]?S=O:E=O}if(E==0)break;y.push(E);let x=v+Math.floor(w*i[E]/s),I=v+Math.floor(w*i[E+1]/s)-1;for(;((x^I)&f)==0;)m=m<<1&g|u(),x=x<<1&g,I=I<<1&g|1;for(;x&~I&p;)m=m&f|m<<1&g>>>1|u(),x=x<<1^f,I=(I^f)<<1|f|1;v=x,w=1+I-x}let N=r-4;return y.map(b=>{switch(b-N){case 3:return N+65792+(t[a++]<<16|t[a++]<<8|t[a++]);case 2:return N+256+(t[a++]<<8|t[a++]);case 1:return N+t[a++];default:return b-1}})}function $Q(t){let e=0;return()=>t[e++]}function QS(t){return $Q(BQ(LQ(t)))}function LQ(t){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let n=t.length,r=new Uint8Array(6*n>>3);for(let s=0,i=0,o=0,a=0;s<n;s++)a=a<<6|e[t.charCodeAt(s)],o+=6,o>=8&&(r[i++]=a>>(o-=8));return r}function MQ(t){return t&1?~t>>1:t>>1}function FQ(t,e){let n=Array(t);for(let r=0,s=0;r<t;r++)n[r]=s+=MQ(e());return n}function Lu(t,e=0){let n=[];for(;;){let r=t(),s=t();if(!s)break;e+=r;for(let i=0;i<s;i++)n.push(e+i);e+=s+1}return n}function XS(t){return Mu(()=>{let e=Lu(t);if(e.length)return e})}function ex(t){let e=[];for(;;){let n=t();if(n==0)break;e.push(jQ(n,t))}for(;;){let n=t()-1;if(n<0)break;e.push(HQ(n,t))}return e.flat()}function Mu(t){let e=[];for(;;){let n=t(e.length);if(!n)break;e.push(n)}return e}function tx(t,e,n){let r=Array(t).fill().map(()=>[]);for(let s=0;s<e;s++)FQ(t,n).forEach((i,o)=>r[o].push(i));return r}function jQ(t,e){let n=1+e(),r=e(),s=Mu(e);return tx(s.length,1+t,e).flatMap((o,a)=>{let[c,...l]=o;return Array(s[a]).fill().map((u,d)=>{let h=d*r;return[c+d*n,l.map(f=>f+h)]})})}function HQ(t,e){let n=1+e();return tx(n,1+t,e).map(s=>[s[0],s.slice(1)])}function zQ(t){let e=[],n=Lu(t);return s(r([]),[]),e;function r(i){let o=t(),a=Mu(()=>{let c=Lu(t).map(l=>n[l]);if(c.length)return r(c)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,c){if(!(i&4&&c===a[a.length-1])){i&2&&(c=a[a.length-1]),i&1&&e.push(a);for(let l of o)for(let u of l.Q)s(l,[...a,u],c)}}}function qQ(t){return t.toString(16).toUpperCase().padStart(2,"0")}function nx(t){return`{${qQ(t)}}`}function WQ(t){let e=[];for(let n=0,r=t.length;n<r;){let s=t.codePointAt(n);n+=s<65536?1:2,e.push(s)}return e}function Tc(t){let n=t.length;if(n<4096)return String.fromCodePoint(...t);let r=[];for(let s=0;s<n;)r.push(String.fromCodePoint(...t.slice(s,s+=4096)));return r.join("")}function VQ(t,e){let n=t.length,r=n-e.length;for(let s=0;r==0&&s<n;s++)r=t[s]-e[s];return r}var GQ="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const Fu=44032,df=4352,hf=4449,ff=4519,rx=19,sx=21,Pc=28,pf=sx*Pc,KQ=rx*pf,JQ=Fu+KQ,YQ=df+rx,ZQ=hf+sx,QQ=ff+Pc;function Cl(t){return t>>24&255}function ix(t){return t&16777215}let D0,RA,U0,bh;function XQ(){let t=QS(GQ);D0=new Map(XS(t).flatMap((e,n)=>e.map(r=>[r,n+1<<24]))),RA=new Set(Lu(t)),U0=new Map,bh=new Map;for(let[e,n]of ex(t)){if(!RA.has(e)&&n.length==2){let[r,s]=n,i=bh.get(r);i||(i=new Map,bh.set(r,i)),i.set(s,e)}U0.set(e,n.reverse())}}function ox(t){return t>=Fu&&t<JQ}function eX(t,e){if(t>=df&&t<YQ&&e>=hf&&e<ZQ)return Fu+(t-df)*pf+(e-hf)*Pc;if(ox(t)&&e>ff&&e<QQ&&(t-Fu)%Pc==0)return t+(e-ff);{let n=bh.get(t);return n&&(n=n.get(e),n)?n:-1}}function ax(t){D0||XQ();let e=[],n=[],r=!1;function s(i){let o=D0.get(i);o&&(r=!0,i|=o),e.push(i)}for(let i of t)for(;;){if(i<128)e.push(i);else if(ox(i)){let o=i-Fu,a=o/pf|0,c=o%pf/Pc|0,l=o%Pc;s(df+a),s(hf+c),l>0&&s(ff+l)}else{let o=U0.get(i);o?n.push(...o):s(i)}if(!n.length)break;i=n.pop()}if(r&&e.length>1){let i=Cl(e[0]);for(let o=1;o<e.length;o++){let a=Cl(e[o]);if(a==0||i<=a){i=a;continue}let c=o-1;for(;;){let l=e[c+1];if(e[c+1]=e[c],e[c]=l,!c||(i=Cl(e[--c]),i<=a))break}i=Cl(e[o])}}return e}function tX(t){let e=[],n=[],r=-1,s=0;for(let i of t){let o=Cl(i),a=ix(i);if(r==-1)o==0?r=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(r,...n),n.length=0,r=a):n.push(a),s=o;else{let c=eX(r,a);c>=0?r=c:s==0&&o==0?(e.push(r),r=a):(n.push(a),s=o)}}return r>=0&&e.push(r,...n),e}function cx(t){return ax(t).map(ix)}function nX(t){return tX(ax(t))}const kA=45,lx=".",ux=65039,dx=1,gf=t=>Array.from(t);function ju(t,e){return t.P.has(e)||t.Q.has(e)}class rX extends Array{get is_emoji(){return!0}}let B0,hx,Mo,$0,fx,cc,Vg,Ka,vo,DA,L0;function mw(){if(B0)return;let t=QS(UQ);const e=()=>Lu(t),n=()=>new Set(e()),r=(u,d)=>d.forEach(h=>u.add(h));B0=new Map(ex(t)),hx=n(),Mo=e(),$0=new Set(e().map(u=>Mo[u])),Mo=new Set(Mo),fx=n(),n();let s=XS(t),i=t();const o=()=>{let u=new Set;return e().forEach(d=>r(u,s[d])),r(u,e()),u};cc=Mu(u=>{let d=Mu(t).map(h=>h+96);if(d.length){let h=u>=i;d[0]-=32,d=Tc(d),h&&(d=`Restricted[${d}]`);let f=o(),p=o(),g=!t();return{N:d,P:f,Q:p,M:g,R:h}}}),Vg=n(),Ka=new Map;let a=e().concat(gf(Vg)).sort((u,d)=>u-d);a.forEach((u,d)=>{let h=t(),f=a[d]=h?a[d-h]:{V:[],M:new Map};f.V.push(u),Vg.has(u)||Ka.set(u,f)});for(let{V:u,M:d}of new Set(Ka.values())){let h=[];for(let p of u){let g=cc.filter(y=>ju(y,p)),m=h.find(({G:y})=>g.some(v=>y.has(v)));m||(m={G:new Set,V:[]},h.push(m)),m.V.push(p),r(m.G,g)}let f=h.flatMap(p=>gf(p.G));for(let{G:p,V:g}of h){let m=new Set(f.filter(y=>!p.has(y)));for(let y of g)d.set(y,m)}}vo=new Set;let c=new Set;const l=u=>vo.has(u)?c.add(u):vo.add(u);for(let u of cc){for(let d of u.P)l(d);for(let d of u.Q)l(d)}for(let u of vo)!Ka.has(u)&&!c.has(u)&&Ka.set(u,dx);r(vo,cx(vo)),DA=zQ(t).map(u=>rX.from(u)).sort(VQ),L0=new Map;for(let u of DA){let d=[L0];for(let h of u){let f=d.map(p=>{let g=p.get(h);return g||(g=new Map,p.set(h,g)),g});h===ux?d.push(...f):d=f}for(let h of d)h.V=u}}function yw(t){return(px(t)?"":`${ww(up([t]))} `)+nx(t)}function ww(t){return`"${t}"`}function sX(t){if(t.length>=4&&t[2]==kA&&t[3]==kA)throw new Error(`invalid label extension: "${Tc(t.slice(0,4))}"`)}function iX(t){for(let n=t.lastIndexOf(95);n>0;)if(t[--n]!==95)throw new Error("underscore allowed only at start")}function oX(t){let e=t[0],n=PA.get(e);if(n)throw Fl(`leading ${n}`);let r=t.length,s=-1;for(let i=1;i<r;i++){e=t[i];let o=PA.get(e);if(o){if(s==i)throw Fl(`${n} + ${o}`);s=i+1,n=o}}if(s==r)throw Fl(`trailing ${n}`)}function up(t,e=1/0,n=nx){let r=[];aX(t[0])&&r.push(""),t.length>e&&(e>>=1,t=[...t.slice(0,e),8230,...t.slice(-e)]);let s=0,i=t.length;for(let o=0;o<i;o++){let a=t[o];px(a)&&(r.push(Tc(t.slice(s,o))),r.push(n(a)),s=o+1)}return r.push(Tc(t.slice(s,i))),r.join("")}function aX(t){return mw(),Mo.has(t)}function px(t){return mw(),fx.has(t)}function cX(t){return hX(lX(t,nX,gX))}function lX(t,e,n){if(!t)return[];mw();let r=0;return t.split(lx).map(s=>{let i=WQ(s),o={input:i,offset:r};r+=i.length+1;try{let a=o.tokens=pX(i,e,n),c=a.length,l;if(!c)throw new Error("empty label");let u=o.output=a.flat();if(iX(u),!(o.emoji=c>1||a[0].is_emoji)&&u.every(h=>h<128))sX(u),l="ASCII";else{let h=a.flatMap(f=>f.is_emoji?[]:f);if(!h.length)l="Emoji";else{if(Mo.has(u[0]))throw Fl("leading combining mark");for(let g=1;g<c;g++){let m=a[g];if(!m.is_emoji&&Mo.has(m[0]))throw Fl(`emoji + combining mark: "${Tc(a[g-1])} + ${up([m[0]])}"`)}oX(u);let f=gf(new Set(h)),[p]=dX(f);fX(p,h),uX(p,f),l=p.N}}o.type=l}catch(a){o.error=a}return o})}function uX(t,e){let n,r=[];for(let s of e){let i=Ka.get(s);if(i===dx)return;if(i){let o=i.M.get(s);if(n=n?n.filter(a=>o.has(a)):gf(o),!n.length)return}else r.push(s)}if(n){for(let s of n)if(r.every(i=>ju(s,i)))throw new Error(`whole-script confusable: ${t.N}/${s.N}`)}}function dX(t){let e=cc;for(let n of t){let r=e.filter(s=>ju(s,n));if(!r.length)throw cc.some(s=>ju(s,n))?mx(e[0],n):gx(n);if(e=r,r.length==1)break}return e}function hX(t){return t.map(({input:e,error:n,output:r})=>{if(n){let s=n.message;throw new Error(t.length==1?s:`Invalid label ${ww(up(e,63))}: ${s}`)}return Tc(r)}).join(lx)}function gx(t){return new Error(`disallowed character: ${yw(t)}`)}function mx(t,e){let n=yw(e),r=cc.find(s=>s.P.has(e));return r&&(n=`${r.N} ${n}`),new Error(`illegal mixture: ${t.N} + ${n}`)}function Fl(t){return new Error(`illegal placement: ${t}`)}function fX(t,e){for(let n of e)if(!ju(t,n))throw mx(t,n);if(t.M){let n=cx(e);for(let r=1,s=n.length;r<s;r++)if($0.has(n[r])){let i=r+1;for(let o;i<s&&$0.has(o=n[i]);i++)for(let a=r;a<i;a++)if(n[a]==o)throw new Error(`duplicate non-spacing marks: ${yw(o)}`);if(i-r>OA)throw new Error(`excessive non-spacing marks: ${ww(up(n.slice(r-1,i)))} (${i-r}/${OA})`);r=i}}}function pX(t,e,n){let r=[],s=[];for(t=t.slice().reverse();t.length;){let i=mX(t);if(i)s.length&&(r.push(e(s)),s=[]),r.push(n(i));else{let o=t.pop();if(vo.has(o))s.push(o);else{let a=B0.get(o);if(a)s.push(...a);else if(!hx.has(o))throw gx(o)}}}return s.length&&r.push(e(s)),r}function gX(t){return t.filter(e=>e!=ux)}function mX(t,e){let n=L0,r,s=t.length;for(;s&&(n=n.get(t[--s]),!!n);){let{V:i}=n;i&&(r=i,t.length=s)}return r}const yx=new Uint8Array(32);yx.fill(0);function UA(t){return D(t.length!==0,"invalid ENS name; empty component","comp",t),t}function wx(t){const e=si(yX(t)),n=[];if(t.length===0)return n;let r=0;for(let s=0;s<e.length;s++)e[s]===46&&(n.push(UA(e.slice(r,s))),r=s+1);return D(r<e.length,"invalid ENS name; empty component","name",t),n.push(UA(e.slice(r))),n}function yX(t){try{if(t.length===0)throw new Error("empty label");return cX(t)}catch(e){D(!1,`invalid ENS name (${e.message})`,"name",t)}}function M0(t){D(typeof t=="string","invalid ENS name; not a string","name",t),D(t.length,"invalid ENS name (empty label)","name",t);let e=yx;const n=wx(t);for(;n.length;)e=Dt(St([e,Dt(n.pop())]));return re(e)}function wX(t,e){const n=e;return D(n<=255,"DNS encoded label cannot exceed 255","length",n),re(St(wx(t).map(r=>{D(r.length<=n,`label ${JSON.stringify(t)} exceeds ${n} bytes`,"name",t);const s=new Uint8Array(r.length+1);return s.set(r,1),s[0]=s.length-1,s})))+"00"}const bx=new Uint8Array(32);bx.fill(0);const bX=BigInt(-1),Ex=BigInt(0),vx=BigInt(1),EX=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function vX(t){const e=ke(t),n=e.length%32;return n?St([e,bx.slice(n)]):re(e)}const AX=io(vx,32),CX=io(Ex,32),BA={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},Gg=["name","version","chainId","verifyingContract","salt"];function $A(t){return function(e){return D(typeof e=="string",`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const IX={name:$A("name"),version:$A("version"),chainId:function(t){const e=de(t,"domain.chainId");return D(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):zr(e)},verifyingContract:function(t){try{return Qe(t).toLowerCase()}catch{}D(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=ke(t,"domain.salt");return D(e.length===32,'invalid domain value "salt"',"domain.salt",t),re(e)}};function Kg(t){{const e=t.match(/^(u?)int(\d+)$/);if(e){const n=e[1]==="",r=parseInt(e[2]);D(r%8===0&&r!==0&&r<=256&&e[2]===String(r),"invalid numeric width","type",t);const s=$o(EX,n?r-1:r),i=n?(s+vx)*bX:Ex;return function(o){const a=de(o,"value");return D(a>=i&&a<=s,`value out-of-bounds for ${t}`,"value",a),io(n?aS(a,256):a,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const n=parseInt(e[1]);return D(n!==0&&n<=32&&e[1]===String(n),"invalid bytes width","type",t),function(r){const s=ke(r);return D(s.length===n,`invalid length for ${t}`,"value",r),vX(r)}}}switch(t){case"address":return function(e){return ui(Qe(e),32)};case"bool":return function(e){return e?AX:CX};case"bytes":return function(e){return Dt(e)};case"string":return function(e){return ia(e)}}return null}function LA(t,e){return`${t}(${e.map(({name:n,type:r})=>r+" "+n).join(",")})`}function th(t){const e=t.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:t}}class Xn{primaryType;#e;get types(){return JSON.parse(this.#e)}#t;#n;constructor(e){this.#t=new Map,this.#n=new Map;const n=new Map,r=new Map,s=new Map,i={};Object.keys(e).forEach(c=>{i[c]=e[c].map(({name:l,type:u})=>{let{base:d,index:h}=th(u);return d==="int"&&!e.int&&(d="int256"),d==="uint"&&!e.uint&&(d="uint256"),{name:l,type:d+(h||"")}}),n.set(c,new Set),r.set(c,[]),s.set(c,new Set)}),this.#e=JSON.stringify(i);for(const c in i){const l=new Set;for(const u of i[c]){D(!l.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(c)}`,"types",e),l.add(u.name);const d=th(u.type).base;D(d!==c,`circular type reference to ${JSON.stringify(d)}`,"types",e),!Kg(d)&&(D(r.has(d),`unknown type ${JSON.stringify(d)}`,"types",e),r.get(d).push(c),n.get(c).add(d))}}const o=Array.from(r.keys()).filter(c=>r.get(c).length===0);D(o.length!==0,"missing primary type","types",e),D(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),ve(this,{primaryType:o[0]});function a(c,l){D(!l.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),l.add(c);for(const u of n.get(c))if(r.has(u)){a(u,l);for(const d of l)s.get(d).add(u)}l.delete(c)}a(this.primaryType,new Set);for(const[c,l]of s){const u=Array.from(l);u.sort(),this.#t.set(c,LA(c,i[c])+u.map(d=>LA(d,i[d])).join(""))}}getEncoder(e){let n=this.#n.get(e);return n||(n=this.#r(e),this.#n.set(e,n)),n}#r(e){{const s=Kg(e);if(s)return s}const n=th(e).array;if(n){const s=n.prefix,i=this.getEncoder(s);return o=>{D(n.count===-1||n.count===o.length,`array length mismatch; expected length ${n.count}`,"value",o);let a=o.map(i);return this.#t.has(s)&&(a=a.map(Dt)),Dt(St(a))}}const r=this.types[e];if(r){const s=ia(this.#t.get(e));return i=>{const o=r.map(({name:a,type:c})=>{const l=this.getEncoder(c)(i[a]);return this.#t.has(c)?Dt(l):l});return o.unshift(s),St(o)}}D(!1,`unknown type: ${e}`,"type",e)}encodeType(e){const n=this.#t.get(e);return D(n,`unknown type: ${JSON.stringify(e)}`,"name",e),n}encodeData(e,n){return this.getEncoder(e)(n)}hashStruct(e,n){return Dt(this.encodeData(e,n))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,n,r){if(Kg(e))return r(e,n);const s=th(e).array;if(s)return D(s.count===-1||s.count===n.length,`array length mismatch; expected length ${s.count}`,"value",n),n.map(o=>this._visit(s.prefix,o,r));const i=this.types[e];if(i)return i.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,n[a],r),o),{});D(!1,`unknown type: ${e}`,"type",e)}visit(e,n){return this._visit(this.primaryType,e,n)}static from(e){return new Xn(e)}static getPrimaryType(e){return Xn.from(e).primaryType}static hashStruct(e,n,r){return Xn.from(n).hashStruct(e,r)}static hashDomain(e){const n=[];for(const r in e){if(e[r]==null)continue;const s=BA[r];D(s,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),n.push({name:r,type:s})}return n.sort((r,s)=>Gg.indexOf(r.name)-Gg.indexOf(s.name)),Xn.hashStruct("EIP712Domain",{EIP712Domain:n},e)}static encode(e,n,r){return St(["0x1901",Xn.hashDomain(e),Xn.from(n).hash(r)])}static hash(e,n,r){return Dt(Xn.encode(e,n,r))}static async resolveNames(e,n,r,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const i={};e.verifyingContract&&!dt(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=Xn.from(n);o.visit(r,(a,c)=>(a==="address"&&!dt(c,20)&&(i[c]="0x"),c));for(const a in i)i[a]=await s(a);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),r=o.visit(r,(a,c)=>a==="address"&&i[c]?i[c]:c),{domain:e,value:r}}static getPayload(e,n,r){Xn.hashDomain(e);const s={},i=[];Gg.forEach(c=>{const l=e[c];l!=null&&(s[c]=IX[c](l),i.push({name:c,type:BA[c]}))});const o=Xn.from(n);n=o.types;const a=Object.assign({},n);return D(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",n),a.EIP712Domain=i,o.encode(r),{types:a,domain:s,primaryType:o.primaryType,message:o.visit(r,(c,l)=>{if(c.match(/^bytes(\d*)/))return re(ke(l));if(c.match(/^u?int/))return de(l).toString();switch(c){case"address":return l.toLowerCase();case"bool":return!!l;case"string":return D(typeof l=="string","invalid string","value",l),l}D(!1,"unsupported type","type",c)})}}}function In(t){const e=new Set;return t.forEach(n=>e.add(n)),Object.freeze(e)}const _X="external public payable override",NX=In(_X.split(" ")),Ax="constant external internal payable private public pure view override",SX=In(Ax.split(" ")),Cx="constructor error event fallback function receive struct",Ix=In(Cx.split(" ")),_x="calldata memory storage payable indexed",xX=In(_x.split(" ")),TX="tuple returns",PX=[Cx,_x,TX,Ax].join(" "),OX=In(PX.split(" ")),RX={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},kX=new RegExp("^(\\s*)"),DX=new RegExp("^([0-9]+)"),UX=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),Nx=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),Sx=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");class _r{#e;#t;get offset(){return this.#e}get length(){return this.#t.length-this.#e}constructor(e){this.#e=0,this.#t=e.slice()}clone(){return new _r(this.#t)}reset(){this.#e=0}#n(e=0,n=0){return new _r(this.#t.slice(e,n).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))}popKeyword(e){const n=this.peek();if(n.type!=="KEYWORD"||!e.has(n.text))throw new Error(`expected keyword ${n.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const n=this.peek();throw new Error(`expected ${e}; got ${n.type} ${JSON.stringify(n.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const n=this.#n(this.#e+1,e.match+1);return this.#e=e.match+1,n}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const n=[];for(;this.#e<e.match-1;){const r=this.peek().linkNext;n.push(this.#n(this.#e+1,r)),this.#e=r}return this.#e=e.match+1,n}peek(){if(this.#e>=this.#t.length)throw new Error("out-of-bounds");return this.#t[this.#e]}peekKeyword(e){const n=this.peekType("KEYWORD");return n!=null&&e.has(n)?n:null}peekType(e){if(this.length===0)return null;const n=this.peek();return n.type===e?n.text:null}pop(){const e=this.peek();return this.#e++,e}toString(){const e=[];for(let n=this.#e;n<this.#t.length;n++){const r=this.#t[n];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}}function co(t){const e=[],n=o=>{const a=i<t.length?JSON.stringify(t[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let r=[],s=[],i=0;for(;i<t.length;){let o=t.substring(i),a=o.match(kX);a&&(i+=a[1].length,o=t.substring(i));const c={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let l=RX[o[0]]||"";if(l){if(c.type=l,c.text=o[0],i++,l==="OPEN_PAREN")r.push(e.length-1),s.push(e.length-1);else if(l=="CLOSE_PAREN")r.length===0&&n("no matching open bracket"),c.match=r.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(l==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(l==="OPEN_BRACKET")c.type="BRACKET";else if(l==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const d=e.pop().text;u=d+u,e[e.length-1].value=xe(d)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(UX),a){if(c.text=a[1],i+=c.text.length,OX.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(Sx)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(DX),a){c.text=a[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new _r(e.map(o=>Object.freeze(o)))}function MA(t,e){let n=[];for(const r in e.keys())t.has(r)&&n.push(r);if(n.length>1)throw new Error(`conflicting types: ${n.join(", ")}`)}function dp(t,e){if(e.peekKeyword(Ix)){const n=e.pop().text;if(n!==t)throw new Error(`expected ${t}, got ${n}`)}return e.popType("ID")}function hi(t,e){const n=new Set;for(;;){const r=t.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(t.pop(),n.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);n.add(r)}return Object.freeze(n)}function xx(t){let e=hi(t,SX);return MA(e,In("constant payable nonpayable".split(" "))),MA(e,In("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function ii(t,e){return t.popParams().map(n=>ut.from(n,e))}function Tx(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return de(t.pop().text);throw new Error("invalid gas")}return null}function oa(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const BX=new RegExp(/^(.*)\[([0-9]*)\]$/);function FA(t){const e=t.match(Sx);if(D(e,"invalid type","type",t),t==="uint")return"uint256";if(t==="int")return"int256";if(e[2]){const n=parseInt(e[2]);D(n!==0&&n<=32,"invalid bytes length","type",t)}else if(e[3]){const n=parseInt(e[3]);D(n!==0&&n<=256&&n%8===0,"invalid numeric width","type",t)}return t}const At={},Gn=Symbol.for("_ethers_internal"),jA="_ParamTypeInternal",HA="_ErrorInternal",zA="_EventInternal",qA="_ConstructorInternal",WA="_FallbackInternal",VA="_FunctionInternal",GA="_StructInternal";class ut{name;type;baseType;indexed;components;arrayLength;arrayChildren;constructor(e,n,r,s,i,o,a,c){if(ld(e,At,"ParamType"),Object.defineProperty(this,Gn,{value:jA}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");ve(this,{name:n,type:r,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const r=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=r,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let n="";return this.isArray()?(n+=this.arrayChildren.format(e),n+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?n+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":n+=this.type,e!=="sighash"&&(this.indexed===!0&&(n+=" indexed"),e==="full"&&this.name&&(n+=" "+this.name)),n}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,n){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return e.map(s=>r.arrayChildren.walk(s,n))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const r=this;return e.map((s,i)=>r.components[i].walk(s,n))}return n(this.type,e)}#e(e,n,r,s){if(this.isArray()){if(!Array.isArray(n))throw new Error("invalid array value");if(this.arrayLength!==-1&&n.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=n.slice();a.forEach((c,l)=>{o.#e(e,c,r,u=>{a[l]=u})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(n))a=n.slice();else{if(n==null||typeof n!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in n))throw new Error(`missing value for component ${c.name}`);return n[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,l)=>{o[l].#e(e,c,r,u=>{a[l]=u})}),s(a);return}const i=r(this.type,n);i.then?e.push(async function(){s(await i)}()):s(i)}async walkAsync(e,n){const r=[],s=[e];return this.#e(r,e,n,i=>{s[0]=i}),r.length&&await Promise.all(r),s[0]}static from(e,n){if(ut.isParamType(e))return e;if(typeof e=="string")try{return ut.from(co(e),n)}catch{D(!1,"invalid param type","obj",e)}else if(e instanceof _r){let a="",c="",l=null;hi(e,In(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",l=e.popParams().map(g=>ut.from(g)),a=`tuple(${l.map(g=>g.format()).join(",")})`):(a=FA(e.popType("TYPE")),c=a);let u=null,d=null;for(;e.length&&e.peekType("BRACKET");){const g=e.pop();u=new ut(At,"",a,c,null,l,d,u),d=g.value,a+=g.text,c="array",l=null}let h=null;if(hi(e,xX).has("indexed")){if(!n)throw new Error("");h=!0}const p=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new ut(At,p,a,c,h,l,d,u)}const r=e.name;D(!r||typeof r=="string"&&r.match(Nx),"invalid name","obj.name",r);let s=e.indexed;s!=null&&(D(n,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(BX);if(o){const a=parseInt(o[2]||"-1"),c=ut.from({type:o[1],components:e.components});return new ut(At,r||"",i,"array",s,null,a,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(l=>ut.from(l)):null;return new ut(At,r||"",i,"tuple",s,a,null,null)}return i=FA(e.type),new ut(At,r||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[Gn]===jA}}class aa{type;inputs;constructor(e,n,r){ld(e,At,"Fragment"),r=Object.freeze(r.slice()),ve(this,{type:n,inputs:r})}static from(e){if(typeof e=="string"){try{aa.from(JSON.parse(e))}catch{}return aa.from(co(e))}if(e instanceof _r)switch(e.peekKeyword(Ix)){case"constructor":return Xs.from(e);case"error":return Hn.from(e);case"event":return gs.from(e);case"fallback":case"receive":return Ks.from(e);case"function":return ms.from(e);case"struct":return qo.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Xs.from(e);case"error":return Hn.from(e);case"event":return gs.from(e);case"fallback":case"receive":return Ks.from(e);case"function":return ms.from(e);case"struct":return qo.from(e)}z(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}D(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Xs.isFragment(e)}static isError(e){return Hn.isFragment(e)}static isEvent(e){return gs.isFragment(e)}static isFunction(e){return ms.isFragment(e)}static isStruct(e){return qo.isFragment(e)}}class hp extends aa{name;constructor(e,n,r,s){super(e,n,s),D(typeof r=="string"&&r.match(Nx),"invalid identifier","name",r),s=Object.freeze(s.slice()),ve(this,{name:r})}}function Hu(t,e){return"("+e.map(n=>n.format(t)).join(t==="full"?", ":",")+")"}class Hn extends hp{constructor(e,n,r){super(e,"error",n,r),Object.defineProperty(this,Gn,{value:HA})}get selector(){return ia(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const n=[];return e!=="sighash"&&n.push("error"),n.push(this.name+Hu(e,this.inputs)),n.join(" ")}static from(e){if(Hn.isFragment(e))return e;if(typeof e=="string")return Hn.from(co(e));if(e instanceof _r){const n=dp("error",e),r=ii(e);return oa(e),new Hn(At,n,r)}return new Hn(At,e.name,e.inputs?e.inputs.map(ut.from):[])}static isFragment(e){return e&&e[Gn]===HA}}class gs extends hp{anonymous;constructor(e,n,r,s){super(e,"event",n,r),Object.defineProperty(this,Gn,{value:zA}),ve(this,{anonymous:s})}get topicHash(){return ia(this.format("sighash"))}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const n=[];return e!=="sighash"&&n.push("event"),n.push(this.name+Hu(e,this.inputs)),e!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(e,n){return n=(n||[]).map(s=>ut.from(s)),new gs(At,e,n,!1).topicHash}static from(e){if(gs.isFragment(e))return e;if(typeof e=="string")try{return gs.from(co(e))}catch{D(!1,"invalid event fragment","obj",e)}else if(e instanceof _r){const n=dp("event",e),r=ii(e,!0),s=!!hi(e,In(["anonymous"])).has("anonymous");return oa(e),new gs(At,n,r,s)}return new gs(At,e.name,e.inputs?e.inputs.map(n=>ut.from(n,!0)):[],!!e.anonymous)}static isFragment(e){return e&&e[Gn]===zA}}class Xs extends aa{payable;gas;constructor(e,n,r,s,i){super(e,n,r),Object.defineProperty(this,Gn,{value:qA}),ve(this,{payable:s,gas:i})}format(e){if(z(e!=null&&e!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),e==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const n=[`constructor${Hu(e,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(e){if(Xs.isFragment(e))return e;if(typeof e=="string")try{return Xs.from(co(e))}catch{D(!1,"invalid constuctor fragment","obj",e)}else if(e instanceof _r){hi(e,In(["constructor"]));const n=ii(e),r=!!hi(e,NX).has("payable"),s=Tx(e);return oa(e),new Xs(At,"constructor",n,r,s)}return new Xs(At,"constructor",e.inputs?e.inputs.map(ut.from):[],!!e.payable,e.gas!=null?e.gas:null)}static isFragment(e){return e&&e[Gn]===qA}}class Ks extends aa{payable;constructor(e,n,r){super(e,"fallback",n),Object.defineProperty(this,Gn,{value:WA}),ve(this,{payable:r})}format(e){const n=this.inputs.length===0?"receive":"fallback";if(e==="json"){const r=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:r})}return`${n}()${this.payable?" payable":""}`}static from(e){if(Ks.isFragment(e))return e;if(typeof e=="string")try{return Ks.from(co(e))}catch{D(!1,"invalid fallback fragment","obj",e)}else if(e instanceof _r){const n=e.toString(),r=e.peekKeyword(In(["fallback","receive"]));if(D(r,"type must be fallback or receive","obj",n),e.popKeyword(In(["fallback","receive"]))==="receive"){const a=ii(e);return D(a.length===0,"receive cannot have arguments","obj.inputs",a),hi(e,In(["payable"])),oa(e),new Ks(At,[],!0)}let i=ii(e);i.length?D(i.length===1&&i[0].type==="bytes","invalid fallback inputs","obj.inputs",i.map(a=>a.format("minimal")).join(", ")):i=[ut.from("bytes")];const o=xx(e);if(D(o==="nonpayable"||o==="payable","fallback cannot be constants","obj.stateMutability",o),hi(e,In(["returns"])).has("returns")){const a=ii(e);D(a.length===1&&a[0].type==="bytes","invalid fallback outputs","obj.outputs",a.map(c=>c.format("minimal")).join(", "))}return oa(e),new Ks(At,i,o==="payable")}if(e.type==="receive")return new Ks(At,[],!0);if(e.type==="fallback"){const n=[ut.from("bytes")],r=e.stateMutability==="payable";return new Ks(At,n,r)}D(!1,"invalid fallback description","obj",e)}static isFragment(e){return e&&e[Gn]===WA}}class ms extends hp{constant;outputs;stateMutability;payable;gas;constructor(e,n,r,s,i,o){super(e,"function",n,s),Object.defineProperty(this,Gn,{value:VA}),i=Object.freeze(i.slice()),ve(this,{constant:r==="view"||r==="pure",gas:o,outputs:i,payable:r==="payable",stateMutability:r})}get selector(){return ia(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(r=>JSON.parse(r.format(e))),outputs:this.outputs.map(r=>JSON.parse(r.format(e)))});const n=[];return e!=="sighash"&&n.push("function"),n.push(this.name+Hu(e,this.inputs)),e!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(Hu(e,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(e,n){return n=(n||[]).map(s=>ut.from(s)),new ms(At,e,"view",n,[],null).selector}static from(e){if(ms.isFragment(e))return e;if(typeof e=="string")try{return ms.from(co(e))}catch{D(!1,"invalid function fragment","obj",e)}else if(e instanceof _r){const r=dp("function",e),s=ii(e),i=xx(e);let o=[];hi(e,In(["returns"])).has("returns")&&(o=ii(e));const a=Tx(e);return oa(e),new ms(At,r,i,s,o,a)}let n=e.stateMutability;return n==null&&(n="payable",typeof e.constant=="boolean"?(n="view",e.constant||(n="payable",typeof e.payable=="boolean"&&!e.payable&&(n="nonpayable"))):typeof e.payable=="boolean"&&!e.payable&&(n="nonpayable")),new ms(At,e.name,n,e.inputs?e.inputs.map(ut.from):[],e.outputs?e.outputs.map(ut.from):[],e.gas!=null?e.gas:null)}static isFragment(e){return e&&e[Gn]===VA}}class qo extends hp{constructor(e,n,r){super(e,"struct",n,r),Object.defineProperty(this,Gn,{value:GA})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return qo.from(co(e))}catch{D(!1,"invalid struct fragment","obj",e)}else if(e instanceof _r){const n=dp("struct",e),r=ii(e);return oa(e),new qo(At,n,r)}return new qo(At,e.name,e.inputs?e.inputs.map(ut.from):[])}static isFragment(e){return e&&e[Gn]===GA}}const ts=new Map;ts.set(0,"GENERIC_PANIC");ts.set(1,"ASSERT_FALSE");ts.set(17,"OVERFLOW");ts.set(18,"DIVIDE_BY_ZERO");ts.set(33,"ENUM_RANGE_ERROR");ts.set(34,"BAD_STORAGE_DATA");ts.set(49,"STACK_UNDERFLOW");ts.set(50,"ARRAY_RANGE_ERROR");ts.set(65,"OUT_OF_MEMORY");ts.set(81,"UNINITIALIZED_FUNCTION_CALL");const $X=new RegExp(/^bytes([0-9]*)$/),LX=new RegExp(/^(u?int)([0-9]*)$/);let Jg=null,KA=1024;function MX(t,e,n,r){let s="missing revert data",i=null;const o=null;let a=null;if(n){s="execution reverted";const l=ke(n);if(n=re(n),l.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(l.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(re(l.slice(0,4))==="0x08c379a0")try{i=r.decode(["string"],l.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(re(l.slice(0,4))==="0x4e487b71")try{const u=Number(r.decode(["uint256"],l.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},i=`Panic due to ${ts.get(u)||"UNKNOWN"}(${u})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?Qe(e.to):null,data:e.data||"0x"};return e.from&&(c.from=Qe(e.from)),wt(s,"CALL_EXCEPTION",{action:t,data:n,reason:i,transaction:c,invocation:o,revert:a})}class Oc{#e(e){if(e.isArray())return new rQ(this.#e(e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new eh(e.components.map(r=>this.#e(r)),e.name);switch(e.baseType){case"address":return new tQ(e.name);case"bool":return new sQ(e.name);case"string":return new fQ(e.name);case"bytes":return new iQ(e.name);case"":return new cQ(e.name)}let n=e.type.match(LX);if(n){let r=parseInt(n[2]||"256");return D(r!==0&&r<=256&&r%8===0,"invalid "+n[1]+" bit length","param",e),new hQ(r/8,n[1]==="int",e.name)}if(n=e.type.match($X),n){let r=parseInt(n[1]);return D(r!==0&&r<=32,"invalid bytes length","param",e),new oQ(r,e.name)}D(!1,"invalid type","type",e.type)}getDefaultValue(e){const n=e.map(s=>this.#e(ut.from(s)));return new eh(n,"_").defaultValue()}encode(e,n){sS(n.length,e.length,"types/values length mismatch");const r=e.map(o=>this.#e(ut.from(o))),s=new eh(r,"_"),i=new x0;return s.encode(i,n),i.data}decode(e,n,r){const s=e.map(o=>this.#e(ut.from(o)));return new eh(s,"_").decode(new ow(n,r,KA))}static _setDefaultMaxInflation(e){D(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),KA=e}static defaultAbiCoder(){return Jg==null&&(Jg=new Oc),Jg}static getBuiltinCallException(e,n,r){return MX(e,n,r,Oc.defaultAbiCoder())}}class FX{fragment;name;signature;topic;args;constructor(e,n,r){const s=e.name,i=e.format();ve(this,{fragment:e,name:s,signature:i,topic:n,args:r})}}class jX{fragment;name;args;signature;selector;value;constructor(e,n,r,s){const i=e.name,o=e.format();ve(this,{fragment:e,name:i,args:r,signature:o,selector:n,value:s})}}class HX{fragment;name;args;signature;selector;constructor(e,n,r){const s=e.name,i=e.format();ve(this,{fragment:e,name:s,args:r,signature:i,selector:n})}}class JA{hash;_isIndexed;static isIndexed(e){return!!(e&&e._isIndexed)}constructor(e){ve(this,{hash:e,_isIndexed:!0})}}const YA={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},ZA={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&YA[t.toString()]&&(e=YA[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};class So{fragments;deploy;fallback;receive;#e;#t;#n;#r;constructor(e){let n=[];typeof e=="string"?n=JSON.parse(e):n=e,this.#n=new Map,this.#e=new Map,this.#t=new Map;const r=[];for(const o of n)try{r.push(aa.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}ve(this,{fragments:Object.freeze(r)});let s=null,i=!1;this.#r=this.getAbiCoder(),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}ve(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(D(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":c=this.#n;break;case"event":c=this.#t;break;case"error":c=this.#e;break;default:return}const l=o.format();c.has(l)||c.set(l,o)}),this.deploy||ve(this,{deploy:Xs.from("constructor()")}),ve(this,{fallback:s,receive:i})}format(e){const n=e?"minimal":"full";return this.fragments.map(s=>s.format(n))}formatJson(){const e=this.fragments.map(n=>n.format("json"));return JSON.stringify(e.map(n=>JSON.parse(n)))}getAbiCoder(){return Oc.defaultAbiCoder()}#s(e,n,r){if(dt(e)){const i=e.toLowerCase();for(const o of this.#n.values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of this.#n)o.split("(")[0]===e&&i.push(a);if(n){const o=n.length>0?n[n.length-1]:null;let a=n.length,c=!0;Nt.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let l=i.length-1;l>=0;l--){const u=i[l].inputs.length;u!==a&&(!c||u!==a-1)&&i.splice(l,1)}for(let l=i.length-1;l>=0;l--){const u=i[l].inputs;for(let d=0;d<n.length;d++)if(Nt.isTyped(n[d])){if(d>=u.length){if(n[d].type==="overrides")continue;i.splice(l,1);break}if(n[d].type!==u[d].baseType){i.splice(l,1);break}}}}if(i.length===1&&n&&n.length!==i[0].inputs.length){const o=n[n.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&r){const o=i.map(a=>JSON.stringify(a.format())).join(", ");D(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=this.#n.get(ms.from(e).format());return s||null}getFunctionName(e){const n=this.#s(e,null,!1);return D(n,"no matching function","key",e),n.name}hasFunction(e){return!!this.#s(e,null,!1)}getFunction(e,n){return this.#s(e,n||null,!0)}forEachFunction(e){const n=Array.from(this.#n.keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(this.#n.get(s),r)}}#o(e,n,r){if(dt(e)){const i=e.toLowerCase();for(const o of this.#t.values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of this.#t)o.split("(")[0]===e&&i.push(a);if(n){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<n.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let c=0;c<n.length;c++)if(Nt.isTyped(n[c])&&n[c].type!==a[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&r){const o=i.map(a=>JSON.stringify(a.format())).join(", ");D(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=this.#t.get(gs.from(e).format());return s||null}getEventName(e){const n=this.#o(e,null,!1);return D(n,"no matching event","key",e),n.name}hasEvent(e){return!!this.#o(e,null,!1)}getEvent(e,n){return this.#o(e,n||null,!0)}forEachEvent(e){const n=Array.from(this.#t.keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(this.#t.get(s),r)}}getError(e,n){if(dt(e)){const s=e.toLowerCase();if(ZA[s])return Hn.from(ZA[s].signature);for(const i of this.#e.values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of this.#e)i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?Hn.from("error Error(string)"):e==="Panic"?Hn.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");D(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=Hn.from(e).format(),e==="Error(string)")return Hn.from("error Error(string)");if(e==="Panic(uint256)")return Hn.from("error Panic(uint256)");const r=this.#e.get(e);return r||null}forEachError(e){const n=Array.from(this.#e.keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(this.#e.get(s),r)}}_decodeParams(e,n){return this.#r.decode(e,n)}_encodeParams(e,n){return this.#r.encode(e,n)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,n){if(typeof e=="string"){const r=this.getError(e);D(r,"unknown error","fragment",e),e=r}return D(It(n,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",n),this._decodeParams(e.inputs,It(n,4))}encodeErrorResult(e,n){if(typeof e=="string"){const r=this.getError(e);D(r,"unknown error","fragment",e),e=r}return St([e.selector,this._encodeParams(e.inputs,n||[])])}decodeFunctionData(e,n){if(typeof e=="string"){const r=this.getFunction(e);D(r,"unknown function","fragment",e),e=r}return D(It(n,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",n),this._decodeParams(e.inputs,It(n,4))}encodeFunctionData(e,n){if(typeof e=="string"){const r=this.getFunction(e);D(r,"unknown function","fragment",e),e=r}return St([e.selector,this._encodeParams(e.inputs,n||[])])}decodeFunctionResult(e,n){if(typeof e=="string"){const i=this.getFunction(e);D(i,"unknown function","fragment",e),e=i}let r="invalid length for result data";const s=vn(n);if(s.length%32===0)try{return this.#r.decode(e.outputs,s)}catch{r="could not decode result data"}z(!1,r,"BAD_DATA",{value:re(s),info:{method:e.name,signature:e.format()}})}makeError(e,n){const r=ke(e,"data"),s=Oc.getBuiltinCallException("call",n,r);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=re(r.slice(0,4)),c=this.getError(a);if(c)try{const l=this.#r.decode(c.inputs,r.slice(4));s.revert={name:c.name,signature:c.format(),args:l},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(n);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,n){if(typeof e=="string"){const r=this.getFunction(e);D(r,"unknown function","fragment",e),e=r}return re(this.#r.encode(e.outputs,n||[]))}encodeFilterTopics(e,n){if(typeof e=="string"){const i=this.getEvent(e);D(i,"unknown event","eventFragment",e),e=i}z(n.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:n.length,expectedCount:e.inputs.length});const r=[];e.anonymous||r.push(e.topicHash);const s=(i,o)=>i.type==="string"?ia(o):i.type==="bytes"?Dt(re(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=io(o):i.type.match(/^bytes/)?o=nY(o,32):i.type==="address"&&this.#r.encode(["address"],[o]),ui(re(o),32));for(n.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){D(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?r.push(null):a.baseType==="array"||a.baseType==="tuple"?D(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?r.push(i.map(c=>s(a,c))):r.push(s(a,i))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,n){if(typeof e=="string"){const o=this.getEvent(e);D(o,"unknown event","eventFragment",e),e=o}const r=[],s=[],i=[];return e.anonymous||r.push(e.topicHash),D(n.length===e.inputs.length,"event arguments/values mismatch","values",n),e.inputs.forEach((o,a)=>{const c=n[a];if(o.indexed)if(o.type==="string")r.push(ia(c));else if(o.type==="bytes")r.push(Dt(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");r.push(this.#r.encode([o.type],[c]))}else s.push(o),i.push(c)}),{data:this.#r.encode(s,i),topics:r}}decodeEventLog(e,n,r){if(typeof e=="string"){const f=this.getEvent(e);D(f,"unknown event","eventFragment",e),e=f}if(r!=null&&!e.anonymous){const f=e.topicHash;D(dt(r[0],32)&&r[0].toLowerCase()===f,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((f,p)=>{f.indexed?f.type==="string"||f.type==="bytes"||f.baseType==="tuple"||f.baseType==="array"?(s.push(ut.from({type:"bytes32",name:f.name})),o.push(!0)):(s.push(f),o.push(!1)):(i.push(f),o.push(!1))});const a=r!=null?this.#r.decode(s,St(r)):null,c=this.#r.decode(i,n,!0),l=[],u=[];let d=0,h=0;return e.inputs.forEach((f,p)=>{let g=null;if(f.indexed)if(a==null)g=new JA(null);else if(o[p])g=new JA(a[h++]);else try{g=a[h++]}catch(m){g=m}else try{g=c[d++]}catch(m){g=m}l.push(g),u.push(f.name||null)}),Qs.fromItems(l,u)}parseTransaction(e){const n=ke(e.data,"tx.data"),r=de(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(re(n.slice(0,4)));if(!s)return null;const i=this.#r.decode(s.inputs,n.slice(4));return new jX(s,s.selector,i,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const n=this.getEvent(e.topics[0]);return!n||n.anonymous?null:new FX(n,n.topicHash,this.decodeEventLog(n,e.data,e.topics))}parseError(e){const n=re(e),r=this.getError(It(n,0,4));if(!r)return null;const s=this.#r.decode(r.inputs,It(n,4));return new HX(r,r.selector,s)}static from(e){return e instanceof So?e:typeof e=="string"?new So(JSON.parse(e)):typeof e.formatJson=="function"?new So(e.formatJson()):typeof e.format=="function"?new So(e.format("json")):new So(e)}}const Px=BigInt(0);function lc(t){return t??null}function xt(t){return t==null?null:t.toString()}class QA{gasPrice;maxFeePerGas;maxPriorityFeePerGas;constructor(e,n,r){ve(this,{gasPrice:lc(e),maxFeePerGas:lc(n),maxPriorityFeePerGas:lc(r)})}toJSON(){const{gasPrice:e,maxFeePerGas:n,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:xt(e),maxFeePerGas:xt(n),maxPriorityFeePerGas:xt(r)}}}function mf(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=re(t.data));const n="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of n)!(s in t)||t[s]==null||(e[s]=de(t[s],`request.${s}`));const r="type,nonce".split(/,/);for(const s of r)!(s in t)||t[s]==null||(e[s]=xe(t[s],`request.${s}`));return t.accessList&&(e.accessList=ya(t.accessList)),t.authorizationList&&(e.authorizationList=t.authorizationList.slice()),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map(s=>iw(s)?re(s):Object.assign({},s))),e}class zX{provider;number;hash;timestamp;parentHash;parentBeaconBlockRoot;nonce;difficulty;gasLimit;gasUsed;stateRoot;receiptsRoot;blobGasUsed;excessBlobGas;miner;prevRandao;extraData;baseFeePerGas;#e;constructor(e,n){this.#e=e.transactions.map(r=>typeof r!="string"?new fd(r,n):r),ve(this,{provider:n,hash:lc(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:lc(e.prevRandao),extraData:e.extraData,baseFeePerGas:lc(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return this.#e.map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=this.#e.slice();return e.length===0?[]:(z(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:n,extraData:r,gasLimit:s,gasUsed:i,hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:d,parentBeaconBlockRoot:h,stateRoot:f,receiptsRoot:p,timestamp:g,transactions:m}=this;return{_type:"Block",baseFeePerGas:xt(e),difficulty:xt(n),extraData:r,gasLimit:xt(s),gasUsed:xt(i),blobGasUsed:xt(this.blobGasUsed),excessBlobGas:xt(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:d,timestamp:g,parentBeaconBlockRoot:h,stateRoot:f,receiptsRoot:p,transactions:m}}[Symbol.iterator](){let e=0;const n=this.transactions;return{next:()=>e<this.length?{value:n[e++],done:!1}:{value:void 0,done:!0}}}get length(){return this.#e.length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let n;if(typeof e=="number")n=this.#e[e];else{const r=e.toLowerCase();for(const s of this.#e)if(typeof s=="string"){if(s!==r)continue;n=s;break}else{if(s.hash!==r)continue;n=s;break}}if(n==null)throw new Error("no such tx");return typeof n=="string"?await this.provider.getTransaction(n):n}getPrefetchedTransaction(e){const n=this.prefetchedTransactions;if(typeof e=="number")return n[e];e=e.toLowerCase();for(const r of n)if(r.hash===e)return r;D(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return qX(this)}}class hd{provider;transactionHash;blockHash;blockNumber;removed;address;data;topics;index;transactionIndex;constructor(e,n){this.provider=n;const r=Object.freeze(e.topics.slice());ve(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:n,blockNumber:r,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}=this;return{_type:"log",address:e,blockHash:n,blockNumber:r,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return z(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return z(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return z(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return WX(this)}}class Ox{provider;to;from;contractAddress;hash;index;blockHash;blockNumber;logsBloom;gasUsed;blobGasUsed;cumulativeGasUsed;gasPrice;blobGasPrice;type;status;root;#e;constructor(e,n){this.#e=Object.freeze(e.logs.map(s=>new hd(s,n)));let r=Px;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),ve(this,{provider:n,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return this.#e}toJSON(){const{to:e,from:n,contractAddress:r,hash:s,index:i,blockHash:o,blockNumber:a,logsBloom:c,logs:l,status:u,root:d}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:r,cumulativeGasUsed:xt(this.cumulativeGasUsed),from:n,gasPrice:xt(this.gasPrice),blobGasUsed:xt(this.blobGasUsed),blobGasPrice:xt(this.blobGasPrice),gasUsed:xt(this.gasUsed),hash:s,index:i,logs:l,logsBloom:c,root:d,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return kx(this)}reorderedEvent(e){return z(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),Rx(this,e)}}class fd{provider;blockNumber;blockHash;index;hash;type;to;from;nonce;gasLimit;gasPrice;maxPriorityFeePerGas;maxFeePerGas;maxFeePerBlobGas;data;value;chainId;signature;accessList;blobVersionedHashes;authorizationList;#e;constructor(e,n){this.provider=n,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,this.#e=-1}toJSON(){const{blockNumber:e,blockHash:n,index:r,hash:s,type:i,to:o,from:a,nonce:c,data:l,signature:u,accessList:d,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:d,blockNumber:e,blockHash:n,blobVersionedHashes:h,chainId:xt(this.chainId),data:l,from:a,gasLimit:xt(this.gasLimit),gasPrice:xt(this.gasPrice),hash:s,maxFeePerGas:xt(this.maxFeePerGas),maxPriorityFeePerGas:xt(this.maxPriorityFeePerGas),maxFeePerBlobGas:xt(this.maxFeePerBlobGas),nonce:c,signature:u,to:o,index:r,type:i,value:xt(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;const n=this.provider.getBlock(e);if(n==null)throw new Error("TODO");return n}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:n,blockNumber:r}=await En({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return n==null||n.blockNumber==null?0:r-n.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,n){const r=e??1,s=n??0;let i=this.#e,o=-1,a=i===-1;const c=async()=>{if(a)return null;const{blockNumber:h,nonce:f}=await En({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(f<this.nonce){i=h;return}if(a)return null;const p=await this.getTransaction();if(!(p&&p.blockNumber!=null))for(o===-1&&(o=i-3,o<this.#e&&(o=this.#e));o<=h;){if(a)return null;const g=await this.provider.getBlock(o,!0);if(g==null)return;for(const m of g)if(m===this.hash)return;for(let m=0;m<g.length;m++){const y=await g.getTransaction(m);if(y.from===this.from&&y.nonce===this.nonce){if(a)return null;const v=await this.provider.getTransactionReceipt(y.hash);if(v==null||h-v.blockNumber+1<r)return;let w="replaced";y.data===this.data&&y.to===this.to&&y.value===this.value?w="repriced":y.data==="0x"&&y.from===y.to&&y.value===Px&&(w="cancelled"),z(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:w==="replaced"||w==="cancelled",reason:w,replacement:y.replaceableTransaction(i),hash:y.hash,receipt:v})}}o++}},l=h=>{if(h==null||h.status!==0)return h;z(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:h.to,from:h.from,data:""},receipt:h})},u=await this.provider.getTransactionReceipt(this.hash);if(r===0)return l(u);if(u){if(r===1||await u.confirmations()>=r)return l(u)}else if(await c(),r===0)return null;return await new Promise((h,f)=>{const p=[],g=()=>{p.forEach(y=>y())};if(p.push(()=>{a=!0}),s>0){const y=setTimeout(()=>{g(),f(wt("wait for transaction timeout","TIMEOUT"))},s);p.push(()=>{clearTimeout(y)})}const m=async y=>{if(await y.confirmations()>=r){g();try{h(l(y))}catch(v){f(v)}}};if(p.push(()=>{this.provider.off(this.hash,m)}),this.provider.on(this.hash,m),i>=0){const y=async()=>{try{await c()}catch(v){if(an(v,"TRANSACTION_REPLACED")){g(),f(v);return}}a||this.provider.once("block",y)};p.push(()=>{this.provider.off("block",y)}),this.provider.once("block",y)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return z(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),kx(this)}reorderedEvent(e){return z(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),z(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Rx(this,e)}replaceableTransaction(e){D(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const n=new fd(this,this.provider);return n.#e=e,n}}function qX(t){return{orphan:"drop-block",hash:t.hash,number:t.number}}function Rx(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function kx(t){return{orphan:"drop-transaction",tx:t}}function WX(t){return{orphan:"drop-log",log:{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}}}class bw extends hd{interface;fragment;args;constructor(e,n,r){super(e,e.provider);const s=n.decodeEventLog(r,e.data,e.topics);ve(this,{args:s,fragment:r,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Dx extends hd{error;constructor(e,n){super(e,e.provider),ve(this,{error:n})}}class VX extends Ox{#e;constructor(e,n,r){super(r,n),this.#e=e}get logs(){return super.logs.map(e=>{const n=e.topics.length?this.#e.getEvent(e.topics[0]):null;if(n)try{return new bw(e,this.#e,n)}catch(r){return new Dx(e,r)}return e})}}class Ew extends fd{#e;constructor(e,n,r){super(r,n),this.#e=e}async wait(e,n){const r=await super.wait(e,n);return r==null?null:new VX(this.#e,this.provider,r)}}class Ux extends cS{log;constructor(e,n,r,s){super(e,n,r),ve(this,{log:s})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class GX extends Ux{constructor(e,n,r,s,i){super(e,n,r,new bw(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);ve(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const XA=BigInt(0);function Bx(t){return t&&typeof t.call=="function"}function $x(t){return t&&typeof t.estimateGas=="function"}function fp(t){return t&&typeof t.resolveName=="function"}function Lx(t){return t&&typeof t.sendTransaction=="function"}function Mx(t){if(t!=null){if(fp(t))return t;if(t.provider)return t.provider}}class KX{#e;fragment;constructor(e,n,r){if(ve(this,{fragment:n}),n.inputs.length<r.length)throw new Error("too many arguments");const s=ca(e.runner,"resolveName"),i=fp(s)?s:null;this.#e=async function(){const o=await Promise.all(n.inputs.map((a,c)=>r[c]==null?null:a.walkAsync(r[c],(u,d)=>u==="address"?Array.isArray(d)?Promise.all(d.map(h=>Cn(h,i))):Cn(d,i):d)));return e.interface.encodeFilterTopics(n,o)}()}getTopicFilter(){return this.#e}}function ca(t,e){return t==null?null:typeof t[e]=="function"?t:t.provider&&typeof t.provider[e]=="function"?t.provider:null}function Fo(t){return t==null?null:t.provider||null}async function Fx(t,e){const n=Nt.dereference(t,"overrides");D(typeof n=="object","invalid overrides parameter","overrides",t);const r=mf(n);return D(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),D(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function JX(t,e,n){const r=ca(t,"resolveName"),s=fp(r)?r:null;return await Promise.all(e.map((i,o)=>i.walkAsync(n[o],(a,c)=>(c=Nt.dereference(c,a),a==="address"?Cn(c,s):c))))}function YX(t){const e=async function(o){const a=await Fx(o,["data"]);a.to=await t.getAddress(),a.from&&(a.from=await Cn(a.from,Mx(t.runner)));const c=t.interface,l=de(a.value||XA,"overrides.value")===XA,u=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!u&&!l&&D(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),D(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const d=c.receive||c.fallback&&c.fallback.payable;return D(d||l,"cannot send value to non-payable fallback","overrides.value",a.value),D(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},n=async function(o){const a=ca(t.runner,"call");z(Bx(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(l){throw sw(l)&&l.data?t.interface.makeError(l.data,c):l}},r=async function(o){const a=t.runner;z(Lx(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),l=Fo(t.runner);return new Ew(t.interface,l,c)},s=async function(o){const a=ca(t.runner,"estimateGas");return z($x(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await r(o);return ve(i,{_contract:t,estimateGas:s,populateTransaction:e,send:r,staticCall:n}),i}function ZX(t,e){const n=function(...l){const u=t.interface.getFunction(e,l);return z(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:l}}),u},r=async function(...l){const u=n(...l);let d={};if(u.inputs.length+1===l.length&&(d=await Fx(l.pop()),d.from&&(d.from=await Cn(d.from,Mx(t.runner)))),u.inputs.length!==l.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const h=await JX(t.runner,u.inputs,l);return Object.assign({},d,await En({to:t.getAddress(),data:t.interface.encodeFunctionData(u,h)}))},s=async function(...l){const u=await a(...l);return u.length===1?u[0]:u},i=async function(...l){const u=t.runner;z(Lx(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const d=await u.sendTransaction(await r(...l)),h=Fo(t.runner);return new Ew(t.interface,h,d)},o=async function(...l){const u=ca(t.runner,"estimateGas");return z($x(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await r(...l))},a=async function(...l){const u=ca(t.runner,"call");z(Bx(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const d=await r(...l);let h="0x";try{h=await u.call(d)}catch(p){throw sw(p)&&p.data?t.interface.makeError(p.data,d):p}const f=n(...l);return t.interface.decodeFunctionResult(f,h)},c=async(...l)=>n(...l).constant?await s(...l):await i(...l);return ve(c,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:n,estimateGas:o,populateTransaction:r,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const l=t.interface.getFunction(e);return z(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),l}}),c}function QX(t,e){const n=function(...s){const i=t.interface.getEvent(e,s);return z(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},r=function(...s){return new KX(t,n(...s),s)};return ve(r,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:n}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=t.interface.getEvent(e);return z(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),r}const yf=Symbol.for("_ethersInternal_contract"),jx=new WeakMap;function XX(t,e){jx.set(t[yf],e)}function er(t){return jx.get(t[yf])}function eee(t){return t&&typeof t=="object"&&"getTopicFilter"in t&&typeof t.getTopicFilter=="function"&&t.fragment}async function vw(t,e){let n,r=null;if(Array.isArray(e)){const i=function(o){if(dt(o,32))return o;const a=t.interface.getEvent(o);return D(a,"unknown fragment","name",o),a.topicHash};n=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?n=[null]:typeof e=="string"?dt(e,32)?n=[e]:(r=t.interface.getEvent(e),D(r,"unknown fragment","event",e),n=[r.topicHash]):eee(e)?n=await e.getTopicFilter():"fragment"in e?(r=e.fragment,n=[r.topicHash]):D(!1,"unknown event name","event",e);n=n.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=n.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:r,tag:s,topics:n}}async function Il(t,e){const{subs:n}=er(t);return n.get((await vw(t,e)).tag)||null}async function eC(t,e,n){const r=Fo(t.runner);z(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await vw(t,n),{addr:a,subs:c}=er(t);let l=c.get(i);if(!l){const d={address:a||t,topics:o},h=m=>{let y=s;if(y==null)try{y=t.interface.getEvent(m.topics[0])}catch{}if(y){const v=y,w=s?t.interface.decodeEventLog(s,m.data,m.topics):[];j0(t,n,w,N=>new GX(t,N,n,v,m))}else j0(t,n,[],v=>new Ux(t,v,n,m))};let f=[];l={tag:i,listeners:[],start:()=>{f.length||f.push(r.on(d,h))},stop:async()=>{if(f.length==0)return;let m=f;f=[],await Promise.all(m),r.off(d,h)}},c.set(i,l)}return l}let F0=Promise.resolve();async function tee(t,e,n,r){await F0;const s=await Il(t,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const c=Array.from(n);r&&c.push(r(a?null:o));try{o.call(t,...c)}catch{}return!a}),s.listeners.length===0&&(s.stop(),er(t).subs.delete(s.tag)),i>0}async function j0(t,e,n,r){try{await F0}catch{}const s=tee(t,e,n,r);return F0=s,await s}const nh=["then"];class jl{target;interface;runner;filters;[yf];fallback;constructor(e,n,r,s){D(typeof e=="string"||GS(e),"invalid value for Contract target","target",e),r==null&&(r=null);const i=So.from(n);ve(this,{target:e,runner:r,interface:i}),Object.defineProperty(this,yf,{value:{}});let o,a=null,c=null;if(s){const d=Fo(r);c=new Ew(this.interface,d,s)}let l=new Map;if(typeof e=="string")if(dt(e))a=e,o=Promise.resolve(e);else{const d=ca(r,"resolveName");if(!fp(d))throw wt("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=d.resolveName(e).then(h=>{if(h==null)throw wt("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return er(this).addr=h,h})}else o=e.getAddress().then(d=>{if(d==null)throw new Error("TODO");return er(this).addr=d,d});XX(this,{addrPromise:o,addr:a,deployTx:c,subs:l});const u=new Proxy({},{get:(d,h,f)=>{if(typeof h=="symbol"||nh.indexOf(h)>=0)return Reflect.get(d,h,f);try{return this.getEvent(h)}catch(p){if(!an(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(d,h)=>nh.indexOf(h)>=0?Reflect.has(d,h):Reflect.has(d,h)||this.interface.hasEvent(String(h))});return ve(this,{filters:u}),ve(this,{fallback:i.receive||i.fallback?YX(this):null}),new Proxy(this,{get:(d,h,f)=>{if(typeof h=="symbol"||h in d||nh.indexOf(h)>=0)return Reflect.get(d,h,f);try{return d.getFunction(h)}catch(p){if(!an(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(d,h)=>typeof h=="symbol"||h in d||nh.indexOf(h)>=0?Reflect.has(d,h):d.interface.hasFunction(h)})}connect(e){return new jl(this.target,this.interface,e)}attach(e){return new jl(e,this.interface,this.runner)}async getAddress(){return await er(this).addrPromise}async getDeployedCode(){const e=Fo(this.runner);z(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const n=await e.getCode(await this.getAddress());return n==="0x"?null:n}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const r=Fo(this.runner);return z(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);r.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return er(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),ZX(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),QX(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,n,r){n==null&&(n=0),r==null&&(r="latest");const{addr:s,addrPromise:i}=er(this),o=s||await i,{fragment:a,topics:c}=await vw(this,e),l={address:o,topics:c,fromBlock:n,toBlock:r},u=Fo(this.runner);return z(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(l)).map(d=>{let h=a;if(h==null)try{h=this.interface.getEvent(d.topics[0])}catch{}if(h)try{return new bw(d,this.interface,h)}catch(f){return new Dx(d,f)}return new hd(d,u)})}async on(e,n){const r=await eC(this,"on",e);return r.listeners.push({listener:n,once:!1}),r.start(),this}async once(e,n){const r=await eC(this,"once",e);return r.listeners.push({listener:n,once:!0}),r.start(),this}async emit(e,...n){return await j0(this,e,n,null)}async listenerCount(e){if(e){const s=await Il(this,e);return s?s.listeners.length:0}const{subs:n}=er(this);let r=0;for(const{listeners:s}of n.values())r+=s.length;return r}async listeners(e){if(e){const s=await Il(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:n}=er(this);let r=[];for(const{listeners:s}of n.values())r=r.concat(s.map(({listener:i})=>i));return r}async off(e,n){const r=await Il(this,e);if(!r)return this;if(n){const s=r.listeners.map(({listener:i})=>i).indexOf(n);s>=0&&r.listeners.splice(s,1)}return(n==null||r.listeners.length===0)&&(r.stop(),er(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){const n=await Il(this,e);if(!n)return this;n.stop(),er(this).subs.delete(n.tag)}else{const{subs:n}=er(this);for(const{tag:r,stop:s}of n.values())s(),n.delete(r)}return this}async addListener(e,n){return await this.on(e,n)}async removeListener(e,n){return await this.off(e,n)}static buildClass(e){class n extends jl{constructor(s,i=null){super(s,e,i)}}return n}static from(e,n,r){return r==null&&(r=null),new this(e,n,r)}}function nee(){return jl}class Cs extends nee(){}function Yg(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):D(!1,"unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}class ree{name;constructor(e){ve(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,n){throw new Error("unsupported coin")}async decodeAddress(e,n){throw new Error("unsupported coin")}}const Hx=new RegExp("^(ipfs)://(.*)$","i"),tC=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),Hx,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];class uc{provider;address;name;#e;#t;constructor(e,n,r){ve(this,{provider:e,address:n,name:r}),this.#e=null,this.#t=new Cs(n,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e)}async supportsWildcard(){return this.#e==null&&(this.#e=(async()=>{try{return await this.#t.supportsInterface("0x9061b923")}catch(e){if(an(e,"CALL_EXCEPTION"))return!1;throw this.#e=null,e}})()),await this.#e}async#n(e,n){n=(n||[]).slice();const r=this.#t.interface;n.unshift(M0(this.name));let s=null;await this.supportsWildcard()&&(s=r.getFunction(e),z(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),n=[wX(this.name,255),r.encodeFunctionData(s,n)],e="resolve(bytes,bytes)"),n.push({enableCcipRead:!0});try{const i=await this.#t[e](...n);return s?r.decodeFunctionResult(s,i)[0]:i}catch(i){if(!an(i,"CALL_EXCEPTION"))throw i}return null}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await this.#n("addr(bytes32)");return i==null||i===$u?null:i}catch(i){if(an(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await this.#n("addr(bytes32,uint)",[i]);if(dt(o,20))return Qe(o)}let n=null;for(const i of this.provider.plugins)if(i instanceof ree&&i.supportsCoinType(e)){n=i;break}if(n==null)return null;const r=await this.#n("addr(bytes32,uint)",[e]);if(r==null||r==="0x")return null;const s=await n.decodeAddress(e,r);if(s!=null)return s;z(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:r}})}async getText(e){const n=await this.#n("text(bytes32,string)",[e]);return n==null||n==="0x"?null:n}async getContentHash(){const e=await this.#n("contenthash(bytes32)");if(e==null||e==="0x")return null;const n=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(n){const s=n[1]==="e3010170"?"ipfs":"ipns",i=parseInt(n[4],16);if(n[5].length===i*2)return`${s}://${sY("0x"+n[2])}`}const r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&r[1].length===64)return`bzz://${r[1]}`;z(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const n=await this.getText("avatar");if(n==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:n});for(let r=0;r<tC.length;r++){const s=n.match(tC[r]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:n}),{linkage:e,url:n};case"ipfs":{const o=Yg(n);return e.push({type:"ipfs",value:n}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:n});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(s[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const l=c[1],u=new Cs(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const g=await u.ownerOf(l);if(a!==g)return e.push({type:"!owner",value:g}),{url:null,linkage:e};e.push({type:"owner",value:g})}else if(i==="erc1155"){const g=await u.balanceOf(a,l);if(!g)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:g.toString()})}let d=await u[o](l);if(d==null||d==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:d}),i==="erc1155"&&(d=d.replace("{id}",io(l,32).substring(2)),e.push({type:"metadata-url-expanded",value:d})),d.match(/^ipfs:/i)&&(d=Yg(d)),e.push({type:"metadata-url",value:d});let h={};const f=await new di(d).send();f.assertOk();try{h=f.bodyJson}catch{try{e.push({type:"!metadata",value:f.bodyText})}catch{const y=f.body;return y&&e.push({type:"!metadata",value:re(y)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!h)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(h)});let p=h.image;if(typeof p!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!p.match(/^(https:\/\/|data:)/i)){if(p.match(Hx)==null)return e.push({type:"!imageUrl-ipfs",value:p}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:p}),p=Yg(p)}return e.push({type:"url",value:p}),{linkage:e,url:p}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const n=await e.getNetwork(),r=n.getPlugin("org.ethers.plugins.network.Ens");return z(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:n}}),r.address}static async#r(e,n){const r=await uc.getEnsAddress(e);try{const i=await new Cs(r,["function resolver(bytes32) view returns (address)"],e).resolver(M0(n),{enableCcipRead:!0});return i===$u?null:i}catch(s){throw s}return null}static async fromName(e,n){let r=n;for(;;){if(r===""||r==="."||n!=="eth"&&r==="eth")return null;const s=await uc.#r(e,r);if(s!=null){const i=new uc(e,s,n);return r!==n&&!await i.supportsWildcard()?null:i}r=r.split(".").slice(1).join(".")}}}const nC=BigInt(0);function Le(t,e){return function(n){return n==null?e:t(n)}}function zu(t,e){return n=>{if(e&&n==null)return null;if(!Array.isArray(n))throw new Error("not an array");return n.map(r=>t(r))}}function pd(t,e){return n=>{const r={};for(const s in t){let i=s;if(e&&s in e&&!(i in n)){for(const o of e[s])if(o in n){i=o;break}}try{const o=t[s](n[i]);o!==void 0&&(r[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";z(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:n})}}return r}}function see(t){switch(t){case!0:case"true":return!0;case!1:case"false":return!1}D(!1,`invalid boolean; ${JSON.stringify(t)}`,"value",t)}function Rc(t){return D(dt(t,!0),"invalid data","value",t),t}function sn(t){return D(dt(t,32),"invalid hash","value",t),t}const iee=pd({address:Qe,blockHash:sn,blockNumber:xe,data:Rc,index:xe,removed:Le(see,!1),topics:zu(sn),transactionHash:sn,transactionIndex:xe},{index:["logIndex"]});function oee(t){return iee(t)}const aee=pd({hash:Le(sn),parentHash:sn,parentBeaconBlockRoot:Le(sn,null),number:xe,timestamp:xe,nonce:Le(Rc),difficulty:de,gasLimit:de,gasUsed:de,stateRoot:Le(sn,null),receiptsRoot:Le(sn,null),blobGasUsed:Le(de,null),excessBlobGas:Le(de,null),miner:Le(Qe),prevRandao:Le(sn,null),extraData:Rc,baseFeePerGas:Le(de)},{prevRandao:["mixHash"]});function cee(t){const e=aee(t);return e.transactions=t.transactions.map(n=>typeof n=="string"?n:zx(n)),e}const lee=pd({transactionIndex:xe,blockNumber:xe,transactionHash:sn,address:Qe,topics:zu(sn),data:Rc,index:xe,blockHash:sn},{index:["logIndex"]});function uee(t){return lee(t)}const dee=pd({to:Le(Qe,null),from:Le(Qe,null),contractAddress:Le(Qe,null),index:xe,root:Le(re),gasUsed:de,blobGasUsed:Le(de,null),logsBloom:Le(Rc),blockHash:sn,hash:sn,logs:zu(uee),blockNumber:xe,cumulativeGasUsed:de,effectiveGasPrice:Le(de),blobGasPrice:Le(de,null),status:Le(xe),type:Le(xe,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function hee(t){return dee(t)}function zx(t){t.to&&de(t.to)===nC&&(t.to="0x0000000000000000000000000000000000000000");const e=pd({hash:sn,index:Le(xe,void 0),type:n=>n==="0x"||n==null?0:xe(n),accessList:Le(ya,null),blobVersionedHashes:Le(zu(sn,!0),null),authorizationList:Le(zu(n=>{let r;if(n.signature)r=n.signature;else{let s=n.yParity;s==="0x1b"?s=0:s==="0x1c"&&(s=1),r=Object.assign({},n,{yParity:s})}return{address:Qe(n.address),chainId:de(n.chainId),nonce:de(n.nonce),signature:_t.from(r)}},!1),null),blockHash:Le(sn,null),blockNumber:Le(xe,null),transactionIndex:Le(xe,null),from:Qe,gasPrice:Le(de),maxPriorityFeePerGas:Le(de),maxFeePerGas:Le(de),maxFeePerBlobGas:Le(de,null),gasLimit:de,to:Le(Qe,null),value:de,nonce:xe,data:Rc,creates:Le(Qe,null),chainId:Le(de,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(t);if(e.to==null&&e.creates==null&&(e.creates=eQ(e)),(t.type===1||t.type===2)&&t.accessList==null&&(e.accessList=[]),t.signature?e.signature=_t.from(t.signature):e.signature=_t.from(t),e.chainId==null){const n=e.signature.legacyChainId;n!=null&&(e.chainId=n)}return e.blockHash&&de(e.blockHash)===nC&&(e.blockHash=null),e}const fee="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class gd{name;constructor(e){ve(this,{name:e})}clone(){return new gd(this.name)}}class pp extends gd{effectiveBlock;txBase;txCreate;txDataZero;txDataNonzero;txAccessListStorageKey;txAccessListAddress;constructor(e,n){e==null&&(e=0),super(`org.ethers.network.plugins.GasCost#${e||0}`);const r={effectiveBlock:e};function s(i,o){let a=(n||{})[i];a==null&&(a=o),D(typeof a=="number",`invalud value for ${i}`,"costs",n),r[i]=a}s("txBase",21e3),s("txCreate",32e3),s("txDataZero",4),s("txDataNonzero",16),s("txAccessListStorageKey",1900),s("txAccessListAddress",2400),ve(this,r)}clone(){return new pp(this.effectiveBlock,this)}}class gp extends gd{address;targetNetwork;constructor(e,n){super("org.ethers.plugins.network.Ens"),ve(this,{address:e||fee,targetNetwork:n??1})}clone(){return new gp(this.address,this.targetNetwork)}}class pee extends gd{#e;#t;get url(){return this.#e}get processFunc(){return this.#t}constructor(e,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin"),this.#e=e,this.#t=n}clone(){return this}}const Zg=new Map;class ir{#e;#t;#n;constructor(e,n){this.#e=e,this.#t=de(n),this.#n=new Map}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return this.#e}set name(e){this.#e=e}get chainId(){return this.#t}set chainId(e){this.#t=de(e,"chainId")}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===de(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===de(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===de(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(this.#n.values())}attachPlugin(e){if(this.#n.get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return this.#n.set(e.name,e.clone()),this}getPlugin(e){return this.#n.get(e)||null}getPlugins(e){return this.plugins.filter(n=>n.name.split("#")[0]===e)}clone(){const e=new ir(this.name,this.chainId);return this.plugins.forEach(n=>{e.attachPlugin(n.clone())}),e}computeIntrinsicGas(e){const n=this.getPlugin("org.ethers.plugins.network.GasCost")||new pp;let r=n.txBase;if(e.to==null&&(r+=n.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?r+=n.txDataZero:r+=n.txDataNonzero;if(e.accessList){const s=ya(e.accessList);for(const i in s)r+=n.txAccessListAddress+n.txAccessListStorageKey*s[i].storageKeys.length}return r}static from(e){if(gee(),e==null)return ir.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const n=Zg.get(e);if(n)return n();if(typeof e=="bigint")return new ir("unknown",e);D(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){D(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const n=new ir(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&n.attachPlugin(new gp(e.ensAddress,e.ensNetwork)),n}D(!1,"invalid network","network",e)}static register(e,n){typeof e=="number"&&(e=BigInt(e));const r=Zg.get(e);r&&D(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",e),Zg.set(e,n)}}function rC(t,e){const n=String(t);if(!n.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${t}`);const r=n.split(".");if(r.length===1&&r.push(""),r.length!==2)throw new Error(`invalid gwei value: ${t}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let s=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||s++,r[1]=s.toString()}return BigInt(r[0]+r[1])}function sC(t){return new pee(t,async(e,n,r)=>{r.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([r.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:rC(a.maxFee,9),maxPriorityFeePerGas:rC(a.maxPriorityFee,9)}}catch(i){z(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:s,error:i})}})}let iC=!1;function gee(){if(iC)return;iC=!0;function t(e,n,r){const s=function(){const i=new ir(e,n);return r.ensNetwork!=null&&i.attachPlugin(new gp(null,r.ensNetwork)),i.attachPlugin(new pp),(r.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};ir.register(e,s),ir.register(n,s),r.altNames&&r.altNames.forEach(i=>{ir.register(i,s)})}t("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),t("ropsten",3,{ensNetwork:3}),t("rinkeby",4,{ensNetwork:4}),t("goerli",5,{ensNetwork:5}),t("kovan",42,{ensNetwork:42}),t("sepolia",11155111,{ensNetwork:11155111}),t("holesky",17e3,{ensNetwork:17e3}),t("classic",61,{}),t("classicKotti",6,{}),t("arbitrum",42161,{ensNetwork:1}),t("arbitrum-goerli",421613,{}),t("arbitrum-sepolia",421614,{}),t("base",8453,{ensNetwork:1}),t("base-goerli",84531,{}),t("base-sepolia",84532,{}),t("bnb",56,{ensNetwork:1}),t("bnbt",97,{}),t("linea",59144,{ensNetwork:1}),t("linea-goerli",59140,{}),t("linea-sepolia",59141,{}),t("matic",137,{ensNetwork:1,plugins:[sC("https://gasstation.polygon.technology/v2")]}),t("matic-amoy",80002,{}),t("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[sC("https://gasstation-testnet.polygon.technology/v2")]}),t("optimism",10,{ensNetwork:1,plugins:[]}),t("optimism-goerli",420,{}),t("optimism-sepolia",11155420,{}),t("xdai",100,{ensNetwork:1})}function H0(t){return JSON.parse(JSON.stringify(t))}class mee{#e;#t;#n;#r;constructor(e){this.#e=e,this.#t=null,this.#n=4e3,this.#r=-2}get pollingInterval(){return this.#n}set pollingInterval(e){this.#n=e}async#s(){try{const e=await this.#e.getBlockNumber();if(this.#r===-2){this.#r=e;return}if(e!==this.#r){for(let n=this.#r+1;n<=e;n++){if(this.#t==null)return;await this.#e.emit("block",n)}this.#r=e}}catch{}this.#t!=null&&(this.#t=this.#e._setTimeout(this.#s.bind(this),this.#n))}start(){this.#t||(this.#t=this.#e._setTimeout(this.#s.bind(this),this.#n),this.#s())}stop(){this.#t&&(this.#e._clearTimeout(this.#t),this.#t=null)}pause(e){this.stop(),e&&(this.#r=-2)}resume(){this.start()}}class Aw{#e;#t;#n;constructor(e){this.#e=e,this.#n=!1,this.#t=n=>{this._poll(n,this.#e)}}async _poll(e,n){throw new Error("sub-classes must override this")}start(){this.#n||(this.#n=!0,this.#t(-2),this.#e.on("block",this.#t))}stop(){this.#n&&(this.#n=!1,this.#e.off("block",this.#t))}pause(e){this.stop()}resume(){this.start()}}class yee extends Aw{#e;#t;constructor(e,n){super(e),this.#e=n,this.#t=-2}pause(e){e&&(this.#t=-2),super.pause(e)}async _poll(e,n){const r=await n.getBlock(this.#e);r!=null&&(this.#t===-2?this.#t=r.number:r.number>this.#t&&(n.emit(this.#e,r.number),this.#t=r.number))}}class wee extends Aw{#e;constructor(e,n){super(e),this.#e=H0(n)}async _poll(e,n){throw new Error("@TODO")}}class bee extends Aw{#e;constructor(e,n){super(e),this.#e=n}async _poll(e,n){const r=await n.getTransactionReceipt(this.#e);r&&n.emit(this.#e,r)}}class Cw{#e;#t;#n;#r;#s;constructor(e,n){this.#e=e,this.#t=H0(n),this.#n=this.#o.bind(this),this.#r=!1,this.#s=-2}async#o(e){if(this.#s===-2)return;const n=H0(this.#t);n.fromBlock=this.#s+1,n.toBlock=e;const r=await this.#e.getLogs(n);if(r.length===0){this.#s<e-60&&(this.#s=e-60);return}for(const s of r)this.#e.emit(this.#t,s),this.#s=s.blockNumber}start(){this.#r||(this.#r=!0,this.#s===-2&&this.#e.getBlockNumber().then(e=>{this.#s=e}),this.#e.on("block",this.#n))}stop(){this.#r&&(this.#r=!1,this.#e.off("block",this.#n))}pause(e){this.stop(),e&&(this.#s=-2)}resume(){this.start()}}const Eee=BigInt(2),vee=10;function rh(t){return t&&typeof t.then=="function"}function Eh(t,e){return t+":"+JSON.stringify(e,(n,r)=>{if(r==null)return"null";if(typeof r=="bigint")return`bigint:${r.toString()}`;if(typeof r=="string")return r.toLowerCase();if(typeof r=="object"&&!Array.isArray(r)){const s=Object.keys(r);return s.sort(),s.reduce((i,o)=>(i[o]=r[o],i),{})}return r})}class qx{name;constructor(e){ve(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function Aee(t){return JSON.parse(JSON.stringify(t))}function z0(t){return t=Array.from(new Set(t).values()),t.sort(),t}async function Qg(t,e){if(t==null)throw new Error("invalid event");if(Array.isArray(t)&&(t={topics:t}),typeof t=="string")switch(t){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:t,tag:t}}if(dt(t,32)){const n=t.toLowerCase();return{type:"transaction",tag:Eh("tx",{hash:n}),hash:n}}if(t.orphan){const n=t;return{type:"orphan",tag:Eh("orphan",n),filter:Aee(n)}}if(t.address||t.topics){const n=t,r={topics:(n.topics||[]).map(s=>s==null?null:Array.isArray(s)?z0(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(n.address){const s=[],i=[],o=a=>{dt(a)?s.push(a):i.push((async()=>{s.push(await Cn(a,e))})())};Array.isArray(n.address)?n.address.forEach(o):o(n.address),i.length&&await Promise.all(i),r.address=z0(s.map(a=>a.toLowerCase()))}return{filter:r,tag:Eh("event",r),type:"event"}}D(!1,"unknown ProviderEvent","event",t)}function Xg(){return new Date().getTime()}const Cee={cacheTimeout:250,pollingInterval:4e3};class Iee{#e;#t;#n;#r;#s;#o;#i;#a;#d;#l;#p;#g;constructor(e,n){if(this.#g=Object.assign({},Cee,n||{}),e==="any")this.#o=!0,this.#s=null;else if(e){const r=ir.from(e);this.#o=!1,this.#s=Promise.resolve(r),setTimeout(()=>{this.emit("network",r,null)},0)}else this.#o=!1,this.#s=null;this.#a=-1,this.#i=new Map,this.#e=new Map,this.#t=new Map,this.#n=null,this.#r=!1,this.#d=1,this.#l=new Map,this.#p=!1}get pollingInterval(){return this.#g.pollingInterval}get provider(){return this}get plugins(){return Array.from(this.#t.values())}attachPlugin(e){if(this.#t.get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return this.#t.set(e.name,e.connect(this)),this}getPlugin(e){return this.#t.get(e)||null}get disableCcipRead(){return this.#p}set disableCcipRead(e){this.#p=!!e}async#c(e){const n=this.#g.cacheTimeout;if(n<0)return await this._perform(e);const r=Eh(e.method,e);let s=this.#i.get(r);return s||(s=this._perform(e),this.#i.set(r,s),setTimeout(()=>{this.#i.get(r)===s&&this.#i.delete(r)},n)),await s}async ccipReadFetch(e,n,r){if(this.disableCcipRead||r.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=n.toLowerCase(),o=[];for(let a=0;a<r.length;a++){const c=r[a],l=c.replace("{sender}",s).replace("{data}",i),u=new di(l);c.indexOf("{data}")===-1&&(u.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:r});let d="unknown error",h;try{h=await u.send()}catch(f){o.push(f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:f}});continue}try{const f=h.bodyJson;if(f.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:f}),f.data;f.message&&(d=f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:f})}catch{}z(h.statusCode<400||h.statusCode>=500,`response not found during CCIP fetch: ${d}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:d}}),o.push(d)}z(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:r,errorMessages:o}})}_wrapBlock(e,n){return new zX(cee(e),this)}_wrapLog(e,n){return new hd(oee(e),this)}_wrapTransactionReceipt(e,n){return new Ox(hee(e),this)}_wrapTransactionResponse(e,n){return new fd(zx(e),this)}_detectNetwork(){z(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){z(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=xe(await this.#c({method:"getBlockNumber"}),"%response");return this.#a>=0&&(this.#a=e),e}_getAddress(e){return Cn(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(dt(e))return dt(e,32)?e:zr(e);if(typeof e=="bigint"&&(e=xe(e,"blockTag")),typeof e=="number")return e>=0?zr(e):this.#a>=0?zr(this.#a+e):this.getBlockNumber().then(n=>zr(n+e));D(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const n=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?z0(c.map(l=>l.toLowerCase())):c.toLowerCase()),r="blockHash"in e?e.blockHash:void 0,s=(c,l,u)=>{let d;switch(c.length){case 0:break;case 1:d=c[0];break;default:c.sort(),d=c}if(r&&(l!=null||u!=null))throw new Error("invalid filter");const h={};return d&&(h.address=d),n.length&&(h.topics=n),l&&(h.fromBlock=l),u&&(h.toBlock=u),r&&(h.blockHash=r),h};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(c=>s(c[0],c[1],c[2])):s(i,o,a)}_getTransactionRequest(e){const n=mf(e),r=[];if(["to","from"].forEach(s=>{if(n[s]==null)return;const i=Cn(n[s],this);rh(i)?r.push(async function(){n[s]=await i}()):n[s]=i}),n.blockTag!=null){const s=this._getBlockTag(n.blockTag);rh(s)?r.push(async function(){n.blockTag=await s}()):n.blockTag=s}return r.length?async function(){return await Promise.all(r),n}():n}async getNetwork(){if(this.#s==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw this.#s===s&&(this.#s=null),i}})();return this.#s=s,(await s).clone()}const e=this.#s,[n,r]=await Promise.all([e,this._detectNetwork()]);return n.chainId!==r.chainId&&(this.#o?(this.emit("network",r,n),this.#s===e&&(this.#s=Promise.resolve(r))):z(!1,`network changed: ${n.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),n.clone()}async getFeeData(){const e=await this.getNetwork(),n=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await En({_block:this.#y("latest",!1),gasPrice:(async()=>{try{const u=await this.#c({method:"getGasPrice"});return de(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await this.#c({method:"getPriorityFee"});return de(u,"%response")}catch{}return null})()});let a=null,c=null;const l=this._wrapBlock(s,e);return l&&l.baseFeePerGas&&(c=o??BigInt("1000000000"),a=l.baseFeePerGas*Eee+c),new QA(i,a,c)},r=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){const s=new di(r.url),i=await r.processFunc(n,this,s);return new QA(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await n()}async estimateGas(e){let n=this._getTransactionRequest(e);return rh(n)&&(n=await n),de(await this.#c({method:"estimateGas",transaction:n}),"%response")}async#u(e,n,r){z(r<vee,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:n,enableCcipRead:!0})});const s=mf(e);try{return re(await this._perform({method:"call",transaction:s,blockTag:n}))}catch(i){if(!this.disableCcipRead&&sw(i)&&i.data&&r>=0&&n==="latest"&&s.to!=null&&It(i.data,0,4)==="0x556f1830"){const o=i.data,a=await Cn(s.to,this);let c;try{c=Tee(It(i.data,4))}catch(d){z(!1,d.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}z(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const l=await this.ccipReadFetch(s,c.calldata,c.urls);z(l!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:c.errorArgs}});const u={to:a,data:St([c.selector,xee([l,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const d=await this.#u(u,n,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:d}),d}catch(d){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:d}),d}}throw i}}async#h(e){const{value:n}=await En({network:this.getNetwork(),value:e});return n}async call(e){const{tx:n,blockTag:r}=await En({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await this.#h(this.#u(n,r,e.enableCcipRead?0:-1))}async#f(e,n,r){let s=this._getAddress(n),i=this._getBlockTag(r);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await this.#h(this.#c(Object.assign(e,{address:s,blockTag:i})))}async getBalance(e,n){return de(await this.#f({method:"getBalance"},e,n),"%response")}async getTransactionCount(e,n){return xe(await this.#f({method:"getTransactionCount"},e,n),"%response")}async getCode(e,n){return re(await this.#f({method:"getCode"},e,n))}async getStorage(e,n,r){const s=de(n,"position");return re(await this.#f({method:"getStorage",position:s},e,r))}async broadcastTransaction(e){const{blockNumber:n,hash:r,network:s}=await En({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=jr.from(e);if(i.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(n)}async#y(e,n){if(dt(e,32))return await this.#c({method:"getBlock",blockHash:e,includeTransactions:n});let r=this._getBlockTag(e);return typeof r!="string"&&(r=await r),await this.#c({method:"getBlock",blockTag:r,includeTransactions:n})}async getBlock(e,n){const{network:r,params:s}=await En({network:this.getNetwork(),params:this.#y(e,!!n)});return s==null?null:this._wrapBlock(s,r)}async getTransaction(e){const{network:n,params:r}=await En({network:this.getNetwork(),params:this.#c({method:"getTransaction",hash:e})});return r==null?null:this._wrapTransactionResponse(r,n)}async getTransactionReceipt(e){const{network:n,params:r}=await En({network:this.getNetwork(),params:this.#c({method:"getTransactionReceipt",hash:e})});if(r==null)return null;if(r.gasPrice==null&&r.effectiveGasPrice==null){const s=await this.#c({method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(r,n)}async getTransactionResult(e){const{result:n}=await En({network:this.getNetwork(),result:this.#c({method:"getTransactionResult",hash:e})});return n==null?null:re(n)}async getLogs(e){let n=this._getFilter(e);rh(n)&&(n=await n);const{network:r,params:s}=await En({network:this.getNetwork(),params:this.#c({method:"getLogs",filter:n})});return s.map(i=>this._wrapLog(i,r))}_getProvider(e){z(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await uc.fromName(this,e)}async getAvatar(e){const n=await this.getResolver(e);return n?await n.getAvatar():null}async resolveName(e){const n=await this.getResolver(e);return n?await n.getAddress():null}async lookupAddress(e){e=Qe(e);const n=M0(e.substring(2).toLowerCase()+".addr.reverse");try{const r=await uc.getEnsAddress(this),i=await new Cs(r,["function resolver(bytes32) view returns (address)"],this).resolver(n);if(i==null||i===$u)return null;const a=await new Cs(i,["function name(bytes32) view returns (string)"],this).name(n);return await this.resolveName(a)!==e?null:a}catch(r){if(an(r,"BAD_DATA")&&r.value==="0x"||an(r,"CALL_EXCEPTION"))return null;throw r}return null}async waitForTransaction(e,n,r){const s=n??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const c=async l=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&l-u.blockNumber+1>=s){i(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",c)};r!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(wt("timeout","TIMEOUT",{reason:"timeout"})))},r)),c(await this.getBlockNumber())})}async waitForBlock(e){z(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const n=this.#l.get(e);n&&(n.timer&&clearTimeout(n.timer),this.#l.delete(e))}_setTimeout(e,n){n==null&&(n=0);const r=this.#d++,s=()=>{this.#l.delete(r),e()};if(this.paused)this.#l.set(r,{timer:null,func:s,time:n});else{const i=setTimeout(s,n);this.#l.set(r,{timer:i,func:s,time:Xg()})}return r}_forEachSubscriber(e){for(const n of this.#e.values())e(n.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new qx(e.type);case"block":{const n=new mee(this);return n.pollingInterval=this.pollingInterval,n}case"safe":case"finalized":return new yee(this,e.type);case"event":return new Cw(this,e.filter);case"transaction":return new bee(this,e.hash);case"orphan":return new wee(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,n){for(const r of this.#e.values())if(r.subscriber===e){r.started&&r.subscriber.stop(),r.subscriber=n,r.started&&n.start(),this.#n!=null&&n.pause(this.#n);break}}async#m(e,n){let r=await Qg(e,this);return r.type==="event"&&n&&n.length>0&&n[0].removed===!0&&(r=await Qg({orphan:"drop-log",log:n[0]},this)),this.#e.get(r.tag)||null}async#w(e){const n=await Qg(e,this),r=n.tag;let s=this.#e.get(r);return s||(s={subscriber:this._getSubscriber(n),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},this.#e.set(r,s)),s}async on(e,n){const r=await this.#w(e);return r.listeners.push({listener:n,once:!1}),r.started||(r.subscriber.start(),r.started=!0,this.#n!=null&&r.subscriber.pause(this.#n)),this}async once(e,n){const r=await this.#w(e);return r.listeners.push({listener:n,once:!0}),r.started||(r.subscriber.start(),r.started=!0,this.#n!=null&&r.subscriber.pause(this.#n)),this}async emit(e,...n){const r=await this.#m(e,n);if(!r||r.listeners.length===0)return!1;const s=r.listeners.length;return r.listeners=r.listeners.filter(({listener:i,once:o})=>{const a=new cS(this,o?null:i,e);try{i.call(this,...n,a)}catch{}return!o}),r.listeners.length===0&&(r.started&&r.subscriber.stop(),this.#e.delete(r.tag)),s>0}async listenerCount(e){if(e){const r=await this.#m(e);return r?r.listeners.length:0}let n=0;for(const{listeners:r}of this.#e.values())n+=r.length;return n}async listeners(e){if(e){const r=await this.#m(e);return r?r.listeners.map(({listener:s})=>s):[]}let n=[];for(const{listeners:r}of this.#e.values())n=n.concat(r.map(({listener:s})=>s));return n}async off(e,n){const r=await this.#m(e);if(!r)return this;if(n){const s=r.listeners.map(({listener:i})=>i).indexOf(n);s>=0&&r.listeners.splice(s,1)}return(!n||r.listeners.length===0)&&(r.started&&r.subscriber.stop(),this.#e.delete(r.tag)),this}async removeAllListeners(e){if(e){const{tag:n,started:r,subscriber:s}=await this.#w(e);r&&s.stop(),this.#e.delete(n)}else for(const[n,{started:r,subscriber:s}]of this.#e)r&&s.stop(),this.#e.delete(n);return this}async addListener(e,n){return await this.on(e,n)}async removeListener(e,n){return this.off(e,n)}get destroyed(){return this.#r}destroy(){this.removeAllListeners();for(const e of this.#l.keys())this._clearTimeout(e);this.#r=!0}get paused(){return this.#n!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(this.#a=-1,this.#n!=null){if(this.#n==!!e)return;z(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(n=>n.pause(e)),this.#n=!!e;for(const n of this.#l.values())n.timer&&clearTimeout(n.timer),n.time=Xg()-n.time}resume(){if(this.#n!=null){this._forEachSubscriber(e=>e.resume()),this.#n=null;for(const e of this.#l.values()){let n=e.time;n<0&&(n=0),e.time=Xg(),setTimeout(e.func,n)}}}}function _ee(t,e){try{const n=q0(t,e);if(n)return lf(n)}catch{}return null}function q0(t,e){if(t==="0x")return null;try{const n=xe(It(t,e,e+32)),r=xe(It(t,n,n+32));return It(t,n+32,n+32+r)}catch{}return null}function oC(t){const e=jt(t);if(e.length>32)throw new Error("internal; should not happen");const n=new Uint8Array(32);return n.set(e,32-e.length),n}function Nee(t){if(t.length%32===0)return t;const e=new Uint8Array(Math.ceil(t.length/32)*32);return e.set(t),e}const See=new Uint8Array([]);function xee(t){const e=[];let n=0;for(let r=0;r<t.length;r++)e.push(See),n+=32;for(let r=0;r<t.length;r++){const s=ke(t[r]);e[r]=oC(n),e.push(oC(s.length)),e.push(Nee(s)),n+=32+Math.ceil(s.length/32)*32}return St(e)}const aC="0x0000000000000000000000000000000000000000000000000000000000000000";function Tee(t){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};z(oc(t)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const n=It(t,0,32);z(It(n,0,12)===It(aC,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=It(n,12);try{const r=[],s=xe(It(t,32,64)),i=xe(It(t,s,s+32)),o=It(t,s+32);for(let a=0;a<i;a++){const c=_ee(o,a*32);if(c==null)throw new Error("abort");r.push(c)}e.urls=r}catch{z(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const r=q0(t,64);if(r==null)throw new Error("abort");e.calldata=r}catch{z(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}z(It(t,100,128)===It(aC,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=It(t,96,100);try{const r=q0(t,128);if(r==null)throw new Error("abort");e.extraData=r}catch{z(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(r=>e[r]),e}function wo(t,e){if(t.provider)return t.provider;z(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function cC(t,e){let n=mf(e);if(n.to!=null&&(n.to=Cn(n.to,t)),n.from!=null){const r=n.from;n.from=Promise.all([t.getAddress(),Cn(r,t)]).then(([s,i])=>(D(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else n.from=t.getAddress();return await En(n)}class Pee{provider;constructor(e){ve(this,{provider:e||null})}async getNonce(e){return wo(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await cC(this,e)}async populateTransaction(e){const n=wo(this,"populateTransaction"),r=await cC(this,e);r.nonce==null&&(r.nonce=await this.getNonce("pending")),r.gasLimit==null&&(r.gasLimit=await this.estimateGas(r));const s=await this.provider.getNetwork();if(r.chainId!=null){const o=de(r.chainId);D(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else r.chainId=s.chainId;const i=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||i)?D(!1,"eip-1559 transaction do not support gasPrice","tx",e):(r.type===0||r.type===1)&&i&&D(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1){const o=await n.getFeeData();z(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice)}else{const o=await n.getFeeData();if(r.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(r.authorizationList&&r.authorizationList.length?r.type=4:r.type=2,r.gasPrice!=null){const a=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=a,r.maxPriorityFeePerGas=a}else r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(z(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice),r.type=0):z(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(r.type===2||r.type===3||r.type===4)&&(r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await En(r)}async populateAuthorization(e){const n=Object.assign({},e);return n.chainId==null&&(n.chainId=(await wo(this,"getNetwork").getNetwork()).chainId),n.nonce==null&&(n.nonce=await this.getNonce()),n}async estimateGas(e){return wo(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return wo(this,"call").call(await this.populateCall(e))}async resolveName(e){return await wo(this,"resolveName").resolveName(e)}async sendTransaction(e){const n=wo(this,"sendTransaction"),r=await this.populateTransaction(e);delete r.from;const s=jr.from(r);return await n.broadcastTransaction(await this.signTransaction(s))}authorize(e){z(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function Oee(t){return JSON.parse(JSON.stringify(t))}class Wx{#e;#t;#n;#r;#s;#o;constructor(e){this.#e=e,this.#t=null,this.#n=this.#i.bind(this),this.#r=!1,this.#s=null,this.#o=!1}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,n){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}async#i(e){try{this.#t==null&&(this.#t=this._subscribe(this.#e));let n=null;try{n=await this.#t}catch(i){if(!an(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(n==null){this.#t=null,this.#e._recoverSubscriber(this,this._recover(this.#e));return}const r=await this.#e.getNetwork();if(this.#s||(this.#s=r),this.#s.chainId!==r.chainId)throw new Error("chaid changed");if(this.#o)return;const s=await this.#e.send("eth_getFilterChanges",[n]);await this._emitResults(this.#e,s)}catch(n){console.log("@TODO",n)}this.#e.once("block",this.#n)}#a(){const e=this.#t;e&&(this.#t=null,e.then(n=>{this.#e.destroyed||this.#e.send("eth_uninstallFilter",[n])}))}start(){this.#r||(this.#r=!0,this.#i(-2))}stop(){this.#r&&(this.#r=!1,this.#o=!0,this.#a(),this.#e.off("block",this.#n))}pause(e){e&&this.#a(),this.#e.off("block",this.#n)}resume(){this.start()}}class Ree extends Wx{#e;constructor(e,n){super(e),this.#e=Oee(n)}_recover(e){return new Cw(e,this.#e)}async _subscribe(e){return await e.send("eth_newFilter",[this.#e])}async _emitResults(e,n){for(const r of n)e.emit(this.#e,e._wrapLog(r,e._network))}}class kee extends Wx{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,n){for(const r of n)e.emit("pending",r)}}const Dee="bigint,boolean,function,number,string,symbol".split(/,/g);function vh(t){if(t==null||Dee.indexOf(typeof t)>=0||typeof t.getAddress=="function")return t;if(Array.isArray(t))return t.map(vh);if(typeof t=="object")return Object.keys(t).reduce((e,n)=>(e[n]=t[n],e),{});throw new Error(`should not happen: ${t} (${typeof t})`)}function Uee(t){return new Promise(e=>{setTimeout(e,t)})}function za(t){return t&&t.toLowerCase()}function lC(t){return t&&typeof t.pollingInterval=="number"}const Vx={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class em extends Pee{address;constructor(e,n){super(e),n=Qe(n),ve(this,{address:n})}connect(e){z(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(e){return await this.populateCall(e)}async sendUncheckedTransaction(e){const n=vh(e),r=[];if(n.from){const i=n.from;r.push((async()=>{const o=await Cn(i,this.provider);D(o!=null&&o.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),n.from=o})())}else n.from=this.address;if(n.gasLimit==null&&r.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const i=n.to;r.push((async()=>{n.to=await Cn(i,this.provider)})())}r.length&&await Promise.all(r);const s=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[s])}async sendTransaction(e){const n=await this.provider.getBlockNumber(),r=await this.sendUncheckedTransaction(e);return await new Promise((s,i)=>{const o=[1e3,100];let a=0;const c=async()=>{try{const l=await this.provider.getTransaction(r);if(l!=null){s(l.replaceableTransaction(n));return}}catch(l){if(an(l,"CANCELLED")||an(l,"BAD_DATA")||an(l,"NETWORK_ERROR")||an(l,"UNSUPPORTED_OPERATION")){l.info==null&&(l.info={}),l.info.sendTransactionHash=r,i(l);return}if(an(l,"INVALID_ARGUMENT")&&(a++,l.info==null&&(l.info={}),l.info.sendTransactionHash=r,a>10)){i(l);return}this.provider.emit("error",wt("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:l}))}this.provider._setTimeout(()=>{c()},o.pop()||4e3)};c()})}async signTransaction(e){const n=vh(e);if(n.from){const s=await Cn(n.from,this.provider);D(s!=null&&s.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),n.from=s}else n.from=this.address;const r=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[r])}async signMessage(e){const n=typeof e=="string"?si(e):e;return await this.provider.send("personal_sign",[re(n),this.address.toLowerCase()])}async signTypedData(e,n,r){const s=vh(r),i=await Xn.resolveNames(e,n,s,async o=>{const a=await Cn(o);return D(a!=null,"TypedData does not support null address","value",o),a});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(Xn.getPayload(i.domain,n,i.value))])}async unlock(e){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),e,null])}async _legacySignMessage(e){const n=typeof e=="string"?si(e):e;return await this.provider.send("eth_sign",[this.address.toLowerCase(),re(n)])}}class Bee extends Iee{#e;#t;#n;#r;#s;#o;#i;#a(){if(this.#r)return;const e=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");this.#r=setTimeout(()=>{this.#r=null;const n=this.#n;for(this.#n=[];n.length;){const r=[n.shift()];for(;n.length&&r.length!==this.#e.batchMaxCount;)if(r.push(n.shift()),JSON.stringify(r.map(i=>i.payload)).length>this.#e.batchMaxSize){n.unshift(r.pop());break}(async()=>{const s=r.length===1?r[0].payload:r.map(i=>i.payload);this.emit("debug",{action:"sendRpcPayload",payload:s});try{const i=await this._send(s);this.emit("debug",{action:"receiveRpcResult",result:i});for(const{resolve:o,reject:a,payload:c}of r){if(this.destroyed){a(wt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:c.method}));continue}const l=i.filter(u=>u.id===c.id)[0];if(l==null){const u=wt("missing response for request","BAD_DATA",{value:i,info:{payload:c}});this.emit("error",u),a(u);continue}if("error"in l){a(this.getRpcError(c,l));continue}o(l.result)}}catch(i){this.emit("debug",{action:"receiveRpcError",error:i});for(const{reject:o}of r)o(i)}})()}},e)}constructor(e,n){super(e,n),this.#t=1,this.#e=Object.assign({},Vx,n||{}),this.#n=[],this.#r=null,this.#o=null,this.#i=null;{let s=null;const i=new Promise(o=>{s=o});this.#s={promise:i,resolve:s}}const r=this._getOption("staticNetwork");typeof r=="boolean"?(D(!r||e!=="any","staticNetwork cannot be used on special network 'any'","options",n),r&&e!=null&&(this.#o=ir.from(e))):r&&(D(e==null||r.matches(e),"staticNetwork MUST match network object","options",n),this.#o=r)}_getOption(e){return this.#e[e]}get _network(){return z(this.#o,"network is not available yet","NETWORK_ERROR"),this.#o}async _perform(e){if(e.method==="call"||e.method==="estimateGas"){let r=e.transaction;if(r&&r.type!=null&&de(r.type)&&r.maxFeePerGas==null&&r.maxPriorityFeePerGas==null){const s=await this.getFeeData();s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null&&(e=Object.assign({},e,{transaction:Object.assign({},r,{type:void 0})}))}}const n=this.getRpcRequest(e);return n!=null?await this.send(n.method,n.args):super._perform(e)}async _detectNetwork(){const e=this._getOption("staticNetwork");if(e)if(e===!0){if(this.#o)return this.#o}else return e;return this.#i?await this.#i:this.ready?(this.#i=(async()=>{try{const n=ir.from(de(await this.send("eth_chainId",[])));return this.#i=null,n}catch(n){throw this.#i=null,n}})(),await this.#i):(this.#i=(async()=>{const n={id:this.#t++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let r;try{r=(await this._send(n))[0],this.#i=null}catch(s){throw this.#i=null,this.emit("debug",{action:"receiveRpcError",error:s}),s}if(this.emit("debug",{action:"receiveRpcResult",result:r}),"result"in r)return ir.from(de(r.result));throw this.getRpcError(n,r)})(),await this.#i)}_start(){this.#s==null||this.#s.resolve==null||(this.#s.resolve(),this.#s=null,(async()=>{for(;this.#o==null&&!this.destroyed;)try{this.#o=await this._detectNetwork()}catch(e){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",wt("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:e}})),await Uee(1e3)}this.#a()})())}async _waitUntilReady(){if(this.#s!=null)return await this.#s.promise}_getSubscriber(e){return e.type==="pending"?new kee(this):e.type==="event"?this._getOption("polling")?new Cw(this,e.filter):new Ree(this,e.filter):e.type==="orphan"&&e.filter.orphan==="drop-log"?new qx("orphan"):super._getSubscriber(e)}get ready(){return this.#s==null}getRpcTransaction(e){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(r=>{if(e[r]==null)return;let s=r;r==="gasLimit"&&(s="gas"),n[s]=zr(de(e[r],`tx.${r}`))}),["from","to","data"].forEach(r=>{e[r]!=null&&(n[r]=re(e[r]))}),e.accessList&&(n.accessList=ya(e.accessList)),e.blobVersionedHashes&&(n.blobVersionedHashes=e.blobVersionedHashes.map(r=>r.toLowerCase())),e.authorizationList&&(n.authorizationList=e.authorizationList.map(r=>{const s=ZS(r);return{address:s.address,nonce:zr(s.nonce),chainId:zr(s.chainId),yParity:zr(s.signature.yParity),r:zr(s.signature.r),s:zr(s.signature.s)}})),n}getRpcRequest(e){switch(e.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[za(e.address),e.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[za(e.address),e.blockTag]};case"getCode":return{method:"eth_getCode",args:[za(e.address),e.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[za(e.address),"0x"+e.position.toString(16),e.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[e.signedTransaction]};case"getBlock":if("blockTag"in e)return{method:"eth_getBlockByNumber",args:[e.blockTag,!!e.includeTransactions]};if("blockHash"in e)return{method:"eth_getBlockByHash",args:[e.blockHash,!!e.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[e.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[e.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(e.transaction),e.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(e.transaction)]};case"getLogs":return e.filter&&e.filter.address!=null&&(Array.isArray(e.filter.address)?e.filter.address=e.filter.address.map(za):e.filter.address=za(e.filter.address)),{method:"eth_getLogs",args:[e.filter]}}return null}getRpcError(e,n){const{method:r}=e,{error:s}=n;if(r==="eth_estimateGas"&&s.message){const a=s.message;if(!a.match(/revert/i)&&a.match(/insufficient funds/i))return wt("insufficient funds","INSUFFICIENT_FUNDS",{transaction:e.params[0],info:{payload:e,error:s}});if(a.match(/nonce/i)&&a.match(/too low/i))return wt("nonce has already been used","NONCE_EXPIRED",{transaction:e.params[0],info:{payload:e,error:s}})}if(r==="eth_call"||r==="eth_estimateGas"){const a=W0(s),c=Oc.getBuiltinCallException(r==="eth_call"?"call":"estimateGas",e.params[0],a?a.data:null);return c.info={error:s,payload:e},c}const i=JSON.stringify(Lee(s));if(typeof s.message=="string"&&s.message.match(/user denied|ethers-user-denied/i))return wt("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[r]||"unknown",reason:"rejected",info:{payload:e,error:s}});if(r==="eth_sendRawTransaction"||r==="eth_sendTransaction"){const a=e.params[0];if(i.match(/insufficient funds|base fee exceeds gas limit/i))return wt("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:a,info:{error:s}});if(i.match(/nonce/i)&&i.match(/too low/i))return wt("nonce has already been used","NONCE_EXPIRED",{transaction:a,info:{error:s}});if(i.match(/replacement transaction/i)&&i.match(/underpriced/i))return wt("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:a,info:{error:s}});if(i.match(/only replay-protected/i))return wt("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:r,info:{transaction:a,info:{error:s}}})}let o=!!i.match(/the method .* does not exist/i);return o||s&&s.details&&s.details.startsWith("Unauthorized method:")&&(o=!0),o?wt("unsupported operation","UNSUPPORTED_OPERATION",{operation:e.method,info:{error:s,payload:e}}):wt("could not coalesce error","UNKNOWN_ERROR",{error:s,payload:e})}send(e,n){if(this.destroyed)return Promise.reject(wt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e}));const r=this.#t++,s=new Promise((i,o)=>{this.#n.push({resolve:i,reject:o,payload:{method:e,params:n,id:r,jsonrpc:"2.0"}})});return this.#a(),s}async getSigner(e){e==null&&(e=0);const n=this.send("eth_accounts",[]);if(typeof e=="number"){const s=await n;if(e>=s.length)throw new Error("no such account");return new em(this,s[e])}const{accounts:r}=await En({network:this.getNetwork(),accounts:n});e=Qe(e);for(const s of r)if(Qe(s)===e)return new em(this,e);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new em(this,n))}destroy(){this.#r&&(clearTimeout(this.#r),this.#r=null);for(const{payload:e,reject:n}of this.#n)n(wt("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e.method}));this.#n=[],super.destroy()}}class $ee extends Bee{#e;constructor(e,n){super(e,n);let r=this._getOption("pollingInterval");r==null&&(r=Vx.pollingInterval),this.#e=r}_getSubscriber(e){const n=super._getSubscriber(e);return lC(n)&&(n.pollingInterval=this.#e),n}get pollingInterval(){return this.#e}set pollingInterval(e){if(!Number.isInteger(e)||e<0)throw new Error("invalid interval");this.#e=e,this._forEachSubscriber(n=>{lC(n)&&(n.pollingInterval=this.#e)})}}function W0(t){if(t==null)return null;if(typeof t.message=="string"&&t.message.match(/revert/i)&&dt(t.data))return{message:t.message,data:t.data};if(typeof t=="object"){for(const e in t){const n=W0(t[e]);if(n)return n}return null}if(typeof t=="string")try{return W0(JSON.parse(t))}catch{}return null}function V0(t,e){if(t!=null){if(typeof t.message=="string"&&e.push(t.message),typeof t=="object")for(const n in t)V0(t[n],e);if(typeof t=="string")try{return V0(JSON.parse(t),e)}catch{}}}function Lee(t){const e=[];return V0(t,e),e}class ys extends $ee{#e;#t;constructor(e,n,r){const s=Object.assign({},r??{},{batchMaxCount:1});D(e&&e.request,"invalid EIP-1193 provider","ethereum",e),super(n,s),this.#t=null,r&&r.providerInfo&&(this.#t=r.providerInfo),this.#e=async(i,o)=>{const a={method:i,params:o};this.emit("debug",{action:"sendEip1193Request",payload:a});try{const c=await e.request(a);return this.emit("debug",{action:"receiveEip1193Result",result:c}),c}catch(c){const l=new Error(c.message);throw l.code=c.code,l.data=c.data,l.payload=a,this.emit("debug",{action:"receiveEip1193Error",error:l}),l}}}get providerInfo(){return this.#t}async send(e,n){return await this._start(),await super.send(e,n)}async _send(e){D(!Array.isArray(e),"EIP-1193 does not support batch request","payload",e);try{const n=await this.#e(e.method,e.params||[]);return[{id:e.id,result:n}]}catch(n){return[{id:e.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(e,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(e,n)}async hasSigner(e){e==null&&(e=0);const n=await this.send("eth_accounts",[]);return typeof e=="number"?n.length>e:(e=e.toLowerCase(),n.filter(r=>r.toLowerCase()===e).length!==0)}async getSigner(e){if(e==null&&(e=0),!await this.hasSigner(e))try{await this.#e("eth_requestAccounts",[])}catch(n){const r=n.payload;throw this.getRpcError(r,{id:r.id,error:n})}return await super.getSigner(e)}static async discover(e){if(e==null&&(e={}),e.provider)return new ys(e.provider);const n=e.window?e.window:typeof window<"u"?window:null;if(n==null)return null;const r=e.anyProvider;if(r&&n.ethereum)return new ys(n.ethereum);if(!("addEventListener"in n&&"dispatchEvent"in n&&"removeEventListener"in n))return null;const s=e.timeout?e.timeout:300;return s===0?null:await new Promise((i,o)=>{let a=[];const c=d=>{a.push(d.detail),r&&l()},l=()=>{if(clearTimeout(u),a.length)if(e&&e.filter){const d=e.filter(a.map(h=>Object.assign({},h.info)));if(d==null)i(null);else if(d instanceof ys)i(d);else{let h=null;if(d.uuid&&(h=a.filter(p=>d.uuid===p.info.uuid)[0]),h){const{provider:f,info:p}=h;i(new ys(f,void 0,{providerInfo:p}))}else o(wt("filter returned unknown info","UNSUPPORTED_OPERATION",{value:d}))}}else{const{provider:d,info:h}=a[0];i(new ys(d,void 0,{providerInfo:h}))}else i(null);n.removeEventListener("eip6963:announceProvider",c)},u=setTimeout(()=>{l()},s);n.addEventListener("eip6963:announceProvider",c),n.dispatchEvent(new Event("eip6963:requestProvider"))})}}async function Mee(t,e,n){const r=document.getElementById("historico");if(!r){console.warn("Elemento #historico no encontrado no DOM.");return}r.innerHTML=`
    <thead>
      <tr>
        <th>You</th>
        <th>Contract</th>
        <th>Result</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody id="historico-body">
    </tbody>
  `;const s=document.getElementById("historico-body");if(!t){s.innerHTML='<tr><td colspan="4">Conta no fornecida.</td></tr>';return}try{const i=new ys(window.ethereum),a=await new Cs(e,n,i).verHistorico(t),c=Array.isArray(a)?a:Object.values(a);if(!c||c.length===0){s.innerHTML="<tr><td colspan='4'>Nenhuma jogada registrada.</td></tr>";return}const l=["Rock","Paper","Scissors"],u=["Loss","Draw","Victory"],d=c.map(h=>{let f=h;Array.isArray(h)?f={jogadorEscolha:h[0],contratoEscolha:h[1],resultado:h[2],timestamp:h[3]}:h.timestamp&&typeof h.timestamp._isBigNumber<"u"?f.timestamp=Number(h.timestamp.toString()):h.timestamp&&typeof h.timestamp=="string"&&(f.timestamp=Number(h.timestamp));const p=Number(f.jogadorEscolha)||0,g=Number(f.contratoEscolha)||0,m=Number(f.resultado)||0,y=Number(f.timestamp)||0,v=y>0?new Date(y*1e3).toLocaleString():"-";return`
        <tr>
          <td>${l[p]??p}</td>
          <td>${l[g]??g}</td>
          <td>${u[m]??m}</td>
          <td>${v}</td>
        </tr>
      `}).join("");s.innerHTML=d}catch(i){console.error("Erro ao buscar histrico:",i),s.innerHTML="<tr><td colspan='4'>Erro ao buscar histrico. Veja console.</td></tr>"}}const G0=[{inputs:[],name:"pagarParaJogar",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"escolha",type:"uint8"}],name:"jogar",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"sacarPremio",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"jogador",type:"address"}],name:"verUltimoResultado",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"jogador",type:"address"},{indexed:!1,internalType:"uint8",name:"jogadorEscolha",type:"uint8"},{indexed:!1,internalType:"uint8",name:"contratoEscolha",type:"uint8"},{indexed:!1,internalType:"uint8",name:"resultado",type:"uint8"}],name:"JogoRealizado",type:"event"},{inputs:[{internalType:"address",name:"jogador",type:"address"}],name:"verHistorico",outputs:[{components:[{internalType:"uint8",name:"jogadorEscolha",type:"uint8"},{internalType:"uint8",name:"contratoEscolha",type:"uint8"},{internalType:"uint8",name:"resultado",type:"uint8"},{internalType:"uint256",name:"timestamp",type:"uint256"}],internalType:"struct PedraPapelTesoura.Jogada[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"}],Fee=[{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],type:"function"}];async function jee(t,e,n){if(!t){console.warn("Conta no fornecida.");return}try{const r=new ys(window.ethereum),i=await new Cs(e,n,r).verHistorico(t);let o=0;i.forEach(h=>{Number(h.resultado)===2&&o++});let a="0",c="",l=0;const u=" - - - ";o>=20?(l=4,a=`lvl - ${l}`,c=`<div class="lvl">
        <p class="green"> 01 </p> ${u}
        <p class="green"> 02 </p> ${u}
        <p class="green"> 03 </p> ${u}
        <p class="green"> 04 </p> ${u}
        <p class="green"> 05 </p>
      </div>`):o>=10?(l=4,a=`lvl - ${l}`,c=`<div class="lvl">
        <p class="green"> 01 </p> ${u}
        <p class="green"> 02 </p> ${u}
        <p class="green"> 03 </p> ${u}
        <p class="green"> 04 </p> ${u}
        <p class="blue"> 05 </p>
      </div>`):o>=5?(l=3,a=`lvl - ${l}`,c=`<div class="lvl">
        <p class="green"> 01 </p> ${u}
        <p class="green"> 02 </p> ${u}
        <p class="green"> 03 </p> ${u}
        <p class="blue"> 04 </p> ${u}
        <p class="blue"> 05 </p>
      </div>`):o>=3?(l=2,a=`lvl - ${l}`,c=`<div class="lvl">
        <p class="green"> 01 </p> ${u}
        <p class="green"> 02 </p> ${u}
        <p class="blue"> 03 </p> ${u}
        <p class="blue"> 04 </p> ${u}
        <p class="blue"> 05 </p>
      </div>`):o>=1?(l=1,a=`lvl - ${l}`,c=`<div class="lvl">
        <p class="green"> 01 </p> ${u}
        <p class="blue"> 02 </p> ${u}
        <p class="blue"> 03 </p> ${u}
        <p class="blue"> 04 </p> ${u}
        <p class="blue"> 05 </p>
      </div>`):(l=0,a=`lvl - ${l}`,c=`<div class="lvl">
        <p class="blue"> 01 </p> ${u}
        <p class="blue"> 02 </p> ${u}
        <p class="blue"> 03 </p> ${u}
        <p class="blue"> 04 </p> ${u}
        <p class="blue"> 05 </p>
      </div>`);const d=document.getElementById("estagio");d&&(d.innerHTML=`<p class="stage">Progress: ${a} (${o} Victorys)</p>${c}`)}catch(r){console.error("Erro ao calcular estgio:",r)}}async function Hee(t,e,n,r,s,i){try{if(!t){i("Connect your wallet first.");return}const a=await new ys(window.ethereum).getSigner(),c=new Cs(e,n,a),l=new Cs(r,s,a),u=NY("1");await c.allowance(t,r)<u&&(i("Approve in your wallet..."),await(await c.approve(r,u)).wait()),i("Processing payment..."),await(await l.pagarParaJogar()).wait(),i("Payment completed. You can now play!")}catch(o){console.error(o),i("Payment failed. Try again.")}}const Gx="bd0ab918d624ef2d2ffd4e9339919390",Kx="0x532BafEb091a55F54079772dcCFC2Ba730A727F7",zee=["function balanceOf(address owner) view returns (uint256)","function decimals() view returns (uint8)","function symbol() view returns (string)"],qee=new XJ({projectId:Gx,networks:[QN]}),Wee={name:"Joken App",description:"Jogo Joken Web3",url:window.location.origin,icons:["https://react-wallet.walletconnect.com/chain-logos/eip155-1.png"]},Iw=oJ({adapters:[qee],networks:[QN],projectId:Gx,metadata:Wee,features:{analytics:!1}});async function Vee(t){try{const e=new ys(window.ethereum),n=await e.getBalance(t);document.getElementById("saldo-eth").innerText=`${_Y(n)} ETH`;const r=new Cs(Kx,zee,e),[s,i,o]=await Promise.all([r.balanceOf(t),r.decimals(),r.symbol()]);document.getElementById("saldo-token").innerText=`${mS(s,i)} ${o}`}catch(e){console.error("Erro ao buscar saldos:",e)}}document.getElementById("open-connect-modal").addEventListener("click",()=>{Iw.open()});let Li=null;Iw.subscribeAccount(t=>{t&&t.address?(Li=t.address,document.getElementById("conta").innerText=Li,Vee(Li),Kee(),Mee(Li,K0,G0),jee(Li,K0,G0)):(Li=null,document.getElementById("conta").innerText="Disconnected",document.getElementById("saldo-eth").innerText="",document.getElementById("saldo-token").innerText="",document.getElementById("estagio").innerHTML="")});const K0="0x4d7A5aF32d2b5ec7734e2D4EBe17E8260441fdd2";function Gee(){const t=document.getElementById("historico-container");t.style.display=t.style.display==="none"?"block":"none"}function Kee(){document.getElementById("btn-historico").style.display="inline-block"}document.getElementById("open-connect-modal").addEventListener("click",()=>{Iw.open()});document.getElementById("btn-historico").addEventListener("click",Gee);function uC(t){const e=document.getElementById("mensagem");e&&(e.innerText=t)}document.getElementById("btn-pagar").addEventListener("click",()=>{if(!Li){uC("Connect your wallet first.");return}Hee(Li,Kx,Fee,K0,G0,uC)});export{$n as $,fe as A,Ee as B,ee as C,Du as D,Jt as E,De as F,VI as G,ep as H,G as I,iy as J,vr as K,wR as L,b3 as M,CT as N,FI as O,$i as P,gc as Q,Ce as R,ws as S,sI as T,Lt as U,_l as V,Ht as W,eo as X,Fe as Y,mC as Z,nn as _,gh as a,st as a$,Sh as a0,ty as a1,Xi as a2,Qee as a3,xf as a4,ny as a5,Yee as a6,Jee as a7,Nf as a8,Ih as a9,dte as aA,l3 as aB,H as aC,SK as aD,Et as aE,ql as aF,we as aG,Hi as aH,me as aI,ye as aJ,gt as aK,Zs as aL,Sl as aM,dB as aN,hne as aO,cE as aP,$_ as aQ,pu as aR,iB as aS,B_ as aT,hB as aU,fne as aV,dne as aW,Lh as aX,mne as aY,pne as aZ,jn as a_,eO as aa,sO as ab,Nte as ac,sR as ad,W as ae,Gu as af,pc as ag,VO as ah,_s as ai,Yo as aj,pte as ak,Ft as al,Xee as am,Af as an,Vn as ao,GC as ap,ote as aq,Y0 as ar,Wl as as,Nh as at,Jo as au,cte as av,vO as aw,ate as ax,lte as ay,_h as az,Dne as b,zC as b$,ST as b0,_m as b1,Hr as b2,br as b3,Une as b4,Sf as b5,Je as b6,WN as b7,C0 as b8,Cc as b9,Zl as bA,ik as bB,E3 as bC,cm as bD,LC as bE,Ko as bF,uk as bG,fc as bH,Vi as bI,WO as bJ,LI as bK,kh as bL,OR as bM,rR as bN,qC as bO,$I as bP,Pte as bQ,Ste as bR,jI as bS,Tte as bT,xte as bU,Pf as bV,uy as bW,ly as bX,W3 as bY,QP as bZ,Dc as b_,wf as ba,sh as bb,fh as bc,Ch as bd,on as be,A0 as bf,ps as bg,Ok as bh,Zee as bi,Z0 as bj,Cf as bk,tR as bl,mt as bm,SI as bn,Ps as bo,xh as bp,xI as bq,A3 as br,PI as bs,D3 as bt,Bc as bu,py as bv,Oh as bw,HI as bx,sk as by,rk as bz,F as c,fte as c0,ete as c1,Is as c2,If as c3,GI as c4,M3 as c5,pI as c6,t3 as c7,vf as c8,oy as c9,Rp as cA,n3 as cB,gte as cC,wI as cD,mte as cE,II as cF,NI as cG,vk as cH,WI as cI,gy as cJ,RC as cK,Ku as cL,qn as cM,RR as cN,uI as cO,dk as cP,LJ as cQ,Ak as cR,Cd as cS,HC as cT,Rte as cU,$k as cV,pT as cW,hs as cX,BJ as cY,rr as cZ,cy as ca,Tf as cb,k3 as cc,Ate as cd,vte as ce,Ete as cf,wc as cg,Ws as ch,wte as ci,RI as cj,bte as ck,U3 as cl,j3 as cm,Ote as cn,BI as co,kte as cp,ite as cq,jR as cr,PR as cs,du as ct,xk as cu,Nk as cv,Sk as cw,ck as cx,fy as cy,_k as cz,et as d,$ne as e,T as f,or as g,le as h,sc as i,nP as j,pt as k,yy as l,Ye as m,wC as n,Y as o,ct as p,cn as q,Bne as r,ln as s,xK as t,Lne as u,Mne as v,cr as w,kne as x,xo as y,Ns as z};
